wheatprojdoc060117.txt

06/01/17:
## talked to Vikas, to do:

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /home/baenziger/pterry
-bash: cd: /home/baenziger/pterry: No such file or directory

## ck Adam, get new HCC acct working
## unclear how Vikas works on this acct, Adam created pterry dir. (OK, Vikas, group works this way) under baenziger in both home & work directories (apparently they don't routinely do ???????). 
So, need **check** wi Vikas, how they work with their directories, and any 'common' dir. ?????????????????????????

## plans for using bedtools to achieve correct numbering for *two part* wheat chromosomes (16 Gb genome). I note the 'locations' were in columns, similar to data.frame structure. Perhaps relatively easy to import into R, manipulate there?

## Vikas to put following file into tusker/share. I can copy it from there.
## Check Adam, my globus not working ??????????????????

Sykes, et al., see discussion, p-356, 
## step 1: PPR.hmm on 
iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip
-----------------------------------------------
Contains the protein sequence of all high-confidence (HC) gene models that have been positioned on the IWGSC sequence assembly, without splice variants. Only the representative gene model per locus is given.

06/05/17:
ssh -Y pterry@tusker.unl.edu
# Rrq096mN
cd /home/baenziger/pterry
cd /home/baenziger/shared/RefSeq_v1_Annotation/proteins/
ls -lh
[pterry@login.tusker proteins]$ pwd
/home/baenziger/shared/RefSeq_v1_Annotation/proteins

[pterry@login.tusker proteins]$ ls -lh
total 25M
-rw-r--r-- 1 vbelamkar2 baenziger 25M Apr 11 08:45 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip
-rw-r--r-- 1 vbelamkar2 baenziger 118 Apr 11 08:45 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip.md5.txt
logout

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry
mkdir wheatproj
cd wheatproj
cd /work/baenziger/pterry/wheatproj

scp pterry@tusker.unl.edu:/home/baenziger/shared/RefSeq_v1_Annotation/proteins/iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip .
ls -lh

scp pterry@tusker.unl.edu:/home/baenziger/shared/RefSeq_v1_Annotation/proteins/iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip.md5.txt .
ls -lh
## Q: how do md5 ?????????????
md5sum <filetocheck> 
md5sum iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip
3acdf6120fcff98d8e65500b24362fe7
cat iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip.md5.txt
The MD5 checksum value is: 3acdf6120fcff98d8e65500b24362fe7
## so checks out.
unzip iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip > iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
## looks like unzip just removes the 'zip' & leaves the '.fa' file, redirect does *not* work, it trying to replace the '.fa' file it just created.

unzip iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip
ls -lh
less iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
>TraesCS1A01G000100.1
MRVIALSAGVTPSLRIGLPMCKCRSHGTFLLFGLQSSHLNICYYHQDLPRRPLCPGSRPG
FCSGRRALLLIGAWRSSRWPGVGRAL*
>TraesCS1A01G000200.1
MVNNLWPMEQCRQGKSAKRIRNFGKRICSEDWAQGSRPRTRRLSADCSCCSRGKSRSPRA
GQGTDQESPLRGLSPSMKQSTQNWYGQGESDYLIKTKHCDGPRGN*
## Q: '*' character ??????????????????????????????????????????????????

## OK, what need for input to hmmsearch ?????????????????
## what kind of file is Trinity.fasta.transdecoder.pep  ????????????????
## p-21, Hmmer manual, a 'fasta' file.
## so perhaps I have an appropriate input file.



## plan for using Hmmer for identifying PPR proteins in new wheat genome
## dnload PPR.hmm (done, from http://pfam.xfam.org/family/ppr#tabview=tab6)

## need couple species controls, check Sykes ref, possibly arabidopsis, rice ????? => **see** 1st few sentence 'Discussion' sectiom, rice, brachypodium, & sorghum

## read over Sykes paper again, get 'controls' used there ?????

06/04/17:
## Hmmer steps:
## Hmmer User's Guide, p-21-27, discussing 'hmmsearch' output

06/06/17: 
## line 8189, my **1st** hmmsearch in Bdac... file

ssh -Y pterry@crane.unl.edu 
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
ls -lh
wc iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
  921676   921676 48634703 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
# grep -c "^>" longest_orfs.pep  ## 158367
grep -c "^>" iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa  ## 110790
## apparently on average, fasta seqs *ave* 7 lines ??????????????

## need scp PPR.hmm to crane

scp PPR.hmm pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
# hmmsearch NB-ARC.hmm Trinity.fasta.transdecoder.pep > hmmsrchshortpep.out
hmmsearch PPR.hmm iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa > PPR.out
## ran almost *instantly*
ls -lh
-rw-r--r-- 1 pterry amundsen   6704453 Jun  6 17:14 PPR.out
less PPR.out
wc PPR.out
 118172  689922 6704453 PPR.out

## now what to do with this output ????????
## initially, perhaps scp it to macbook, examine what have. Think need create a fasta file of top hits (how decide) ???????????
## Q: check Vikas AWK script ???????????????????????????????????????
## from /work/baenziger/pterry/wheatproj/PPR.out file
logout

cd /Users/bterry/macbook2017/vikas17/wheatproj
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/PPR.out .
ls -lh
## Hmmer User's Guide, p-21-27, discussing 'hmmsearch' output
## line 8203 (Bdac...)
## note: PPR.out has *no* 'description' colm entries, hmmsrchshortpep.out *does* ????????
## line 8208, ## 3rd colm, 'bias' ...
## line 8210, The next three colms are again an E-value, score, and bias, but only for the **single** best-scoring domain in the sequence, rather than the sum of all its identified domains.
## line 8213, ## So ***operationally***,
if both E-values are significant (<< 1), the sequence is likely to be homologous to your query.

06/12/17:
## Note: p-544, cheng ref., 0.1 for *full*, 100 for *domain* ??????
## Q: few comments:
## PPR.out, line 1540, 'inclusion threshold'
## p-9, sci. reports, RFL genes  >= 10 p-class ppr motifs, (note: sec 2, PPR.out, line 542, # domains < 10) So, should num. domains affect cutoff for hmmsearch hits ?????????????????
## p-533, cheng ref., PPR proteins, 2 to 30 tandem repeats ??????????????
## p-533, cheng ref., PPR.out, line 1562, criteria cutoff, 
(-E 0.1),
(-E 100)
## compare, hmmer doc, p-23, cutoff E-value <= 10.0, catches *all* 1595 lines sec 2, PPR.out 
## hmmer doc, p-24, sec 3, ...

## talked to Vikas, would like to take hits in PPR.out file using cheng, p-544 criterion of 'full' E-value <= 0.1. This line 1562 and above in sec 2.

06/13/17:
## So, to do, start  wi PPR.out file
i) remove sec 1 above sec 2
cd /Users/bterry/macbook2017/vikas17/wheatproj
head -n 1562 PPR.out | tail -n 1

ii) get sec 2 rows of PPR.out, lines 1562 & above
head -n 1562 PPR.out | tail -n 1546 | head -n 1
head -n 1562 PPR.out | tail -n 1546 > PPRsec2_1562.txt
## Left, remove line 1524, 'inclusion threshold' in new file
## try unix commands before doing wi BBedit, remaining, 1523 lines.
head -n 1523 PPRsec2_1562.txt > top.txt
tail -n 22 PPRsec2_1562.txt > bottom.txt

cat top.txt bottom.txt > tmp.txt
wc -l tmp.txt  ## expect 1545
    1545 tmp.txt

## examine tmp.txt in BBedit, if line above, below 'inclusion threshold' line ok, (looks good) then
mv tmp.txt PPRsec2_1562.txt  ## done, now 1545 in length
wc -l PPRsec2_1562.txt
    1545 PPRsec2_1562.txt  ## ok, have 9 colms

iii) cut colm 9, the 'sequence' colm.
#cut -f 9 PPRsec2_1562.txt | head -n 3
#cut -d ' ' -f 24 PPRsec2_1562.txt > PPRsec2_1562seqname.txt
## *not* working, varying number spaces in lines.
## so, try read into **R**, get 'sequence' colm that way ?????????

#xlsC_up_logdf <- read.delim("xlsC_up_logdf.txt", header=T, sep=" ", stringsAsFactors=FALSE)
## inside rStudio & R
setwd("~/macbook2017/vikas17/wheatproj")
#PPRsec2_1562 <- read.delim("PPRsec2_1562.txt", header=FALSE, sep=" ", stringsAsFactors=FALSE)
dim(PPRsec2_1562)  ## [1] 2290   27 ?????????????????????????????
head(PPRsec2_1562, n=3)
tail(PPRsec2_1562, n=3)
rm(PPRsec2_1562)
PPRsec2_1562 <- read.delim("PPRsec2_1562.txt", header=FALSE, stringsAsFactors=FALSE)
dim(PPRsec2_1562)  ## [1] 1545    1   ???????????????????????????????
head(PPRsec2_1562, n=3)
1    3.1e-147  471.5  44.9    3.7e-09   38.7   0.1   21.3 21  TraesCSU01G134400.1   
## so, right number rows, all in ***one*** colm ??????????????????
class(PPRsec2_1562)  ## [1] "data.frame"
## now what? Can I separate fields into df wi 9 fields ?????????????

#write.table(RefSeqID_seq, file="Trinity.fasta.transdecoder.pep.df.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE) 
write.table(PPRsec2_1562, file="Testwrite.txt", quote=FALSE, sep="\t", row.names=FALSE) 

## talked to Vikas about working with sec 2, hmmsearch output in PPRsec2_1562.txt.
cat PPRsec2_1562.txt|perl -pe 's/.+(Traes.+)/\1/'| head -n 3
TraesCSU01G134400.1   
TraesCS6B01G108900.1  
TraesCS6A01G081600.2 
## so, looks like successful peeling off colm 9.
cat PPRsec2_1562.txt|perl -pe 's/.+(Traes.+)/\1/' | > PPRsec2 _1562_Seqscolm.txt
## gives error ???????????????
cat PPRsec2_1562.txt|perl -pe 's/.+(Traes.+)/\1/'| head -n 1545 > PPRsec2_1562_Seqscolm.txt
## 1st & last rows look ok.
iv) sort | uniq | length, see if still have same number as in PPRsec2_1562.txt (i.e., are there any duplicates)? Name this file PPRseqnames.txt 

sort PPRsec2_1562_Seqscolm.txt |uniq | wc -l  ##     1545  as expected if each record in unique.

## next use Vikas getsubsetfatofa.awk (getseq.awk) pgm to subset the records selected by hmmsearch in iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa file to file PPR.out.

06/14/17:
## 1st need scp iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa file from crane to macbook.

scp ...
cd /Users/bterry/macbook2017/vikas17/wheatproj
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa .
-rw-r--r--   1 bterry  staff  48634703 Jun 14 10:27 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
ssh -Y pterry@crane.unl.edu 
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
ls -al

## currently 644,
-rw-r--r--@ 1 bterry  staff   1.7K Jun 12 11:40 getseq.awk
## so not executable, Q: the '@' ?????????????????
#chmod u=rwx,g=rx,o=r myfile
chmod 755 getseq.awk
ls -lh
## Q: what wrong? Looks like at https://stackoverflow.com/questions/9991858/how-to-run-a-awk-file
## 1st line script needs to be right ?????????????????????

philip-terry-2:wheatproj bterry$ ./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa PPRsec2_1562_Seqscolm.txt | head -n 3
>TraesCS1A01G031600.1
MDCCCRACRTDLALAFFGRLLRTGLQAGQVVFNTLLKGLCHTKRADEALDVLLHRMPELG
CTPDVVAYNTVIHGFFREGQVGKACDMFHGMAQKGVMPNVVTYNSVIDGLCKARAMDKAE
## so worked.

## To try 
./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa PPRsec2_1562_Seqscolm.txt > PPRhmmsearchsubset.fa
wc -l PPRhmmsearchsubset.fa
   18284 PPRhmmsearchsubset.fa
grep -c "^>Tr" PPRhmmsearchsubset.fa   # 1545 as expect

python seqread.py first6ref.fta
python findcol3.py PPRsec2_1562.txt
## no output ???, perhaps try with make up some file data ??????????????
python findcol3.py
## failed on PPRsec2_1562.txt ????????????????????????????????????????

## OK, ready for next step, 

Vikas email, submit PPRhmmsearchsubset.fa to pfam at:
http://pfam.xfam.org/search#tabview=tab1
## problem, 500 or 5000 limit number sequences ??????????????????????????

06/15/17:
## so try say 1st 500 seqs. Q: how select 1st 500 'name' lines ????????????
grep "^>Tr" PPRhmmsearchsubset.fa > namelines.txt
wc -l namelines.txt  ##     1545 namelines.txt
## so 1st 500 seqs in PPRhmmsearchsubset.fa ends on line 5839
head -n 5839 PPRhmmsearchsubset.fa > PPRhmmsearchsubset1to500.fa
submit PPRhmmsearchsubset1to500.fa to pfam at:
http://pfam.xfam.org/search#tabview=tab1
## 2:16pm, approx wait time, 1hr 34 min.
## Output to browser screen, number of links ??????????
## email
# Your job id was: 0563853C-51FF-11E7-AAEB-FFCADBC3747A
# You can retrieve the **full** results by going to:
# http://www.ebi.ac.uk/Tools/hmmer/results/score/0563853C-51FF-11E7-AAEB-FFCADBC3747A
## complicated output, **HMMSCAN**
# If you have any comments or questions about the use of this service,
# please contact us at: hmmer-help@ebi.ac.uk

## check Vikas, what to do with this output?


## try put couple files in /work/baenziger/share
PPRhmmsearchsubset.fa
PPRhmmsearchsubset1to500.fa

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
ls -lh
cd ..
cd ..
cd shared
ls -lh
mkdir terry
cd terry
mkdir hmm
cd hmm
pwd
logout

cd /Users/bterry/macbook2017/vikas17/wheatproj

scp PPRhmmsearchsubset.fa pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm
scp PPRhmmsearchsubset1to500.fa pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm

## log back in, check /work/baenziger/shared/terry/hmm dir.
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/shared/terry/hmm
ls -al  ## sizes are same.

06/17/17:
Talked to vikas about:
## search refs for method to subset PLS, P subsets of PPRs ??????******??????
## try cheng paper, which others ???????????????????
## check where mentions particular genes having RF capability ??????????
## 1st 500 results from online hmmscan for PPRhmmsearchsubset1to500.fa.
## Idea: set up pipeline to get the output got in *email* for multiple species. Course, catenate results with more than 500 rows submitted to pfam.
## **pipeline**:
For each species:
i) hmmsearch the .fa file
# hmmsearch PPR.hmm iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa > PPR.out
## so for wheat, done, result PPR.out

ii) get colm 10 from hmmsearch output using vikas **one** line command

philip-terry-2:wheatproj bterry$ grep "Traes" PPR.out|tr -s " " "\t"|awk -F'\t' -v OFS='\t' '$2<0.1 {print $10}' > PPR.out.E0p1.txt
## 1545 records, colm 10.
## *same* as PPRsec2_1562_Seqscolm.txt, also 1545 records

## *testing* getting hmmsearch output into 'handleable' form.
grep "Traes" PPR.out|tr -s " " "\t"|awk -F'\t' -v OFS='\t' '$2<0.1 {print $2, $3, $4, $5, $6, $7, $8, $9, $10}' > test.txt
## looks like got colms 2 thru 10 sep'd wi '\t'

Test read.delim into R? Then try 'dim' number colms? Will I have to try remove removed 1st '\t' in Bbedit before read.delim? (done above)
testdf <- read.delim("test.txt", header=FALSE, stringsAsFactors=FALSE)
dim(testdf)  ##  [1] 1545    9  as expected.
head(testdf, n=3)   ## looks ok

06/18/17:

iii) getseq.AWK script to subset input .fa file
./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa PPRsec2_1562_Seqscolm.txt > PPRhmmsearchsubset.fa
wc -l PPRhmmsearchsubset.fa
   18284 PPRhmmsearchsubset.fa
grep -c "^>Tr" PPRhmmsearchsubset.fa   # 1545 as expect

## for wheat, proceed with use PPRsec2_1562_Seqscolm.txt rather than switching to PPR.out.E0p1.txt produced by Vikas. They the same. 

06/19/17:

iv) upload subset fasta to pfam online for hmmscan search.
## need do 4 times, including repeat of 1 to 500.

## so resubmit PPRhmmsearchsubset1to500.fa to hmmscan online pfam.
http://pfam.xfam.org/search#tabview=tab1
## cp/rename 1st, PPRhmmsearchsubset1to500.fa to PPRhmmsearchsubset1to500_2nd.fa
Your job is queued behind 5123 other searches. (approximate wait time: 2 hours and 51 minutes)
## **error** in receiving results, says on browser, no email message.
## so start another run, with PPRhmmsearchsubset1to500_3rd.fa, started 9:50am.
Your job is queued behind 9146 other searches. (approximate wait time: 5 hours and 5 minutes)
## done by 1 pm.
http://www.ebi.ac.uk/Tools/hmmer/results/AD5CAB18-54FE-11E7-859B-21AF53F04F9B/score
## email results only approx half that vikas recovered ???????????????????
## to send ***email*** to  hmmer-help@ebi.ac.uk
## my questions:

i) having trouble 'capturing' all of the output from an online pfam hmmscan result sent via email. the last line captured is:
>TraesCS1D01G198900.1 193 226 193 226 &n
So, wondering if I am not capturing all the output?

ii) looks like the results in the browser not formatted similarly. Is there some standard way I should be following in accessing the output results?

## prepare 501 to 1000 .fa file for submission to pfam online hmmscan run.
## namelines.txt, line in PPRhmmsearchsubset.fa
>TraesCS3A01G131000.1   501    1st line 5840
>TraesCS5B01G195700.1   1000   line after seq  11826
## 5987, for 'tail'
#head -n 5839 PPRhmmsearchsubset.fa > PPRhmmsearchsubset1to500.fa

head -n 11826 PPRhmmsearchsubset.fa | tail -n 5987 > PPRhmmsearchsubset501to1000.fa
## check, verify in PPRhmmsearchsubset.fa, looks ok, names and line numbers correlate in PPRhmmsearchsubset.fa & PPRhmmsearchsubset1to500.fa

06/21/17:
Vikas request **two** files copy to 'shared' dir, one, PPRhmmsearchsubset.fa, prevly there.
## 2nd
cd /Users/bterry/macbook2017/vikas17/wheatproj
scp hmmscanOP_1-500.txt pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm
ls -al

## talked to vikas:
## to do: read the refs again, try figure out how get hmm specific for 'P' motif
## check 'sci reports'
## check 'Sykes'
## finish 'cheng'

## ready to submit to pfam hmmscan online, but 1st, wait for response to email, and read the refs again, try figure out what to do with hmmscan output ????????????????????????

06/24/17:
Talked to vikas today. Upshot: 
vikas ran MSA for PPRhmmsearchsubset.fa with clustal/omega, then phylogeny, which 'connected' with clustal/omega run.
To graph this, he used 'figtree' (to dnload, install).
## To do: I want to repeat this, learn myself.
## To do: re-read sykes ref, task want to accomplish for wheat proj.
## To do: read BMC genomics, 2014, 15 950.
## now protocol for what want do next:
--get 'cloned' RFSs (see sykes, p-2, sci reports, 1st full paragraph ?????????????
06/25/17:
In Sykes paper, p-354, section 'Phylogenetic Analysis of the RFL Cluster', refers to supplementary table S1, 143 rows, *multiple* species.

In sci. reports paper, page 2, 1st full paragraph, refers to CMS/Rf systems in supp. table S1 (*all* rice species).

06/26/17:
Talked to vikas:
To do: from srep35152-s1.pdf, table S1, take the 42 rows (see p-2, srep35152.pdf), the values in colm 3, 'NCBI reference', get the protein sequences from batch entrez search.
## 1st get colm 3 out of table S1. For now, use BBedit, but later like to put in unix command line with pipes ???????????????
## in BBedit, 3 steps
Find: \w+ \w+ \w+ (.+)
Replace: \1
## manually, write in 'group' for rows 19-2, for 41-42, remove rest 'species', then write in group 
Find: ^group (.+)
Replace: \1
## now, if manually removed line1, 3-7, 40-42 trailer parts from 'cultivar name', could then do cut of new colm2
## try cut
cut -d ' ' -f 2 srep35152-s1_tableS1_copy.txt | head -n 3  ## ok
cut -d ' ' -f 2 srep35152-s1_tableS1_copy.txt | head -n 42 > NCBIrefcolm.txt
## NCBIrefcolm.txt looks ok, 42 rows, has a blank 43 row ??????????????, so removed before proceed.

06/27/17:
## now for batch entrez search at NCBI, upload NCBIrefcolm.txt
## Note: some issues with 'batch entrex' output ?????????
## Q: AB179840 has 3 proteins, 2nd hypothetical tho matches dupl AB179840 , 1st matches on table S1, 3rd hypothetical, no aa seq given ??????????
## Q: note, batch conversion nucleotide to protein does not appear to match protein name from table S1 ???????
## Q: perhaps, manually try match each 'ncbi ref' with protein(s) coded for, select one matches table S1. What about 'ncbi ref' without protein name in table S1 ???????
## Q: or, to try find 'cloned' RF(L) proteins, look t p-2, sci peports, ref papers, try get 'a few' cloned genes ?????????????????????????

## talked to vikas, to manually examine table S1, 'sci reports' paper, each row in 'NCBI ref' colm. Sort of curate which select for 'restorer for CMS' genes to use in phylogeny with wheatproj PPR proteins (detd from PPR.hmm on wheatproj gene proteins. So, from NCBIrefcolm.txt file,

AB106867 /product="PPR protein"
AB110016 /product="Rf1"  (Q: ????????????????????????)

AB195686 /product="PPR protein"
AB470408 /product="pentatricopeptide repeat-containing protein"
         /function="fertility restorer"

AB470409 /product="pentatricopeptide repeat-containing protein"
AB470406 /product="pentatricopeptide repeat-containing protein"

AB470407 /product="pentatricopeptide repeat-containing protein"
DQ311053 /product="PPR protein"

DQ311054 /product="PPR protein"
DQ311052 /product="PPR protein"

AB179840 /product="restorer for CMS", /gene="Rf-1A", /protein_id="BAD20283.1"
AB179840 /product="hypothetical protein", /gene="Rf-1D", /protein_id="BAD20284.1"
AB179840 /gene="Rf-1B", /note="hypothetical protein", /pseudo

AB112811 /product="PPR protein", /function="fertility restoration of CMS", /gene="Rf-1C", /protein_id="BAD13711.1"

AB110443 /product="fertility restorer", /gene="Rf-1", /protein_id="BAD08214.1"
AB110443 /product="hypothetical protein", /gene="PPR794", /protein_id="BAD08211.1"

AB110443 /product="hypothetical protein", /gene="PPR683", /protein_id="BAD08212.1"
AB110443 /product="hypothetical protein", /gene="PPR762", /protein_id="BAD08213.1"

AB110444 /product="hypothetical protein", /protein_id="BAD08215.1"

AB110444 /product="hypothetical protein", /protein_id="BAD08216.1"
AB110444 /product="fertility restorer", /protein_id="BAD08217.1"

AB900791 /product="pentatricopeptide repeat-containing protein", /gene="PPR454", /protein_id="BAQ15368.1", /note="fertility restorer for Wild-abortive (WA) type
                     cytoplasmic male sterility (CMS)"
AB900792 /product="pentatricopeptide repeat-containing protein", /gene="PPR782a", /protein_id="BAQ15369.1", /note="fertility restorer for Wild-abortive (WA) type cytoplasmic male sterility (CMS)"

AB900793 /product="pentatricopeptide repeat-containing protein", /gene="PPR782b",  /protein_id="BAQ15370.1" /note="fertility restorer for Wild-abortive (WA) type cytoplasmic male sterility (CMS)"

AB900794 /product="pentatricopeptide repeat-containing protein", /gene="PPR458", /protein_id="BAQ15371.1", /note="fertility restorer for Wild-abortive (WA) type
                     cytoplasmic male sterility (CMS)"

Os10g0495400 uniprotKB, a seq., but Status Unreviewed
-Annotation score:no score -Protein predicted.

Os10g0495200 uniprotKB, a seq., but Status Unreviewed
-Annotation score:no score -Protein predicted.

Os10g0495100 uniprotKB not coming up, Oryzabase, Search Condition : Keyword(Os10g0495100), link to => big file for AP008216.2

KJ680250 /product="PPR protein PPR9-782-ZH", /gene="Rf4", /protein_id="AIC74552.1", /note="recessive fertility restorer allele for wild
                     abortive cytoplasmic male sterility (CMS-WA)"

KJ680249 /product="PPR protein PPR9-782-M", /gene="Rf4", /protein_id="AIC74551.1", /note="fertility restorer allele for wild abortive
                     cytoplasmic male sterility (CMS-WA)"

KJ680248 /product="PPR protein PPR9-782-I", /gene="Rf4", /protein_id="AIC74550.1", /note="fertility restorer allele for wild abortive
                     cytoplasmic male sterility (CMS-WA)"
KJ680247 /product="truncated PPR protein PPR9-409-Z", /gene="Rf4", /protein_id="AIC74549.1", /note="recessive fertility restorer allele for wild
                     abortive cytoplasmic male sterility (CMS-WA)"

KJ680253 /product="PPR protein PPR10-469-93", /gene="Rf4-like", /protein_id="AIC74555.1", /note="similar to the fertility restorer Rf4 for wild
                     abortive cytoplasmic male sterility (CMS-WA)"
KJ680252 /product="PPR protein PPR10-454-Z", /gene="Rf4-like", /protein_id="AIC74554.1", /note="similar to the fertility restorer Rf4 for wild
                     abortive cytoplasmic male sterility (CMS-WA)"

KJ680251 /product="PPR protein PPR10-454-M", /gene="Rf4-like", /protein_id="AIC74553.1", /note="similar to the fertility restorer Rf4 for wild
                     abortive cytoplasmic male sterility (CMS-WA)"

KJ680246 /product="PPR protein PPR8-780-M", /gene="Rf4-like", /protein_id="AIC74548.1", /note="similar to the fertility restorer Rf4 for wild
                     abortive cytoplasmic male sterility (CMS-WA)"
 
KJ680245 /product="PPR protein PPR7-458-ZH", /gene="Rf4-like", /protein_id="AIC74547.1", /note="similar to the fertility restorer Rf4 for wild
                     abortive cytoplasmic male sterility (CMS-WA)"
KJ680244 /product="PPR protein PPR7-458-Z", /gene="Rf4-like", /protein_id="AIC74546.1", /note="similar to the fertility restorer Rf4 for wild
                     abortive cytoplasmic male sterility (CMS-WA)"

KJ680243 /product="PPR protein PPR7-458-I", /gene="Rf4-like", /protein_id="AIC74545.1", /note="similar to the fertility restorer Rf4 for wild
                     abortive cytoplasmic male sterility (CMS-WA)"
KJ680242 /product="PPR protein PPR7-454-M", /gene="Rf4-like", /protein_id="AIC74544.1", /note="similar to the fertility restorer Rf4 for wild
                     abortive cytoplasmic male sterility (CMS-WA)"

AB179840 *DUPL* OF ABOVE. 

AK066315 Q: what to think ???????????????? 

06/30/17:
## so, 'FR' & lengths to select from 42 rows from table S1, 'sci reports'
AB470408 266/35 = 7.6
AB179840 790/35 = 22.57

AB112811 794/35 = 22.69
AB110443 791/35 = 22.6
AB110444 266/35 = 7.6
AB900791 455/35 = 13
AB900792 782/35 = 22.34
AB900793 782/35 = 22.34
AB900794 458/35 = 13.09
KJ680249 782/35 = 22.34
KJ680248 782/35 = 22.34

## talked to vikas, would like to next create a fasta file of these 11, append  to PPRhmmsearchsubset.fa (perhaps 1st, do gbLocks MSA for just the 11, see how well they align). 
http://molevol.cmima.csic.es/castresana/Gblocks_server.html
## see JMower course, plant systematics, lab 3, 02/05/16, sec II, 'Trimming alignments'.

07/01/17:
## so *updated* BdactyloidesthruGSEA081615.txt & wheatprojdoc060117.txt to github, planets repo.

## try append the 11 together 1st, then a reg expn to shorten the names on the name rows

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs

ls -lh
cat *seq.txt > FRknownseqs.fa
wc FRknownseqs.fa  ##      
117     180    8533 FRknownseqs.fa
head -n 4 FRknownseqs.fa
grep -c "^>" FRknownseqs.fa  ## 11  ????????????
grep "^>" FRknownseqs.fa > grepoutput  ## 11 rows as expect

## test reg expns in bbedit on grepoutput file.


1st:
(>)\w+\|(.+)
\1\2
>AB110443.1_prot_BAD08214.1_4 [gene=Rf-1] [prot ...

Then:
(>\w+).+
\1
## working with 'fresh' file, like p-28, bottom, haddock & dunn ?????????????????
## To do, same test for FRknownseqs_copy.fa
## looks like success, so rename FRknownseqs_shtname.fa
wc FRknownseqs_shtname.fa
     117     117    7164 FRknownseqs_shtname.fa
grep -c "^>" FRknownseqs_shtname.fa  ## 11 rows as expect


## perhaps try gblocks on FRknownseqs_shtname.fa, see if good alignment before proceed ????
## Note: ***purpose*** of Gblocks: Selection of conserved blocks from multiple alignments for their use in phylogenetic analysis, i.e., couple 'algorithms' to subset MSA to better matching parts of MSA for use in phylogenetic map prepn.

Gblocks did not work
Please check that the file format is correct
Generated by Gblocks Server
## WHAT TO THINK ??????????????????????????????????????????????
## Note in Angiosperm_...-muscle.fas, Gblocks worked ????????
## APPARENTLY GBLOCKS RETURNS ONLY PARTS OF INPUT THAT ALIGN WELL ???????????

## perhaps try FRknownseqs_shtname.fa with clustal/omega (ensembl).
## Q: should the two 7.6 and the two 13 length be retained ???????????? 
## Q: apparently '*', '-', & ':' missing from any column if one row has no aa ??????????
## Q: at least would get these symbols for most of length rest of the rows ?????
## Q: Q: should I try to trim some colms as Gblocks seems to do. Q: output file of Gblocks probably outputs these subsets ??????????????????????????????????

07/02/17:

## at least run clustal/omega *without* these 4 rows, so can see how well rest of rows align. Prepare FRknownseqs_shtname_7.fa from FRknownseqs_shtname.fa. Remove '408', '444', '791' & '794'.
## Getting '*', '-', & ':' symbols out to about 780 aa's.

STOPPED

## Q: test making a tree from this, practice ?????
## ok, *perhaps do*, include the two 13's since > 10, see if changes relationship of seven 22s run by themselves ??????????
## create FRknownseqs_shtname_9.fa from FRknownseqs_shtname.fa (remove '408' & '444')
## run clustal omega on FRknownseqs_shtname_9.fa
 ## phyl. for FRknownseqs_shtname_9.fa, relationships the 7 in FRknownseqs_shtname_7.fa *not* changed.

## so perhaps append the '9' (FRknownseqs_shtname_9.fa) to  PPRhmmsearchsubset.fa, & with with PPRhmmsearchsubset.fa subset by removing all seqs < 10*35 in length. Then perhaps test both ways, thinking Gblocks/JMower strategy for MSA 'trimming' of value ????

## 1st, MSA on FRknownseqs_shtname_9.fa appended to PPRhmmsearchsubset.fa

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
#cat *seq.txt > FRknownseqs.fa
cat PPRhmmsearchsubset.fa FRknownseqs_shtname_9.fa > PPRhmmsearchsubset_plus9.fa
grep -c "^>" PPRhmmsearchsubset_plus9.fa  ## 1554 as expect
## run PPRhmmsearchsubset_plus9.fa on clustal omega, the phylogeny, then figtree
## submitted, 12:16am, 07/03/17.
## apparently ran ~ 20 min.

07/03/17:
## now what, 'send to simple phylogeny' ??????? Try it, no dnside ???????
## **fails**, max 500 aligned seqs allowed.
## so what did Vikas do to get phylogeny on PPRhmmsearchsubset.fa previously ????????


## test 'awk' pgm wi FRknownseqs_shtname_9.fa 1st for counting seq lengths in fasta file.
awk '/^>/ {if (seqlen){print seqlen}; print ;seqlen=0;next; } { seqlen += length($0)}END{print seqlen}' FRknownseqs_shtname_9.fa
## worked!

## talked to Vikas, 
## 1st, went to email link to clustal MCA run for PPRhmmsearchsubset_plus9.fa. Q: now, from this results page, what did ???????????????
## Click on 'Phylogenetic Tree', scroll down a bit, see the '9' grouped together, and 14 closest relatives, all map to 'FR' part of radial tree layout in figtree right next to the 9 rice 'FR' +ve control proteins. Q: might these 14 cluster on new wheat genome as they reportedly do in rice? Is the new wheat seq allow to find their locations, see if they cluster?

07/04/17:
Vikas email, ideas, for going forward.
## from PPRhmmsearchsubset_plus9.fa phylogram, thru 'colors' in figtree, separate P & PLS proteins. 
## Q: any additional subsetting of the proteins from the branches near the leaves ???????????????
## Then, choose subsets of the 'wheat' proteins, like 'PLS', 'P', then hmmalign, hmmbuild, hmmsearch to refine subsets of PPRhmmsearchsubset.fa. Repeat MSA wi clustal, Gblocks, then phylogeny (Mega or what ???) 

07/05/17:
## talked to vikas,
## to do, 
## Note: PPRhmmsearchsubset_plus9_clustaltree_colored has NEXUS phylogenetic tree starting at line. So, just use 1st 1560 lines to get 'colored' rows.
cat PPRhmmsearchsubset_plus9_clustaltree_colored_copy | head -n 1560 > PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560
## check number 'Treas' rows, in, '1560' (1545 as expected) in bbedit. Matches number in PPRhmmsearchsubset.fa.

## now reg expn to get 'colored' subset ('P') list. 

.+(Traes.+\d).+color.+  ## works bbedit, but lines not 'found' by this *remain*.
## so try,
cat PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 30
## works, replaces matching rows *but* leaves as was any line not matched, i.e., *still* 1560 lins long.
## check number 'color' rows, 820 + 9 as expect as 'AB', 'KJ' not included.

cat PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 1560 > PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl
## check number of 'Traes' in bbedit, 1545 as expect.

## next,
grep "^Traes" PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl |  head -n 30

## looks like working, so 

grep "^Traes" PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl > PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl_listfile
## 820 rows, matching what expect from number of 'color' rows in PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560

## check for duplicates
sort PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl_listfile |uniq | wc -l  ##          820  as expected if each record in unique.

07/06/17:
## now, subset PPRhmmsearchsubset.fa fasta file with the PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl_listfile listfile. 

## to do, use Vikas getsubsetfatofa.awk (getseq.awk) pgm to subset the records selected by figtree ('color' rows, possibly 'P' proteins) listfile in PPRhmmsearchsubset.fa. Output to PPRhmmsearchsubset_P_prots820.fa

## getseq.AWK script to subset input .fa file

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
./getseq.awk PPRhmmsearchsubset.fa PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl_listfile  > PPRhmmsearchsubset_P_prots820.fa
grep -c "^>Tr" PPRhmmsearchsubset_P_prots820.fa   # 820 as expect

## talked to Vikas,

07/07/17:
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/shared/terry/hmm
ls -al  ## sizes are same.
module avail
## muscle/3.8   

07/08/17:
## next steps: starting with PPRhmmsearchsubset_P_prots820.fa
## muscle alignment, ON crane, CHECK if can put out stockholm format ???????????????????, doc, says not,  
## what crane dir to work in ??????
ssh -Y pterry@crane.unl.edu
cd /work/baenziger/pterry/wheatproj
mkdir refinPprots820
cd refinPprots820
## scp PPRhmmsearchsubset_P_prots820.fa to crane, dir = refinPprots820
logout
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp PPRhmmsearchsubset_P_prots820.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820

STOPPED

## run muscle on PPRhmmsearchsubset_P_prots820.fa
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj/refinPprots820

## see line 109, srun muscle ...
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load muscle/3.8
cd /work/baenziger/pterry/wheatproj/refinPprots820
muscle -in PPRhmmsearchsubset_P_prots820.fa -out PPRhmmsearchsubset_P_prots820.fa.aln
## ~ 11:25pm => killed, ~ 12:25am, 07/09/17.

*** WARNING *** Invalid character '*' in FASTA sequence data, ignored

*** WARNING *** Invalid character '*' in FASTA sequence data, ignored
PPRhmmsearchsubset_P_prots820 820 seqs, lengths min 151, max 1448, avg 603
00:00:03     25 MB(2%)  Iter   1  100.00%  K-mer dist pass 1
00:00:03     25 MB(2%)  Iter   1  100.00%  K-mer dist pass 2
00:00:30   437 MB(32%)  Iter   1  100.00%  Align node       
00:00:30   441 MB(32%)  Iter   1  100.00%  Root alignment
00:01:34   442 MB(32%)  Iter   2  100.00%  Refine tree   
00:01:34   442 MB(32%)  Iter   2  100.00%  Root alignment
00:01:34   442 MB(32%)  Iter   2  100.00%  Root alignment
00:33:02   442 MB(32%)  Iter   3  100.00%  Refine biparts
srun: Force Terminated job 7945126 85.58%  Refine bipartsfine biparts
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
srun: error: c2017: task 0: Killed 87.29%  Refine biparts
[pterry@login.crane refinPprots820]$ ls -lh
total 512K
-rw-r--r-- 1 pterry amundsen 511K Jul  8 22:08 PPRhmmsearchsubset_P_prots820.fa
[pterry@login.crane refinPprots820]$ 
## Q: EXACTLY WHY KILLED ?????????????????????????????????
## ANYWAY, CHECK ADAM ON MONDAY.
## MEAN TIME, TRY RUN AS SLURM JOB ??????????????????

07/09/17:
## most recent slurm file template: slurm_blastp_uniprotKB_C_UP.sh
## slurm_muscle_wheatproj_refin820.sh
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /home/baenziger/pterry
mkdir scripts
logout
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs

scp slurm_muscle_wheatproj_refin820.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/


ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_refin820.sh
ls -lh
sbatch slurm_muscle_wheatproj_refin820.sh 7955004  16:18pm => ??:??am, 
squeue -u pterry  ## a PD
            JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
           7955004     batch TJob_mus   pterry PD       0:00      1 (Resources)

## Q: still pending at 1pm. How best to reduce resources requested to reduce 'PD' time ??????????????????
## stopped running before 10:22pm

[pterry@login.crane refinPprots820]$ squeue -u pterry
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
## Q: meaning of 'ST'  ???????????????????????

cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh
-rw-r--r-- 1 pterry amundsen 602K Jul  9 21:28 job.7955004.err
-rw-r--r-- 1 pterry amundsen    0 Jul  9 19:43 job.7955004.out
-rw-r--r-- 1 pterry amundsen 511K Jul  8 22:08 PPRhmmsearchsubset_P_prots820.fa
-rw-r--r-- 1 pterry amundsen 2.5M Jul  9 21:28 PPRhmmsearchsubset_P_prots820.fa.aln

less job.7955004.err
## many invalid '*' lines.
head -n 12 job.7955004.err
## many of following line in '.err' file.
*** WARNING *** Invalid character '*' in FASTA sequence data, ignored


sacct -j  7955004 -o start,end
              Start                 End 
------------------- ------------------- 
2017-07-09T19:43:42 2017-07-09T21:28:09 
2017-07-09T19:43:42 2017-07-09T21:28:09 
## 21:28:09 - 19:43:42 ~= 1hr 44min run

wc -l job.7955004.err
1660 job.7955004.err
grep -c "***" job.7955004.err
1660    ## so not directly related to 820 input lines ??????????????
## look at last line of error file
tail -n 18 job.7955004.err
*** WARNING *** Invalid character '*' in FASTA sequence data, ignored

*** WARNING *** Invalid character '*' in FASTA sequence data, ignored

*** WARNING *** Invalid character '*' in FASTA sequence data, ignored
PPRhmmsearchsubset_P_prots820 820 seqs, lengths min 151, max 1448, avg 603
00:00:06     25 MB(2%)  Iter   1  100.00%  K-mer dist pass 1
00:00:06     25 MB(2%)  Iter   1  100.00%  K-mer dist pass 2
00:01:02   437 MB(32%)  Iter   1  100.00%  Align node       
00:01:03   441 MB(32%)  Iter   1  100.00%  Root alignment
00:02:07   442 MB(32%)  Iter   2  100.00%  Refine tree   
00:02:07   442 MB(32%)  Iter   2  100.00%  Root alignment
00:02:07   442 MB(32%)  Iter   2  100.00%  Root alignment
00:33:17   442 MB(32%)  Iter   3  100.00%  Refine biparts
01:03:34   442 MB(32%)  Iter   4  100.00%  Refine biparts
01:34:27   442 MB(32%)  Iter   5  100.00%  Refine biparts
01:44:22   442 MB(32%)  Iter   6  100.00%  Refine biparts
01:44:22   442 MB(32%)  Iter   6  100.00%  Refine biparts
[pterry@login.crane refinPprots820]$ 
## ANYTHING TO GLEAN FROM THESE LINES AT END OF ERROR FILE ??????????

## Q: SHOULD I HAVE GOTTEN RID OF THE '*' IN INPUT FILE SEQS BEFORE RUN MUSCLE ???????????????????????
less PPRhmmsearchsubset_P_prots820.fa.aln  ## looks to be *in* MSA fasta format.
head -n 50 PPRhmmsearchsubset_P_prots820.fa.aln
head -n 60 PPRhmmsearchsubset_P_prots820.fa.aln | tail -n 7
## 1st fasta seq has 53 lines

## Q for *Vikas*: convert to stockholm format using Vikas script, OR web converter pgm???????????????????????????????????????????????? 
http://sequenceconversion.bugaco.com/converter/biology/sequences/

07/10/17:
## could scp Vikas fasta2stockholm.pl pgm to crane, make conversion *there* ??????

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp fasta2stockholm.pl pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh
chmod 755 fasta2stockholm.pl
./fasta2stockholm.pl PPRhmmsearchsubset_P_prots820.fa.aln > PPRhmmsearchsubset_P_prots820.fa.aln.slx
/usr/bin/env: perl -w: No such file or directory  ## ERROR
## Q: perhaps 1st line of '.pl'file needs to be different ?????????????????????????
fasta2stockholm.pl PPRhmmsearchsubset_P_prots820.fa.aln > PPRhmmsearchsubset_P_prots820.fa.aln.slx
-bash: fasta2stockholm.pl: command not found  ## ERROR



ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
fasta2stockholm.pl PPRhmmsearchsubset_P_prots820.fa.aln > PPRhmmsearchsubset_P_prots820.fa.aln.slx
[pterry@login.crane refinPprots820]$ srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
srun: job 7957944 queued and waiting for resources
srun: job 7957944 has been allocated resources
[pterry@c3713.crane refinPprots820]$ module load perl/5.22
[pterry@c3713.crane refinPprots820]$ fasta2stockholm.pl PPRhmmsearchsubset_P_prots820.fa.aln > PPRhmmsearchsubset_P_prots820.fa.aln.slx
bash: fasta2stockholm.pl: command not found
[pterry@c3713.crane refinPprots820]$ ./fasta2stockholm.pl PPRhmmsearchsubset_P_prots820.fa.aln > PPRhmmsearchsubset_P_prots820.fa.aln.slx
/usr/bin/env: perl -w: No such file or directory
## Q: so how get run on crane ????????????????????????????????????????????????????

## scp over PPRhmmsearchsubset_P_prots820.fa.aln
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820/PPRhmmsearchsubset_P_prots820.fa.aln .
ls -lh
head -n 5 PPRhmmsearchsubset_P_prots820.fa.aln
## Q: which converter, fasta to stockholm  ???????????????????

## try fasta2stockholm.pl on Macbook ?????
fasta2stockholm.pl PPRhmmsearchsubset_P_prots820.fa.aln > PPRhmmsearchsubset_P_prots820.fa.aln.slx
-bash: fasta2stockholm.pl: command not found
chmod 755 fasta2stockholm.pl
./fasta2stockholm.pl PPRhmmsearchsubset_P_prots820.fa.aln > PPRhmmsearchsubset_P_prots820.fa.aln.slx
more PPRhmmsearchsubset_P_prots820.fa.aln.slx
## so have 'stockholm MSA file
## examine a bit,
head -n 2 PPRhmmsearchsubset_P_prots820.fa.aln.slx
grep -c "Trae" PPRhmmsearchsubset_P_prots820.fa.aln.slx  ## 820, as expect.


## back on crane, *see* if can run the perl script, get '.slx' file there, won't have to scp the '.slx' over from macbook if works.

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl PPRhmmsearchsubset_P_prots820.fa.aln > PPRhmmsearchsubset_P_prots820.fa.aln.slx

-rw-r--r-- 1 pterry amundsen 2571524 Jul 10 22:42 PPRhmmsearchsubset_P_prots820.fa.aln.slx  ## same size as on Macbook

## now for *hmmbuild*

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/refinPprots820

hmmbuild PPRhmmsearchsubset_P_prots820.fa.aln.hmm PPRhmmsearchsubset_P_prots820.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             PPRhmmsearchsubset_P_prots820.fa.aln.slx
# output HMM file:                  PPRhmmsearchsubset_P_prots820.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     PPRhmmsearchsubset_P_prots820.fa.aln   820  3114   727    19.20  0.590 

# CPU time: 3.50u 0.02s 00:00:03.52 Elapsed: 00:00:03.58
ls -al
exit
less PPRhmmsearchsubset_P_prots820.fa.aln.hmm
head -n 17 PPRhmmsearchsubset_P_prots820.fa.aln.hmm
HMMER3/f [3.1b2 | February 2015]
NAME  PPRhmmsearchsubset_P_prots820.fa.aln
LENG  727
ALPH  amino
RF    no
MM    no
CONS  yes
CS    no
MAP   yes
DATE  Mon Jul 10 23:32:32 2017
NSEQ  820
EFFN  19.196854
CKSUM 3787875152
STATS LOCAL MSV      -13.0024  0.69650
STATS LOCAL VITERBI  -14.3885  0.69650
STATS LOCAL FORWARD   -6.2752  0.69650
HMM          A        C        D        E        F        G        H        I        K        L        M        N        P        Q        R        S        T        V        W        Y   

wc PPRhmmsearchsubset_P_prots820.fa.aln.hmm
  2203  38656 339104 PPRhmmsearchsubset_P_prots820.fa.aln.hmm
tail -n 3 PPRhmmsearchsubset_P_prots820.fa.aln.hmm
          2.68100  4.42130  2.77999  2.72243  3.43843  2.42827  3.73790  3.28413  2.67511  2.65416  4.18353  2.92764  2.75690  3.17989  2.88499  2.37939  2.79409  2.98568  4.57761  3.62571
          2.21088  0.11609        *  4.16179  0.01570  0.00000        *
//


## realign using hmm model, hmmalign ?????, Vikas notes, is this a trimming fcn, --trim ????????????????  yes

07/11/17:
## perhaps make *slurm*, as 'timed out' with srun wi muscle above.
/Users/bterry/macbook2016/keenanres16/Bdac/pfam/uniprot

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp slurm_hmmalign_wheatproj_refin820.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_muscle_wheatproj_refin820.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_refin820.sh 7976540  10:43am => ??:??am, 
squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
           7976540     batch TJob_hmm   pterry PD       0:00      1 (Priority)


cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh
-rw-r--r-- 1 pterry amundsen    0 Jul 11 10:48 job.7976540.err
-rw-r--r-- 1 pterry amundsen    0 Jul 11 10:48 job.7976540.out
-rw-r--r-- 1 pterry amundsen 5.8M Jul 11 10:49 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln

sacct -j  7976540 -o start,end
              Start                 End 
------------------- ------------------- 
2017-07-11T10:48:43 2017-07-11T10:49:34 
2017-07-11T10:48:43 2017-07-11T10:49:34 
10:49:34 - 10:48:43 = < 1 min
## Q: is this quick ***ok*** ???????????????????????????????????????????????????????????????

less PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln
head -n 3 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln
tail -n 3 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln
grep -c "Trae" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln  ## 26240, so not telling anything ????????????????
wc -l PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln
26290 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

## scp following script over to crane, chmod, see if will run

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp stockholm2fasta.pl pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
chmod 755 stockholm2fasta.pl
ls -al
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots820
module load perl/5.22
perl stockholm2fasta.pl -c 999999 -g PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa

less PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa
grep -c ">Traes" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa  ## 820 as expect.
logout

## scp to macbook, examine in bbedit
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820/PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa .

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
## examine wi bbedit, or SEA VIEW ??????????????????????????
## 1620 lines in bbedit, not sure could 'trim manually in bbedit ????????????????????????????????????????????????????????????????????????

## Gblocks, try run, with PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa
## Save resulting alignment as PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa

## run grep -c 
grep -c "^>Tr" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
philip-terry-2:FRprotseqs bterry$ grep -c "^>Tr" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
grep: PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa: No such file or directory
## WHY THIS ERROR ???????????????????????????????????????????????????????
## copy PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa to test_Gblocks.fa
grep -c "^>Tr" test_Gblocks.fa  ## 820 as expect ???????????????????????

07/12/17:
## JMower, lab 3sec III does parsimony wi MEGA. But I want ML. So check subsequent labs if shows MEGA can receive 'trimmed' file for ML. Looks like lab 4 (871 course, does ML (2/12/2016) with PhyML & MEGA. I note several settings for PhyML & Mega are needed. Might **Vikas** have such for this task for PhyML ???????? Looks like can dnload 'binaries' for PhyML ????????????? BMC genomics paper, p-3, 'default' settings.
## sec II, Running ML using MEGA: what choices need to make for current task ??????
## copy PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa to 'documents dir. Changed extension to '.fas' (probably not necessary. Selected 'all.files'. Then this file name appeared in 'docs' dir. Try open, get **ERROR**, 'invalid data file format specified'.
## addl question, 'out group', 'rooting a tree' ??????????????????
## NOW WHAT ????????????????????????? Problem with PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa *NAME* ????????
## has 4920 lines.

07/13/17:
**TO DO**: TRY COPY TO NEW NAME, DELETE ORIGINAL, COPY BACK TO THIS NAME ?????????????????????
## NOW MEGA CAN 'SEE' THE FILE IN *DOCUMENTS* DIR.
***'test_Gblocks.fa'***  ## 4920 lines
cp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa test_cp_cmd.fa
cp: PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa: No such file or directory
## Q: '@' after file names in ls -al command ????????????????????
## Q: SO JUST TRY CHANGE NAME with 'Finder', not unix cmd line ????? 'PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa' to PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa.NAME.PROBLEM
THEN do 
cp test_Gblocks.fa PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
## then test cp new file to 
cp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa test_cp_cmd.fa
## if successful (worked ok), delete (done) test_cp_cmd.fa

...
## now a menu of choices: 
Model/Method: 8 choices, took default, 'Jones-Taylor-Thornton (JTT) model'
## started 11:23am => ~ 12:30pm, 07/14/17, (~25hrs), 'bootstrapping started'
## four days later, 07/17/17, bootstapping only at 17%. So stop job, remove MEGA6 from macbook, try install MEGA7 (GUI version), restart PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa ML phylogeny.


07/16/17:

ONGOING

## Try install (done), then run on 'macbook pro'.
## Folowing MEGA7-CC-QUICK-START-TUTORIAL.PDF file.

## need scp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa from macbook 'documents' dir to crane, then scp this to 'pro' in 'documents' dir.

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al  ## check if there ????
## on 'pro' at 'documents' dir
cd Documents
-rw-r--r-- 1 pterry amundsen  259925 Jul 16 12:14 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820/PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa .
ls -al
## on 'pro', 
scp (from crane to 'pro', ...Gblocks.fa file, Documents dir.


## slide 8: launch MEGA-PROTO from 'Applications folder'.
## model/method: 16 options, took 'JTT'
## match rest settings as did on macbook
## save infer_ML_protein_PPR820.mao in default 'bterry' dir.
## Q: skipped slide 15, 'compute timetree (RelTime-ML) ?????????????????????????????????/?????????????????????????????????????????????
## slide 7: to run 'megacc'
megacc ...
## started on 'pro', 12:49pm => 6:13pm, **5 hr 26 min.**

Start time: 16-7-17 12:49:41
Executing analysis:

   94%  Optimizing final tree MEGA-CC has logged the following error:
  When         = 16-7-17 18:13:13
  Data file    = PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
  AnalysisFile = ./infer_ML_protein_PPR820.mao
  Parameter    = -o
  Parameter    = MLtree_PPR820.out
  Message      = Error: Access violation

  Please see the summary file for warnings/messages
  Please validate all your inputs and try again. If you think this is a
  bug, please report it at http://www.megasoftware.net
       100% Analysis Complete                                                               
An unhandled exception occurred at $0002F35E :
EInOutError :
  $0002F35E

EInOutError:
philip-terry:Documents bterry$


## Q: access violation for writing MLtree_PPR820.out, output file, can't find such a file on 'pro' ????????????
## Q: '100% Analysis Complete'
## Q: perhaps check vikas, jmower, bug report to MEGA, OR install, try GUI MEGA on Mac  ?????????????????????????????????

07/17/17:
## Installed mega7(gui) on macbook. Open, won't show PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa in its file display for '.fas' in 'Documents', and for 'all files', when try open, says 'invalid data file format specified'. though it is the output from Gblocks ?????????? This was input in mega7cc on 'pro' yesterday, but 'Error: Access violation' occurred then ?????????????

## talked to Vikas, ideas:
--upload to 'shared' dir, two files,
PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa, & PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs

scp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm

scp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm

## check if ok
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/shared/terry/hmm
ls -al
## notified vikas, email

--try install BioPerl.org/INSTALL.html to see if can get align_convert_fas_to_phy.pl to work.  (crane HAS)
--try stockholm2fasta.pl output in align_convert_fas_to_phy.pl since previously trimmed. (DONE below)
--try PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa in MEGA, i.e., skip Gblocks, already trimmed by hmmalign.
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

07/18/17:
## check if for two '.fa' files,
PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa, & PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa 
## can be subset to <= 10 char for '>' lines.
grep -c "^>Tr" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
grep -c "^>Tr" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa

test3_hmmaln.fa

## will this work ??????
cat test3_hmmaln.fa|perl -pe 's/(>).+(G.+$)/\1\2/' | head -n 3  ## worked
cat test3_hmmaln.fa|perl -pe 's/(>).+(G.+{9})/\1\2/' | head -n 3  ## failed ???
cat test3_hmmaln.fa|perl -pe 's/(>).+(G.+){9}/\1\2/' | head -n 3  ## worked
cat test3_hmmaln.fa|perl -pe 's/(>).+(G.+){9}/\1\2/' |wc -l  ## 6, ok

cat test4_hmmaln-Gblocks.fa|perl -pe 's/(>).+(G.+$)/\1\2/' | head -n 8  # worked
cat test4_hmmaln-Gblocks.fa|perl -pe 's/(>).+(G.+){9}/\1\2/' | head -n 8 # wrkd
cat test4_hmmaln-Gblocks.fa|perl -pe 's/(>).+(G.+$)/\1\2/' | wc -l  ## 24, ok
## NOTE: EACH SEQ 1 LINE FOR ...hmmaln.fa, BUT MULTIPLE LINES FOR hmmaln-Gblocks.fa  ?????????????????????????????????????????????????????????????

cat PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa|perl -pe 's/(>).+(G.+$)/\1\2/' | wc -l  ## 1640

cat PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa|perl -pe 's/(>).+(G.+$)/\1\2/' | head -n 1640 > PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln_10char.fa  ## has expected 1640 lines, 10 char names.
grep -c "^>" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln_10char.fa  ## 820, ok
grep "^>" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln_10char.fa | sort | uniq | wc -l  ## 768, **NOT UNIQ** ??????????????????????????????????????????
## NOTE: LOOKS LIKE CAN'T PROCEED THIS WAY ??????????????????????????????????
##CAN VIKAS PERHAPS PUT A LOOP INTO AWK (or just iterate integers to translate 'name' fields into >1, ... >820 ??????????????????????????


## while mega proceeding, try **PhyML**.
## look into PhyML, Q: could I use the online version ??????? 
## 1st, need 
*Building phylogeny tree
    Convert the hmm.aln.fas file into phylip format using the perl script
    
        align_convert_fas_to_phy.pl seq.fa.aln.hmmaln.fa

## Could just run this pgm on macbook on file PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
## better do on copy in case '.pl' pgm might change input pgm ???????
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
cp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks_copy.fa
## ERROR, 1ST FILE NAME, QQCH WRONG ?????????????????
## after fix above, copy works ok.

chmod 755 align_convert_fas_to_phy.pl
perl align_convert_fas_to_phy.pl PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks_copy.fa
BEGIN failed--compilation aborted at align_convert_fas_to_phy.pl line 3.
## looks like 'Bio::AlignIO' needed ????????????????????????????????????????
## vikas, HOW TO GET ??????????????????

## Q: FOR VIKAS, fix Bio::AlignIO; ??????????????????????, since soln below to shorten name failed ??????????????????????????????????
## So, **Sat am**, email Vikas.

## for now try for PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks_copy.fa
i) convert fasta to phylip format with online converter 'http://sequenceconversion.bugaco.com/converter/biology/sequences/fasta_to_phylip.php'
## NOTE: **10** char limit, tried internet, no clear solns ??????????

## talked to adam, suggests try crane, bioperl installed there. Q: will this work for Gblocks with multiline seqs ???????????????? So to start:
--scp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa to crane
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820

--scp align_convert_fas_to_phy.pl to crane
scp align_convert_fas_to_phy.pl pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al

--check permissions for the '.pl' file ## already 755

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots820
module load bioperl
#perl stockholm2fasta.pl -c 999999 -g 

./align_convert_fas_to_phy.pl PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
## -rw-r--r-- 1 pterry amundsen  911847 Jul 18 22:35 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.phy

## scp back to macbook, 
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820/PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  911847 Jul 18 23:22 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.phy

less PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.phy
head -n 10 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.phy
## in bbedit, find 820 'Tra' lines as expect, 727 colms.

ii) then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.
## submitted, 11:59pm. Says, executing PhyML SMS. WAS THIS A GOOD CHOICE ???????
****************************************************************
## **1 day 12 hrs***
## potl FR section of phylogram, to test wi the '14', ck vikas, 'color' icon grayed out ???????????????????????


STOPPED

07/19/17:
## Checked at 9:45am,
ID: 1037530
Analysis name : p_prots820_fa_aln_hmmaln

Running

## to display in figtree

## Note: perhaps repeat, run Gblocks file thru align_convert_fas_to_phy.pl, then PhyML.
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots820
module load bioperl

./align_convert_fas_to_phy.pl PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa
--------------------- WARNING ---------------------
MSG: Got a sequence without letters. Could not guess alphabet
---------------------------------------------------
## got 5 of these warnings ???????????????????????????
ls -al
-rw-r--r-- 1 pterry amundsen  340299 Jul 19 10:52 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.phy

## Q: did this work with the 5 warnings? Or perhaps in input file, these seqs 'empty' ???????????????????????
exit
less PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.phy
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820/PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  340299 Jul 19 11:02 PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.phy
## check bbedit for 
PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa  ## for missing residues in any seqs. FOUND 5 names with no aa's in the seq. Should I remove them, run align...pl again, or just submit current .phy to PhyML ??????????????????
## initially try latter.
## bbedit of PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.phy, says finds 'Tr 820 times BUT can't find the 5 names of no aa seqs ?????????????????????????

## so submit to PhyML, PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.phy
## name it: P_prots820_fa_aln_hmmaln-Gblx, SMS, aLRT.
## started, 12:11pm
## status, running.

07/20/17:
**************************************************************************
## P_prots820_fa_aln_hmmaln-Gblx ran in ***12 hr 28 min***.
## display pprhmmsearchsubset_p_prots820_fa_aln_hmmaln_gblocks_phy_phyml_tree.txt
## in figtree (what format, newick ?????????????)
## note: 4 files in pprhmmsearchsubset_p_prots820_fa_aln_hmmaln_gblocks_phy_phyml dir.
## **DON'T** KNOW BUNCH THIS INFO ?????????????????????
## display in figtree, looks like could be a split FR & rest of P proteins.
##TO DO: might color (grayed out ??????) as Vikas, check of the 14 near seqs prev plot are in the 'FR' section.

## **results**: looks like a set of proteins separated from rest in both phylogram from Gblx & hmmaln. Yet to test with the 14 most closely related to the 9 rice RF's previously. Don't 'color' grayed out on figtree in my hands (ck vikas) ????????? Will ck Adam about PhyML on crane, give us opportunity do bootstrap.
*****************************************************************
## map the 14 on each phylogran, 3 groups, members same on each tree.
******************************************************************
## I note: organization/grouping of the 14 on these plots (1,4,9), and clustal/omega plot before the new wheat ony hmm prepared ***is different***.

## consider get PhyML on crane, in PhyMl_manual_012.pdf, sec 6.4, discusses parallel version of PhyML. Q: is SMS available on dnload version ?????????

## try mega7(gui) wi different input, see if can find file in 'Documents' dir.
## Installed mega7(gui) on macbook. Open, won't show PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa in its file display for '.fas' in 'Documents', and for 'all files', when try open, says 'invalid data file format specified'. though it is the output from Gblocks ?????????? This was input in mega7cc on 'pro' yesterday, but 'Error: Access violation' occurred then ?????????????
## try mega7(gui) on macbook with PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa
## would not accept PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln-Gblocks.fa in Documents dir earlier ('invalid data file format specified') ??????????????????????????
## BUT, ACCEPTING PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa *in* Documents dir.
## *no* bootstrap, other options were guesses, start, 7/19/17, 11:35pm => < 5:00am on 07/22/17, so < 53 hrs.

07/21/17:

Waiting MEGA(GUI) to finish ????????????????????????
## Newick_Export.nwk
## rename PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.mega7.nwk
## dir.:  /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/mega7

## checked, '1' powition relative to 2, 3 & 6, 7. In Gblocks, closer to 6. 7. But in two 'hmmaln's, closer to 2, 3, a DIFFERENCE ?????????????????????????????????????


## Talked to VIKAS
i) rerun realign step as per vikas 'Notes_Alignment_UsingHMMs.txt' thru PhyML step, , but with the 'seq.fa' file including the 820 seqs ***+*** the 9 from rice. So will need run 820 + 9 starting with muscle. Q: **how** do they organize in a phylogram with respect to the '14'. Note above, in the phylogram plot before create wheat protein hmm, the 14 **don't** group as they do in most recent two phylograms.
I note: Vikas a **preference** for the hmmaln.fa over the hmmaln-Gblocks.fa trimmed MSA when going for a phylogram.

ii) CYVERSE (Vikas, says has PhyML, MEGA)
pterry, ipWs14
## start at DE (discovery environment), LAUNCH
## sign in
## click apps button
## search: PhyML
## in here, need upload data before can proceed wi phyML run
## click data button, try upload input data to /iplant/home/pterry/analyses

07/22/17:

## OK, prepare input 'phy' data for PhyML on Cyverse. (820 + 9). To do, 

FRknownseqs_shtname_9.fa the '9' rice FR protein fasta file to cat to PPRhmmsearchsubset_P_prots820.fa before 'muscle'
## work in dir /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829
## so copy preceding two files into this dir.
## from /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs, PPRhmmsearchsubset_P_prots820.fa
## from /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs, 
FRknownseqs_shtname_9.fa
cat PPRhmmsearchsubset_P_prots820.fa FRknownseqs_shtname_9.fa > PPRhmmsearchsubset_P_prots820_plus9.fa
## bbedit, PPRhmmsearchsubset_P_prots820_plus9.fa  ## 829 '>' lines as expect.

STOPPED

07/23/17:
## Q: WHY WOULD NEED MUSCLE HERE, ONCE HAVE 'seq.fa', that is 'ready' for hmmalign step, following 'Notes_Alignment_UsingHMMs.txt' of Vikas.

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
ls -al
mkdir refinPprots820plus9
pwd
cp refinPprots820/PPRhmmsearchsubset_P_prots820.fa.aln.hmm refinPprots820plus9/
logout

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829
scp slurm_hmmalign_wheatproj_refin820plus9.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

cd /work/baenziger/pterry/wheatproj/refinPprots820plus9
scp PPRhmmsearchsubset_P_prots820plus9.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820plus9

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820plus9
ls -al ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_muscle_wheatproj_refin820.sh
ls -al
sbatch slurm_hmmalign_wheatproj_refin820plus9.sh 8084737  11:29am => ??:??am, 
squeue -u pterry  ## a PD
[pterry@login.crane scripts]$ squeue -u pterry
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
cd /work/baenziger/pterry/wheatproj/refinPprots820plus9
ls -lh
sacct -j  8084737 -o start,end
              Start                 End 
------------------- ------------------- 
2017-07-23T11:29:14 2017-07-23T11:30:09 
2017-07-23T11:29:14 2017-07-23T11:30:09 
## 11:30:09 - 11:29:14 = 55 sec.
less PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

cd /work/baenziger/pterry/wheatproj
cp refinPprots820/stockholm2fasta.pl refinPprots820plus9
cd refinPprots820plus9
ls -al
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots820plus9
module load perl/5.22
perl stockholm2fasta.pl -c 999999 -g PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.fa
ls -al
less PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.fa
grep -c ">" PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.fa  ## 829 as expect.

STOPPED

## now fas to phy

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl refinPprots820plus9
cd refinPprots820plus9
ls -al

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots820plus9
module load bioperl

./align_convert_fas_to_phy.pl PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
## -rw-r--r-- 1 pterry amundsen  921846 Jul 23 13:35 PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.phy

## scp back to macbook, 
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots820plus9/PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  921846 Jul 23 13:38 PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.phy

less PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.phy
head -n 4 PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.phy
 829 727
'TraesCS1A01G222900.1'  ---------- ---------- ---------- ---------- ---------- ---------- 
'TraesCS3D01G317800.1'  -------PQT PTVRRLPMAT TAAA-AAAAT ATASTRANSL SRIFSSSSPT VKPPKHNPNT 
## so phy header 829, 727 as expect

ii) then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.
## submitted, 11:59pm. Says, executing PhyML SMS. WAS THIS A GOOD CHOICE ???????
****************************************************************
## **1 day 12 hrs***
## potl FR section of phylogram, to test wi the '14', ck vikas, 'color' icon grayed out ???????????????????????

07/24/17:
## so updated BdactyloidesthruGSEA081615.txt wheat...060117.txt to github, planets repo.

07/29/17:
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree.txt
## the output from french site.
-rw-r--r--@  1 bterry  staff  45412 Jul 25 11:46 pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree.txt

## from cyverse site,
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829/cyverse/PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.phy_phyml_cyverse_tree.txt
## the output from cyverse site.
-rw-r--r--@  1 bterry  staff  45412 Jul 30 00:19 PPRhmmsearchsubset_P_prots820plus9.fa.aln.hmmaln.phy_phyml_cyverse_tree.txt
## ***same*** number bytes in file from both phylogeny sites.

## might try dnload figtree, Q: subtle, were there couple sites,need choose correct one. But, find printout where dnloaded from previously, **same** URL. I note, figtree 1.4.3 previously installed on 'pro', 

07/30/17:
## try dnload, install figtree v1.4.3.dmg
## when try run, gives **error** as previously, figtree v1.4.3 quit unexpectedly, ...
so in morning, scp twp tree files to 'pro' (still running os 10.10 & figtree v1.4.3 successfully), view in figtree, then mark 'Trae' 1,2,3,6,7 & the 9 rice 'FRs', see how they compare. 

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml

scp pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree.txt pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm

## go check if looks ok in 'shared' dir ??
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/shared/terry/hmm
## ck if number bytes same as before scp
ls -al  ## ok, 
-rw-r--r-- 1 pterry amundsen   45412 Jul 30 10:31 pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree.txt

## Now, set up a dir on 'pro', scp thid file over, and run in figtree. 
## create macbook macbookpro2017/vikas17/pyML829 dirs
cd ~
mkdir macbookpro2017
cd macbookpro2017
mkdir vikas17
cd vikas17
mkdir pyML829
cd ~/macbookpro2017/vikas17/pyML829
scp pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree.txt .
ls -lh

## now, on 'pro', load tree file, pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree.txt, in figtree.
##, locate 'Trae' 1,2,3,6,7 on tree
## 1 by self, r1,r2,r3,r4,r6,r7,r8,r9 near 2 & 3, r5 near 6 & 7 (????). So, split of the 9 rice proteins into two groups of sizes 1 & 8. 

## For 829 PhyML phylogram, 820 wheat proteins grouping similarly to PhyML 820 phylogram. For 829 PhyML phylogram, nine rice proteins group into two groups, r5 groups with 'Trae' 6, 7, 8, 10. Other 8 rice proteins group with 2,3,4,5,9,11,12,13,14 Trae wheat proteins (9 group). THOUGH the rice proteins group by selves on the shorter branch beside the '9 group'. What to think?

## Q: don't see 'aLRT' on branches ??????????????????

## If believe rice proteins good FR proteins, then perhaps grab (how many) wheat proteins near the rice eight group?
## Probably in any case, look for more proven FR proteins from other species.
## Would help to understand more about these proteins, correlate domains with proteins displaying near the eight rice proteins.

08/02/17:
## talked to Vikas
## so, highlighted two branches as possible FR's, red (8 rice FRs colocate) blue, (1 rice FR co-locates). 
## figtree, **save as** 820plus9nexustree_colors on 'pro'. A nexus file wih the colored rows representing the possible FR's co-locating near the rice FR's, either the group of 8, or the group of 1.
## rename to:
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt
## REQUEST: this file to **'shared'** dir on crane.
scp ...to crane 'shared' from 'pro', done.
scp ... to dir on Macbook:
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/shared/terry/hmm
ls -al  ## two files of interest look fine.

-rw-r--r-- 1 pterry amundsen   70689 Aug  2 22:05 pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt
-rw-r--r-- 1 pterry amundsen   45412 Jul 30 10:31 pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree.txt

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml

scp pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt .
ls -lh
-rw-r--r--@  1 bterry  staff  45412 Jul 25 11:46 pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree.txt
-rw-r--r--   1 bterry  staff  70689 Aug  2 22:39 pprhmmsearchsubse t_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt

## saved wheatprojdoc060117 to github.
## macbook froze, had to hit power button to recover. Afterward cursor seemed ok again, so tried to install figtree again, FAILED again. Note is error message mentions 'java' application. PERHAPS THIS WHERE COULD WORK. PERHAPS CALL **APPLECARE**. 1-800-275-2273. www.apple.com/support/macbook, july 05, 2015.


07/05/17:
phoned applecare, result: Demonstrated > java 1.6 installed. At URL,
https://java.com/en/download/help/version_manual.xml
...
The JRE and JDK are separate and can coexist on your system. Only **one** JRE can be installed on Mac. There can be multiple JDKs installed on a system, as many as you wish.

JRE Version Command Line on Mac

Type the following in a Terminal window:

philip-terry-2:planets bterry$ /Library/Internet\ Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java -version
java version "1.8.0_144"
Java(TM) SE Runtime Environment (build 1.8.0_144-b01)
Java HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode)
philip-terry-2:planets bterry$ 

## so, apparently evidence > ver 1.6 installed.

## **or** in the **java control panel**

Your system has the recommended version of Java.
Java 8  update 144

## or at URL:
https://support.apple.com/en-us/HT204036

Note: You can also download legacy Java SE 6 from Apple if you’re using an app that specifically requires this unsupported, out-of-date version.

Perhaps see if Vikas can get figtree to work on his mac sierra' If can then, perhaps I try load **legacy** ver of java, see if that allows figtree to  install. Q: apparently both versions cannot coexist ????????????????/

STOPPED

08/09/10:

## looking thru 2nd paragraph, p-2, srep35152.pdf ref., ref 8 there, looking for verified RF gene/protein for more detailed comparison to possible red or blue wheat proteins. 
## Q: trying get seq from ensembl ??????????????

08/10/17:

## talked to vikas,
## Rf-1, try get GFF file from ensembl plants, use fig 3 notation try get seq. for 'RF-1 RF protein.
## from ftp://ftp.ensemblgenomes.org/pub/plants/release-36/gff3/oryza_sativa/, see File: File:Oryza_sativa.IRGSP-1.0.36.chromosome.10.gff3.gz
	566 KB 	6/7/17
## TO DO: open, check for addresses like fig 3, sci reports ref.
## put in dir orysa_sativa+gff3
gunzip ...

## note: refs 26, 27 ???????????????????

08/11/17:
## copied to github, version this file copied to extl hdrive, 08/11/17

## Look in sci reports for a second method to find RF proteins (read fig 1 ???)

## Look in sci reports, fig 3, ensembl plants, are the 'Os_10_17173' refs into gff3 file ????????????????

08/13/17:
## TO DO, subset the red & blue rows separately. Refer to as nearricesubsetof8 (red) & nearricesubsetof1 (blue).
## see line 1633
## ref. see line 642 above ????????????????

## to do, (from 642 - 676 above)
## subset colored rows in file from figtree, 
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt ## ('P' proteins)

## Note: ## pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt has NEXUS phylogenetic tree starting at line 837. So, just use 1st 837 lines to get 'colored' rows.

cat pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt | head -n 835 > pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835.txt

## check number 'Treas' rows, in, '835' (835 as expected) in bbedit. Matches number in PPRhmmsearchsubset.fa (??????????????????????????????????)
grep -c "Traes" pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835.txt   # 820 as expect

## now reg expn to get 'colored' subset ('P') list. 

grep '.*Traes.*ff\]$' pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835.txt | head -n 4  ## worked

grep '.*Traes.*ff\]$' pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835.txt | wc
      22      22     899  ## correct for Traes 'blues'
## note, has *one* of 9 rice RFs nearby
grep '.*Traes.*ff\]$' pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835.txt > pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue.txt

grep '.*Traes.*00\]$' pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835.txt | wc
     122     122    5002

grep '.*Traes.*00\]$' pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835.txt > pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red.txt

## now pull out of 'red' & 'blue' 'P' proteins the name will use to go back and get their aa seq.

.+(Traes.+\d).+color.+  ## works bbedit, but lines not 'found' by this *remain*.
## so try,

# cat PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 30

cat pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue.txt|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 22

cat pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue.txt|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 22 > pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt

cat pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red.txt|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 122 > pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt

08/14/17:

## check for duplicates [TO DO ????????]
sort PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl_listfile |uniq | wc -l  ##          820  as expected if each record in unique.

07/06/17:
## now, subset PPRhmmsearchsubset_P_prots820plus9.fa fasta file with the 
with 'red' (122 proteins) & 'blue' (22 proteins) from figtree color. 

## file to subset with 'blue' & 'red' proteins is 
PPRhmmsearchsubset_P_prots820plus9.fa

## need copy down from extl hdrive, done.

## to do, use Vikas getsubsetfatofa.awk (getseq.awk) pgm to subset the records selected by figtree ('color' rows, possibly 'PF' proteins) in 'blue' or 'red' listfiles in PPRhmmsearchsubset_P_prots820plus9.fa. Output to 
PPRhmmsearchsubset_P_prots820plus9_blue.fa or PPRhmmsearchsubset_P_prots820plus9_red.fa

STOPPED


## getseq.AWK script to subset input .fa file
## getseq.AWK script to subset input .fa file
## ref: line 1657 above

## cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
## ./getseq.awk PPRhmmsearchsubset.fa PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl_listfile  > PPRhmmsearchsubset_P_prots820.fa
## grep -c "^>Tr" PPRhmmsearchsubset_P_prots820.fa   # 820 as expect

cd /Users/bterry/macbookpro2017/vikas17/tmp081117reparemacbook

./getseq.awk PPRhmmsearchsubset_P_prots820plus9.fa pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt > PPRhmmsearchsubset_P_prots820plus9_blue.fa

# grep -c "^>Tr" PPRhmmsearchsubset_P_prots820.fa   # 820 as expect

grep -c "^>Tr" PPRhmmsearchsubset_P_prots820plus9_blue.fa   # 22 as expect

## now for the red

./getseq.awk PPRhmmsearchsubset_P_prots820plus9.fa pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt > PPRhmmsearchsubset_P_prots820plus9_red.fa

grep -c "^>Tr" PPRhmmsearchsubset_P_prots820plus9_red.fa   # 122 as expect

08/15/17:
## I ***note*** for pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt file, 
## 119 of 122 rows either chr 1,2,or 6. And 8 rice RF proteins near, **but** by themselves. Pattern ***similar*** rice p-4, sci. reports ref. paper.

## talked to Vikas,
## try a 2nd method for grouping (see Sci Reps paper, srep35152.pdf)
## **Note**: for red set, chr 1,2,6 have 119 of the 122 rows.

08/17/17:
orthofinder plan:
## prepare to run on crane ??????????
## get 9 rice RF genes in a fasta file.
FRknownseqs_shtname_9.fa
PPRhmmsearchsubset_P_prots820.fa
grep -c "^>" FRknownseqs_shtname_9.fa   # 9 as expect
grep -c "^>" PPRhmmsearchsubset_P_prots820.fa   # 820 as expect

## ref: https://github.com/davidemms/OrthoFinder
## Aside: try run these two files in orthoMCL online (Q: can't find online site ??????????, ck if vikas can find ??????????????????

08/18/17:
## scp the two orthofind input files to dir ???? on crane.
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry
mkdir ofinder  ## where plan to place orthofinder input files.
/work/baenziger/pterry/wheatproj/ofinder

## scp the two files 
cd /Users/bterry/macbookpro2017/vikas17/tmp081117reparemacbook

scp rice9.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/ofinder
scp wheat820P.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/ofinder

## Adam on crane
## installed OrthoFinder-1.1.8.tar.gz
## to test, Q: are dependencis needed here ??????????
module avail
   blast/2.4     ## Q: is this blast ok ????????????????????
   mcl/14.137

module spider orthofinder  

STOPPED

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/ofinder
ls -lh
cd ..
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj
module load blast/2.4   ## ## Q: is this blast ok ????????????????????
module load mcl/14.137
module load orthofinder/1.1
OrthoFinder-1.1.8/orthofinder -h ## OrthoFinder should print its 'help' text.
bash: OrthoFinder-1.1.8/orthofinder: No such file or directory
????????????????????????????????????????????????????????????????
orthofinder -h  ## outputs help info.
## example test
# OrthoFinder-1.1.8/orthofinder -f ExampleDataset
orthofinder -f ExampleDataset
...
IOError: [Errno 2] No such file or directory: '/lustre/work/baenziger/pterry/wheatproj/ExampleDataset/SimpleTest.phy'
???????????????????????????????????????????????????????????
## perhaps need ExampleDataset/SimpleTest.phy in dir wheatproj ???????

cd /work/baenziger/pterry/wheatproj
## orthofinder -f fasta_files_directory [-t number_of_threads]
orthofinder -f ofinder
[pterry@c0912.crane wheatproj]$ orthofinder -f ofinder
OrthoFinder version 1.1.8 Copyright (C) 2014 David Emms

    This program comes with ABSOLUTELY NO WARRANTY.
    This is free software, and you are welcome to redistribute it under certain conditions.
    For details please see the License.md that came with this software.

16 thread(s) for highly parallel tasks (BLAST searches etc.)
1 thread(s) for OrthoFinder algorithm

## what to think ???????????????
## if run **slurm** what parameters to choose ????????????????????
## match number tasks with number_of_threads
orthofinder -f ofinder [-t number_of_threads]

cd /Users/bterry/macbookpro2017/vikas17/tmp081117reparemacbook
scp slurm_ofinder_wheatproj_inp820and9.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
less slurm_ofinder_wheatproj_inp820and9.sh
## ck if present slurm_muscle_wheatproj_refin820.sh
ls -lh

08/19/17:
sbatch slurm_ofinder_wheatproj_inp820and9.sh 8443947  12:15am => ??:??am, 
squeue -u pterry  ## a PD

cd /work/baenziger/pterry/wheatproj
less job.8443839.out
Unrecognised argument: [-t

ERROR: An error occurred, please review previous error messages for more information.
job.8443791.out (END) 
## try [ -t 4], if still fails (does), skip specifying number of threads.
squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
           8443947     batch TJob_ofi   pterry  R       0:46      1 c3713
## ok, running

cd /work/baenziger/pterry/wheatproj
ls -al
less job.8443947.out
cat job.8443947.out
## looks like orthogroup output produced.

[pterry@login.crane Results_Aug19]$ ls -al
total 92
drwxr-xr-x 4 pterry amundsen  4096 Aug 19 00:57 .
drwxr-xr-x 4 pterry amundsen  4096 Aug 19 00:14 ..
-rw-r--r-- 1 pterry amundsen   932 Aug 19 00:57 Orthogroups.csv
-rw-r--r-- 1 pterry amundsen    43 Aug 19 00:57 Orthogroups.GeneCount.csv
-rw-r--r-- 1 pterry amundsen    44 Aug 19 00:57 Orthogroups_SpeciesOverlaps.csv
-rw-r--r-- 1 pterry amundsen 25932 Aug 19 00:57 Orthogroups.txt
-rw-r--r-- 1 pterry amundsen 25863 Aug 19 00:57 Orthogroups_UnassignedGenes.csv
drwxr-xr-x 4 pterry amundsen  4096 Aug 19 00:57 Orthologues_Aug19
-rw-r--r-- 1 pterry amundsen     0 Aug 19 00:57 SingleCopyOrthogroups.txt
-rw-r--r-- 1 pterry amundsen  1407 Aug 19 00:57 Statistics_Overall.csv
-rw-r--r-- 1 pterry amundsen  1773 Aug 19 00:57 Statistics_PerSpecies.csv
drwxr-xr-x 2 pterry amundsen  4096 Aug 19 00:57 WorkingDirectory
[pterry@login.crane Results_Aug19]$ 
## anything useful in  WorkingDirectory ?????????????????????
## so look inside Orthogroups.csv
less Orthogroups.csv
cat Orthogroups.csv
less Orthogroups_UnassignedGenes.csv
less Orthogroups.txt
less Statistics_Overall.csv
cat Statistics_Overall.csv
less Statistics_PerSpecies.csv
cat Statistics_PerSpecies.csv
less Orthogroups_SpeciesOverlaps.csv
        rice9   wheat820P
rice9   1       1
wheat820P       1       1
Orthogroups_SpeciesOverlaps.csv (END) 
## ok, want to see if 39 wheat proteins in Orthogroups.csv are a subset of 122 'red' proteins from ML phylogeny previously.
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/ofinder/Results_Aug19/Orthogroups.csv .

## to do: compare results of ML phylogeny estimate of RF proteins in 820 wheat P proteins (red, 122, blue, 22). Determine how many of Orthogroups.csv wheat proteins (39) (formatted as vectors in Ogroups_copy.csv) are in the red & blue P subsets.
## So, need files 
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt
R
## from Ogroups_copy.csv
wheat820P <- c(TraesCS1A01G054500.1, TraesCS1A01G054700.2, TraesCS1A01G067400.1, TraesCS1A01G067600.1, TraesCS1B01G071600.1, TraesCS1B01G072400.1, TraesCS1B01G072900.2, TraesCS1B01G074600.1, TraesCS1B01G075000.1, TraesCS1B01G085300.1, TraesCS1B01G085900.1, TraesCS1D01G056200.1, TraesCS1D01G058200.1, TraesCS1D01G068400.1, TraesCS1D01G068500.1, TraesCS1D01G068800.1, TraesCS1D01G068900.1, TraesCS5B01G250800.1, TraesCS6A01G014500.1, TraesCS6A01G014600.1, TraesCS6A01G014800.1, TraesCS6A01G014900.1, TraesCS6A01G015000.1, TraesCS6A01G083000.1, TraesCS6A01G311600.1, TraesCS6B01G021200.1, TraesCS6B01G021500.1, TraesCS6B01G021600.1, TraesCS6B01G045200.1, TraesCS6B01G114300.1, TraesCS6D01G017700.1, TraesCS6D01G017800.1, TraesCS6D01G047700.1, TraesCS6D01G076500.1, TraesCS6D01G290900.1, TraesCS7D01G487500.1, TraesCSU01G089700.1, TraesCSU01G089800.1, TraesCSU01G090200.1)
## How read in red, blue files ???????????

08/20/17:
## methods, 
i) https://stackoverflow.com/questions/3695677/how-to-find-common-elements-from-multiple-vectors
ii) p-222, v buffalo

## try read into R
setwd("~/macbookpro2017/vikas17/tmp081117reparemacbook/r_stuff")
 ## p-196, v buffalo
#testdf <- read.delim("test.txt", header=FALSE, stringsAsFactors=FALSE)
bluedf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("blue"))
dim(bluedf)  ##  [1] 22  1  as expected.
head(bluedf, n=3)   ## looks ok
class(bluedf)
reddf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("red"))
dim(reddf)  ##  [1] 22  1  as expected.
head(reddf, n=3)   ## looks ok
class(reddf)
#wheat820P <- c(TraesCS1A01G054500.1, TraesCS1A01G054700.2, TraesCS1A01G067400.1, TraesCS1A01G067600.1, TraesCS1B01G071600.1, TraesCS1B01G072400.1, TraesCS1B01G072900.2, TraesCS1B01G074600.1, TraesCS1B01G075000.1, TraesCS1B01G085300.1, TraesCS1B01G085900.1, TraesCS1D01G056200.1, TraesCS1D01G058200.1, TraesCS1D01G068400.1, TraesCS1D01G068500.1, TraesCS1D01G068800.1, TraesCS1D01G068900.1, TraesCS5B01G250800.1, TraesCS6A01G014500.1, TraesCS6A01G014600.1, TraesCS6A01G014800.1, TraesCS6A01G014900.1, TraesCS6A01G015000.1, TraesCS6A01G083000.1, TraesCS6A01G311600.1, TraesCS6B01G021200.1, TraesCS6B01G021500.1, TraesCS6B01G021600.1, TraesCS6B01G045200.1, TraesCS6B01G114300.1, TraesCS6D01G017700.1, TraesCS6D01G017800.1, TraesCS6D01G047700.1, TraesCS6D01G076500.1, TraesCS6D01G290900.1, TraesCS7D01G487500.1, TraesCSU01G089700.1, TraesCSU01G089800.1, TraesCSU01G090200.1)
## won't work for char data
sed 's/^/"/' testOgroups.txt
sed 's/^/"/' whtOgroup.txt | sed 's/$/", /' > whtOgroupsed.txt

## before do any more, try read whtOgroup.txt into R.
whtOgroupdf <- read.delim("whtOgroup.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("whtOgrp"))
dim(whtOgroupdf)  ##  [1] 39  1  as expected.
head(whtOgroupdf, n=3)   ## looks ok
class(whtOgroupdf)
intersect(whtOgroupdf$whtOgrp, bluedf$blue)  ## 7 proteins
intersect(whtOgroupdf$whtOgrp, reddf$red)  ## 29 prots
## so, 39 - 36 = 3 prots not in common.
## now venn diagram or 'UpSetR', Gehlenborg ??????????

08/23/17:
*********************************************************************
Brought this file back from 'pro' today, so when decide, will backup to github.
**********************************************************************

Talked to vikas yesterday:
1) would like to create 1 file of 820+9. See what happens for following:
i) run online with orthoMCL
ii) run on orthofinder
## if result same as when ran separate files 820 & 9, then don't do (2) below.
2) run 820 wheat P seqs vs those for a rice genome P's (how get???). Include the '9' RF's from previous runs. See if find more orthogroups (only got 1 wi 820 & 9 ?????????

08/25/17:
talked to vikas.
## vikas request to 'shared' dir on crane, 
a) the 36 wheat proteins found as RF's in orthoFinder run on 820 & 9 files above.
b) previously did not have 829 file, only 820 & 9, so copy two input files for orthoFinderb to 'shared'.
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
ls -lh  ## ck dir contents?
cd ofinder
## rice9.fa, wheat820P.fa
cd /work/baenziger/shared/terry/hmm
cp /work/baenziger/pterry/wheatproj/ofinder/*.fa .  ## ok, done


08/26/17:
## before do any more, try read whtOgroup.txt into R.
whtOgroupdf <- read.delim("whtOgroup.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("whtOgrp"))
dim(whtOgroupdf)  ##  [1] 39  1  as expected.
head(whtOgroupdf, n=3)   ## looks ok
class(whtOgroupdf)

bluedf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("blue"))
dim(bluedf)  ##  [1] 22  1  as expected.
head(bluedf, n=3)   ## looks ok
class(bluedf)
reddf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("red"))
dim(reddf)  ##  [1] 22  1  as expected.
head(reddf, n=3)   ## looks ok
class(reddf)

Ofinder_blue <- intersect(whtOgroupdf$whtOgrp, bluedf$blue)  ## 7 proteins
Ofinder_red <- intersect(whtOgroupdf$whtOgrp, reddf$red)  ## 29 prots
## so, 39 - 36 = 3 prots not in common with RF phylogenetic ML analysis proteins.
write.table(Ofinder_blue, file="Ofinder_blue.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names="blue")
write.table(Ofinder_red, file="Ofinder_red.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names="red")

cat Ofinder_blue.txt Ofinder_red.txt > Ofinder_blueandred36.txt
## to copy to 'shared' on crane: Ofinder_blueandred36.txt

scp Ofinder_blueandred36.txt pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm  ## ok, done

08/27/17:

1) would like to create 1 file of 820+9. See what happens for following:
i) run online with orthoMCL
ii) run on orthofinder

1st, cp rice9.fa & wheat820P.fa from /Users/bterry/macbook2017/vikas17frompro/tmp081117reparemacbook/
## to /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp
cat rice9.fa wheat820P.fa > rice9wheat820P.fa
ls -al

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
ls -lh  ## ck dir contents?
mkdir ofinder1
cd ofinder1

## scp rice9wheat820P.fa to ofinder1
scp rice9wheat820P.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/ofinder1
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/ofinder1
ls -lh  ## ck dir contents?
## now change slurm, scp over to crane
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp
scp slurm_ofinder1_wheatproj_inp829.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/
## now run the slurm Job
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
#cd /work/baenziger/pterry/wheatproj
cd /home/baenziger/pterry/scripts

sbatch slurm_ofinder1_wheatproj_inp829.sh 8532901  1:08pm => ??:??am, 
squeue -u pterry  ## a PD

less job.8532901.err
Traceback (most recent call last):
  File "/util/opt/anaconda/4.3/envs/orthofinder-1.1.8/bin/orthofinder", line 1499, in <module>
    clustersFilename_pairs, statsFile, summaryText, orthogroupsResultsFilesString = DoOrthogroups(options, dirs, seqsInfo)    
  File "/util/opt/anaconda/4.3/envs/orthofinder-1.1.8/bin/orthofinder", line 1239, in DoOrthogroups
    summaryText, statsFile = Stats(ogs, speciesNamesDict, dirs.speciesToUse, dirs.resultsDir, iResultsVersion)
  File "/util/opt/anaconda/4.3/envs/orthofinder-1.1.8/bin/orthofinder", line 673, in Stats
    writer_sp.writerow(["Percentage of orthogroups containing species"] + [percentFormat % (100.*sum([iSp in og_sp for og_sp in speciesPresence])/len(properOGs)) for iSp in iSpecies])
ZeroDivisionError: float division by zero
job.8532901.err (END) 

## ***what to think*** ??????????????????????

less job.8532901.out
cat job.8532901.out
less Orthogroups.csv
        rice9wheat820P
Orthogroups.csv (END) 
## looks like ***no*** proteins reported in orthogroup ?????????????????

[pterry@login.crane Results_Aug27]$ cat Statistics_Overall.csv
Number of genes	829
Number of genes in orthogroups	0
Number of unassigned genes	829
Percentage of genes in orthogroups	0.0
Percentage of unassigned genes	100.0
Number of orthogroups	0
## NO genes in orthogroups
## So, have not proven that that using only **1** input .fa (rice9wheat820P.fa) file caused the failure to find any proteins in Orthogroups.csv output file. 

## for now, move on to try the **one** file (rice9wheat820P.fa) with orthoMCL online run. Tho I don't see a ratioale to do this, but if orthomcl only allows 1 file? Perhaps run a 2nd with rice9.fa & wheat820P.fa ???????
## dir is:
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp
## orthomcl: http://orthomcl.org/orthomcl/proteomeUpload.do
## submitted 9:30pm, 08/27/17.

08/28/17:
## result from orthomcl with one input file, /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/rice9wheat820P.fa
## results in /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/omclonline/orthomclResult-2V0ZL87G4ZTZ/orthologGroups file.

## talked to vikas, he went and found one of the rice 9 proteins (row) in this output file, 

AB110443	OG5_131220	osat|NP_001064958	0	-181	89	99

## noted OG5_131220 orthomcl_group same for all 9 rice RF proteins. Q: why only 828 records ???????????????????
## anyway, search in bbedit for OG5_131220 rows gives 144 rows, similar to number for 'blue' & 'red' results from phylogenetic ML analysis. 

## so, *to do*, compare this 144 with the 144 'blue' & 'red' phylogenetic ML analysis proteins. If roughly same set, then **two independent** ways to identify. Also, score what chromosomes these hits are on. Q: are they preponderantly on 1, 2, & 6 ??????????

08/29/17:

## so need:
--144 rows from orthoMCL
--red & blue protein lists from phylogenetic ML analysis

## for reference, place intersect.R in dir.:
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/r_stuff
## cp to this dir:
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt
## now, from /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/orthomclResult-2V0ZL87G4ZTZ
## cp over orthologGroups to /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/r_stuff
## now make copy of orthologGroups, then subset inside bbedit to oGroups144.txt


grep '.*OG5_131220.*$' oGroups144.txt > Test
## deleted oGroups144.txt, renamed test to oGroups144.txt.
## oGroups144.txt has 135 non rice9 RFs, 122 match red, 10 match blue, apparently 3 non matchers.

## next, cut 1st colm from oGroups144.txt, then ready for r code for intersect test.
## from /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/r_stuff

cut -f 1  oGroups144.txt | head -n 3
cut -f 1  oGroups144.txt > oGroups144col1.txt  ## ok, 144 rows

## now for the intersect from R code
whtOMCLgroupdf <- read.delim("oGroups144col1.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("whtOgrp"))
dim(whtOMCLgroupdf)
head(whtOMCLgroupdf, n=3)
class(whtOMCLgroupdf)

bluedf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("blue"))
dim(bluedf)
head(bluedf, n=3)

reddf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("red"))
dim(reddf)
head(reddf, n=3)

Ofinder_blue <- intersect(whtOMCLgroupdf$whtOgrp, bluedf$blue)
Ofinder_red <- intersect(whtOMCLgroupdf$whtOgrp, reddf$red)

## check
red_blue_overlap <- intersect(reddf$red, bluedf$blue)
length(red_blue_overlap)  ## 0 as expect

write.table(Ofinder_blue, file="OfinderMCL_blue.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names="blue")
write.table(Ofinder_red, file="OfinderMCL_red.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names="red")

## so, 10 of 22 'blue' phylogenic ML proteins match with OfinderMCL OG5_131220 orthomcl_group proteins, 122 of 122 'red' phylogenic ML proteins match with OfinderMCL OG5_131220 orthomcl_group proteins (135 OfinderMCL proteins). For the 'red', 122/820 and 122 (of 135)/820 orthoMCL match. Statistically, this degree of matching would not appear to be by chance. So if one can view othoMCL & phylogeny ML as independent methods, then the matching proteins related. 

## next step. Doc chromosomes for the 'red' 122?
## next step, perhaps do orthoMCL for the 820 wheat P proteins vs one of the rice protein genome proteins (1st do hmmPPR.hmm for the rice proteins to select P subset), or don't subset 1st, let orthoMCL find as many orthogroups as can? Guess just put all in one file? That is, try broaden search for RF proteins?

08/30/17:
## talked to vikas 
1) ## **to do** request put 147 wheat proteins on 'shared'. Q: how got 147? 122 (match 'red') + 10 (match 'blue'). Q: how get the additional 15? Perhaps the remaining 3 from orthoMCL, + ?? (perhaps remaining 12 nonmatching from 'blue' ?????????
  
## combine 135 proteins from oGroups144col1.txt (**remove** 9 rice rows. Last 12 needed are the 'blue' phylogenetic proteins not intersecting with oGroups144col1.txt proteins. 
## to get these, try setdiff(x,y) in R (order parameters matters) where x = blue file, y = intersect blue with oGroups144col1.txt output (10 rows)

08/31/17:
## will become setdiff12blue.R after run in rstudio.

setwd("~/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/r_stuff")
whtOMCLgroupdf <- read.delim("oGroups144col1.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("whtOgrp"))
dim(whtOMCLgroupdf)
head(whtOMCLgroupdf, n=3)
class(whtOMCLgroupdf)
bluedf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("blue"))
dim(bluedf)
head(bluedf, n=3)
Ofinder_blue <- intersect(whtOMCLgroupdf$whtOgrp, bluedf$blue)
length(Ofinder_blue)
class(Ofinder_blue)
## if vector (char vector), use as is ???????????????????????????????????????????????
class(bluedf$blue)
twelve <- setdiff(bluedf$blue, Ofinder_blue)
class(twelve)
length(twelve)  ## 12
write.table(twelve, file="twelve_nocolnam.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)
write.table(whtOMCLgroupdf, file="oGroups144col1_nocolnam.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

## grep out 9 rice rows
grep '.*OG5_131220.*$' oGroups144.txt > Test
grep 'Tr' oGroups144col1_nocolnam.txt > oGroups144col1_nocolnam_norice9.txt

## then cat twelve_nocolnam.txt to oGroups144col1_nocolnam_norice9.txt giving oGroups135plus12blue_norice9.txt

cat oGroups144col1_nocolnam_norice9.txt twelve_nocolnam.txt > oGroups135plus12blue_norice9.txt

sort oGroups135plus12blue_norice9.txt |uniq | wc -l  ## 147


## next move oGroups135plus12blue_norice9.txt to 'shared' for vikas.
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/r_stuff

scp oGroups135plus12blue_norice9.txt pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm

## go check 'shared' dir
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/shared/terry/hmm
ls -lh  ## ck dir contents?

sort oGroups135plus12blue_norice9.txt > sort147.txt  ## counted 3 rows for each chromosome.	

# slip a save to ***github*** in here
cd ~/planets
git status
git add wheatprojdoc060117.txt
git commit -m "update 08/31/17 wheatprojdoc060117.txt"
git status
git push origin master
# git remote -v

09/01/17:
## spoke wi vikas
I have downloaded the gff3 file and it is available here: /work/baenziger/shared with Filename: iwgsc_refseqv1.0_HighConf_2017Mar13.gff3.zip.

I have also downloaded an annotation file available for the reference genome (iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB.zip).

## Q: what get from each ??????????????????????

09/02/17:
## initially, det. how use the gff3 file. Perhaps scp over to mbook.

/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/wheatgff3

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/shared/terry/hmm
cd /work/baenziger/shared

cd /work/baenziger/shared/terry/hmm
cp /work/baenziger/shared/iwgsc_refseqv1.0_HighConf_2017Mar13.gff3.zip .
cp /work/baenziger/shared/iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB.zip .
## scp gff3 to /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/wheatgff3

scp pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm/iwgsc_refseqv1.0_HighConf_2017Mar13.gff3.zip .
ls -lh
unzip iwgsc_refseqv1.0_HighConf_2017Mar13.gff3.zip
ls -al
less iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
head -n 3 iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
## looks like 9 fields, perhaps look for 'Traes...' rows in 147, 'gene' rows for these names ??????????????
wc -l iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
 1743281 iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
sort oGroups135plus12blue_norice9.txt |uniq > testsort147.txt
less iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
## 1st protein name: TraesCS1A01G031600
grep -c "TraesCS1A01G031600" iwgsc_refseqv1.0_HighConf_2017Mar13.gff3  ## 4 rows
grep "TraesCS1A01G031600" iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
## try grep just 'gene' line ??????
grep '.*gene.*TraesCS1A01G031600.*$' iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
## worked, got just the gene line.
## next, perhaps can create a shell script with such a command for each of 147 rows in sort147.txt ?????????????????

09/03/17:
## **annotation** file for the reference genome
scp pterry@crane.unl.edu:/work/baenziger/shared/terry/hmm/iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB.zip .
ls -lh
unzip iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB.zip
ls -al
less iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB

head -n 2 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB

pcp256668pcs:wheatgff3 bterry$ head -n 2 
iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB

Gene-ID	is_repr	AHRD-Quality-Code	Blast-Hit-Accession	Human-Readable-Description	Pfam-IDs-(Description)	Interpro-IDs-(Description)	GO-IDs-(Description)-via-Interpro	Gene-or-TE-TE?-U (via-function)	Pfam-IDs	Interpro-IDs	GO-IDs-via-Interpro
TraesCS1A01G000100.1	1	-**	sp|P0AGJ7|TRML_ECOLI	tRNA (cytidine(34)-2'-O)-methyltransferase				G			
pcp256668pcs:wheatgff3 bterry$
## A Q: ***possible*** search annotation file for all PPR proteins, compare to the 147 'RF' proteins ??????????????????????????????????????

## continue planning to analyze gff3 file:
## attempt to subset 'gene' gff3 rows of iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
grep '.*gene.*$' iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 | wc -l  ##   110790
## think could handle with R ??????????
grep '.*gene.*$' iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 > gff3_genes.txt
wc -l gff3_genes.txt
  110790 gff3_genes.txt
cut -f 1,3,4,5 gff3_genes.txt > gff3_genes_col1345.txt
head -n 3 gff3_genes_col1345.txt
cut -f 9 gff3_genes.txt > gff3_genes_col9.txt
head -n 3 gff3_genes_col9.txt  ## looks like 'Trae' numbers 'incrementing' ????
cat gff3_genes_col9.txt|perl -pe 's/^ID=(Tr.+);.+/\1/' | wc -l  ##   110790 as expect.
cat gff3_genes_col9.txt|perl -pe 's/^ID=(Tr.+);.+/\1/' | head -n 110790 > gff3_genes_col9names.txt
wc -l gff3_genes_col9names.txt
  110790 gff3_genes_col9names.txt  ## a expect
## to check fidelity,
head -n 3 gff3_genes_col9.txt
head -n 3 gff3_genes_col9names.txt
tail -n 3 gff3_genes_col9.txt
tail -n 3 gff3_genes_col9names.txt
## so lengths same, and head, tail same, so can proceed
sort gff3_genes_col9names.txt |uniq | wc -l   ## 110790 as expect
head -n 3 gff3_genes.txt
head -n 3 gff3_genes_col9names.txt
tail -n 3 gff3_genes.txt
tail -n 3 gff3_genes_col9names.txt
wc -l gff3_genes.txt  ##   110790 gff3_genes.txt
wc -l gff3_genes_col9names.txt  ##   110790 gff3_genes_col9names.txt
## now, paste back together colms 1,3,4,5 with colm9.
paste gff3_genes_col1345.txt gff3_genes_col9names.txt > gff3_1345_9names.txt
head -n 3 gff3_1345_9names.txt
tail -n 3 gff3_1345_9names.txt
## preceding checks look ok.

2) ## vikas, ***above***, got GFF3, get start, end, (including introns ?????) introns, exons, 
## Note: word 'intron' ***not*** in GFF3 file (checked with 'less' command) ??????????


STOPPED

3) ## display location all proteins (genes) all chromosomes same plot. (Q: how do ????, vikas had example ????????????????
4) ## in 'annotation' file, perhaps try 
--select rows matching 'gene' names in gff3 (approx 110k rows), then look for 'ppr' in human readable description column?
--select 147 rows tentative 'RF' proteins, see what their human readable description column says?

09/04/17:

## sent vikas email stating gff3 issue, possible solns, request any suggestion ???

less iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
wc -l iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
 1743281 iwgsc_refseqv1.0_HighConf_2017Mar13.gff3  ## note 110790 'genes' rows

09/05/17:
talked to vikas:

i. subset gff3_1345_9names.txt wi grep -x -f, pattern file will be sort147.txt file after remove ".digit' from rhs each row.
## to display locations on chromosomes, check into ggplot2 'facets' ?????????
## Q: can **IGV** browser be used to display ?????? Perhaps if in gff3 format ????????
## Q: perhaps need subset ***the original gff3*** file wi the 147 RF names to display in GSDS or IGV or UCSC (checked ucsc site, currently **not** handle gff3 format)????????????
## try grep -x -f on (Q: with the name multiple times in some rows, to **test** if might be a problem ????????
## looks like practice wi top few lines of the gff3 file wi lines wi multiple names in.


ii. annotation file protein names have ".digit' at end of its names, which start off the rows. Apparently tab separated colms. Try just one name to start, may be multiple rows with each protein name ????????? Perhaps reduce number rows before subset with the 147 'RF' protein file. determine how many row, perhaps play around with 'cut' and 1st few rows of annotation file to determine  ???????

wc -l iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
  107502 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB

iii. plot gene structures from gff3 (vikas has link for this, http://gsds.cbi.pku.edu.cn/)

09/06/17:
## one add'l **idea**: phylogeny on just the 147, GSDS site can then display (me: unclear ??????)

## working on (i) from previous day
## 1st, remove '.digit' from rhs sort147.txt, before try subset original gff3 file with it (i.e., using grep -x -f)

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/r_stuff

cat sort147.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | wc -l  ## 147, ok
cat sort147.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 3
TraesCS1A01G031600  ## looks good
cat sort147.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 147 > sort147_nodotnum.txt

## now ready try grep -x -f pat.txt sample.txt
## 1st, try on '31600' lines of iwgsc_refseqv1.0_HighConf_2017Mar13.gff3

grep -x -f sort147_nodotnum.txt samp31600_8rows.gff3 | wc -l   ## 0
grep -f sort147_nodotnum.txt samp31600_8rows.gff3 | wc -l    ## 8, so not specific ???
grep -f sort147_nodotnum.txt samp31600_8rows.gff3
## perhaps check if just 'TraesCS1A01G031600' can successfully match in samp31600_8rows.gff3

grep '.*TraesCS1A01G031600.*' samp31600_8rows.gff3 | wc -l  ## worked!
## but, -f option not working, what to try ????????????????
## python list & for loop ??????????????????????
name in 
09/07/17:
## 1st try code from Zeynep
bash Philip.bash sort147_nodotnum.txt
bash: Philip.bash: No such file or directory  ## what wrong  ?????
## perhaps try
bash Philip.sh sort147_nodotnum.txt  ## this ran
## ok, try modify Philip.sh to Philip_no_else.sh
bash Philip_no_else.sh sort147_nodotnum.txt
## ok, try modify Philip_no_else.sh to Philip_no_echo.sh
bash Philip_no_echo.sh sort147_nodotnum.txt
## ok, looks like worked on this test sample gff3 file.
## now try to save output to a file
bash Philip_no_echo.sh sort147_nodotnum.txt > testbashtofile.gff3
## looks like worked. Now try on actual gff3 file, iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
## Philip_realgff3.sh
## ran in less than 20 min, 789 rows, Q: should I delete last 3 pattern outputs since no chromosome specified before pass to GSDS display  (or IGV) ?????

09/08/17:
## submit realbashtofile.gff3 to http://gsds.cbi.pku.edu.cn, request png output
## Q: what looking at ????????
## different number of 'names' left side of png display ??????????
## Q: other possible displays from GSDS (phylogenetic tree) ??????????????
## Q: if want qqch like Vikas had with gene locations on chromosome, not getting it here ????????
## Q: to get such a display, perhaps check the faceting with ggplot2 using my 5 colm df for 'gene' rows for the 147  ??????
## Q: or IGV ????????????????

## talked to vikas
i. plot chr(y axis) vs start position (x axis). Could subset 5 colm from gff3 (already gff3 subset to 'genes' rows) with 147 RF names, then take appropriate colms from gff3_1345_9names.txt, 1st & 2nd, to plot with ggplot2 script from vikas.
ii. subset the annotation file for the 147 RF proteins/genes. See what the descriptions say.

09/09/17: to subset 
## so try to do (i) 1st. Working with GenomeWidePlot.R from vikas, but 1st need file with 

wc -l gff3_1345_9names.txt
  110790 gff3_1345_9names.txt
## try modify Philip_realgff3.sh, use to subset gff3_1345_9names.txt wi the 147 RF genes from sort147_nodotnum.txt.
## rename, modify this '.sh' file in Philip_5colmgff3.sh
bash Philip_5colmgff3.sh sort147_nodotnum.txt > gff3_1345_9names_147.txt  ## ok
## Note, last 3 rows have no chromosome number, but a start number ??????????????????????????????????
## cut colms 1 & 3 for input to GenomeWidePlot.R.

cut -f 1,3 gff3_1345_9names_147.txt > gff3_cols13_147.txt
head -n 3 gff3_cols13_147.txt

## then remove last 3 rows, no chr number ???????????????????????
gff3_cols13_144.txt
## finally, remove 1st 3 char each row in gff3_cols13_144.txt with 

cat gff3_cols13_144.txt|perl -pe 's/chr(.+)/\1/' | head -n 3  ## ok
cat gff3_cols13_144.txt|perl -pe 's/chr(.+)/\1/' | head -n 144 > gff3_cols13_144nochr.txt

## now try modify GenomeWidePlot.R to use here ??????
## to GenomeWidePlot_pmt.R
## note 3 rows chr 5, 3 rows chr 7. Keep ????????????????????????????????
## GenomeWidePlot_pmt.R  ## result: basically for the chroms with the most putative Rf genes, #'s 1, 2, 6, the genes are clustered!
## What was vikas suggesting for the change to 'geom_point' in the ggplot code ???????
## A change which would be nice is the number of genes on the plot to indicate the clustering ???????????????
## so perhaps vikas thinking of cluster bars & I would add the number in the cluster ??????????

09/10/17:
## use vikas email to summarize result of GenomeWidePlot_pmt.R run on gff3_cols13_144nochr.txt.

Would say, basically for the chroms with the most putative Rf genes, #'s 1, 2, 6, the genes are clustered! 

***NOTE:*** CLUSTERS NEAR SAME LOCATION FOR EACH NUMBERED CHROMOSOME FOR A, B, & D CHROMOSOME DUPLICATIONS!

chrom   # prots      # prots
        on chrom     in cluster
1A       23            22
1B       28            26
1D       30            29
2A       8              7
2B       6              4
2D       8              7
5A       1
5B       2
5D       1
6A       11             7(?)
6B       12             5,4(?)
6D       11             8
7B       1
7D       2

## now for (ii) above, the annotation file

wc -l iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
  107502 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB

## try modify Philip_realgff3.sh, use to subset iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB wi the 147 RF genes from sort147_nodotnum.txt.
## rename, modify this '.sh' file in Philip_realannotation.sh
bash Philip_realannotation.sh sort147_nodotnum.txt > wheatannotationvs147.txt  ## ok
wc -l wheatannotationvs147.txt
     147 wheatannotationvs147.txt
## all 147 rows are PPR 'human-readable description' colm.
## To do: read into R so can more easily 'see' the colms.

cut -f 5 wheatannotationvs147.txt | head -n 147 > colm5.txt
## looks like colm 5 is 'Human-Readable_Description' colm. All rows have 'Pentatricopeptide repeat-containing protein' in colm 5
## colm 6, Pfam-IDs-(Description), Q: what to think ?????????????????????
## colm ?,Interpro-IDs-(Description). Q: Q: what to think ?????????????????????
## colm 9, (via-function), all 'G's, ????????????????????//
## colm 10, Pfam-IDs
## colm 11, Interpro-IDS
## colm 12, GO-IDs_via-Interpro

## so annotation file result: almost all colm 5 'Human-Readable_Description' are 'Pentatricopeptide repeat-containing protein'.
## test
cut -f 5 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB > allcolm5_annotation.txt
## can see much annotation, not PPR
## perhaps search on colm 5 for 'Pentatricopeptide', get a sense if many more than 147 in allcolm5_annotation.txt ??????
grep -c "Pentatricopeptide" allcolm5_annotation.txt  ## 1602
grep "Pentatricopeptide" allcolm5_annotation.txt > colm5Pentatricopeptide.txt
## basically 1602 rows of 'Pentatricopeptide repeat-containing protein' in iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
## ~ 1.5% of the rows, WHAT TO THINK ???????????????????????????????

09/11/17:
## talked to vikas
09/12/17:
i. run GenomeWidePlot_pmt.R again, this time with 
#geom_jitter(alpha=I(0.1)) +
## test different settings starting with '0.1'
## done, helps, may want try later, perhaps not helping current goal enough ??????
## also, modify 
 geom_point(colour="red", size=2) +
## try values of 0.5, 1.0, 1.5
## tried 0.5, helps, still can see points, but can close by points also. Note, 2A chrom, should be 7 points, still only see 4. 1D, should see 29, only seeing 22
## Q: why vikas comment out ????????????????????????????????/

ii. det. size of clusters for chrom's !A, 1B, 1D, 2A, 2B, 2D, 6A, 6B, 6D, for now just use start positions. To do, for example for 1A, read gff3_cols13_144nochr.txt file into R, grep '1A' in colm 1, the 23 rows, sort by colm 2, small to large, then head 22, removes location outlier. Then, 

## do in R if reg expn will work, else, try unix command line ????????????????
df_col13_144nochr <- read.delim("gff3_cols13_144nochr.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("chrom", "start"))
dim(df_col13_144nochr)
head(df_col13_144nochr, n=3)
df_1A <- df_col13_144nochr[grep("^1A", col13_144nochr_df$chrom), ]
dim df_1A  ## will be used vikas plot for 22, TO DO, so delete row 23 before plot 
## sort df_1A with the 22 before vikas plot (tho presumably don't need)
## need min, max for row 1 & 2 of df_minmaxchr1.

chrom <- vector(mode="character", length=6)
start <- vector(mode="numeric", length=6)

09/14/17:
df_minmaxchr1 <- data.frame(chrom, start)
df_minmaxchr1[1,1] <- "1A"
df_minmaxchr1[2,1] <- "1A"
df_minmaxchr1[3,1] <- "1B"
df_minmaxchr1[4,1] <- "1B"
df_minmaxchr1[5,1] <- "1D"
df_minmaxchr1[6,1] <- "1D"
head(df_minmaxchr1)

from https://stackoverflow.com/questions/1296646/how-to-sort-a-dataframe-by-columns
## dd[order(-dd$z, dd$b),]
df_1A <- df_1A[order(df_1A$start), ]
tail(df_1A, n=3)  ## check that last row is the outlier value ?????
## need remove row 23 1st
dim(df_1A)  ## expect 22 2 ?????????????
df_1A <- df_1A[-c(23), ]
dim(df_1A)  ## expect 22 2 ?????????????

df_minmaxchr1[1,2] <- min(df_1A$start, na.rm=T)
df_minmaxchr1[2,2] <- max(df_1A$start, na.rm=T)
head(df_minmaxchr1)

09/13/17:
## TO finish last 4 rows of df_minmaxchr1
## WILL need df_1B & df_1D.

df_1B <- df_col13_144nochr[grep("^1B", df_col13_144nochr$chrom), ]
dim(df_1B)  ## will be used vikas plot for 26, TO DO, so delete 2 rows before plot 
df_1B <- df_1B[order(df_1B$start), ]
tail(df_1B, n=3)  ## check that last 2 rows are the outlier values ?????

## need remove last 2 rows 1st
df_1B <- df_1B[-c(27, 28), ]
dim(df_1A)  ## expect 26 2 ?????????????

df_minmaxchr1[3,2] <- min(df_1B$start, na.rm=T)
df_minmaxchr1[4,2] <- max(df_1B$start, na.rm=T)
head(df_minmaxchr1)

## now for df_1D

df_1D <- df_col13_144nochr[grep("^1D", df_col13_144nochr$chrom), ]
dim(df_1D)  ## will be used vikas plot for 29, TO DO, so delete 1 row before plot 

df_1D <- df_1D[order(df_1D$start), ]
tail(df_1D, n=3)  ## check that last row is the outlier value ?????

## need remove last row 1st
df_1D <- df_1D[-c(30), ]
dim(df_1D)  ## expect 29 2 ?????????????

df_minmaxchr1[5,2] <- min(df_1D$start, na.rm=T)
df_minmaxchr1[6,2] <- max(df_1D$start, na.rm=T)
head(df_minmaxchr1)

## TO calc **'range'** of '1A' cluster, & of '1B' & '1D'. 
>range(y,na.rm=TRUE)

[1] -4 43

[1] 47

## define dataframe

chr_ran <- vector(mode="character", length=3)
str_ran <- vector(mode="numeric", length=3)
df_rangchr1 <- data.frame(chr_ran, str_ran)
df_rangchr1[1,1] <- "1A"
df_rangchr1[2,1] <- "1B"
df_rangchr1[3,1] <- "1D"

rang <- range(df_1A$start,na.rm=TRUE)
class(rang)
rang
df_rangchr1[1,2] <- diff(rang)

rang <- range(df_1B$start,na.rm=TRUE)
df_rangchr1[2,2] <- diff(rang)

rang <- range(df_1D$start,na.rm=TRUE)
df_rangchr1[3,2] <- diff(rang)
head(df_rangchr1)

## TO DO: now for some plotting

## will need to convert df_minmaxchr1 to terminology in GenomeWidePlot.R (the 'data' df there) before proceed with that plot.

## for example, 'data' df, colms 'chrom' & 'pos'
data <- df_minmaxchr1
head(data)
colnames(data)[2] <- "pos"
head(data)

## following from GenomeWidePlot_pmt.R
##********************
#Converting BP scale from bp to Mb
data$Mb=data$pos*0.000001
head(data)

library(RColorBrewer)
library(ggplot2)
library(reshape)  ## h wickham ???????????????

#Plot
ggplot(data, aes(x=Mb, y=chrom)) + theme_classic() +
  geom_point(colour="red", size=0.5) +
  #scale_x_continuous(breaks = seq(0, 60, 10)) +
  theme(axis.text.x = element_text(colour = 'black', face="bold", size = 20, vjust=0.5)) +
  theme(axis.text.y = element_text(colour = 'black', face="bold", size = 20)) +
  theme(axis.title.x = element_text(colour = 'black', face="bold", size = 25, vjust=-0.2)) +
  theme(axis.title.y = element_text(colour = 'black', face="bold", size = 25, angle=90)) +
  xlab("Length of chromosome (Mb)") +
  ylab("Chromosome") +
  geom_jitter(alpha=I(0.1)) +
  theme(plot.background=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
        panel.border=element_blank()) +
  #theme(axis.ticks.x = element_blank()) +
  scale_x_continuous(expand = c(0,0)) + scale_y_discrete(expand = c(0,0))

##*********************************************

## Yet to plot, df_1A, df_1B, df_1D
head(df_1A)
dim(df_1A)
tail(df_1A)

## for example, 'data' df, colms 'chrom' & 'pos'
data <- df_1A
head(data)
colnames(data)[2] <- "pos"
head(data)

## following from GenomeWidePlot_pmt.R
##********************
#Converting BP scale from bp to Mb
data$Mb=data$pos*0.000001
head(data)

#Plot
ggplot(data, aes(x=Mb, y=chrom)) + theme_classic() +
  geom_point(colour="red", size=0.5) +
  #scale_x_continuous(breaks = seq(0, 60, 10)) +
  theme(axis.text.x = element_text(colour = 'black', face="bold", size = 20, vjust=0.5)) +
  theme(axis.text.y = element_text(colour = 'black', face="bold", size = 20)) +
  theme(axis.title.x = element_text(colour = 'black', face="bold", size = 25, vjust=-0.2)) +
  theme(axis.title.y = element_text(colour = 'black', face="bold", size = 25, angle=90)) +
  xlab("Length of chromosome (Mb)") +
  ylab("Chromosome") +
  geom_jitter(alpha=I(0.1)) +
  theme(plot.background=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
        panel.border=element_blank()) +
  #theme(axis.ticks.x = element_blank()) +
  scale_x_continuous(expand = c(0,0)) + scale_y_discrete(expand = c(0,0))

##*********************************************

## plotting with geom_point = 2 gave expected 22 points. Plotting with geom_point = 0.5 gave 26 points != 22 ??????????????????????????????
## note: clustering in 3 locations, **not** uniformly distributed across the 43 Mb for df_1A.

in df_1A, 1st 2, next 9, next 7 & last 4 in the total of 22. 

#rang <- range(df_1A$start,na.rm=TRUE)
#rang1 <- range(df_1A[1:2, ], na.rm=TRUE)  ## fails
rang1minmax <- range(df_1A$start[1:2], na.rm=TRUE)  ## works
head(rang1minmax)
rang1 <- diff(rang1minmax)
rang1  ## [1] 6964

rang2minmax <- range(df_1A$start[3:11], na.rm=TRUE)  ## works
head(rang2minmax)
rang2 <- diff(rang2minmax)
rang2  ## [1] 1,337,765

rang3minmax <- range(df_1A$start[12:18], na.rm=TRUE)  ## works
head(rang3minmax)
rang3 <- diff(rang3minmax)
rang3  ## [1] 363,314

rang4minmax <- range(df_1A$start[19:22], na.rm=TRUE)  ## works
head(rang4minmax)
rang4 <- diff(rang4minmax)
rang4  ## [1] 240,790

## to do, plot the 4 groups in 1A

09/16/17:
________________________________________________________________________________________
## ***an aside*** for a moment, try get python to do what did with shell script above, do in dir. /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/wheatgff3/python

bash Philip_no_echo.sh sort147_nodotnum.txt > testbashtofile_pydir.gff3
## ok, same output as testbashtofile.gff3 on 09/07/17 above.
## now try repeat with python, initially with 'print' statement.
python3 adam2.py
   File "adam2.py", line 13, in <module>
    if name in line2.split('\t')[8]:
IndexError: list index out of range
## don't see what wrong ?????????????????????????
## anyway, replace line 13 by
##      if name in line2:
## result: found the 4 31600 lines, but ***not*** the 31700 lines. The shell script on these two input files found the 8 lines expected ???????????????????????????
## end ***aside*** for now.
_______________________________________________________________________________________

## TO DO: perhaps plot the 4 sets of ranges, one at a time, in df_1A, may have some genes clustered **within** the groups.
df_1Agrp1 <- df_1A[1:2, ]
dim(df_1Agrp1)  ## [1] 2 2
head(df_1Agrp1)  ## looks ok.

## for example, 'data' df, colms 'chrom' & 'pos'
data <- df_1Agrp1
head(data)
colnames(data)[2] <- "pos"
head(data)

## following from GenomeWidePlot_pmt.R
##********************
#Converting BP scale from bp to Mb
data$Mb=data$pos*0.000001
head(data)

#Plot
ggplot(data, aes(x=Mb, y=chrom)) + theme_classic() +
  geom_point(colour="red", size=2) +
  #scale_x_continuous(breaks = seq(0, 60, 10)) +
  theme(axis.text.x = element_text(colour = 'black', face="bold", size = 20, vjust=0.5)) +
  theme(axis.text.y = element_text(colour = 'black', face="bold", size = 20)) +
  theme(axis.title.x = element_text(colour = 'black', face="bold", size = 25, vjust=-0.2)) +
  theme(axis.title.y = element_text(colour = 'black', face="bold", size = 25, angle=90)) +
  xlab("Length of chromosome (Mb)") +
  ylab("Chromosome") +
  geom_jitter(alpha=I(0.1)) +
  theme(plot.background=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
        panel.border=element_blank()) +
  #theme(axis.ticks.x = element_blank()) +
  scale_x_continuous(expand = c(0,0)) + scale_y_discrete(expand = c(0,0))

STOPPED

df_1Agrp2 <- df_1A[3:11, ]
dim(df_1Agrp2)  ## ## [1] 9 2
head(df_1Agrp2)  ## looks ok.

## for example, 'data' df, colms 'chrom' & 'pos'
data <- df_1Agrp2
head(data)
colnames(data)[2] <- "pos"
head(data)

#Converting BP scale from bp to Mb
data$Mb=data$pos*0.000001
head(data)

#Plot
ggplot(data, aes(x=Mb, y=chrom)) + theme_classic() +
  geom_point(colour="red", size=2) +
  #scale_x_continuous(breaks = seq(0, 60, 10)) +
  theme(axis.text.x = element_text(colour = 'black', face="bold", size = 20, vjust=0.5)) +
  theme(axis.text.y = element_text(colour = 'black', face="bold", size = 20)) +
  theme(axis.title.x = element_text(colour = 'black', face="bold", size = 25, vjust=-0.2)) +
  theme(axis.title.y = element_text(colour = 'black', face="bold", size = 25, angle=90)) +
  xlab("Length of chromosome (Mb)") +
  ylab("Chromosome") +
  geom_jitter(alpha=I(0.1)) +

theme(plot.background=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
        panel.border=element_blank()) +
  #theme(axis.ticks.x = element_blank()) +
  scale_x_continuous(expand = c(0,0)) + scale_y_discrete(expand = c(0,0))

 
df_1Agrp3 <- df_1A[12:18, ]
dim(df_1Agrp3)  ## [1] 7 2
head(df_1Agrp3)  ## looks ok.

## for example, 'data' df, colms 'chrom' & 'pos'
data <- df_1Agrp3
head(data)
colnames(data)[2] <- "pos"
head(data)

#Converting BP scale from bp to Mb
data$Mb=data$pos*0.000001
head(data)

#Plot
ggplot(data, aes(x=Mb, y=chrom)) + theme_classic() +
  geom_point(colour="red", size=2) +
  #scale_x_continuous(breaks = seq(0, 60, 10)) +
  theme(axis.text.x = element_text(colour = 'black', face="bold", size = 20, vjust=0.5)) +
  theme(axis.text.y = element_text(colour = 'black', face="bold", size = 20)) +
  theme(axis.title.x = element_text(colour = 'black', face="bold", size = 25, vjust=-0.2)) +
  theme(axis.title.y = element_text(colour = 'black', face="bold", size = 25, angle=90)) +
  xlab("Length of chromosome (Mb)") +
  ylab("Chromosome") +
  geom_jitter(alpha=I(0.1)) +
  theme(plot.background=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
        panel.border=element_blank()) +
  #theme(axis.ticks.x = element_blank()) +
  scale_x_continuous(expand = c(0,0)) + scale_y_discrete(expand = c(0,0))

df_1Agrp4 <- df_1A[19:22, ]
dim(df_1Agrp4)  ## [1] 7 2
head(df_1Agrp4)  ## looks ok.

## for example, 'data' df, colms 'chrom' & 'pos'
data <- df_1Agrp4
head(data)
colnames(data)[2] <- "pos"
head(data)

#Converting BP scale from bp to Mb
data$Mb=data$pos*0.000001
head(data)

#Plot
ggplot(data, aes(x=Mb, y=chrom)) + theme_classic() +
  geom_point(colour="red", size=2) +
  #scale_x_continuous(breaks = seq(0, 60, 10)) +
  theme(axis.text.x = element_text(colour = 'black', face="bold", size = 20, vjust=0.5)) +
  theme(axis.text.y = element_text(colour = 'black', face="bold", size = 20)) +
  theme(axis.title.x = element_text(colour = 'black', face="bold", size = 25, vjust=-0.2)) +
  theme(axis.title.y = element_text(colour = 'black', face="bold", size = 25, angle=90)) +
  xlab("Length of chromosome (Mb)") +
  ylab("Chromosome") +
  geom_jitter(alpha=I(0.1)) +
  theme(plot.background=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
        panel.border=element_blank()) +
  #theme(axis.ticks.x = element_blank()) +
  scale_x_continuous(expand = c(0,0)) + scale_y_discrete(expand = c(0,0))

09/17/17:

## To finish displaying for 1B (26 genes), & 1D (29 genes), the 'cluster' portion of the genes, compare distribution to 1A chromosome (22 genes).

## for df_1B (26 genes)
head(df_1B)
dim(df_1B)  ## [1] 26  2
tail(df_1B)
data <- df_1B
head(data)
colnames(data)[2] <- "pos"
head(data)
data$Mb=data$pos*0.000001
head(data)

ggplot(data, aes(x=Mb, y=chrom)) + theme_classic() +
  geom_point(colour="red", size=2) +
  #scale_x_continuous(breaks = seq(0, 60, 10)) +
  theme(axis.text.x = element_text(colour = 'black', face="bold", size = 20, vjust=0.5)) +
  theme(axis.text.y = element_text(colour = 'black', face="bold", size = 20)) +
  theme(axis.title.x = element_text(colour = 'black', face="bold", size = 25, vjust=-0.2)) +
  theme(axis.title.y = element_text(colour = 'black', face="bold", size = 25, angle=90)) +
  xlab("Length of chromosome (Mb)") +
  ylab("Chromosome") +
  geom_jitter(alpha=I(0.1)) +
  theme(plot.background=element_blank(),panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
        panel.border=element_blank()) +
  #theme(axis.ticks.x = element_blank()) +
  scale_x_continuous(expand = c(0,0)) + scale_y_discrete(expand = c(0,0))

## now calc ranges of the 4 groups of genes in df_1B seen in plot.

rang1_1Bminmax <- range(df_1B$start[1:8], na.rm=TRUE)  ## works
head(rang1_1Bminmax)
rang1_1B <- rang1_1Bminmax
rang1_1B
rang1_1B <- diff(rang1_1Bminmax)
rang1_1B  ## [1] 1179582  ## so 1179 Kb, pretty wide compared to fig 3, sci reports ??

rang2_1Bminmax <- range(df_1B$start[9:19], na.rm=TRUE)  ## works
head(rang2_1Bminmax)
rang2_1B <- diff(rang2_1Bminmax)
rang2_1B  ## [1] 1835062

rang3_1Bminmax <- range(df_1B$start[20:24], na.rm=TRUE)  ## works
head(rang3_1Bminmax)
rang3_1B <- diff(rang3_1Bminmax)
rang3_1B  ## [1] 1142607

rang4_1Bminmax <- range(df_1B$start[25:26], na.rm=TRUE)  ## works
head(rang4_1Bminmax)
rang4_1B <- diff(rang4_1Bminmax)
rang4_1B  ## [1] 94820

09/18/17:
## Talked to vikas, to do's:
i. count of different wheat RF's on different chromosomes (vikas has script)
ii. relation RF's of different chromosomes. Use phylogeny. May already have this data? Recall the 'blue' & 'red' subsets of phylogeny tree. Should be able to find those subsets, just go in, at 'leaves', see which protein/gene names are on leaves on same nodes.
iii. multiple chromosome displays (send links to vikas)
--https://biodatamining.biomedcentral.com/articles/10.1186/1756-0381-6-18 (Phenogram)
--https://stackoverflow.com/questions/33727432/how-to-plot-positions-along-a-chromosome-graphic (ggplot)
iv. send vikas input file for overhead plot of location of genes on chromosome (yet to find) 
v. tandem gene duplication distance (see soybean paper)
vi. PAG, jan 13-17, 2018 (possible abstract of work with new wheat genome)

## finish (iv) done.

## next, read (iii), look for file, how display to do (ii).

##**saved** wheatprojdoc060117.txt to github.

09/19/17:
___________________________________________________________________________
## resume bit about python from 09/16/17 above
head -n 10 sort147_nodotnum.txt > 10sort147_nodotnum10.txt  ## done
## working with pythonsubset.py
## following fails, 
  if line1 == 'TraesCS1A01G054800':  ## not working, does not break, check csce155t info on index for for loop ?????
      break
## next, try, no match line 17 for 2nd pattern '31700' ????????????????????/
philip-terry-2:python bterry$ python3 pythonsubset.py
TraesCS1A01G031600
chr1A   IWGSC_March2017 gene    14577948        14579936        49      +       .       ID=TraesCS1A01G031600;primconf=HC

chr1A   IWGSC_March2017 mRNA    14577948        14579936        49      +       .       ID=TraesCS1A01G031600.1;Parent=TraesCS1A01G031600;primconf=HC;secconf=HC1

chr1A   IWGSC_March2017 exon    14577948        14579936        .       +       .       Parent=TraesCS1A01G031600.1

chr1A   IWGSC_March2017 CDS     14577948        14579936        .       +       0       Parent=TraesCS1A01G031600.1

TraesCS1A01G031700
TraesCS1A01G054500
TraesCS1A01G054700
TraesCS1A01G054800
TraesCS1A01G055500
TraesCS1A01G055600
TraesCS1A01G055800
TraesCS1A01G056000
TraesCS1A01G057300
philip-terry-2:python bterry$ 

## send Juan 4 files
i. pythonsubset.py
ii. samp31600_8rows.gff3
iii. sort147_nodotnum10.txt
iv. output when run, 2nd pattern, ...31700 not found in gff3 file?
_______________________________________________________________________________

09/20/17:
 
## ok, printed blue & red from figtree on 'pro'. **Yet** to do, compare the relationships in figtree display say for chrom 1, for A, B, & D with locations on these chromosomes. Note, few relations betw proteins on different numbered chroms in phylogeny diagram.  To relate locations on chrom vs phylogeny relations, ***need*** go back from gff3_cols13_144nochr.txt to step before removed gene/protein name ????????????????????

09/22/17:
## talked to vikas
i. prepare homeologous proteins/genes table. columns: protein gene names. Q: exactly how define 'homeologous' in phylogram? Looks like lot of 'three' leaves, perhaps use this? Perhaps group the rows by chromosome number, i.e., 1, 2, 6? But perhaps, would like to show additional nearby relationships ???????????????
Q: where aLRT values sort of overlapping, clarify exactly how to interpret, value & what near to ???????????
Q: perhaps could increase 'three leaves' some depending on associated aLRT values ??????
Q: or from circular display, perhaps get relation larger than say 'three size groups', then in table, group rows accordingly ???????????????
Q: perhaps start with vikas script GenomeWidePlot_pmt.R. Plot a few 'threes' or bit larger group, see if can find some patterns between phyml relationships of proteins & seq of genes along for example, chroms 1A, 1B, & 1D ??????
Q: **phenoGram**, perhaps submit subsets of genes (on say just chroms 1A, 1B, 1D) would like to compare to phenoGram, view positions on chromosomes. 
ii. count genes per chromosome, vikas had script.
iii. To Finish: analyzing blue & red parts of phyml phylogram from figtree run on 'pro'.
*////////////////////////////////////////////////////////////////////////////////
***iv.*** Work flow steps, start to end, try '.Rmd'
***v.*** RNAseq from new db, (Q: not yet done ?????)
-- wheatExp, contact info ?????????? https://wheat.pw.usda.gov/WheatExp/
-- expVIP  http://www.wheat-expression.com/#
vi. MEME (input fasta file) http://meme-suite.org/tools/meme
vii. 144 proteins REDO: PHYLOGENY through hmm ( see vikas 'Notes_Alignment_UsingHMMs.txt
///////////////////////////////////////////////////////////////////////////////////*

09/24/17: 
## working on (i) above, after find file gff3_cols13_144nochr.txt (input for GenomeWidePlot_pmt.R), need relate this back to file still has related protein/gene names ????? Came from gff3_cols13_144.txt (from gff3_cols13_147.txt). Of course, will test **phenoGram** also. Check precursor file, gff3_1345_9names_147.txt.

09/26/17:
## from blue & red RF-like proteins, select from red 12 from 1A, 1B, 1D, see if located closer together compared to 3 from 1A, 1B, 1D from blue. See if the 3 from blue located away from the 12 from red ??????????

09/27/17:
Talked to vikas, emphasize (iv), (v) above. And qqch about producing phylogeny of just the 147 RF-like proteins ??????????????????????????

gff3_1345_9names_147.txt -> gff3_1345_9names_15.txt (done)
gff3_1345_9names_15.txt -> gff3_1345_9names_12.txt (done)

## from 09/17/17 above
## cut colms 1 & 3 for input to GenomeWidePlot.R.

cut -f 1,3 gff3_1345_9names_15.txt > gff3_cols13_15.txt
head -n 3 gff3_cols13_15.txt

cut -f 1,3 gff3_1345_9names_12.txt > gff3_cols13_12.txt
head -n 3 gff3_cols13_12.txt

## finally, remove 1st 3 char each row in gff3_cols13_15.txt, gff3_cols13_12.txt with 

cat gff3_cols13_15.txt|perl -pe 's/chr(.+)/\1/' | head -n 3  ## ok
cat gff3_cols13_15.txt|perl -pe 's/chr(.+)/\1/' | head -n 15 > gff3_cols13_15nochr.txt

cat gff3_cols13_12.txt|perl -pe 's/chr(.+)/\1/' | head -n 3  ## ok
cat gff3_cols13_12.txt|perl -pe 's/chr(.+)/\1/' | head -n 12 > gff3_cols13_12nochr.txt

## now try modify GenomeWidePlot.R to use here ??????
## looks like can just copy GenomeWidePlot_pmt.R to GenomeWidePlot_15pmt.R, modify


09/28/17:
## ready to run GenomeWidePlot_12pmt.R in RStudio
## did, not getting nice plot, but showing that the proteins in 1A, 1B, & 1D are within chrom, clustered, thus phylogram relationships correlate with close distance relationship on chromosomes.
## the range for the proteins are:
1A 61742
1B 356307
1D 152289
## comparing to fig 3, sci reports, within scale there of 100k to 500k. Significance ??????????
## perhaps phenogram plot can do better ????????????????????



10/17/17:
working with wheatflowdocnotes.txt, ppointtmp.txt, and then wheatflowdocnotestoc4_from_ppointtmp.Rmd

10/26/17:
## from 09/22/17 above, task number **vii**, **redo** phylogeny thru hmm for .../r_stuff/oGroups144.txt, but for subset 122 (match red) plus 10 (match blue) for hmm part. Note: previously decided to include 12 additional blue rows not matching orthoMCL. Finally, add back rice9 at hmmalign step, run phyML online (French), finally display in figtree, locate what rice 9 seqs near. So for muscle step, start with 122 + 10 + 12 + 9 = 153 rows.
## Note: orthoMCL result has 135 rows of wheat proteins in orthoGroup 'OG5_131220' which also contained the rice 9 RF proteins (total 144). So, 3 rows not match in blue, red groups from phylogram. For now, don't include these 3 in 'redo' phylogeny (following 'Notes_Alignment_UsingHMMs.txt' from vikas)

## ref. 07/22/17
i) rerun realign step as per vikas 'Notes_Alignment_UsingHMMs.txt' thru PhyML step, , but with the 'seq.fa' file including the 153 seqs referenced above. So will need run 144 + 9 starting with muscle. 
I note: Vikas a **preference** for the hmmaln.fa over the hmmaln-Gblocks.fa trimmed MSA when going for a phylogram.

## example
line 1346
FRknownseqs_shtname_9.fa the '9' rice FR protein fasta file to cat to PPRhmmsearchsubset_P_prots820.fa before 'muscle'

## to do, prepare .fa input file for the 153 proteins mentioned above.

## in /Users/bterry/macbook2017/vikas17frompro/tmp081117reparemacbook dir, found
PPRhmmsearchsubset_P_prots820plus9_blue.fa
## 22 seqs

## & PPRhmmsearchsubset_P_prots820plus9_red.fa
## 122 seqs

## & rice9.fa
## 9 seqs
## also FRprotseqs dir has FRknownseqs-shtname_9.fa

## to cat these 3 files (22, 122, 9 - 153), will be input for muscle pgm

10/27/17:
## ref 07/22/17: to cat ...
## dir for the files: .../FRprotseqs/phyml/pyML153
## copy the three files to cat to pyML153
PPRhmmsearchsubset_P_prots820plus9_blue.fa
PPRhmmsearchsubset_P_prots820plus9_red.fa
rice9.fa

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153
cat PPRhmmsearchsubset_P_prots820plus9_blue.fa PPRhmmsearchsubset_P_prots820plus9_red.fa > 22plus122.fa
bbedit, 22plus122.fa  ## 144 '>' lines as expect.
cat 22plus122.fa rice9.fa > 22plus122plus9.fa
bbedit, 22plus122plus9.fa  ## 153 '>' lines as expect.

## need new dir on crane to do next three steps, muscle, fasta2stockholm.pl, & hmmbuild.

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir refinPprots153
cd refinPprots153
## scp PPRhmmsearchsubset_P_prots820.fa to crane, dir = refinPprots820
logout
## now for slurm_muscle_wheatproj_refin153.sh
## edit, then scp
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153
scp 22plus122plus9.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots153

scp slurm_muscle_wheatproj_refin153.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots153
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_refin820.sh
ls -lh
sbatch slurm_muscle_wheatproj_refin153.sh 10392665  11:56pm => ??:??am, 
squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          10392665     batch TJob_mus   pterry  R       0:17      1 c3709
cd /work/baenziger/pterry/wheatproj/refinPprots153
ls -lh

less job.10392665.err
## many invalid '*' lines.
sacct -j  10392665 -o start,end
              Start                 End 
------------------- ------------------- 
2017-10-27T23:57:08 2017-10-27T23:57:42 
2017-10-27T23:57:08 2017-10-27T23:57:42 
## so 34 seconds run

less 22plus122plus9.fa.aln  ## looks to be *in* MSA fasta format.
head -n 50 22plus122plus9.fa.aln
# head -n 60 PPRhmmsearchsubset_P_prots820.fa.aln | tail -n 7

## next, fasta2stockholm.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh
cd ..
cd refinPprots153
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al
-rwxr-xr-x 1 pterry amundsen   1231 Oct 28 00:33 fasta2stockholm.pl

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots153
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl 22plus122plus9.fa.aln > 22plus122plus9.fa.aln.slx
ls -al
-rw-r--r-- 1 pterry amundsen 149389 Oct 28 00:39 22plus122plus9.fa.aln.slx

10/28/17:
## to check top stockholm file
less 22plus122plus9.fa.aln.slx


## now for *hmmbuild*
## see 07/10/17 above.

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots153
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/refinPprots153

hmmbuild 22plus122plus9.fa.aln.hmm 22plus122plus9.fa.aln.slx
# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     22plus122plus9.fa.aln   153   955   778     2.53  0.590 

## Q: This line some signif. differences from run on 07/10/17. What to think?

exit
less 22plus122plus9.fa.aln.hmm
head -n 17 22plus122plus9.fa.aln.hmm
wc -l 22plus122plus9.fa.aln.hmm
 2356 22plus122plus9.fa.aln.hmm
tail -n 3 22plus122plus9.fa.aln.hmm

## realign using hmm model, hmmalign ?????, Vikas notes, is this a trimming fcn, --trim ????????????????  yes
## slurm file prepared

scp slurm_hmmalign_wheatproj_refin153.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots153
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_refin153.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_refin153.sh 10403500  11:29am => ??:??am, 
squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          10403500     batch TJob_hmm   pterry  R       0:04      1 c3618

cd /work/baenziger/pterry/wheatproj/refinPprots153
ls -lh

-rw-r--r-- 1 pterry amundsen    0 Oct 28 11:30 job.10403500.err
-rw-r--r-- 1 pterry amundsen    0 Oct 28 11:30 job.10403500.out
-rw-r--r-- 1 pterry amundsen 298K Oct 28 11:30 22plus122plus9.fa.aln.hmmaln

sacct -j  10403500 -o start,end
              Start                 End 
------------------- ------------------- 
2017-10-28T11:30:04 2017-10-28T11:30:18 
2017-10-28T11:30:04 2017-10-28T11:30:18 
## 14 sec

less 22plus122plus9.fa.aln.hmmaln
head -n 3 22plus122plus9.fa.aln.hmmaln
tail -n 3 22plus122plus9.fa.aln.hmmaln
#grep -c "Trae" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln  ## 26240, so not telling anything ????????????????
wc -l 22plus122plus9.fa.aln.hmmaln
 1547 22plus122plus9.fa.aln.hmmaln

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al

cd ..
cd refinPprots153
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x 1 pterry amundsen   1398 Oct 28 16:22 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots153
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g 22plus122plus9.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > 22plus122plus9.fa.aln.hmmaln.fa

ls -al
less 22plus122plus9.fa.aln.hmmaln.fa

grep -c ">Traes" 22plus122plus9.fa.aln.hmmaln.fa  ## 144 as expect, as rice9 not counted
exit
logout

## scp to macbook, examine both 'hmmaln' (22plus122plus9.fa.aln.hmmaln) & hmmaln.fa (22plus122plus9.fa.aln.hmmaln.fa) in bbedit.

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots153/22plus122plus9.fa.aln.hmmaln .

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots153/22plus122plus9.fa.aln.hmmaln.fa .

ls -al

## unclear which format should manually look at to see if additional trimming needed, Stockholm or fasta ??????????????????????????????????
*******************************************************************************
## examine wi bbedit, or SEA VIEW ??????????????????????????
## ***need*** to learn more about format of stockholm MSA file ??????????????????????????? 
22plus122plus9.fa.aln.hmmaln.fa has 306 lines as expect (2*153).
## don't know that know ***how*** to determine if 'trimming is needed' ???????????????????
## even if SEA VIEW, how decide if trimming needed ?????????????????????????????
*********************************************************************************

## now fas to phy

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl refinPprots153
cd refinPprots153
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots153
module load bioperl

./align_convert_fas_to_phy.pl 22plus122plus9.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 178714 Oct 29 13:15 22plus122plus9.fa.aln.hmmaln.phy
exit

## scp back to macbook, 
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots153/22plus122plus9.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  178714 Oct 29 13:38 22plus122plus9.fa.aln.hmmaln.phy

less 22plus122plus9.fa.aln.hmmaln.phy
head -n 4 22plus122plus9.fa.aln.hmmaln.phy
 153 778
'TraesCS1B01G074600.1'  -SPPSRSWSP EGAFAAATAR LSTGTLSPEE AHHLFDELLR QATPVPSRSL NGFLATLSRD

## so phy header 153, 727, expect the 153

STOPPED

ii) then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153
/22plus122plus9.fa.aln.hmmaln.phy

The alignment file "22plus122plus9.fa.aln.hmmaln.phy" was uploaded, it contains 153 taxons of 778 characters.

Your job was submitted. (10/29/17, 1:58PM)
****************************************************************

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20171029-195838_Rr84/cmd.txt

10/31/17:
## **Viewed** result of online phyML at http://www.atgc-montpellier.fr/presto/index.php?tree=20171029-195838_Rr84/22plus122plus9_fa_aln_hmmaln_phy_phyml_tree.txt

## Some **comments**:

## **trimming**: 
hmmalign --trim ...
#=GR 
gblocks
might all he '*'s affect choices on trimming
BIOS 942, proj2, multidomain to one domain ????????????
BIOS 942, proj2, ... structure/fcn relationships ... ??????

## **discrepancy**, here in 153, rice9 all together, previous 820plus9, 5th rice seq. by self, 'blue' seqs selected.
## To do, redisplay 820plus9 in figtree, check if 5th rice seq. really 'out by self' ????
## 

## to view /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153/22plus122plus9_fa_aln_hmmaln_phy_phyml/22plus122plus9_fa_aln_hmmaln_phy_phyml_tree.txt in figtree


## github saved

11/01/17:
## talked to vikas, went over what need to do to publish
## 5 figures
fig1: 1545, sec 2.1.2, but get location of rice 9 on plot
fig2: 820plus9, locate the rice9 in image in file: ./hmmpipeline/FRprotseqs/phyml/pyML829/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt
fig3: ve nn diagram
fig4: 156 phylogeny, venn diagram with 4 colors
fig4b: ????
fig5: genome wide distn, phenogram ??
fig6: intron/exon => gff3 ???????????

## additional to dos:
--sec 2.1.2, for 1545 wheat seqs plus 9, check figtree plot of this, locate where rice 9 plot ?? .../FRprotseqs/PPRhmmsearchsubset_plus9_clustaltree_colored
 (DO ***THURS***, IF PROBLEM, CHECK WITH VIKAS) 
***ALL RICE9 IN*** RED SECTION, SEC 2.1.2 
Q: not finding plot **1545** with **both** blue & red colors, but appears to be same plot as FRprotseqs/PPRhmmsearchsubset_plus9_clustaltree_colored, so location rice9 would be same.
--also for image in sec 2.2 (tho think same 1545 as previous line), locate rice 9 ??
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors_scrnshot.png
Has 1545, two colors, TO FIND, WHERE FILE WHICH CAN LOAD INTO FIGTREE, GET THIS IMAGE ????
--on 'pro', pyML829/pph...820plus9...nexus_2colors.txt, => AB900794  ***single*** rice9 off by self, in 22 blue.

--TO DO:  http://pfam.xfam.org/search#tabview=tab1
Q: vikas said we did, I not remembering ???????????????????

--'Notes' steps on '156' seqs n, (add 3 non intersecting from orthoMCL)
***THURS***: TRY plot 153 in figtree, ***colorize*** 
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153/22plus122plus9_fa_aln_hmmaln_phy_phyml/22plus122plus9_fa_aln_hmmaln_phy_phyml_tree.txt in figtree on 'pro'.


Q: relative to 122, 10, 12, identify relative position to rice9.
PRACTICE WITH VIKAS ??????????????????????

--location plots (yet to put in Rmd, vikas likes 'phenogram' he did

11/03/17:
## talked to vikas, few notes:
--three wheat seqs to exclude from planned above 156 'Notes' steps (...99600, ...10800, ...196200). BUT DOC IN FIG LEGEND LATER). So call it, 156-3 'Notes' run.
--made some comments on how use figtree. 
root tree, midpoint
Node labels, aLRT, sig digits = 2
## note, vikas colored 153 tree tree, the rice9 seqs in figtree 'orange', saved file.

11/06/17:
After looking thru items on 11/01 & 11/03, prioritize **while in TX** 
--Rmd doc, fill out, etc.
--run 156_3 thru vikas 'Notes' steps
Others involving figtree, etc., do in do when back in Lincoln.

## To run 'Notes' steps on 156_3 set of sequences

## 1st, find the 3 seqs in oGroups144col1.txt which don't intersect with blue or red sets. Colorize consistent over images.

from ##08/31/17:


setwd("~/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/r_stuff")
whtOMCLgroupdf <- read.delim("oGroups144col1.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("whtOgrp"))
dim(whtOMCLgroupdf)
head(whtOMCLgroupdf, n=3)
class(whtOMCLgroupdf)
bluedf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("blue"))
dim(bluedf)
head(bluedf, n=3)

reddf <- read.delim("pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("red"))
dim(reddf)
head(reddf, n=3)

intermed <- setdiff(whtOMCLgroupdf$whtOgrp, reddf$red)
head(intermed, n=3)
length(intermed)  ## 22, as expect

out3 <- setdiff(intermed, bluedf$blue)
class(out3)
length(out3)  ## 12 as expect, 9(rice) + 3(ones in orthroMCL not in blue or red pyML of 820 possible 'P' proteins.  
head(out3, n=3)
out3
 [1] "TraesCS6A01G014500.1" "TraesCS6A01G014900.1" "TraesCS6B01G114300.1" "AB110443"            
## so the 3 wheat names are the orthoMCL seqs **not** in 'red' or 'blue' sets.
 ## note: longest of these only ~ 400 aa's.

## 1st, prepare the 156_3 seqs

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML156_3

## prepare 135xtra3.fa from PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln.fa in dir /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs using bbedit

cp -rw-r--r--   1 bterry  staff   84500 Oct 27 14:38 22plus122.fa
from /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153

## cat to get the 156 seqs

cat 22plus122plus9.fa 135xtra3.fa > 22plus122plus9plus3.fa
bbedit 22plus122plus9plus3.fa

## finally, remove the 3 outlier seqs seen in figtree display of the 153 seqs
-rw-r--r--@  1 bterry  staff  8244 Oct 29 21:02 22plus122plus9_fa_aln_hmmaln_phy_phyml_tree.txt
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML153/22plus122plus9_fa_aln_hmmaln_phy_phyml/22plus122plus9_fa_aln_hmmaln_phy_phyml_tree.txt

## They are:
TraesCS1D01G199600.1   ## length > 600
TraesCS1B01G210800.1  ## length > 600
TraesCS1A01G196200.1  ## length > 600 aa's
## note, ***all*** from 'blue' set of 22 (TO check, in 12 blue seqs *not* in orthoMCL)

## so, 
cp 22plus122plus9plus3.fa > 156_3.fa
## use bbedit to delete these 3
## confirmed new length = 153

## ref: 10/26/17 (line 2981)

## need new dir on crane to do next three steps, muscle, fasta2stockholm.pl, & hmmbuild.

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML156_3

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir refinPprots156_3
cd refinPprots156_3
## scp PPRhmmsearchsubset_P_prots820.fa to crane, dir = refinPprots156_3
logout
## now for slurm_muscle_wheatproj_refin153.sh
## edit, then scp
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML156_3
scp 156_3.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots156_3
## cp slurm_muscle_wheatproj_refin153.sh to slurm_muscle_wheatproj_refin156_3.sh, edit

scp slurm_muscle_wheatproj_refin156_3.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots156_3
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_refin820.sh
ls -lh
sbatch slurm_muscle_wheatproj_refin156_3.sh 10467000  7:51pm => ??:??am, 
squeue -u pterry  ## a R
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
             
cd /work/baenziger/pterry/wheatproj/refinPprots156_3
ls -lh

less job.10467000.err
## many invalid '*' lines.
sacct -j  10467000 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-06T19:51:38 2017-11-06T19:52:11 
2017-11-06T19:51:38 2017-11-06T19:52:11 
19:52:11 - 19:51:38 = 33 sec

less 156_3.fa.aln  ## looks to be *in* MSA fasta format.
head -n 50 156_3.fa.aln
# head -n 60 PPRhmmsearchsubset_P_prots820.fa.aln | tail -n 7

## next, fasta2stockholm.pl conversion (line 3826)

11/07/17:
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -lh
cd ..
cd refinPprots156_3
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al
-rwxr-xr-x 1 pterry amundsen   1231 Oct 28 00:33 fasta2stockholm.pl

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots156_3
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl 156_3.fa.aln > 156_3.fa.aln.slx
ls -al
-rw-r--r-- 1 pterry amundsen 150001 Nov  7 08:05 156_3.fa.aln.slx

## to check top stockholm file
less 156_3.fa.aln.slx

## now for *hmmbuild*
## see 10/28/17 above.

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots156_3
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/refinPprots156_3

hmmbuild 156_3.fa.aln.hmm 156_3.fa.aln.slx
# input alignment file:             156_3.fa.aln.slx
# output HMM file:                  156_3.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     156_3.fa.aln           153   959   788     2.34  0.590 

# CPU time: 2.52u 0.01s 00:00:02.52 Elapsed: 00:00:02.54
exit
less 156_3.fa.aln.hmm
#head -n 17 156_3.fa.aln.hmm
wc -l 156_3.fa.aln.hmm
 2386 156_3.fa.aln.hmm
tail -n 3 156_3.fa.aln.hmm

## realign using hmm model, hmmalign 

## slurm file prepared

scp slurm_hmmalign_wheatproj_refin156_3.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots156_3
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_refin156_3.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_refin156_3.sh 10469154  8:44am => ??:??am, 
squeue -u pterry  ## a ST
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/refinPprots156_3
ls -lh

-rw-r--r-- 1 pterry amundsen    0 Nov  7 08:44 job.10469154.err
-rw-r--r-- 1 pterry amundsen    0 Nov  7 08:44 job.10469154.out
-rw-r--r-- 1 pterry amundsen 299K Nov  7 08:44 156_3.fa.aln.hmmaln

sacct -j  10469154 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-07T08:44:27 2017-11-07T08:44:42 
2017-11-07T08:44:27 2017-11-07T08:44:42 
08:44:42 - 08:44:27 = 15 sec

less 156_3.fa.aln.hmmaln
#head -n 3 22plus122plus9.fa.aln.hmmaln
tail -n 3 156_3.fa.aln.hmmaln
#grep -c "Trae" PPRhmmsearchsubset_P_prots820.fa.aln.hmmaln  ## 26240, so not telling anything ????????????????
wc -l 156_3.fa.aln.hmmaln
1547 156_3.fa.aln.hmmaln  ## same as 153

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al

cd ..
cd refinPprots156_3
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x 1 pterry amundsen   1398 Oct 28 16:22 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots156_3
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g 156_3.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > 156_3.fa.aln.hmmaln.fa

ls -al
less 156_3.fa.aln.hmmaln.fa

grep -c ">Traes" 156_3.fa.aln.hmmaln.fa  ## 144 as expect, as rice9 not counted
exit
logout

## now fas to phy

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl refinPprots156_3
cd refinPprots156_3
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots156_3
module load bioperl

./align_convert_fas_to_phy.pl 156_3.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 184070 Nov  7 10:00 156_3.fa.aln.hmmaln.phy
exit

## scp back to macbook, 
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML156_3
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots156_3/156_3.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  184070 Nov  7 10:03 156_3.fa.aln.hmmaln.phy

less 156_3.fa.aln.hmmaln.phy
head -n 4 156_3.fa.aln.hmmaln.phy

 153 788
'TraesCS1D01G057800.1'  --STSTPTLR PSRSWSPHAA FAAATERVRA GTLSPEDAHH LFDELLRQAT PVPSRSLDGF 

## so phy header 153, 788, expect the 153

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML156_3
/156_3.fa.aln.hmmaln.phy

Data type: aa's

Submitted 10:14am, name: 156_3

The alignment file "156_3.fa.aln.hmmaln.phy" was uploaded, it contains 153 taxons of 788 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20171107-171418_Md38/cmd.txt

github saved

## ok, for 156_3, try color by prev red122, blue10, blue12 ???????? Perhaps by colocation on a chromosome

11/08/17:

## working with figtree on 'pro'
'checks', LHS include 'Tip labels' (sig digits =2), 'Node labels', (display aLRT, sig. digits =2, ), 'Scale bar', (????)
## working on 156_3.fa.aln.hmmaln.phy_phyml_tree.txt, 
## Q: labeling like did with mega ?????????????/
## Q: node, clade, taxa settings ?????????????????
## Q:  'Trees', root tree, midpoint  ?????????????????????
## Q: 'Find'  ?????????????????
## Q: color, **when** click on a branch, which mode to select, perhaps taxa, highlignts leaf labels ????????
## rice9, orange-tan, green, closest 20 seqs, ...
## annotate paper clip ???????????????

## Q: So with 9 rice9 orange, 20 closest in green, **to compare** the green labels with the blue, red subsets from 820plus9. Perhaps do as previously, grab/grep the colored subsets from the ...tree.txt file, try intersect with the blue, red.
## get vikas comments on 156_3 tree ??????????????
## Q: how select blue, red names on 156_3.fa.aln.hmmaln.phy...tree.txt, so can color ?????????? Perhaps have to color manually, one at a time ???????????

11/09/17:
## ok, to try label 'tree' file for remaining 19 'blue' seqs, 3 removed from '153' tree prepared previously (still like to check which in 10 in orthoMCL and 12 not) ????
## **to try,** take uncolored 'tree' file, copy it. Then set up all the settings did previously for colored tree. Then see if can select one blue seq in 156_3 tree file, color it blue, see if can save, have one seq with figtree assigned color designation. If works, then manually copy this color to remaining 18 'blue' seqs. Finally, display in figtree, visually display the 'blue' seqs in 156_3 figtree display.
## ok, on 'pro', have display of the remaining 19 'blue' seqs. Since the 3 'U' seqs in this group, perhaps try find those in the display ???????????? Note: 3 'U' seqs are in the 10 seqs recognised by both pyML & orthoMCL. 

11/10/17:
## ok, on 'pro', modified tree file from with figtree, (file name 156_3_fa_aln_hmmaln_phy_phyml_tree_copy_bluecolored.txt). Colored remainder of the '12' blue purple, blue '10' blue, & rice9 tan-orange. Can see that the 12-3 = 9 are ***outliers*** here, the two closest branches to grouped rice9 are mixture of blue 10 & pyML red seqs. Note: blue 12 names in file twelve_nocolnam.txt in dir: /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/r_stuff
## NOTE: WHICH CHROMOSOME WHEAT SEQS ARE ON, ARE ***GROUPED*** ON CIRCULAR TREE !!!!!!!!!!!!!!

11/13/17:
Talkd to vikas:
i) new 'Notes'run. 122 + 10 + 3(nonintersecting in orthoMCL) + 9(rice9) = 144. So removing all from the 12 purple (phyML blue not intersecting with orthoMCL)
ii) if no outlier seqs in image in (i), convey list of 144 seqs to vikas (Q: format ?????????????????)
ii) new notes run, 820 + 9, this time all input run thru all 'Notes' steps
iii) optional: phyML for 1545 + rice9, so thru 'Notes' rather than clustal/omega.
iv) for 156_3, color the 3 seqs from orthoMCL not intersecting with phyML blue or red.


so
i) above
see line 3283

## To run 'Notes' steps on 122plus10plus3plusrice9 (orthoMCL135plusrice9), total 144 set of sequences.

 [1] "TraesCS6A01G014500.1" "TraesCS6A01G014900.1" "TraesCS6B01G114300.1" "AB110443"            
## so the 3 wheat names are the orthoMCL seqs **not** in 'red' or 'blue' sets.
 ## note: longest of these only ~ 400 aa's.

## create new dir, .../phyml/pyMLorthoMCL135price9 from 
cp iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa from .../wheatproj
cp 135xtra3.fa from pyML156_3
cp oGroups144col1_nocolnam_norice9.txt from o_mclonline/r_stuff
cp getseq.awk from .../wheatproj dir
cp 

STOPPED

11/14/17:
## Now, to try 

./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa oGroups144col1_nocolnam_norice9.txt > orthoMCL135.fa
grep -c "^>Tr" orthoMCL135.fa   # 135 as expect

## check that 3 not intersecting orthoMCL seqs are present ??
## use bbedit,  [1] "TraesCS6A01G014500.1" "TraesCS6A01G014900.1" "TraesCS6B01G114300.1" "AB110443"            
## all present

## try python to check if red 122 & blue 10 are also in orthoMCL135.fa
## cp pythonsubset_2.py to .../phyml/pyMLorthoMCL135price9
## move pythonsubset_2.py pythonsubset_3.py

## 1st patfile:
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt
## ten hits in orthoMCL135.fa as expect, the 10 blue intersecting with orthoMCL 135 rows.
## 2nd patfile
pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt
## 122 hits in orthoMCL135.fa as expect, the 122 red intersecting with orthoMCL 135 rows.


## need a cat for the rice9
cat rice9.fa wheat820P.fa > rice9wheat820P.fa
ls -al

cat rice9.fa orthoMCL135.fa > rice9orthoMCL135.fa
ls -al
## ok, 144 rows expect, orthoMCL 135 plus rice9

11/15/17:
## ref lin3 3347

Then Notes steps ...
## need new dir on crane to do next three steps, muscle, fasta2stockholm.pl, & hmmbuild.

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL135price9

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir refinPprots135price9
cd refinPprots135price9
## scp rice9orthoMCL135.fa to crane, dir = refinPprots135price9
logout
## now for slurm_muscle_wheatproj_refin153.sh
## edit, then scp
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL135price9
scp rice9orthoMCL135.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots135price9
## cp slurm_muscle_wheatproj_refin153.sh to slurm_muscle_wheatproj_refin156_3.sh, edit

scp slurm_muscle_wheatproj_refin135rice9.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots135price9
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_refin135rice9.sh
ls -lh
sbatch slurm_muscle_wheatproj_refin135rice9.sh 10530356  10:10am => ??:??am, 
squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          10530356     batch TJob_mus   pterry PD       0:00      1 (Priority)
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/refinPprots135price9
ls -lh

less job.10530356.err
## many invalid '*' lines.
sacct -j  10530356 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-15T10:20:29 2017-11-15T10:20:59 
2017-11-15T10:20:29 2017-11-15T10:20:59 
10:20:59 - 10:20:29 = 30 sec

less rice9orthoMCL135.fa.aln  ## looks to be *in* MSA fasta format.

## next, fasta2stockholm.pl conversion (line 3395)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots135price9
ls -lh
cd ..
cd refinPprots135price9
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots135price9
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl rice9orthoMCL135.fa.aln > rice9orthoMCL135.fa.aln.slx
ls -al
-rw-r--r-- 1 pterry amundsen 139156 Nov 15 11:50 rice9orthoMCL135.fa.aln.slx

## to check top stockholm file
less rice9orthoMCL135.fa.aln.slx

## now for *hmmbuild*
## see 11/07/17 above.

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots135price9
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/refinPprots135price9

hmmbuild rice9orthoMCL135.fa.aln.hmm rice9orthoMCL135.fa.aln.slx
# input alignment file:             rice9orthoMCL135.fa.aln.slx
# output HMM file:                  rice9orthoMCL135.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     rice9orthoMCL135.fa.aln   144   945   803     1.61  0.589 

# CPU time: 3.03u 0.00s 00:00:03.03 Elapsed: 00:00:03.36
exit
less rice9orthoMCL135.fa.aln.hmm

#head -n 17 rice9orthoMCL135.fa.aln.hmm
wc -l rice9orthoMCL135.fa.aln.hmm
 2431 rice9orthoMCL135.fa.aln.hmm
tail -n 3 rice9orthoMCL135.fa.aln.hmm

## realign using hmm model, hmmalign 

## slurm file prepared

scp slurm_hmmalign_wheatproj_refinrice9orthoMCL135.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots135price9
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_refinrice9orthoMCL135.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_refinrice9orthoMCL135.sh 10538157  10:24pm => ??:??am, 
squeue -u pterry  ## a ST
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          10538157     batch TJob_hmm   pterry  R       0:09      1 c2124

cd /work/baenziger/pterry/wheatproj/refinPprots135price9
ls -lh
-rw-r--r-- 1 pterry amundsen 281K Nov 15 22:24 rice9orthoMCL135.fa.aln.hmmaln

sacct -j  10469154 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-07T08:44:27 2017-11-07T08:44:42 
2017-11-07T08:44:27 2017-11-07T08:44:42 
08:44:42 - 08:44:27 = 15 sec

less rice9orthoMCL135.fa.aln.hmmaln

## next, fasta2stockholm.pl conversion (line 3707)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al

cd ..
cd refinPprots135price9
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x 1 pterry amundsen   1398 Oct 28 16:22 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots135price9
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g rice9orthoMCL135.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > rice9orthoMCL135.fa.aln.hmmaln.fa

ls -al
less rice9orthoMCL135.fa.aln.hmmaln.fa

grep -c ">Traes" rice9orthoMCL135.fa.aln.hmmaln.fa  ## 135 as expect, as rice9 not counted
exit
logout

## now fas to phy

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl refinPprots135price9
cd refinPprots135price9
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots135price9
module load bioperl

./align_convert_fas_to_phy.pl rice9orthoMCL135.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 175691 Nov 15 23:14 rice9orthoMCL135.fa.aln.hmmaln.phy
exit

## scp back to macbook, 
t
The alignment file "rice9orthoMCL135.fa.aln.hmmaln.phy" was uploaded, it contains 144 taxons of 803 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20171116-063126_Mh91/cmd.txt

11/16/17:
## see 3573
## have the 'tree' file in dir.
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL135price9/rice9orthomcl135_fa_aln_hmmaln_phy_phyml

-rw-r--r--@  1 bterry  staff  7749 Nov 16 07:43 rice9orthomcl135_fa_aln_hmmaln_phy_phyml_tree.txt
cp to 'pro' laptop

in figtree
tree/midpoint
'Node labels', (display aLRT, sig. digits =2, )
## on taxa 
## basically no more 'long' branches
## now highlighting chr 1, 2, 6 in turn
## set aLRT on %

## talked to vikas, priorities: 
i) prepare another figtree display with 131 sequences from othroMCL 135. The four to be removed from previous display (rice9orthomcl135_fa_aln_hmmaln_phy_phyml_tree.txt)
because they are on long branches in the figtree display. The four are:
--TraesCS1B01G073200.1
--TraesCS1D01G076400.1
--TraesCS1A01G073600.1
--TraesCS1D01G075800.1
## these 'partial' outliers in 156_3 file figtree file display.
## To check: if blue or red source for these four  ??????????????????
ii) finalize figures prevly discussed
iii) doc more in Rmd file
iv) get the four reference papers listed, refer fig 3, then get 1 or 2 more RF proteins that were prevly verified.
  
11/17/17:
## so proceeding with (i), 1st remove the 4 seqs from rice9orthoMCL135.fa file with bbedit. Name the resulting file rice9orthoMCL131.fa. Place in dir. /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131price9

## Now run Notes steps ... (refer 11/15/17, line 3658 above)

Then Notes steps ...
## need new dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir refinPprots131price9
cd refinPprots131price9
## scp rice9orthoMCL131.fa to crane, dir = refinPprots131price9
logout
## now for slurm_muscle_wheatproj_refin153.sh
## edit, then scp
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131price9
scp rice9orthoMCL131.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131price9
## cp slurm_muscle_wheatproj_refin135rice9.sh to slurm_muscle_wheatproj_refin131rice9.sh, edit

scp slurm_muscle_wheatproj_refin131rice9.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_refin131rice9.sh
ls -lh
sbatch slurm_muscle_wheatproj_refin131rice9.sh 10551043 9:48am =>
[pterry@login.crane scripts]$ 
[pterry@login.crane scripts
squeue -u pterry  ## a PD
[pterry@login.crane scripts]$ squeue -u pterry
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
ls -lh
less job.10551043.err
sacct -j  10551043 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-18T09:47:29 2017-11-18T09:47:56 
2017-11-18T09:47:29 2017-11-18T09:47:56
09:47:56 - 9:47:29 = 27 sec

less rice9orthoMCL131.fa.aln  ## looks to be *in* MSA fasta format.

## next, fasta2stockholm.pl conversion (line 3707)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
ls -lh
cd ..
cd refinPprots131price9
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl rice9orthoMCL131.fa.aln > rice9orthoMCL131.fa.aln.slx
ls -al
-rw-r--r--  1 pterry amundsen 135288 Nov 18 13:15 rice9orthoMCL131.fa.aln.slx

## to check top stockholm file
less rice9orthoMCL131.fa.aln.slx

## now for *hmmbuild*
## see 11/15/17 above (line 3731)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/refinPprots131price9

hmmbuild rice9orthoMCL131.fa.aln.hmm rice9orthoMCL131.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             rice9orthoMCL131.fa.aln.slx
# output HMM file:                  rice9orthoMCL131.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     rice9orthoMCL131.fa.aln   140   945   803     1.57  0.589 

# CPU time: 3.02u 0.00s 00:00:03.02 Elapsed: 00:00:03.07
exit
less rice9orthoMCL131.fa.aln.hmm

#head -n 17 rice9orthoMCL135.fa.aln.hmm

## realign using hmm model, hmmalign 

## slurm file prepared

scp slurm_hmmalign_wheatproj_refinrice9orthoMCL131.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_refinrice9orthoMCL131.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_refinrice9orthoMCL131.sh 10553043  9:00pm => ??:??am, 
squeue -u pterry  ## a R
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          10553043     batch TJob_hmm   pterry  R       0:01      1 c3616

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
             
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
ls -lh
-rw-r--r-- 1 pterry amundsen 271K Nov 18 21:01 rice9orthoMCL131.fa.aln.hmmaln

sacct -j  10553043 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-18T21:01:33 2017-11-18T21:01:44 
2017-11-18T21:01:33 2017-11-18T21:01:44 
21:01:44 - 21:01:33 = 11 sec

less rice9orthoMCL131.fa.aln.hmmaln

## next, stockholm2fasta.pl conversion (line 3791)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al

cd ..
cd refinPprots131price9
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x 1 pterry amundsen   1398 Oct 28 16:22 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g rice9orthoMCL131.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > rice9orthoMCL131.fa.aln.hmmaln.fa

ls -al
less rice9orthoMCL131.fa.aln.hmmaln.fa

grep -c ">Traes" rice9orthoMCL131.fa.aln.hmmaln.fa  ## 131 as expect, as rice9 not counted
exit
logout

## now fas to phy (line 3819)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl refinPprots131price9
cd refinPprots131price9
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots131price9
module load bioperl

./align_convert_fas_to_phy.pl rice9orthoMCL131.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r--  1 pterry amundsen 170811 Nov 18 21:35 rice9orthoMCL131.fa.aln.hmmaln.phy
exit
logout

## scp back to macbook, (line 3841)

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131price9

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131price9/rice9orthoMCL131.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  170811 Nov 18 21:45 rice9orthoMCL131.fa.aln.hmmaln.phy

less rice9orthoMCL131.fa.aln.hmmaln.phy

head -n 4 rice9orthoMCL131.fa.aln.hmmaln.phy
 144 803
'TraesCS6D01G089500.1'  ------GSSS GTVSSHANQL LNKLKDHVGS GTLQPERAHQ LFDKLLRQAV PISACALNGL 

## so phy header  140 803, expect the 140

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131price9/rice9orthoMCL131.fa.aln.hmmaln.phy

Data type: aa's

The alignment file "rice9orthoMCL131.fa.aln.hmmaln.phy" was uploaded, it contains 140 taxons of 803 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20171119-045204_Ul26/cmd.txt

Submitted 9:52pm, name: rice9orthoMCL131

## path to rice9orthoMCL131 tree file
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131price9/rice9orthomcl131_fa_aln_hmmaln_phy_phyml

## tree file:
rice9orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt

-rw-r--r--@ 1 bterry  staff  7529 Nov 19  2017 rice9orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt

cp to 'pro' laptop

in figtree
tree/midpoint
'Node labels', (display aLRT, sig. digits =2, )
## on taxa 
## basically no more 'long' branches
## now highlighting chr 1, 2, 6 in turn

## set aLRT on %

11/20/17:
## talked to vikas, items:
i) subset 131 for gff3
ii) 'Notes' for 131, no rice9
iii) 131 + RF's from other species
iv) 5 figures, finalize, SVG from figtree
## 820+9, color 9 so stand out more
## venny, think see prev talk items, indicating what subsets to use
v) 4 refs top .Rmd file
vi) where store .Rmd file. Q: github thru rstudio, crane, ?????

*******************ASIDE*******************************************************
## **Aside** task before work on (i)
## for the 131, trying to subset the rows in .../wheatgff3/iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 
## apparently what needed after the subsetting are the rows in the order they are in this wheat gff3 file.
## suggested approach after talk to vikas:
sort oGroups144col1_to_131_nodotnum.txt => oGroups144col1_to_131_nodotnum_sort.txt
subset iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 using oGroups144col1_to_131_nodotnum_sort.txt
## expect will be sorted by chromosome name, BUT, **within** rows of a chromosome name, if in different order in oGroups144col1_to_131_nodotnum_sort.txt than in iwgsc_refseqv1.0_HighConf_2017Mar13.gff3, then would not achieve desired iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 order after the subsetting. If this turns out, could do additional sort sort on 'start' field to fix this ??????? Order of rows in 'type' field still may not be correct ????????

sort oGroups144col1_to_131_nodotnum.txt > oGroups144col1_to_131_nodotnum_sort.txt

## bash Philip_realgff3.sh oGroups144col1_to_131_nodotnum_sort.txt > 131.gff3
bash Philip_realgff3.sh oGroups144col1_to_131_nodotnum_sort.txt > 131_sort.gff3
11:25pm => 11:32pm
ls -al

11/23/17: 

## check 131_sort.gff3 in bbedit  ## chrom colm sorted as expect. Perhaps compare few more entries, see if seq of rows same in 131_sort.gff3 & iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 checked 

TraesCS1A01G031600  ## has 4 rows
TraesCS1A01G054700  ## has 9 rows

## each set of rows matches in the two files, so wheat gene/protein name has info to indicate its place in gff3 file, ***don't*** need start field.

STOPPED

## perhaps check another pair in **another** chrom, perhaps the 'U' rows ?????

11/24/17:

TraesCSU01G090200  ## 12 rows

## 12 rows, sequence of rows match in 131_sort.gff3 & iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
## LOOKS LIKE THE 131_sort.gff3 FILE HAS THE **SAME** ORDER OF ROWS AS THE iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 FILE FOR THE SUBSET 131 ROWS FROM THE orthoMCL OUTPUT MAPPING TO 691 ROWS IN 131_sort.gff3.
**************END ASIDE****************************************


## so for (i) above
## try modify shell script, Philip_realgff3.sh, see line 2302, (also compare python script), also do 'uniq' to check don't have duplicate rows. 
## Work from .../wheatgff3 dir.
## for 'pattern' file, copy in from .../r_stuff/oGroups144col1_nocolnam_norice9.txt
cd .../wheatgff3 dir
cp .../r_stuff/oGroups144col1_nocolnam_norice9.txt .
## need remove '.digit' from RHS of string
## following from line 2273
## cat sort147.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 147 > sort147_nodotnum.txt
cat oGroups144col1_nocolnam_norice9.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 135 > oGroups144col1_to_135_nodotnum.txt


## Now manually reduce from 135 to 131 (using 11/16/17 above) => done
oGroups144col1_to_131_nodotnum.txt

## Target the wheat gff3 file already in .../wheatgff3 dir
## bash Philip_realgff3.sh sort147_nodotnum.txt > realbashtofile.gff3
bash Philip_realgff3.sh oGroups144col1_to_131_nodotnum.txt > 131.gff3
12:41pm => < 1:00pm
## Q: why 'zero bytes' in finder window ??????
## 691 rows, 131 with 'gene' in row. 24 rows of 'chrUn' for the 3 gene names in the 131.
## then 'uniq' check for duplicate rows & python ???????????
## sort gff3_genes_col9names.txt |uniq | wc -l   ## 691 as expect
sort 131.gff3 |uniq | wc -l   ## 110790 as expect
     691  ## thus, all rows unique.
     
## now, for (ii), 'Notes' for 131, **no** rice9, so new directory, pyMLorthoMCL131norice9.
So, refer line 3880 above. New dir: /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9 dir.
## cp rice9orthoMCL131.fa from /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131price9
to dir:/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9
## now, in bbedit, remove the rice9 rows, rename orthoMCL131.fa, done.

## Now run Notes steps ... (refer 11/17/17, line 3882 above)

## need new dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

11/22/17:
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir refinPprots131norice9
cd refinPprots131norice9
## scp orthoMCL131.fa to crane, dir = refinPprots131norice9
logout
## now for slurm_muscle_wheatproj_refin153.sh
## edit, then scp

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9
scp orthoMCL131.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131norice9
## cp slurm_muscle_wheatproj_refin131rice9.sh to slurm_muscle_wheatproj_refin131norice9.sh, edit

scp slurm_muscle_wheatproj_refin131norice9.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_refin131norice9.sh
ls -lh
sbatch slurm_muscle_wheatproj_refin131norice9.sh 10587339 12:4pm =>

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          10587339     batch TJob_mus   pterry PD       0:00      1 (Resources)
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
ls -lh
less job.10587339.err
sacct -j  10587339 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-22T12:44:32 2017-11-22T12:44:57 
2017-11-22T12:44:32 2017-11-22T12:44:57 
12:44:57 - 12:44:32 = 25 sec

less orthoMCL131.fa.aln  ## looks to be *in* MSA fasta format.

## next, fasta2stockholm.pl conversion (line 3929)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
ls -lh
cd ..
cd refinPprots131norice9
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl orthoMCL131.fa.aln > orthoMCL131.fa.aln.slx
ls -al
-rw-r--r--  1 pterry amundsen 126693 Nov 25 10:37 orthoMCL131.fa.aln.slx

## to check top stockholm file
less orthoMCL131.fa.aln.slx

## now for *hmmbuild*
## see 11/17/17 above (line 3954)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9

hmmbuild orthoMCL131.fa.aln.hmm orthoMCL131.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             orthoMCL131.fa.aln.slx
# output HMM file:                  orthoMCL131.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     orthoMCL131.fa.aln     131   945   802     1.56  0.590 

exit
less orthoMCL131.fa.aln.hmm

#head -n 17 orthoMCL135.fa.aln.hmm

STOPPED

## realign using hmm model, hmmalign  (line 3984)

## slurm file prepared
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9
scp slurm_hmmalign_wheatproj_refinorthoMCL131.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_refinorthoMCL131.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_refinorthoMCL131.sh 10606917  8:45pm => ??:??am, 
squeue -u pterry  ## a R
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
             
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
ls -lh
-rw-r--r-- 1 pterry amundsen 254K Nov 25 20:45 orthoMCL131.fa.aln.hmmaln

sacct -j  10606917 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-25T20:45:17 2017-11-25T20:45:26 
2017-11-25T20:45:17 2017-11-25T20:45:26 
20:45:26  - 20:45:17 = 9 sec

less orthoMCL131.fa.aln.hmmaln

## next, stockholm2fasta.pl conversion (line 4017)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al

cd ..
cd refinPprots131norice9
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x 1 pterry amundsen   1398 Oct 28 16:22 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g orthoMCL131.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > orthoMCL131.fa.aln.hmmaln.fa

ls -al
less orthoMCL131.fa.aln.hmmaln.fa

grep -c ">Traes" orthoMCL131.fa.aln.hmmaln.fa  ## 131 as expect
exit
logout


## now fas to phy (line 4045)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl refinPprots131norice9
cd refinPprots131norice9
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots131norice9
module load bioperl

./align_convert_fas_to_phy.pl orthoMCL131.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r--  1 pterry amundsen 159709 Nov 25 23:18 orthoMCL131.fa.aln.hmmaln.phy
exit
less orthoMCL131.fa.aln.hmmaln.phy
logout

## scp back to macbook, (line 4068)

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131norice9/orthoMCL131.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  159709 Nov 25 23:26 orthoMCL131.fa.aln.hmmaln.phy

less orthoMCL131.fa.aln.hmmaln.phy

head -n 4 orthoMCL131.fa.aln.hmmaln.phy
 131 802
'TraesCS1A01G067800.1'  ---------- ---------- ---------- ---------- ---------- ----------

## so phy header  131 802, expect the 131

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9/orthoMCL131.fa.aln.hmmaln.phy

Data type: aa's

The alignment file "orthoMCL131.fa.aln.hmmaln.phy" was uploaded, it contains 131 taxons of 803 characters.

Your job was submitted (131norice9, 11:34pm)
JobID : 1220598
Analysis name : 131norice9
Execution time: 1 hour(s), 12 minute(s)

11/26/17:
## path to orthoMCL131 tree file (line 4101)

/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9/orthomcl131_fa_aln_hmmaln_phy_phyml
orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt

## tree file:
orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt
-rw-r--r--@  1 bterry  staff  7142 Nov 26 07:46 orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt

cp to 'pro' laptop orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt

in figtree
tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
## basically no more 'long' branches
## now highlighting chr 1, 2, 6 in turn

## set aLRT on %

## overall, circular view of orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt
 similar to rice9orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt. The group farthest away from rest of groups, with rice9 closest to it, is sort of the farthest away group in both trees (131plusrice9, & 131norice9)
 ## sort of 2 phylogenetic groups inhorizontal display
 --one, (with CS6B01G114300), nearest to group near rice9
 --two, rest of sequences
 
 ## TO DO, check, how 'blue 10' intersecting with orthoMCL are distributed in these two groups. => seem split between two 'chr6' groups. Chr's 1, 2, 6 grouped similarly as previous ML phylograms.
 
11/28/17:
******************************start venny*************************************
## refer line 4127, venny for orthoMCL135, red 122, blue 22 (total 4 colors, 3 files to venny)
## for orthoMCL135, use file: .../wheatgff3/oGroups144col1_to_135_nodotnum.txt
## for red 122, use file: .../r_stuff/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt
## 1st, need remove '.d' from rhs
cd .../r_stuff/
cat pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 122 > red122_nodotnum.txt
## for blue 22, use file:
.../r_stuff/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt 
## 1st, remove '.digit' from rhs sort147.txt, refer line 2266 - 2273.
## cat sort147.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 147 > sort147_nodotnum.txt
cat pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_blue_wheatnames.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 22 > blue22_nodotnum.txt

## now, submit these 3 files to venny
http://bioinfogp.cnb.csic.es/tools/venny/index.html
## output: .../r_stuff/orthoMCL135red122blue22venn.png
## Q: how get '4' colors ????????????????????
## can one select the colors ???????????????

## vikas suggestion, cat blue22, red122, do venny with just **2** input files.
cat red122_nodotnum.txt blue22_nodotnum.txt > red122andblue22.txt  ## 144 rows
venny output: .../r_stuff/venny2inp_orthoMCL135andphylogeny.png
## redone, 12/26/17, to change names above circles to orthoMCL & Phylogeny. 
## Q: why not calc % in new venn diagram ????????????????????????

## note: another web site, https://www.stefanjol.nl/venny, say can do **proportional** circles ??????????????????
## tried, all overlaps not correct ??????????????
********************************end venny***************************************

11/29/17:
talked to vikas
## following file to be appended to the '131', run thru 'Notes' steps. Try finish by tomorrow, thursday.
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9/FunctionallyCharacterizedRfs_fasta.txt
## try venny with 2 files, the '135' orthoMCL, & a combined 'blue' plus 'red' file (122+22)
## cp rmd_wkflowdoc dir to 'share' dir on crane. Look into private repo on gethub ??????

*************************Mower*********************************************
talked to J. Mower
## Fuggii paper mentioned
## he familiar with CMS system, does in research
## monitoring transcription: find lines don't restore, look for absent gene transcripts ???? Issue with low transcription level for CMS genes
## says identification of RF's hard, try 'mapping' (me: exactly how ????????????)
## uses figtree, says muscle, phyML ok
*************************Mower****************************************

## ok, next do 'Notes' steps after concatenate '.fa' files '131' & FunctionallyCharacterizedRfs_fasta.txt from vikas.
## 1st need remove blank lines from this file. Done.
## create new dir, 
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131vikas6
##  line 4199, copy following file
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9/orthoMCL131.fa (ref: line 4199)

*************ERROR********************
MISTAKENLY DELETED DIR .../phyml/pyMLorthoMCL131norice9
TO TRY: manually restore (how do time capsule ????) 
--two slurm files, 
--initial .fa file, 
--and the phyml '.zip' file
Q: TERMINAL STILL FINDS THE DIR ?????????????????????????????????
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9
LATER, NEXT DAY => NO SUCH DIR. 
***********END ERROR********************************

11/30/17:
## now, for (ii), 'Notes' for 131, **plus** vikas6, 

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131vikas6

cat orthoMCL131.fa FunctionallyCharacterizedRfs_fasta.txt > orthoMCL131vikas6.fa
check in bbedit, number seqs = 131+6=137  ## have 137

## Now run Notes steps ... (refer 11/22/17, line 4201 above)

## need new dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir refinPprots131vikas6
cd refinPprots131vikas6
## scp orthoMCL131vikas6.fa to crane, dir = refinPprots131vikas6
logout
## now for slurm_muscle_wheatproj_refin131vikas6.sh
## edit, then scp

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131vikas6
scp orthoMCL131vikas6.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131vikas6
## cp slurm_muscle_wheatproj_refin131rice9.sh to slurm_muscle_wheatproj_refin131vikas6.sh, edit

scp slurm_muscle_wheatproj_refin131vikas6.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 4223)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_refin131vikas6.sh
ls -lh
sbatch slurm_muscle_wheatproj_refin131vikas6.sh 10660308 10:15pm =>

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
ls -lh
less job.10660308.err
sacct -j  10660308 -o start,end
              Start                 End 
------------------- ------------------- 
2017-11-30T22:15:28 2017-11-30T22:15:58 
2017-11-30T22:15:28 2017-11-30T22:15:58 
22:15:58 - 22:15:28 = 30 sec

less orthoMCL131vikas6.fa.aln  ## looks to be *in* MSA fasta format.
## Q: why the vikas6 seqs at top file ???????????????

## next, fasta2stockholm.pl conversion (line 4248)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
ls -lh
cd ..
cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl orthoMCL131vikas6.fa.aln > orthoMCL131vikas6.fa.aln.slx
ls -al
-rw-r--r--  1 pterry amundsen 136568 Nov 30 22:47 orthoMCL131vikas6.fa.aln.slx

## to check top stockholm file
less orthoMCL131vikas6.fa.aln.slx

## now for *hmmbuild*

## see 11/22/17 above (line 4273)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6

hmmbuild orthoMCL131vikas6.fa.aln.hmm orthoMCL131vikas6.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             orthoMCL131vikas6.fa.aln.slx
# output HMM file:                  orthoMCL131vikas6.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     orthoMCL131vikas6.fa.aln   137   974   768     2.38  0.590 

exit
less orthoMCL131vikas6.fa.aln.hmm

#head -n 17 orthoMCL131vikas6.fa.aln.hmm

12/01/17:
## realign using hmm model, hmmalign  (line 4304)

## slurm file prepared
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131vikas6
scp slurm_hmmalign_wheatproj_refinorthoMCL131vikas6.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_refinorthoMCL131vikas6.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_refinorthoMCL131vikas6.sh 10663856  9:28am => ??:??am, 
squeue -u pterry  ## a ST
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
             
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
ls -lh
-rw-r--r-- 1 pterry amundsen 313K Dec  1 09:27 orthoMCL131vikas6.fa.aln.hmmaln

sacct -j  10663856 -o start,end
              Start                 End 
------------------- ------------------- 
2017-12-01T09:27:47 2017-12-01T09:27:59 
2017-12-01T09:27:47 2017-12-01T09:27:59
09:27:59 - 09:27:47 = 12 sec

less orthoMCL131vikas6.fa.aln.hmmaln  ## # STOCKHOLM 1.0 format MSA

## next, stockholm2fasta.pl conversion (line 4334)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al

cd ..
cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x 1 pterry amundsen   1398 Oct 28 16:22 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g orthoMCL131vikas6.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > orthoMCL131vikas6.fa.aln.hmmaln.fa

ls -al
less orthoMCL131vikas6.fa.aln.hmmaln.fa

grep -c ">Traes" orthoMCL131vikas6.fa.aln.hmmaln.fa  ## 131 as expect
grep -c ">" orthoMCL131vikas6.fa.aln.hmmaln.fa  ## 137 as expect
exit
logout

## now fas to phy (line 4363)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/refinPprots820
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl refinPprots131vikas6
cd refinPprots131vikas6
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/refinPprots131vikas6
module load bioperl

./align_convert_fas_to_phy.pl orthoMCL131vikas6.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r--  1 pterry amundsen 158628 Dec  1 09:55 orthoMCL131vikas6.fa.aln.hmmaln.phy
exit
less orthoMCL131vikas6.fa.aln.hmmaln.phy
 137 768
'TraesCS1D01G057800.1'  ---------- ----TRVRAG TLSPEDAHHL FDELLRQATP VPSRSLDGFI AALARAPASA 
logout

## scp back to macbook, (line 4387)

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131vikas6

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131vikas6/orthoMCL131vikas6.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  158628 Dec  1 10:05 orthoMCL131vikas6.fa.aln.hmmaln.phy

less orthoMCL131vikas6.fa.aln.hmmaln.phy

head -n 4 orthoMCL131vikas6.fa.aln.hmmaln.phy
 137 768
'TraesCS1D01G057800.1'  ---------- ----TRVRAG TLSPEDAHHL FDELLRQATP VPSRSLDGFI AALARAPASA 

## so phy header  137 768, expect the 137

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131vikas6/orthoMCL131vikas6.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT

The alignment file "orthoMCL131vikas6.fa.aln.hmmaln.phy" was uploaded, it contains 137 taxons of 768 characters.

Your job was submitted. (10:15am)

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20171201-171442_As33/cmd.txt

## location 1341vikas6 tree file: orthomcl131vikas6_fa_aln_hmmaln_phy_phyml_tree.txt

/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131vikas6/orthomcl131vikas6_fa_aln_hmmaln_phy_phyml/orthomcl131vikas6_fa_aln_hmmaln_phy_phyml_tree.txt

## transfer tree file to 'pro'

in figtree
tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
## basically no more 'long' branches
## now highlighting chr 1, 2, 6 in turn

## set aLRT on %

## Some comments on the figtree display for orthomcl131vikas6_fa_aln_hmmaln_phy_phyml_tree.txt
## Q76C99.1, rice (monocot), looks like similar relationship to all the wheat proteins as the rice9 were previously. The other 5 (dicots) are on long branches not real close to Q76C99.1. So, as the wheat seqs are grouped by chromosome on pyML fightree displays, the dicots are grouped and distinguished from the monocots.
## what to think of the 9.7% on the dicot (the 5) branch ????????

STOPPED
12/02/17:
***********************Aside_p-415_python bk****************
## [:-2], what would this do ????????????????
***********************End aside*****************************
 
# slip a save to ***github*** in here


ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/shared/terry
mkdir rmd_wkflowdoc
cd /work/baenziger/shared/terry/rmd_wkflowdoc
ls -al
logout
cd /Users/bterry/macbook2017/vikas17/wheatproj/rmd_wkflowdoc
ls -al *_ppo*.Rmd
scp *_ppo*.Rmd pterry@crane.unl.edu:/work/baenziger/shared/terry/rmd_wkflowdoc
ls -al *.png
scp *.png pterry@crane.unl.edu:/work/baenziger/shared/terry/rmd_wkflowdoc
## then log on, see if worked, yes 11 files transferred.

12/04/17:
Talked to vikas
1) 131 gff3 file => s/w to provide the picture of domains, patterns, (for example, see if lot of introns, did I do this before ????) try find ref from prev vikas email from 09/05/17, 'gsds' online site, is this s/w meant? Line 2306 above, from 09/08/17.
2) 131 hmmaln output, '.fa' file, weblogo online pgm, see what looks like
orthoMCL131.fa.aln.hmmaln.fa (line 4353)

## So (1), submit .../wheatgff3/131_sort.gff3 to http://gsds.cbi.pku.edu.cn, request png output
## see line 4143, 11/20/17
## line 4165, 
## LOOKS LIKE THE 131_sort.gff3 FILE HAS THE **SAME** ORDER OF ROWS AS THE iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 FILE FOR THE SUBSET 131 ROWS FROM THE orthoMCL OUTPUT MAPPING TO **691** ROWS IN 131_sort.gff3.
## requested '.png', get browser display of output, can one save to file ??????????
Q: selection of other online page options. Vikas saved using right-click, '.png' provided.

Q: re-submitted .../wheatgff3/131_sort.gff3 to GSDS having selected 'SVG' option. After display appeared, option to save either as svg, png or pdf presented, selected 'svg', then got page http://gsds.cbi.pku.edu.cn/task/ARV2HU/ARV2HU.svg, saved to .../wheatgff3/gsds131.svg. BUT THEN FOR EXAMPLE, COULD NOT OPEN IN 'PREVIEW' ??????????????????????????????

12/05/17:
## (2) 
Q: vikas, get orthoMCL131.fa.aln.hmmaln.fa from crane .../refinPprots131norice9 dir, submit to weblogo, accepts defaults.

cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/
mkdir pyMLorthoMCL131norice9  ## note, this dir previously mistakenly deleted.

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131norice9/orthoMCL131.fa.aln.hmmaln.fa .
ls -al *.fa
## submit to weblogo
## Q: output file, fileVdk3vK.png, x-axis TOO MANY compared to weblogo ???????????????
## perhaps somehow need get the ~35 aa domains of these RF-like seqs to run on weblogo.

12/06/17:
talked to vikas
1) reran .../phyml/pyMLorthoMCL131norice9
/orthoMCL131.fa.aln.hmmaln.fa on weblogo, but 'checked 'multiline logo, kept default of 32 symbols/line. Saved file as .../phyml/pyMLorthoMCL131norice9/131hmmaln.fa.weblogo.pdf
## note: vikas clicked the firefox weblogo to increase size of the display ?????????
## NOTE: basically, at many positions, 1 or few aa's listed, indicating the seqs in the input fasta file seqs similar in aa at many positions.
## Q: could one go in following one of the ref papers, 'mark' the domains by repetition of seq patterns by setting setting multiline logo to appropriate value ????????????????????????????????????
2) MEME ver 4.12.0 (to do)
http://meme-suite.org/tools/meme
fasta format, limit 60,000 char. My file, orthoMCL131.fa.aln.hmmaln.fa has 108,072
## so perhaps split into 132 & 130 size files, run each thru MEME ??????
## Q: says, 'select number motif sites' ????? Q: not knowing what number to give, perhaps run multiple times with say 1, 2, 3 for 1st 3 runs ?????????????????????????????
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9
head -n 132 orthoMCL131.fa.aln.hmmaln.fa > orthoMCL131.fa.aln.hmmaln_1st132lines.fa
wc orthoMCL131.fa.aln.hmmaln_1st132lines.fa
     132     132   54450 orthoMCL131.fa.aln.hmmaln_1st132lines.fa
tail -n 130 orthoMCL131.fa.aln.hmmaln.fa > orthoMCL131.fa.aln.hmmaln_last130lines.fa
wc orthoMCL131.fa.aln.hmmaln_last130lines.fa
     130     130   53622 orthoMCL131.fa.aln.hmmaln_last130lines.fa
>>> 54450 + 53622
108072
## 'any number of repetitions'
## number motifs = 1  ???????????????
Sequence contains bad characters

    Total of 18928 bad characters in 66 sequences
    Found 18928 characters (including '-') not in the alphabet on lines 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, ...
## Q: what to do ?????????
## Q: perhaps run perl substitution command, substitute '-' by nothing ???????????
## Q: see line 207 above, looks like perl substitution does not work if the '-' are not in a pattern  ??????????????

12/07/17:
## Q: kochan & wood, p-82, couple approaches, Q: how specify output file ??????
tr -d '-' < orthoMCL131.fa.aln.hmmaln.fa > test_tr
## working ok, but still file > 60,000
-rw-r--r--   1 bterry  staff   72478 Dec  7 08:52 test_tr
## so do 'tr' as follows
tr -d '-' < orthoMCL131.fa.aln.hmmaln_1st66seqs.fa > orthoMCL131.fa.aln.hmmaln_1st66seqs_dash.fa
-rw-r--r--   1 bterry  staff   35522 Dec  7 09:04 orthoMCL131.fa.aln.hmmaln_1st66seqs_dash.fa
## so < 60,000
tr -d '-' < orthoMCL131.fa.aln.hmmaln_last65seqs.fa > orthoMCL131.fa.aln.hmmaln_1ast65seqs_dash.fa
-rw-r--r--   1 bterry  staff   36956 Dec  7 09:12 orthoMCL131.fa.aln.hmmaln_1ast65seqs_dash.fa
## so < 60,000
## now ready submit non dash < 60,000 char to MEME

upload orthoMCL131.fa.aln.hmmaln_1st66seqs_dash.fa
## 'any number of repetitions'
## number motifs = 1  ???????????????
## Advanced options => should any of these be used ???????
## submitted 9:50am => 
## NOTE: REMOVING DASHES WITHIN SEQ OF AA seq, MEME only works on ungapped seqs, so removal all dashes apparently would not hurt MEME ???????
## NOTE: orthoMCL131.fa.aln.hmmaln_1st66seqs_dash.fa has seq length **variance** 179 to 800 ??????????????????

## output, Q: MAST, diff. from MAST ???????
## Q: What to think of this 'logo' ????????????????????????

12/08/17:
## try 2nd run meme, description: orthoMCL131.fa.aln.hmmaln_1st66seqs_dash.fa_2motif
## submit, 10:09am, 
An error occurred running your MEME job. Further details may be available below
http://meme-suite.org/info/status?service=MEME&id=appMEME_4.12.01512749382745409351221
## don't see any error notes ????????????????????????????

## perhaps submit with 3 motifs
http://meme-suite.org/tools/meme
## try 2rd run meme, description: orthoMCL131.fa.aln.hmmaln_1st66seqs_dash.fa_3motif
12/8/2017, 11:30:02 AM
An error occurred running your MEME job. Further details may be available below.
http://meme-suite.org/info/status?service=MEME&id=appMEME_4.12.01512754202263189880938
## don't see any error notes ????????????????????????????

## TALKED TO VIKAS
**PROBLEM:** FOR MEME, WANT ORIGINAL '.fa' FILE PUT THRU 'NOTES' STEPS, NOT THE 'TRIMMED' OUTPUT FROM HMMALIGN !!!!!!!!!!!!!!!!!!??????????????????????????
## line 4199, today, can't find orthoMCL131.fa in /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9  ???????????????????????????????????????????????????/
## so, 
scp it back from pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131norice9/orthoMCL131.fa
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131norice9/orthoMCL131.fa .
ls -al
## Now, submit this file to MEME
## Q: Will MEME have problem with '*' characters ????????????????????? Answer, YES
## so try remove with 'tr'
wc orthoMCL131.fa
    1398    1398   76214 orthoMCL131.fa
## so will need divide file, say in half to be < 60,000

#head -n 701 orthoMCL131.fa.aln.hmmaln.fa > orthoMCL131.fa.aln.hmmaln_1st132lines.fa
head -n 701 orthoMCL131.fa > orthoMCL131_top701.fa
tail -n 697 orthoMCL131.fa > orthoMCL131_last697.fa
## two output files look ok.
## try again submit to MEME
orthoMCL131_top701.fa_1motif
## ran, logo: YNTLIHGYFKVGKMDKACKJFHEMTSQGVEPBVVTYSSVIDALCKNGRMD
Each of the following 63 sequences has an E-value less than 10.
The motif matches shown have a position p-value less than 0.0001

## try again for 2 motifs
orthoMCL131_top701.fa_2motif
Your job ID is: appMEME_4.12.01512792223286-1920140562
running, 10:05pm
## result: motif locations, seeing **different** pattern of the two motifs in the various input sequences.

## github save again.

## perhaps **to try** run wi 3 motifs, then start analyzing 


## get rid '*'s
## apparently not a problem.
## Note: need check size file also. Both small enough.

12/10/17:
vikas
MEME
jhu article (crispr)

12/17/17:
# redo MEME for 131 for 1, 2, & 3 motifs
orthoMCL131_top701.fa
orthoMCL131_top701redo2.fa_1motif
http://meme-suite.org/tools/meme
'any number repetitions'
no. of motifs =1
start: 12:53pm

orthoMCL131_top701.fa
orthoMCL131_top701redo2.fa_2motif
http://meme-suite.org/tools/meme
'any number repetitions'
no. of motifs =2
start: 1:01pm

orthoMCL131_top701.fa
orthoMCL131_top701.fa_3motif
http://meme-suite.org/tools/meme
'any number repetitions'
no. of motifs =3
start: 1:05pm

## Q: pattern of the 3 motifs ***varies*** for location in each sequence ??????????????
## Q: can meme3motif.txt be displayed outside of meme browser result page ????????

## For further information on how to interpret these results, go to http://meme-suite.org
, motif compari
# Q: Tomtom, motif comparison tool ?????????????????????
# I note pattern of 1motif run similar to 1st pattern for 3 motif run.

12/18/17:
talked to vikas
1) get images, etc. in .Rmd file ready for pub
2) vikas available later in day, thurs, fri to work with this info.

3) redo vikas phenogram (/Users/bterry/macbook2017/vikas17/vikas_phenograms
), this time for the 131 seqs rather than 144
## also, try option to display expanded single chrom, fig 8 of phenogram paper.

12/20/17:
## try prepare file for the 131 like gff3_cols13_144nochr_ForPhenoGram.txt of vikas.
## need file wi chr & position for the 131 seqs. Try look at input/output for orthoMCL ???????
gff3_cols13_144nochr.txt, perhaps could go to gff3, select the 131 seqs, similar to prepn of gff3_cols13_144nochr.txt ?????????????????

12/21/17:
## proceeding, 1st get the 131 seq names from /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9/orthoMCL131.fa
grep "^>" orthoMCL131.fa > orthoMCL131names.txt  ## 131 rows as expect, appears sorted, last 3 are chromosome 'U'. Presume need to remove before phenoraph ??????????????
# next, remove '>' left hand side of each line
## cat sort147.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 147 > sort147_nodotnum.txt
cat orthoMCL131names.txt|perl -pe 's/>(Tr.+)$/\1/' | head -n 131 > orthoMCL131names2.txt
# next, remove '.digit'
## cat sort147.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 147 > sort147_nodotnum.txt
cat orthoMCL131names2.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 131 > orthoMCL131namesnodotnum.txt
# now need subset .../wheatgff3/gff3_1345_9names.txt
# 1st copy to /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9
# see p-2325
# sort/uniq check of orthoMCL131namesnodotnum.txt
#sort oGroups135plus12blue_norice9.txt |uniq > testsort147.txt
sort orthoMCL131namesnodotnum.txt |uniq > testsortuniq131.txt
## seq of rows seems same
## now, ready for bash subsetting script.
## cp bash Philip_5colmgff3.sh to .../phyml/pyMLorthoMCL131norice9
##bash Philip_5colmgff3.sh sort147_nodotnum.txt > gff3_1345_9names_147.txt  ## ok
bash Philip_5colmgff3.sh orthoMCL131namesnodotnum.txt > gff3_1345_9names_131.txt  ## ok

## now cut colms 1,3  ## Q: will seq names in new colm 3 be a problem ???????????
cut -f 1,3 gff3_1345_9names_131.txt > gff3_cols13_131.txt

## finally, remove 1st 3 char (chr) (each row in gff3_cols13_131.txt with 
cat gff3_cols13_131.txt|perl -pe 's/chr(.+)/\1/' | head -n 131 > gff3_cols13_131nochr.txt

## talked to vikas
1) put 'tree' filenames in file .../rmd_wkflowdoc/listofimages.tst for each of the images. 8 tree files copied to .../wheatproj/rmd_wkflowdoc
2) changes to venny image (orthoMCL & Phylogeny labels). They compare orthoMCL (135 seqs & the phylogeny, blue=22+red=44=144 after 820 blue & red 'p' + rice9 image above. I note, now missing % display ??????????????
3) Q: The Goal of this research? heterosis, in research scale, 'chemical hybridizing agent' to stop polination some plants in field (like detassaling). But not for production scale. Q: vikas comment: active RF proteins only work with subset of sterile cytoplasm (Me: NEED CLARIFY HOW RF-proteins fcn ???????????!!!!!!!!!!!!************)
4) vikas interest to redo rice9, get more rice RF proteins, run say orthoMCL these + the 820 'p' proteins, see if add'l orthogroups contain some of these known active RF proteins, +ve controls ?????
5) vikas new task: snp locations, find location overlaps (also 1000 bases before & after) with RF genes (Me: need add'l explanation of task, data set ?????????????? I note, bioconductor may be able to do ???? Check bioconductor help site. Also, v buffalo, chpt 9, See p-263-4 and following for starters.
6) get the image for the introns in the RF protein seqs, gsds (done, in Rmd file)
7) phenogram with annotation, see what vikas thinks of the single chrom. plots with input files containing seq. names ??????
8) Q: comment on MEME, what to think about varying pattern of motifs between putative RF seqs ?????????????????????????????
9) weblogo ???????????????????

12/22/17:
## read into R, create 3 colm headers, add a vector, 'RF-like_seq'
## need be in dir .../phyml/pyMLorthoMCL131norice9
setwd("/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9")
colm3 <- rep('RF-like_seq', 131)
class(colm3)
length(colm3)
nchar(colm3)
colm1and2 <- read.delim("gff3_cols13_131nochr.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("chr", "pos"))
phen_input <- data.frame(chr = colm1and2$chr, pos = colm1and2$pos, phenotype = colm3)
dim(phen_input)
head(phen_input, n = 3)
write.table(phen_input, file="phen_input131.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
## remove 3 'U' rows => phen_input128.txt
## ready for phenogram plots
## pheno_gram.33904.png, all chromosomes
## pheno_gram.1A.10to60.png, chrom. 1A, 10,000,000 to 60,000,000 part of ~ 594 million length chrom. 1A 
## 
## Q: could I annotate the seqs on this segment of 1A ?????????????
## tried, failed, perhaps email, contact wi Question ???????????????/

12/26/17:
## **also try** like **3rd example** at phenoGram site, put seq names in 'phenotype' colm, select chrom 1A (only 21 seqs for chrom 1A betw. 10 & 60 million), see if annotate by color and display seq names below the ideogram ????????

## now cut colms 1,3,5
cut -f 1,3,5 gff3_1345_9names_131.txt > gff3_cols135_131.txt

## finally, remove 1st 3 char (chr) (each row in gff3_cols135_131.txt with 
cat gff3_cols135_131.txt|perl -pe 's/chr(.+)/\1/' | head -n 131 > gff3_cols135_131nochr.txt
## ck in bbedit, if all tab separations ????
## need colm headers, try add with R

## read into R, create 3 colm headers, add a vector, 'RF-like_seq'
## need be in dir .../phyml/pyMLorthoMCL131norice9
setwd("/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9")
getwd()
colms123 <- read.delim("gff3_cols135_131nochr.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("chr", "pos", "phenotype"))
dim(colms123)
head(colms123, n=3)
phen_input <- data.frame(chr = colms123$chr, pos = colms123$pos, phenotype = colms123$phenotype)
dim(phen_input)
head(phen_input, n = 3)
write.table(phen_input, file="phen_input131protnames.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
## remove 3 'U' rows => phen_input128.txt

## ready for phenogram plots
## ***error***, lost dir.../phyml/pyMLorthoMCL131norice9 by keyboard sensitivity problem ????? Try find the files with 'find' command ??????
## finding the files previously in /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9 in /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pheno_gram.30959 dir.
## but pheno_gram.30959 dir **not** showing up in finder window ???c
?

## ***what to do*** Perhaps mv pheno_gram.30959 to pyMLorthoMCL131norice9
## from 
mv pheno_gram.30959 pyMLorthoMCL131norice9
## check if can see in finder window, looks ok now.

## result: pheno_gram.1A.10.60protnames128.png => gave the 21 seq names, but some colors ***similar*** enough that betw. perhaps 3 or 4, can't identify colored circle matching seq. name ????????? ***But*** seq names in phen_input128protnames.txt **same** as order along chrom. So, **can** see which seqs are ***'grouped'*** on chrom.


## To do, now copy pheno_gram.1A.10.60protnames128.png from Downloads to .../phyml/pyMLorthoMCL131norice9 dir. (done)

## updated venny in 'Rmd' file (Q: why no % calc this time) ????????

12/27/17: 
## To do, put two .png images into rmd_wkflowdoc dir from .../phyml/pyMLorthoMCL131norice9 dir so can invoke in wheatflowdocnotestoc4_from_ppointtmp.Rmd file.
i) pheno_gram.33904.png
ii) pheno_gram.1A.10.60protnames128.png

## now, update, then knit wheatflowdocnotestoc4_from_ppointtmp.Rmd file (done)

12/28/17:
## copy tree files to .../wheatproj/rmd_wkflowdoc (see listoftreefiles.txt)
1) not in pub ???
2) pro, .../100817/PPRhmmsearchsubset_plus9_clustaltree_coloredPandrice9

3) pro, .../vikas17frompro/pyML829/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.txt

4).../pyML153/22plus122plus9_fa_aln_hmmaln_phy_phyml/22plus122plus9_fa_aln_hmmaln_phy_phyml_tree.txt
5) .../phyml/pyML156_3/156_3_fa_aln_hmmaln_phy_phyml
/156_3_fa_aln_hmmaln_phy_phyml_tree.txt
6) .../phyml/pyMLorthoMCL135price9/rice9orthomcl135_fa_aln_hmmaln_phy_phyml
/rice9orthomcl135_fa_aln_hmmaln_phy_phyml_tree.txt
7) .../phyml/pyMLorthoMCL131price9/rice9orthomcl131_fa_aln_hmmaln_phy_phyml
/rice9orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt
8) pro, .../macbookpro2017/pyMLorthoMCL131norice9/orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt
9) .../phyml/pyMLorthomcl131vikas6/orthomcl131vikas6_fa_aln_hmmaln_phy_phyml
/orthomcl131vikas6_fa_aln_hmmaln_phy_phyml_tree.txt

## left to do, 3 pro files above (done, copied to .../wheatproj/rmd_wkflowdoc on mbook)

# slip a save to ***github*** in here
cd ~/planets
git status
git add wheatprojdoc060117.txt
git commit -m "update 08/31/17 wheatprojdoc060117.txt"
git status
git push origin master
# git remote -v

12/29/17:

*****************************Start,chpt9,vbuffalo***********************************
p-270
have R 3.4.1, so upgrade to 3.4.2 (3.4.3 avail also), choose 3.4.2 since bioconductor using. (tho reading further, 3.4.3 perhaps better choice.
Now install bioconductor 3.6
Start R, then
source("https://bioconductor.org/biocLite.R")
biocLite()
3.5, not 3.6 ????????????????????????????
source("https://bioconductor.org/biocLite.R")
         biocLite("BiocUpgrade")
## still 3.5, not 3.6 ????????????????????
## but then says:
Upgrade all packages to Bioconductor version 3.6? [y/n]: y
p-270
biocLite("GenomicRanges")
## several **utility** bioconductor packages mentioned.
p-271, new R session
library(BiocInstaller)
biocLite("GenomicRanges")
library(IRanges)
rng <- IRanges(start=4, end=13)  ## how specify sequence ???
rng
IRanges(start=4, width=3)
p-272
p-278
## to run this page, try fig out fig 9.8  ????????????????????
set.seed(0)
alns <- IRanges(start=sample(seq_len(50), 20), width=5)
alns
reduce(alns)
## ok, see how works

12/30/17:

12/31/17:

p-290
## to try code this page, fig 9-16, not needed, can see what happening without coding
p-294
## to try code this page, 'coverage(), 
set.seed(0) 
rngs <- IRanges(start=sample(seq_len(60), 10), width=7)
rngs
names(rngs)[9] <- "A"  # label one range for examples later
rngs_cov <- coverage(rngs)
rngs_cov

01/01/18:
p-299
GenomicRanges
p-306
## perhaps run code, see if 4 chr3 seqs ???????????????????????????
p-307
## perhaps run code, try figure out what happening for (1), see if my interpretation ok for (2), (3), ??????????????????????????
p-308
top of page code output ??????????????????
p-309
## to check bit.ly/anno-data url, => available annotation packages ???????????


p-312
## looks like will need to create a transscriptDb object for data/organism will want to work with ?????????????????????
## Q: will this be a problem ????????????????

p-313
## import.gff() ?????????????????????????
p-314-315
## to run this code ??????????????

p-316
## two ways to grab promoter nucleotide seqs ???????????????????????

01/02/18:
p-317
## Biostrings ????
## large scale alignment/mapping ?????????????????????
## bottom page code ??????????????????????

xxxxxxxxxxxxxxxxxxxxxxxxxxxxx start vikas Q'sxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
## talked to vikas
1) for rice, is there a list of RF-like genes, Os.... one can access ?????
2) start 131, follow vikas 'Notes', create hmm (think previously did ??), then hmmsearch vs all the wheat .fa seqs, => , initially see what get (note: with PRR.hmm, prevly got 1545).
3) venny, check if different web sites, may differ by the '%' representation ??????
4) cp rmd_wkflow_doc to crane
5) get the ios app for pag2018 going (apparently only for ios, not for osx ???) (done)
6) snp input data format

SNP id  | chr  | position
snp1    | 2    | 5 Mb
...
        | 1    |
...

## working with gff3 file, looks like 3 colms from gff3 file, add 2 add'l colms

Traes  | start  | end | start - 1kb | start+1kb

To do: subset snp's within/around RF-like genes. Suggest check google for method to accomplish. Also chpt 9 of v buffalo.
## google finding qqch on ncbi, but searching a seq **prevly** has snps located ?????

7) Evid. RF-like proteins may have variation: Melonek abstr: this implies PPR gene inactivation and loss during polyploidization, for which we found evidence in the form of truncated or frame-shifted gene fragments. Pattern MEME motifs vary between 61 putative RF-like seqs. tested. Are MEME motifs perhaps **more sensitive** way to discriminate betw. putative RF-like seqs. ????????? Perhaps use to subset putative RF-like seqs, look for seqs with similar motif patterns ???????????

8) ask vikas try install figtree on his new mac pro ?????
xxxxxxxxxxxxxxxxxxxxxxxxxx end vikas Qs xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

p-324
finding, working with overlapping ranges **[LOOKS LIKE TASK WANT TO ACCOMPLISH]**
## could one build/structure files as prevly described, then employ IRanges package (TO CHECK)
p-326
findOverlaps()  ???????????

01/03/18:
p-328 Lander-Waterman
## Q: looks like some typos in here ??????????????
p-329
BEDTools
p-330
Q: BED files, GTF, GFF, how compare ????????????????
## note: format vikas suggested & '.bed' files examples bit different, how to proceed ????????

01/04/18:
p-331
annotation/track formats ?????????????????
BAM files ??????????
p-333
## dealing with strand ???????????????????????
## Q: 'echo' line ???????????????????????
p-334
## check chr names compatible ????????
p-335
## Q: strand, stumbling block ?????????????????

## so at the end of chpt9, next to try, p-330 (overlaps) & p-333-35 (slop, flank)
## at same time, check out vikas rec., plink

## 1st, map out what input files will be, steps to get the input files ready.

01/05-06/18:
## after looking at the plink 'Extract a subset of SNPs: file-list options' section, have number of questions for vikas. Some are:
1) looks like 'snp' file will need 2 colms, chr & position (I assume need chr colm as position number not unique in genome, only within a chrom.)  ???????????????????????????????????
2) myrange.txt, would have 4 colms.
For example,

     2 30000000 35000000  R1
## if build from gff3 file, could cut last 3 of these fields directly from gff3 file, for chr field, perhaps extract chr from 'LABEL' field (perhaps what C. Brown presented using R, also in v buffalo for this task).
3) SET file, what is it, perhaps prevly doc'd snps in genes ??????????
4) +- 1bk ranges upstream/downstream of gene (is gene = 5'utr, coding region, 3'utr). Would/can plink do this with its algorithm, or would one need to prepare these ranges oneself  ??????????????????????????
5) are we only doing the 128 genes ?????????????????????????
6) perhaps do for *all* chromosomes ?????????????????
 
## so for (2), prepare myrange.txt file
## 1st, find what did prevly processing wheat ggf3 file for the 128 RF-like gnes/proteins. Check 131 also (perhaps also 135), since only difference is subtracted last 3 lines.
##
 ok, line 5034, looks like can start with file .../phyml/pyMLorthoMCL131norice9
/gff3_1345_9names_131.txt
chr1A	gene	49346779	49349220	TraesCS1A01G067600
chr1A	gene	49355113	49356126	TraesCS1A01G067700
## so in new myrange.txt file, colm 1 will remove chr from chr1A
## new colm 2 will be colm 3 from gff3_1345_9names_131.txt
## new colm 3 will be colm 4 from gff3_1345_9names_131.txt
## new colm 4 will be colm 5 from gff3_1345_9names_131.txt

STOPPED

## to do: implement preceding steps.
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9
cut -f 1,3,4,5 gff3_1345_9names_131.txt > gff3_cols1345_131.txt
cat gff3_cols1345_131.txt|perl -pe 's/chr(.+)/\1/' | head -n 131 > gff3_cols1345_131nochr.txt
## the last file the 'myrange.txt' file in plink section '
Extract a subset of SNPs: file-list options' at url: http://zzz.bwh.harvard.edu/plink/dataman.shtml

## email vikas:
--get 'snp' file
--check if correct in num. colms think need for this file to use in plink  ????????????
--work on pag18 talks to see
check academic courses for 18, stat, agron, the biology (BIOS ???)

## **stopped** plink effort for moment

STOPPED



****************************End,chpt9,vbuffalo**************************************


01/10/18:
from 01/02/18 above, line 5188, 
## 2) start 131 .fa prot. seqs, follow vikas 'Notes' (1st 3 steps only), create hmm (think previously did ??), then hmmsearch vs all the wheat .fa seqs, => , initially see what get (note: with PRR.hmm, prevly got 1545).
## ref. HMMER userguide.pdf, p-20-22

## needed steps to get new hmmsearch output for new hmm based on the 131
## do 1st 3 steps in file: /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/Notes_Alignment_UsingHMMs.txt
## on mbook, work in dir .../vikas2018/131RFlike
mkdir ../macbook2018/vikas18/131RFlike
## i. muscle on .fa for the 131 putative RF-like seqs
## 131 .fa file ???, looks like can use /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice9/orthoMCL131.fa
## cp to ../macbook2018/vikas18/131RFlike dir
## refer line 719, 739
## ../FRprotseqs/slurm_muscle_wheatproj_refin820.sh

cp, rename ../FRprotseqs/slurm_muscle_wheatproj_refin820.sh to ../macbook2018/vikas18/131RFlike/slurm_muscle_wheatproj_131RFlike.sh, & edit.
  
## github update (done)

## update crane wi rmd_wkflow_doc

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/shared/terry/rmd_wkflowdoc
ls -al |wc -l ## 15, 14 .png, 1 .Rmd
rm *.png
rm *.Rmd
ls -lh ## dir empty
logout
cd /Users/bterry/macbook2017/vikas17/wheatproj/rmd_wkflowdoc
ls -al *_ppo*.Rmd
scp *_ppo*.Rmd pterry@crane.unl.edu:/work/baenziger/shared/terry/rmd_wkflowdoc
ls -al *.png | wc -l  16
scp *.png pterry@crane.unl.edu:/work/baenziger/shared/terry/rmd_wkflowdoc
## then log on, see if worked, lists 20 files.
ls -lh *.Rmd  # 1
ls -lh *.png  # 16
[pterry@login.crane rmd_wkflowdoc]$ ls -lh |wc -l
18
## later, check what other 1 extra file is ?????????????

01/22/18:

## to prepare crane for this slurm run

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/
ls -lh
## if no dir 131RFlike, create one
mkdir 131RFlike
ls -lh
## /work/baenziger/pterry/wheatproj/131RFlike
logout
## probably need scp orthoMCL131.fa over to crane into .../131RFlike dir.
cd /Users/bterry/macbook2018/vikas18/131RFlike
scp orthoMCL131.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/131RFlike

scp slurm_muscle_wheatproj_131RFlike.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/131RFlike
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_refin820.sh
ls -lh
sbatch slurm_muscle_wheatproj_131RFlike.sh 11302281  12:17pm => ??:??am, 

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          11302281     batch TJob_mus   pterry PD       0:00      1 (Resources)
## later, 3:36pm,
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/131RFlike
ls -lh

-rw-r--r-- 1 pterry amundsen  69K Jan 22 12:25 job.11302281.err
-rw-r--r-- 1 pterry amundsen    0 Jan 22 12:24 job.11302281.out
-rw-r--r-- 1 pterry amundsen  75K Jan 22 11:21 orthoMCL131.fa
-rw-r--r-- 1 pterry amundsen 126K Jan 22 12:25 orthoMCL131.fa.aln

less job.11302281.err

sacct -j  11302281 -o start,end
              Start                 End 
------------------- ------------------- 
2018-01-22T12:24:41 2018-01-22T12:25:08 
2018-01-22T12:24:41 2018-01-22T12:25:08 
12:25:08 - 12:24:41 = 27 sec

less orthoMCL131.fa.aln  ## looks to be *in* MSA fasta format.
 
## next, fasta2stockholm.pl conversion (line 4248)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/131RFlike
ls -lh
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl orthoMCL131.fa.aln > orthoMCL131.fa.aln.slx
ls -al
-rw-r--r--  1 pterry amundsen 126693 Jan 22 16:17 orthoMCL131.fa.aln.slx

## to check top stockholm file
less orthoMCL131.fa.aln.slx

## now for *hmmbuild*

## see 11/30/17 above (line 4595)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/131RFlike
ls -lh
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/131RFlike

hmmbuild orthoMCL131.fa.aln.hmm orthoMCL131.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             orthoMCL131.fa.aln.slx
# output HMM file:                  orthoMCL131.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     orthoMCL131.fa.aln     131   945   802     1.56  0.590 

# CPU time: 2.57u 0.01s 00:00:02.57 Elapsed: 00:00:02.62
exit
less orthoMCL131.fa.aln.hmm
HMMER3/f [3.1b2 | February 2015]
NAME  orthoMCL131.fa.aln
LENG  802
ALPH  amino
RF    no
MM    no
CONS  yes
CS    no
MAP   yes
DATE  Mon Jan 22 16:43:25 2018
NSEQ  131
EFFN  1.555145
CKSUM 2958776102
STATS LOCAL MSV      -12.8115  0.69619
STATS LOCAL VITERBI  -13.7209  0.69619
STATS LOCAL FORWARD   -6.7808  0.69619

## preparing for hmmsearch using orthoMCL131.fa.aln.hmm vs iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa

## log back in, check /work/baenziger/shared/terry/hmm dir.
## has zip file for iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/shared/terry/hmm
ls -al  ## sizes are same.

iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip
/work/baenziger/pterry/wheatproj
## perhaps iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa deleted from crane ??????????????
## not finding iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip in shared dir on crane.
## try from /Users/bterry/macbook2017/vikas17/wheatproj dir the following
cd /Users/bterry/macbook2017/vikas17/wheatproj
find . -name 'iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa' -print
./iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
## so scp iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa to /work/baenziger/pterry/wheatproj/131RFlike

-rw-r--r--  1 bterry  staff  48634703 Jun 14  2017 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa

scp iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/131RFlike

## then check file same size on crane
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj/131RFlike
ls -al
-rw-r--r--  1 pterry amundsen 48634703 Jan 22 19:20 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
## matches

## then, 
## hmmsearch PPR.hmm iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa > PPR.out
## analyze output of hmmsearch, ... get output like PPRsec2_1562_Seqscolm.txt

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj/131RFlike
ls -al
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
# hmmsearch NB-ARC.hmm Trinity.fasta.transdecoder.pep > hmmsrchshortpep.out
cd /work/baenziger/pterry/wheatproj/131RFlike
hmmsearch orthoMCL131.fa.aln.hmm iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa > orthoMCL131hmmsearch.out
## 7:43pm, ran < 1min.
ls -lh
-rw-r--r-- 1 pterry amundsen 5.2M Jan 22 19:43 orthoMCL131hmmsearch.out

less orthoMCL131hmmsearch.out

# hmmsearch :: search profile(s) against a sequence database
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# query HMM file:                  orthoMCL131.fa.aln.hmm
# target sequence database:        iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Query:       orthoMCL131.fa.aln  [M=802]
Scores for complete sequences (score includes all domains):
   --- full sequence ---   --- best 1 domain ---    -#dom-
    E-value  score  bias    E-value  score  bias    exp  N  Sequence             Description
    ------- ------ -----    ------- ------ -----   ---- --  --------             -----------
          0 1527.6   2.1          0 1527.4   2.1    1.0  1  TraesCS1D01G056200.1  
          0 1513.4   3.1          0 1513.1   3.1    1.0  1  TraesCS1A01G054700.2  
          0 1513.2   0.3          0 1513.0   0.3    1.0  1  TraesCS1D01G068400.1  
          0 1512.9   8.4          0 1512.7   8.4    1.0  1  TraesCS1B01G072900.2  
          0 1510.9   0.6          0 1510.7   0.6    1.0  1  TraesCS1A01G067400.1  
          0 1509.9   0.4          0 1509.7   0.4    1.0  1  TraesCS1B01G085900.1  
          0 1501.2   0.0          0 1500.9   0.0    1.0  1  TraesCS1A01G067600.1  
          0 1497.3   0.3          0 1497.1   0.3    1.0  1  TraesCS1D01G068900.1  
          0 1495.6   1.0          0 1495.3   1.0    1.0  1  TraesCS1D01G068500.1  

wc -l orthoMCL131hmmsearch.out
67619 orthoMCL131hmmsearch.out

## compare PPR.out for size, e-values
wc PPR.out
 118172  689922 6704453 PPR.out

## so only approx half many lines as PPR.out

## to check: how determied how many wheat proteins to call hits with orthoMCL131.fa.aln.hmm vs iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa

## 1st, scp 

## ref, 06/12/17 (line 137)
## Note: p-544, cheng ref., 0.1 for *full*, 100 for *domain* ??????
## Q: few comments:
## PPR.out, line 1540, 'inclusion threshold'
## p-9, sci. reports, RFL genes  >= 10 p-class ppr motifs, (note: sec 2, PPR.out, line 542, # domains < 10) So, should num. domains affect cutoff for hmmsearch hits ?????????????????
## p-533, cheng ref., PPR proteins, 2 to 30 tandem repeats ??????????????
## p-533, cheng ref., PPR.out, line 1562, criteria cutoff, 
(-E 0.1),
(-E 100)
## compare, hmmer doc, p-23, cutoff E-value <= 10.0, catches *all* 1595 lines sec 2, PPR.out 
## hmmer doc, p-24, sec 3, ...

## talked to Vikas, would like to take hits in PPR.out file using cheng, p-544 criterion of 'full' E-value <= 0.1. This line 1562 and above in sec 2.

## 1st, scp orthoMCL131hmmsearch.out back to macbook
cd /Users/bterry/macbook2018/vikas18/131RFlike
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/131RFlike/orthoMCL131hmmsearch.out .

philip-terry-2:131RFlike bterry$ ls -al
-rw-r--r--   1 bterry  staff  5350084 Jan 22 21:16 orthoMCL131hmmsearch.out

## note: all but last row of seqs for LHS E-value < .1


STOPPED

## comments:
i. meme, p-77, 'sparkle', domain viewer (5:40pm tuesday), perhaps could split 'P' from 'PLS', RF-like eqs ??????????
ii. so 1553 - 14 = 1539 rows of seqs < 0.1 LHS E-value
iii. could run thru phyml, see what looks like, including rice9 ???????????
iv. perhaps check couple other hmmsearch criteria for output file ????????
v. Read over melonek material, understand all of it, may help with ideas ??????
vi. ... ????

01/23/18:
## for now, stop with 06/13/17 section steps for hmmsearch output file, /work/baenziger/pterry/wheatproj/131RFlike/orthoMCL131hmmsearch.out file.

## talked to vikas today.
i. given the 1539 seqs < Evalue = 0.1 in orthoMCL131hmmsearch.out, not helping to identify RF-like genes.
ii. to check: compare 1545 from PPR.hmm with 1539 from orthoMCL131.fa.aln.hmm (sort, unique, diff ???). If basically the same set, then
iii. get a list of rice RF-like proteins (see melonek 2016 paper on rice).
iv. unclear vikas here? Considering orthoMCL & ML phylogeny methods. 
--run orthoMCL on expanded rice RF-like list + wheat P proteins selected by another ML phylogeny run (?) (or using all 1539 from orthoMCL131.fa.aln.hmm) output???
-- ???? compare with phylogeny for wheat 'p' proteins rice RF-like seqs with ?? wheat P proteins
v. read over melonek 2016 rice paper (think place where got rice seq from Ensembl) ??? Q: gene/protein names in table S1, fig 3 ???????????????????
vi. understand melonek wheat talk & sorghum poster
vii. barkan & small review, fig 2, could I try differentiate RF-like from 'P' proteins using for example webLogo ????????????????????????????????
viii. autogamous, wheat, apparently ????????

01/28/18:
## talked to vikas, 01/26/18
i. having trouble getting protein seqs from melonek paper, table S5, check out ref. Fuji there for the 'red' seqs, from bradi??? 
ii. Fujii, 2011, *not* 2016

01/29/18:
iii. Sykes paper
Q: is new wheat genome seq 'high quality' ??????????????
# Q: how distinguish RF or PPR-RF from RFL ????? Is idea here, these two co-locate ???? Functional markers for actual RF genes yet to be identified ?????


01/30/18:
## talked to vikas yesterday.
i. from Fujii, 2011 paper, table S1, set up runs of
--orthoMCL & 
--ML phyml 
with following seqs
## 820 'P' proteins prevly used
## table S1 arabidopsis (dicot), brachypodium (monocot as is wheat), & soybean (dicot) RFL seqs. Try dnload these seqs from ensembl in *'bulk'* if can figure how to do?
ii. check sykes paper for additional RFL seqs to use here
iii. run orthoMCL & phyML each twice, once for 3 + wheat (820 P), once for brachy + wheat (820 P).

01/31/18:
## From ftp://ftp.ensemblgenomes.org/pub/plants/release-38/fasta/brachypodium_distachyon/pep/ got Brachypodium_distachyon.v1.0.pep.all.fa (31029 '>' lines). 
# Q: to try, from table S1 of Fujii (2011 paper), subset the 9 brachy seqs from the '.fa' file ???????
# finding 1st two of 9 brachy protein seqs from S1 table in the brachy '.fa' file. 
# did vikas have a script, if provide names, will get that subset protein seqs from the .fa file ???????????????

## looks like ./getseq.awk
## example of use:
philip-terry-2:wheatproj bterry$ pwd
/Users/bterry/macbook2017/vikas17/wheatproj
philip-terry-2:wheatproj bterry$ find . -name 'PPRsec2_1562_Seqscolm.txt' -print
./PPRsec2_1562_Seqscolm.txt
## to do just put 9 brachy names in a file, run as following *example* vs :
## ./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa PPRsec2_1562_Seqscolm.txt > PPRhmmsearchsubset.fa

02/03/18:

# slip a save to ***github*** in here
cd ~/planets
git status
git add wheatprojdoc060117.txt
git commit -m "update 02/03/18 wheatprojdoc060117.txt"
git status
git push origin master
# git remote -v

STOPPED

02/04/18:
## finish reading Sykes paper, checking if additional RFL's can include in (see 0/30/18 above)
## Comments:
i) would any of this Sykes pipeline be helpful for us at this point?
ii) perhaps check fujii, 2011 list, table S1, with sykes sup. table 1, see how compares, if any proteins want to use from Sykes?  

cd /Users/bterry/macbook2018/vikas18/131RFlike
#cat bracky9_3colms.txt|perl -pe 's/.+(Br.+).1/\1/' | head -n 9 > bracky9names.txt
cat bracky9_3colms.txt|perl -pe 's/.+(Br.+)/\1/' | head -n 9 > bracky9names.txt
tr '[a-z]' '[A-Z]' < bracky9names.txt > bracky9namesCAPS.txt

./getseq.awk Brachypodium_distachyon.v1.0.pep.all.fa bracky9namesCAPS.txt > bracky9names.fa
 
02/06/18:
Dnloaded Glycine_max.Glycine_max_v2.0.pep.all.fa.gz from ftp://ftp.ensemblgenomes.org/pub/plants/release-38/fasta/glycine_max/pep/
## expanded yielded
-rw-rw-rw-@ 1 bterry  staff    54M Feb  5 10:09 Glycine_max.Glycine_max_v2.0.pep.all.fa
## gene names closest to Fujii (2011) table S1 soybean names. For example, 

>KRH43692 pep chromosome:Glycine_max_v2.0:8:12977614:12982018:-1 gene:GLYMA_08G164800 transcript:KRH43692 gene_biotype:protein_coding transcript_biotype:protein_coding description:hypothetical protein

## so, appears an *extra* '_' in the gene names compared to Fujii, 2011,table S1.
$## tried 5 names, only 1 of 5 found in soybean .fa file ???????????? Had to make all caps, & put in '_' 1st.
# Q: note place to 'update your ensembl IDs. Fujii paper from 2011, 6-7 years ago ???? Phytozome v4.0 source for G. max ?????????

Try dnload arabidopsis.t
-rw-rw-rw-@ 1 bterry  staff    32M Feb  5 11:45 Arabidopsis_thaliana.TAIR10.pep.all.fa
-rw-rw-rw-@ 1 bterry  staff   9.3M Feb  5 11:44 Arabidopsis_thaliana.TAIR10.pep.all.fa.gz

48322 '>' in .fa file

Differences betw format of name betw Fujii 2011 table S1 & arabidopsis .fa file. BUT, note, .fa file lists for ex., at least *3* tx's for gene name AtPPR_1g06580 (tab S1), AT1G06580 in .fa file.

02/06/18:
## talked to vikas
i. resume search for soybean seqs as follows:
https://soybase.org/dlpages/, try submit list of 41 soybean genes from Fujii, 2011,table S1.
I note, could fail for reasons like the case of the letters in the names, etc. The genome soybean genome I dnloaded above from ensembl had such issues.

cat bracky9_3colms.txt|perl -pe 's/.+(Br.+)/\1/' | head -n 9 > bracky9names.txt
tr '[a-z]' '[A-Z]' < bracky9names.txt > bracky9namesCAPS.txt

cat soybean41Fujii2011.txt|perl -pe 's/.+(Gly.+)\t.+/\1/' | head -n 41 > soybean41Fujii2011names.txt
## At https://soybase.org/dlpages/#genecallcorrespondence site, 1st did 
## Gene Model Correspondence Lookup
## result, 38 of 41 found a name for Wm82.a2.v1 version. Note several names found more than 1 name for this version ?????????
## anyway, **PERHAPS** take these 38 names (instead of submitted ones), submit these names to 'Download longest transcript or predicted protein sequence for gene calls' section of soybean site.
## 1st, need isolate the 4th column from soybase.org_correspondence_methods.csv. Deleted 3 rows wi 'no correspondence'. Tabbed where apparent 'tab' missing ???????? Deleted 1st 3 rows. New name: Glyma4vernames.txt
Now, use perl -pe script
cat Glyma4vernames.txt|perl -pe 's/.+(Glyma\..+)/\1/' | head -n 38 | perl -pe 's/(.+),/\1/' | head -n 38 > Glyma_ver2.0names38.txt

cat Glyma4vernames.txt|perl -pe 's/.+(Glyma\..+,)/\1/' | head -n 38 | perl -pe 's/(.+),/\1/' | head -n 38 > Glyma_ver2.0names38.txt

## unclear what to do, absence '.' several version 2 names, perl -pe can't work ok ???
## need clarify what **want** to do ???????????????????

's/.+\,.+\,\t(Gly.+)\,.+/\1/'
's/.+,.+,.+(Gly.+),.+/\1/'
's/.+(Glyma\..+)/\1/'
's/(.+),/\1/'

02/07/18:
https://soybase.org/dlpages/#dnarna
## https://www.arabidopsis.org/download/index-auto.jsp?dir=/download_files/Proteins
## tair, not used.
## test downloaded 1st soybean v.2 name, appears to have provided two transcripts for that gene

## continue with arabidopsis
## from 02/06/18 above have 
-rw-rw-rw-@ 1 bterry  staff    32M Feb  5 11:45 Arabidopsis_thaliana.TAIR10.pep.all.fa
## from Fujii, 2011, have arab26fujii2011.txt.
## isolate colm 3, 'ID in gene models' (perl -pe)
cat arab26fujii2011.txt|perl -pe 's/.+(AtPPR.+)/\1/' | head -n 3 | perl -pe 's/(.+)\t.d/\1/' | head -n 3
  > Glyma_ver2.0names38.txt
 ## preceding failed ???????????????? 

bbedit: .+(At)PPR_(.+)\t\d to arab26fujii2011.txt
replace was \1\2.1
## new file name: arab26fujii2011names.txt
## check no repeats
sort arab26fujii2011names.txt |uniq  ## 26, originally not sorted, leave that way ????

## left, make names all CAPS
tr '[a-z]' '[A-Z]' < arab26fujii2011names.txt > arab26fujii2011namesCAPS.txt
## now ready for getseq.awk

cp two files to .../arabidopsistuff dir.
Arabidopsis_thaliana.TAIR10.pep.all.fa, Arabidopsis_thaliana.TAIR10.pep.all.fa.gz, & getseq.awk
cd /Users/bterry/macbook2018/vikas18/131RFlike/arabidopsistuff

./getseq.awk Arabidopsis_thaliana.TAIR10.pep.all.fa arab26fujii2011namesCAPS.txt > arab26fujii2011names.fa
## all but >AT1G62915.1 (167 aa's) have lengh ~ 490 range or more

02/08/18:

## back to soybean
## file used to manually select RFlike names originally from Fujii, 2011, table S1, Glyma_Correspondence_Report_20180207232909.csv. Need display in excel due to fact only these, can easily see which names in v2 column. **But wait**, the internet site does this **better** than excel, https://www.soybase.org/correspondence/index.php
## Puts multiple ver2 hits in same colm, **easier** to see.

## so new file with manually selected ver2 name for Fujii, 2011 soybean names will be soybean41to_ver2names38.txt.

02/09/18:

## now, submit this file to https://soybase.org/dlpages/#dnarna, 'Download longest transcript or predicted protein sequence for gene calls' section using soybean41to_ver2names38.txt file.

## resulting soybean41to_ver2names38.txt.prot.fa file has 54 '>' lines (apparently getting muliple isoforms ??????????
## to do, try bbedit reg expn, on soybean41to_ver2names38.txt, add '.1.p' at end to input file. then run this with getseq.awk on soybean41to_ver2names38.txt.prot.fa to get new '.fa' file with just '.1.p' isoform (hopefully dowm from 54 '>' lines to '38 lines ?????

soybean41to_ver2names38.txt => soybean41to_ver2names38dot1dotp.txt (done)

./getseq.awk soybean41to_ver2names38.txt.prot.fa soybean41to_ver2names38dot1dotp.txt > soybean41to_ver2names38dot1dotp.fa

## Finally ready for orthoMCL runs, tho 1st shorten .fa file '>' names, then for 1st orthoMCL run, 
http://orthomcl.org/orthomcl/proteomeUpload.do

## talked to vikas, comments
i. would like copy of Fujii, 2011 names submitted to Glyma 1.1 to Glyma2.0 Correspondence Lookup at https://soybase.org/dlpages
ii. would like both orthoMCL * ML phylogeny on each of the combinations
--820 + bracky9 + rice9
--820 + bracky9 + rice9 + arabidopsis26 + soybean38

iii. ML phylogeny
--820 + bracky9 + rice9
--820 + bracky9 + rice9 + arabidopsis?? + soybean38

## so next, get the .fa files **together**, check for need shorten '>' names
/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl

arab26fujii2011names.fa
bracky9names.fa
soybean41to_ver2names38dot1dotp.fa

## ref line 674
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqsPPRhmmsearchsubset_P_prots820.fa
## names *short* enough, just the wheat names

## rice9 ????
## From /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyML829
## copy FRknownseqs_shtname_9.fa file. Has short names *already*.
## ref., 'cat', line 1352

02/10/18:

## still need shorten '>'names in .fa files for arabidopsis26, bracky9 & soybean38 ?????
## ref. p-28, haddock, example: (>\w+).+\[(\w+).+

arab26fujii2011names.fa =bbedit=> arab26fujii2011namesshort.fa
(>\w+\.\d).+
\1\r
grep -c "^>" arab26fujii2011namesshort.fa   # 26 as expect
sort arab26fujii2011namesCAPS.txt |uniq | wc -l  ## 26

bracky9names.fa  =bbedit=> bracky9namesshort.fa
(>\w+\.\d).+
\1\r
grep -c "^>" bracky9namesshort.fa   # 9 as expect
sort bracky9namesCAPS.txt |uniq | wc -l  ## 9 

## last, 
soybean41to_ver2names38dot1dotp.fa =bbedit=> soybean41to_ver2names38dot1dotpshort.fa
(>\w+\.\w+\.\d).+
\1\r
grep -c "^>" soybean41to_ver2names38dot1dotpshort.fa   # 38 as expect
sort soybean41to_ver2names38dot1dotp.txt |uniq | wc -l  ## 38

## yet to *cat* input files for orthoMCL ????? see line 1995 for orthomcl ????
--820P + bracky + rice
--820P + bracky + rice + soy + arab

cat PPRhmmsearchsubset_P_prots820.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa > p820br9rice9.fa
grep -c "^>" p820br9rice9.fa  ## 820+9+9=838 as expect

## finally, ready run orthoMCL online (ref. line 1995)
submitted: 02/10/18, 7:36pm.
Job name: p820br9rice9_021018
Sequence file uploaded: p820br9rice9.fa
Email: pterry@huskers.unl.edu

/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/orthomclResult-4HHT9B3DDQF7/orthologGroups
## Q:s
i. what can say about orthoMCL group wi +ve controls in it ????????
ii. 'osat' or 'rcom' ??????
iii. seq ID of best hit (do these hits relate to specific protein ???????)
iv. difference, %ID & %match ????????????????????
v. for orthomcl_group OG5_131220, containing the bracky9 & rice9 'controls', total 153 occurrences. Subtract 153 - 18 = 135 wheat seqs (matching the 135 from last summer).
vi. p-6.12.3, ***where*** access OrthoMCL-DB Web site to learn about 'orthomcl_groups' of interest ???
vii. should one rerun with 1545 seqs following PPR.hmm or even the 110,000 before PPR.hmm ???

cat PPRhmmsearchsubset_P_prots820.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa > p820br9rice9soy38arab26.fa
grep -c "^>" p820br9rice9soy38arab26.fa  ## 820+9+9+38+26=902 as expect

## finally, ready run orthoMCL online (ref. line 1995)
submitted: 02/10/18, 10:29pm
Job name: p820br9rice9soy38arab26_021018
Sequence file uploaded: p820br9rice9soy38arab26.fa
Email: pterry@huskers.unl.edu

02/11/18:
/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/orthomclResult-2PSJAXREJR6L/orthologGroups
## Q:s
i. several of the +ve controls are in orthogroup **different** from OG5_131220 ??????
ii. tried google search for NP_001052533, but no hits.
iii. google OG5_131220, hitting PPR proteins.
iii. 210 OG5_131220 rows in orthoGroups output file for p820br9rice9soy38arab26.fa input file. Could check how many are wheat proteins. Estimate ~ 130 without actually counting.
iv. tried google another of the soybean orthogroups, OG5_170290, hitting a 'pentatricopeptide (PPR)' protein.

## NOTE: ORTHOMCL only compares input protein seqs to PRE-BUILT orthogroups. Melonek, sci reports paper, p-9, OrthoMCL-DB web site, (www.orthomcl.org/orthomcl/). Q: what all can do there ??? If use ML phylogeny, ALL input seqs processed compared to orthomcl. WHAT does CD-Hit do ?????????

TO TRY: orthomcl run with 1545 wheat seqs ?????
find . -name 'PPRhmmsearchsubset.fa' -print
## copied PPRhmmsearchsubset.fa to /Users/bterry/macbook2018/vikas18/131RFlike/orthomcl

grep -c "^>Tr" PPRhmmsearchsubset.fa  ## 1545

02/12/18:

## to create the two .fa (cat) file with 2 & 4 +ve ctl species for orthomcl & the 1545 .fa file ??
cat PPRhmmsearchsubset.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa > p1545br9rice9.fa
grep -c "^>" p1545br9rice9.fa  ## 1545+9+9=1563 as expect

## finally, ready run orthoMCL online (ref. line 1995)
submitted: 02/12/18, 10:24pm.
Job name: p1545br9rice9_021218
Sequence file uploaded: p1545br9rice9.fa
Email: pterry@huskers.unl.edu

02/13/18:
/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/orthomclResult-UUSGQP3LHON2/orthologGroups
# in bbedit,
##  Tr.+\.[2-9].+
## 86 'Tr' rows != '.1', total 'Tr' rows = 1545
## Tr.+\.[^1].+  ## not working ??????????
## so, in OG5_131220 orthogroup are 
154 - 18 (ctl's) = 136 'Tr' rows in orthogroup OG5_131220, so similar number to all the prev. orthomcl runs.

## vikas Q: on isoforms:
## 86 in [2-9] for 'Tr...\.d', only ~ 2 in OG5_131220 orthogroup, so, if this orthogroup the identifier for RF-like seqs, & '.1' refers to 1st isoform, then ~ only 2 of these higher than '.1' isoforms are RF-like seqs. 1459 ('.1') + 86 (!='.1') = 1545. So accounts for all the seqs input to orthomcl.

## check actual 86, if in OG5_131220
## rename orthologGroups file to orthologGroups86.txt
## (Tr.+\.[2-9]).+  ## finds '86'
## replace: \1
## message says replaced, but 'where are new 86' ???????????
## (Tr\w+\.[2-9]\t\w+).+
## \1
## did replacement, but left all rest in place ????????????

grep -c "Tr\w+\.[2-9]\t\w+.+" orthologGroups86.txt  ## , so *fails*  ????????????
grep -c '\.[2-9]' orthologGroups86.txt  ## 86, ok.
grep '\.[2-9]' orthologGroups86.txt > test86.txt
## bbedit test86.txt for OG5_131220 orthogroup returns only 3 rows
## so, looking like 86 .[2-9] rows except for 3 not RF-like seqs.
## finally, note, *all* 18 +ve ctl's in orthologGroups86.txt associated with orthogroup OG5_131220, the one assoc'd with the +ve ctl's in the previous orthMCL runs.

## still create, submit to orthomcl p1545br9rice9soy38arab26.fa
cd /Users/bterry/macbook2018/vikas18/131RFlike/orthomcl

cat PPRhmmsearchsubset.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa > p1545br9rice9soy38arab26.fa
grep -c "^>" p1545br9rice9soy38arab26.fa  ## 1545+9+9+38+26=1627 as expect

## finally, ready run orthoMCL online (ref. line 1995)
submitted: 02/13/18, 7:54pm
Job name: p1545br9rice9soy38arab26_021318
Sequence file uploaded: p1545br9rice9soy38arab26.fa

## Note: only 3 '.2' seqs in **orthoMCL131.fa**, rest are '.1' tx.

02/14/18:

/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/orthomclResult-X5O8LRIX5OBA/orthologGroups
## number rows = 1627 as expect
## total 211 OG5_131220 orthogroup rows in file from p1545br9rice9soy38arab26.fa. With 82 'ctl' rows, 211 - 82 = 129 *max* possible rows with OG5_131220 & wheat sequence.

## check 'ctrl' rows for orthogroup: I note a few not with OG5_131220. So, try grep them out for closer look.
grep -v 'Tr' orthologGroups1545_4crtl.txt > test4ctrl82.txt
## 6 of 82 not OG5_131220. 3 in soy, 3 in arab. The 6 are all *different*.

## check wheat rows for not '.1'.
grep -c '\.[2-9]' orthologGroups1545_4ctrl.txt  ## 86, ok.
grep '\.[2-9]' orthologGroups1545_4ctrl.txt > test1545_4ctrl86.txt
## only **3** of the 86 **non** '.1' wheat seqs are in orthogroup OG5_131220 ?????????

## conclude, even starting with 1545 wheat seqs for orthoMCL, only get ~ 129 RF-like seqs, similar to the result starting with 820 'P' proteins.
## Q: diff from melonek 207 number. So far, don't have an explanation. 
## unless a bunch of the non OG5_131220 orthogroups associated with the ~ 75 non '.1' wheat seqs, upon checking, would turn out to be RF-like seqs. A visual check looks like **don't** have many if any in common ??????
## BUT THE 75, ***APPROX*** the DIFFerence betw. 130 & 207 OF MELONEK ?????????????

TO DO: THIS CHECK FOR THE 820P RUNS ????

TO DO: PERHAPS CHECK SOME OF THESE ORTHOGROUPS ARE RF-LIKE REFERENCES ????

## CHECK IF EACH OF THESE [2-9] SEQS SHARE A NAME WITH A WHEAT '.1' SEQ ??????

## talked to vikas
i. check 7 orthogroups found mapping to at least one ctrl (arab or soy), to see if map to any wheat sequence ???????
cd /Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/orthomclResult-X5O8LRIX5OBA

## for orthologGroups1545_4ctrl.txt file, 6 of 7 hit no wheat proteins, one hit 3 (OG5_170290). They are all on chromosome one:

TraesCS1A01G060500.1	OG5_170290	osat|NP_001047166	0	-181	48	100
TraesCS1B01G078800.1	OG5_170290	osat|NP_001047166	0	-181	48	100
TraesCS1D01G061400.1	OG5_170290	osat|NP_001047166	0	-181	48	100


02/15/18:
## to check for 820+4ctrl species ????
cd /Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/orthomclResult-2PSJAXREJR6L

grep -v 'Tr' orthologGroups820_4ctl.txt > test820_4ctrl82.txt
for orthologGroups820_4ctl.txt file, 6 of 7 hit no wheat proteins, one hit 3 (OG5_170290).

## Q: do google search for this orthogroup name. MpPPR_24 	'Pentatricopeptide repeat' proteins. In PFAM, hits PF01535 (and 2 others, all PPR repeat). PF01535 same pfam hit by OG5_131220. So these additional 3 wheat seqs in previous 820 'P's & 1545 group, listed above, all on chromosome one. 
## SO, PRESUME **INCLUDE** IN TENTATIVE RF-like seqs (that is, add to the 131) since tyey map to RF-like control seqs. BUT, HITTING STUFF NOT LABELED RF-like. Perhaps include, later may remove, I note they located on chr 1,

02/16/18:
## saved to github

## TO DO, send email to vikas with this result. (done)

ii. do ML phylogeny (follow steps in vikas 'Notes ...' file for 820P & 1545 with 2 & 4 ctrl species above. See if can isolate additional wheat seqs as RF-like?

## reference (11/30/17)
##  line 4512, now, for (ii), 'Notes' for 131, **plus** vikas6, 

cd /Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/p820br9rice9soy38arab26.fa
## 902 seqs, 
## Q: >Gl... rows not wrapped at 70 as rest of seqs ????

## Now run Notes steps ... 

## need new dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir p820br9rice9soy38arab26
cd p820br9rice9soy38arab26
## scp p820br9rice9soy38arab26.fa to crane, dir = p820br9rice9soy38arab26
logout
## now for slurm_muscle_wheatproj_p820br9rice9soy38arab26.sh
## edit, then scp (done)

cd 
/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/phyml/p820br9rice9soy38arab26

scp p820br9rice9soy38arab26.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
## cp slurm_muscle_wheatproj_refin131vikas6.sh to slurm_muscle_wheatproj_p820br9rice9soy38arab26.sh

scp slurm_muscle_wheatproj_p820br9rice9soy38arab26.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 4541)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_p820br9rice9soy38arab26.sh
ls -lh
sbatch slurm_muscle_wheatproj_p820br9rice9soy38arab26.sh 11716409 2:09pm =>

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          11716409     batch TJob_mus   pterry PD       0:00      1 (Priority)

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -lh
less job.11716409.err
sacct -j  11716409 -o start,end
              Start                 End 
------------------- ------------------- 
2018-02-16T14:23:25 2018-02-16T15:19:31 
2018-02-16T14:23:25 2018-02-16T15:19:31 
15:19:31 - 14:23:25 = 65min 06 sec

less p820br9rice9soy38arab26.fa.aln  ## looks to be *in* MSA fasta format.

## next, fasta2stockholm.pl conversion (line 4567)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -lh
#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl p820br9rice9soy38arab26.fa.aln > p820br9rice9soy38arab26.fa.aln.slx
ls -al
-rw-r--r--  1 pterry amundsen 3400034 Feb 16 19:28 p820br9rice9soy38arab26.fa.aln.slx

## to check top stockholm file
less p820br9rice9soy38arab26.fa.aln.slx

## now for *hmmbuild*

## see 11/30/17 above (line 4593)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -lh

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26

hmmbuild p820br9rice9soy38arab26.fa.aln.hmm p820br9rice9soy38arab26.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             p820br9rice9soy38arab26.fa.aln.slx
# output HMM file:                  p820br9rice9soy38arab26.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     p820br9rice9soy38arab26.fa.aln   902  3748   738    18.65  0.590 

# CPU time: 3.65u 0.02s 00:00:03.67 Elapsed: 00:00:03.72
exit
less p820br9rice9soy38arab26.fa.aln.hmm

#head -n 17 orthoMCL131vikas6.fa.aln.hmm

## refer (12/01/17, p-4623)

## realign using hmm model, hmmalign  (line 4632)
mv  slurm_hmmalign_wheatproj_refinorthoMCL131vikas6.sh slurm_hmmalign_wheatproj_p820br9rice9soy38arab26.sh
## slurm file prepared
cd /Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/phyml/p820br9rice9soy38arab26

scp slurm_hmmalign_wheatproj_p820br9rice9soy38arab26.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

STOPPED

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_refinorthoMCL131vikas6.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_p820br9rice9soy38arab26.sh 11723687  10:19am => ??:??am, 
squeue -u pterry  ## a ST
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          11723687     batch TJob_hmm   pterry PD       0:00      1 (Priority)

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
             
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -lh
-rw-r--r-- 1 pterry amundsen 7.8M Feb 16 22:22 p820br9rice9soy38arab26.fa.aln.hmmaln

sacct -j  11723687 -o start,end
              Start                 End 
------------------- ------------------- 
2018-02-16T22:20:39 2018-02-16T22:22:01 
2018-02-16T22:20:39 2018-02-16T22:22:01 
22:22:01 - 22:20:39 = 1 min 22 sec 

less p820br9rice9soy38arab26.fa.aln.hmmaln  ## # STOCKHOLM 1.0 format MSA

## next, stockholm2fasta.pl conversion (line 4653)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -al

#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g p820br9rice9soy38arab26.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > p820br9rice9soy38arab26.fa.aln.hmmaln.fa

ls -al
less p820br9rice9soy38arab26.fa.aln.hmmaln.fa

grep -c ">Traes" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 820 as expect
grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit
logout

## now fas to phy (line 4682)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl p820br9rice9soy38arab26
cd p820br9rice9soy38arab26
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
module load bioperl

./align_convert_fas_to_phy.pl p820br9rice9soy38arab26.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r--  1 pterry amundsen 1013773 Feb 16 23:43 p820br9rice9soy38arab26.fa.aln.hmmaln.phy
exit
less p820br9rice9soy38arab26.fa.aln.hmmaln.phy
 902 768
'TraesCS5D01G097800.1'  ------PTTH FTPSQAHAAA TSHHPAAA-- AAAATATARL HASASASAPA AAAALCPPFL 
logout

02/17/18:

## scp back to macbook, (line 4707)

cd /Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/phyml/p820br9rice9soy38arab26

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26/p820br9rice9soy38arab26.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  1013773 Feb 17 18:04 p820br9rice9soy38arab26.fa.aln.hmmaln.phy

less p820br9rice9soy38arab26.fa.aln.hmmaln.phy

head -n 4 p820br9rice9soy38arab26.fa.aln.hmmaln.phy
  902 738
'TraesCS5D01G097800.1'  ------PTTH FTPSQAHAAA TSHHPAAA-- AAAATATARL HASASASAPA AAAALCPPFL 
 
## so phy header  902 768, expect the 902

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/phyml/p820br9rice9soy38arab26/p820br9rice9soy38arab26.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT

Name: p820br9rice9soy38arab26_021718

The alignment file "p820br9rice9soy38arab26.fa.aln.hmmaln.phy" was uploaded, it contains 902 taxons of 738 characters.

Your job was submitted. (6:16pm)

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20180218-011554_Ub55/cmd.txt


STOPPED

02/19/18:
Dnloaded from http://www.atgc-montpellier.fr/phyml/results.php?path=20180218-011554_Ub55/sms.csv
## new location:
/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/phyml/p820br9rice9soy38arab26/p820br9rice9soy38arab26_fa_aln_hmmaln_phy_phyml.zip

## Running **time**: 1 day 13 hrs

/Users/bterry/macbook2018/vikas18/131RFlike/orthomcl/phyml/p820br9rice9soy38arab26/p820br9rice9soy38arab26_fa_aln_hmmaln_phy_phyml/p820br9rice9soy38arab26_fa_aln_hmmaln_phy_phyml_tree.txt

## transfer tree file to 'pro'

in figtree
Initially asked select a name for node values, gave aLRT

tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
BR = red, Gly = pink, rice(AB) = green arab(AT) = yellow, these +ve ctls group to the left of circular phylogram. Red & pink sort of group together, yellow near pink. but note, some dispersal of a few mostly yellow & green ?????????????????????
## now highlighting chr 1, 2, 6 in turn
## they pretty much **spread around** the circular phylogram  ???????????????????
## PERHAPS SHOULD NOT HAVE USED **ALL** SEQS IN p820br9rice9soy38arab26.fa FOR hmmbuild ?????????????
## working with p820br9rice9soy38arab26_fa_aln_hmmaln_phy_phyml_tree.txt file, red [=] TraesCS1, chr 1. green [=] TraesCS2, chr 2, purple [=] TraesCS6, chr 6.

## talked to vikas:
i. mentioned wheat seqs in p820br9rice9soy38arab26 phylogram **spread around** the circular phylogram. He suggested could be wheat seqs more closely related to selves than the other species ???????????

02/20/18:
ii. blast 131+3 'genes' of the RF-like genes vs 110,000 genes. Not protein-protein. Det. which blast need. See if can identify any more RF-like seqs. Note: **only** did 131 HERE

## which blast: ??????????

iii. subset ~ 110,000 wheat genome protein seqs using 131+3 RF-like genes (remove '.d' before search). When get, look for '.d' hits where 'd' = [2-9]. See if the number is in ~ 75 count, and what 'orthoGroup' they map to, if to PPR annotation.

## from line 4990 above
#bash Philip_5colmgff3.sh orthoMCL131namesnodotnum.txt > gff3_1345_9names_131.txt  ## ok
## perhaps test if 110,000 wheat genome protein file has names with '.d' following gene name, presumably would not make any difference to this bash script query  ????????

## Note, if gff3 file had '.d' name extensions, should have found duplicate rows. But still without them, if they existed, then why don't have more than 131 rows in output subset file ??????

## vs 110,790 seq '.fa' file (iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa), grep, see if get some rows with '.d' extensions ?????????
## working from dir /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
grep -c '>' iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa  ## 110790, as expect
grep -c '\.[2-9]' iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa  ## 8970
grep -c '\.1' iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa  ## ## 101820

## 1st, perhaps for the 110,790 '.fa' file, run this query file (orthoMCL131namesnodotnum.txt) against it with bash script. So, modify Philip_5colmgff3.sh to Philip_iwsgc131.sh

bash Philip_iwsgc131.sh orthoMCL131namesnodotnum.txt > iwsgc131names.txt
## finds 3 names with '.2', each unique. So, for these RF-like names, iwsgc '.fa' file does not have dupl names with differing '.d' endings.

## Could run these 131 names vs the non '.1' rows from 1545 run with orthoMCL, check if any of the 131 names match these names ?????  Rule out these [2-9] as having same name as any of the 131 ????

02/21/18:
talked to vikas, library
i. vikas to get new wheat gene seqs file
ii. vikas to get all proteins file (my attempt to find additional seqs of same name as 131 doomed to fail, as REPR iwgsc file only has one seq each protein **by definition**.
iii. gene expression for 131+3 (vikas think start this). He to get info how to do ??
iv. note 'private' blast for URGI (vikas can do), Q: should I sign up to do ???????

02/23/18:
## received vikas email on 2/21/18 with info on preceding questions.
## check /home/baenziger/shared/pterry for
--CDS seqs, both repr & all-variants. Suggest use repr CDS for 1st set blast search (Q: URGI private blast, or crane (blastn?), or what ???????????)
## Q: will I '131 subset' the CDS db 1st, then blast the subset '.fa' file vs the db ?????????
## to make available for viksas, the 131 subset '.fa' file, so he can test the online 'private' URGI blast tool.
## look for the all-protein file. Retry to subset based on the 131 'names'.
## check the README file for more info.
## he has 'shared' dir on 'home'  ???????

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /home/baenziger/shared/pterry  ## so NOT on work dir  ???????????????
## BUT found above: /work/baenziger/shared/terry/hmm
cd /work/baenziger/shared/terry
## so try both ???????
## so I put Rmd on work dir (???????????????????)
## but work dirve subjet to deletion, probably not good place for Rmd file ??????
ls -al

## scp back to macbook

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp pterry@crane.unl.edu:/home/baenziger/shared/pterry/iwgsc_refseqv1.0_README.pdf .
ls -al
-rw-r--r--   1 bterry  staff    318861 Feb 23 11:23 iwgsc_refseqv1.0_README.pdf

scp pterry@crane.unl.edu:/home/baenziger/shared/pterry/iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.zip .
ls -al
-rw-r--r--   1 bterry  staff  42085055 Feb 23 11:48 iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.zip


md5 iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.zip
MD5 (iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.zip) = 456a8a62bcc7a513e84e92be0aaed78c

less iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa
head -n 10 iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa
>TraesCS1A01G000100.1 gene=TraesCS1A01G000100
ATGCGCGTGATCGCGCTATCTGCCGGGGTTACCCCGTCCCTTAGGATCGGCTTACCCATG
TGCAAGTGCCGTTCACATGGAACCTTTCTCCTCTTCGGCCTTCAAAGTTCTCATTTGAAT
ATTTGCTACTACCACCAAGATCTGCCGCGACGGCCGCTCTGCCCGGGCTCGCGCCCCGGG
TTTTGCAGCGGCCGCCGCGCCCTCCTACTCATCGGGGCATGGCGCTCGTCCAGATGGCCG
GGTGTGGGTCGCGCGCTTTAG
>TraesCS1A01G000200.1 gene=TraesCS1A01G000200

## so looks like could subset with the non '.d' 131 names and get the desired '131.fa' gene CDS.

#bash Philip_iwsgc131.sh orthoMCL131namesnodotnum.txt > iwsgc131names.txt
## rename Philip_iwsgc131.sh to Philip_iwsgc131_CDS.sh, modify inside file to iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa & run

bash Philip_iwsgc131.sh orthoMCL131namesnodotnum.txt > iwsgc131_CDSnames.txt
-rw-r--r--   1 bterry  staff       2879 Feb 23 12:15 iwsgc131_CDSnames.txt
-rw-r--r--   1 bterry  staff       2879 Feb 20 23:15 iwsgc131names.txt
## identical to output when ran vs iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
## expected.

## next, getseq.awk to get 'fa file for CDS's seqs

#./getseq.awk soybean41to_ver2names38.txt.prot.fa soybean41to_ver2names38dot1dotp.txt > soybean41to_ver2names38dot1dotp.fa

## to do,

remove '>' from iwsgc131_CDSnames.txt (becomes query) => iwsgc131_CDSnames_minus1stchar.txt
## in bbedit, find box: >(\w+\.\d)  replace box: \1

then ready for 
./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa iwsgc131_CDSnames_minus1stchar.txt > iwsgc131_CDS_seqs.fa
ls -al
-rw-r--r--   1 bterry  staff     225890 Feb 23 15:55 iwsgc131_CDS_seqs.fa
## has 3797 lines

## next, get to vikas (do I need to shorten the '>' lines ????) to try with 

02/25/18:
## vikas tested iwsgc131_CDS_seqs.fa as query vs wheat genome db ('private blast'). Result like BLAT, the locations of the hits on the chromosomes, does not tell if underlying gene at the location.
## Suggeted alternative,BLASTN of the query against wheat CDS db. Try do up on crane.

## Searching in /Users/bterry/planets/BdactyloidesthruGSEA081615.txt, around line 498 for about 20 lines, note file slurm_8Trinitymakeblastdbexampdatacrane.sh in dir cd /Users/bterry/macbookpro2015/keenanres15/trintoGSEA/testing/tut
## and slurm_10Trinityblastnexampdatacrane.sh showing how did 'makeblastdb' & 'blastn'.

## See if can adapt for my task ???? Q: how megablast mentioned in slurm_10Trinityblastnexampdatacrane.sh ???????????????

02/26/18:
## at ncbi, blast page, support center, down bottom page, 'dnload' blast+, ver 2.71 latest.
## To check ver at HCC ?????

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/p820br9rice9soy38arab26
ls -al

module avail

blast/2.6   ## closest to current 2.7.1  ?????
## megablast ??????????????
## how useful my current slurm files ???????????
## try check with JJ ????

## talked to JJ:
## see pencil comments on two slurm templates
## suggest practice initially from unix command line
## email addr for JJ if want help on custom made format for output from blastn run
## bcrd-support@unl.edu

02/27/18:
# Initially find a dir. on crane to work in, place query & inpuit file there.
# create dir /work/baenziger/pterry/wheatproj/blast131vsiwsgcCDS
# copy query (iwsgc131_CDS_seqs.fa, check if already on crane, NO), & target db (file from 'home' 'shared' dir, /home/baenziger/shared/pterry, iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.zip).


ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
mkdir blast131vsiwgscCDS
cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
## on crane, copy CDS...zip to /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS 
cp  /home/baenziger/shared/pterry/iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.zip .
ls -al
 
unzip iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.zip
rm iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.zip
logout
cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp iwsgc131_CDS_seqs.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blast131vsiwgscCDS

# Try make a makeblastdb slurm to produce 'target db'
# sample slurm file on 'pro' **only**. So scp that file up to crane

# from 'pro'
cd /Users/bterry/macbookpro2015/keenanres15/trintoGSEA/testing/tut
# file to transfer: slurm_8Trinitymakeblastdbexampdatacrane.sh
scp slurm_8Trinitymakeblastdbexampdatacrane.sh pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
# could then scp to mbook to edit

# from mbook:
cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blast131vsiwgscCDS/slurm_8Trinitymakeblastdbexampdatacrane.sh .

02/28/18:
##########################################################################
## NOTE, ABOUT NOON, MBOOK2015 LOCKED UP. PUSHED START BUTTON TO CAUSE IT TO SHUT DOWN.
## SUBSEQUENTLY, DUO ON CELL PHONE CAN'T PERFORM 2ND STEP OF CRANE LOGIN ???????
## NEITHER MBOOK OR 'PRO' WORKS. CAN'T BRING UP THE GREEN CHECK SCREEN ON CELL PHONE ???
## SO PROBLEM BOTH LAPTOPS, THUS PERHAPS CELL PHONE IS PROBLEM ?????? DO APP UPDATE ON CELL PHONE. AFTER APP UPDATE, WORKING AGAIN.
########################################################################
# to do: edit slurm file, slurm_makeblastdb_iwgscCDS.sh

# now, arrange to run this slurm file

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp slurm_makeblastdb_iwgscCDS.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/



ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_makeblastdb_iwgscCDS.sh
ls -lh
sbatch slurm_makeblastdb_iwgscCDS.sh 11994615  1:05pm => ??:??am, 
squeue -u pterry  ## a ST
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          11994615     batch TJob_bla   pterry PD       0:00      1 (Priority)

             
cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -lh
-rw-r--r--  1 pterry amundsen  12037764 Feb 28 13:10 iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.nhr
-rw-r--r--  1 pterry amundsen   1329596 Feb 28 13:10 iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.nin
-rw-r--r--  1 pterry amundsen  34119809 Feb 28 13:10 iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa.nsq
## so 3 new files as expect from makeblastdb

less job.11994615.out
Building a new DB, current time: 02/28/2018 13:10:03
New DB name:   /lustre/work/baenziger/pterry/wheatproj/blast131vsiwgscCDS/iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa
New DB title:  iwgsc_refseqv1.0_HighConf_REPR_CDS_2017Apr03.fa
Sequence type: Nucleotide
Keep MBits: T
Maximum file size: 1000000000B
Adding sequences from FASTA; added 110790 sequences in 5.57137 seconds.
job.11994615.out (END) 

sacct -j  11994615 -o start,end
              Start                 End 
------------------- ------------------- 
2018-02-28T13:10:01 2018-02-28T13:10:10 
2018-02-28T13:10:01 2018-02-28T13:10:10 
13:10:10 - 13:10:01 = 9 sec

## now ready, prepare slurm file for blastn. Use slurm_makeblastdb_iwgscCDS.sh as starting template, new name: slurm_blastn131_iwgscCDS.sh

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp slurm_blastn131_iwgscCDS.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/



ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastn131_iwgscCDS.sh
ls -lh
sbatch slurm_blastn131_iwgscCDS.sh 12001430  6:02pm => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          12001430     batch TJob_bla   pterry PD       0:00      1 (Priority)

sacct -j  12001430 -o start,end
              Start                 End 
------------------- ------------------- 
2018-02-28T18:03:01 2018-02-28T18:03:08 
2018-02-28T18:03:01 2018-02-28T18:03:08 
18:03:08 - 18:03:01 = 7 sec

wc -l iwsgc131_CDS.blastn
131 iwsgc131_CDS.blastn

TraesCS1A01G031600.1    TraesCS1A01G031600.1    100.000 1989    0       0       1       1989
    1       1989    0.0     3674
TraesCS1A01G031700.1    TraesCS1A01G031700.1    100.000 2226    0       0       1       2226
iwsgc131_CDS.blastn 
## 131 seqs in blastn output, as expect if set -max_target_seqs parameter to 1. All 131 have -evalue=1e-20.
## email to vikas, to get comment how would like to prioritize further options.

03/01/18:
## new blastn run, to omit -max_target_seqs parameter (JJ, allows blastn to output up to default number output hits).

## create new slurm, remove -max_target_seqs parameter, allow blastn to output up to default number of hit seqs.

## slurm_blastn131_iwgscCDS_defnohits.sh
## scp to crane

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp slurm_blastn131_iwgscCDS_defnohits.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## run script

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastn131_iwgscCDS.sh
ls -lh
sbatch slurm_blastn131_iwgscCDS_defnohits.sh 12038319  10:30pm => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          12001430     batch TJob_bla   pterry PD       0:00      1 (Priority)

sacct -j  12038319 -o start,end
              Start                 End 
------------------- ------------------- 
2018-03-01T22:30:48 2018-03-01T22:30:55 
2018-03-01T22:30:48 2018-03-01T22:30:55 
22:30:55 - 22:30:48 = 7 sec

cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -al
## **overwrote** prev. iwsgc131_CDS.blastn (should have named iwsgc131_CDS_defnohits.blastn)
wc -l iwsgc131_CDS.blastn
4726 iwsgc131_CDS.blastn  ## only had 131 when '-max_target_seqs parameter to 1'.
less iwsgc131_CDS.blastn
## To do, scp this file back, examine.

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blast131vsiwgscCDS/iwsgc131_CDS_defnohits.blastn .
## open, examine in bbedit
## for example, 1st 22 hits are vs 1st row of the 131 query. evalue = 0.0 for each. Q: bitscore, size varies thru the 22 rows ?????
## more generally, how try analyze this data ???????

03/02/18:
## some ideas for analyzing the data
i) consider evalue 1e-50 as 'matches of very high quality'
ii) in a series of 22 hits for 1st 131 query sequence, all evalues = 0.0. Bitscores vary from 3674 to 652, and '%ident'l matches' varies from 100 to  73.8%.
iii) looks like one could subset gff3 file with the 22 hits here, map the locations, here on chr 1 since all on that chr. Document pattern of location of hits for the 131 query seqs. Or, just take chr 1 location form the name of the hits. Compare the gff3 location of the query sequence with the location pattern for the 22 hits. Are the hits outside the location of the query sequence. Since the evalues are all 0.0, what might this say about RF-like genes?
iv) I note the 22 hits are listed in bitscore or %identity matches order on blastn output sheet. This not in location order on in this case chromosome 1.
v) In view of the preceding, what analyses should one do? For example, what might preceding say about evolution and RF-like sequences?


grep -c "^TraesCS1A01G031600" iwsgc131_CDS_defnohits.blastn  ## 22

grep -c "TraesCS1A01G031600" iwsgc131_CDS_defnohits.blastn  ## 43

## grep the two preceding (check with bbedit, why 2nd not 44)

grep "^TraesCS1A01G031600" iwsgc131_CDS_defnohits.blastn  > TraesCS1A01G031600_22.txt
cut -f1,2,3,4,5,9,11,12 TraesCS1A01G031600_22.txt > out22_8colm.txt
grep "TraesCS1A01G031600" iwsgc131_CDS_defnohits.blastn  > TraesCS1A01G031600_43.txt
cut -f1,2,3,4,5,9,11,12 TraesCS1A01G031600_43.txt > out43_8colm.txt

## for TraesCS1A01G031600.1, member of 131 seqs, all 22 hits are seqs in the 131. Suggests the 131 may be a subset of related seqs within the 110790 seqs in repr_CDS file. AND, subsets of the 131 are *closely* related to each other, but *not* to the whole 131!
## note: orthoMCL finds the 131, but does not subset within the 131.

03/03/18:

## perhaps can list the related *subsets*, & see how their locations are related ?????

## to find:
## Q: any hits in colm2 not in the 131? These may be additional RF-like seqs ????
## perhaps, cut colm 2 out, do sort|uniq, use bash script to subset it with 131 gene names. If not all seqs selected, unselected would be hits not to the 131?

## 1st, need cut colm 2 from iwsgc131_CDS_defnohits.blastn
cut -f2 iwsgc131_CDS_defnohits.blastn > iwsgc131_CDS_defnohits_colm2.blastn

sort iwsgc131_CDS_defnohits_colm2.blastn |uniq | wc -l  ## 148
wc -l iwsgc131_CDS_defnohits_colm2.blastn  ## 4726
# need check which not in 131? Perhaps, 1st, remove '.\d', see if still get 148
cat iwsgc131_CDS_defnohits_colm2.blastn|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 4726 > iwsgc131_CDS_defnohits_colm2nodotd.blastn
sort iwsgc131_CDS_defnohits_colm2nodotd.blastn |uniq | wc -l  ## *still* 148 > 131
sort iwsgc131_CDS_defnohits_colm2nodotd.blastn |uniq > iwsgc131_CDS_defnohits_colm2nodotd_148uniq.blastn

## so did R have a command to find differences between two vectors (setdiff(x,y), anything in x not in y)

## if vector (char vector), use as is ???????????????????????????????????????????????

## to remove \.\d from iwsgc131_CDSnames_minus1stchar.txt (131 rows), 1 of inputs to setdiff
cat iwsgc131_CDSnames_minus1stchar.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 131 > iwsgc131_CDSnames_minus1stchar_minus_dotd.txt

## the other input to setdiff, the 148 seqs, iwsgc131_CDS_defnohits_colm2nodotd_148uniq.blastn

## start R in rstudio

y131 <- read.delim("iwsgc131_CDSnames_minus1stchar_minus_dotd.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("the131"))
class(y131)

x148 <- read.delim("iwsgc131_CDS_defnohits_colm2nodotd_148uniq.blastn", header=FALSE, stringsAsFactors=FALSE, col.names=c("the148"))

class(x)148
#twelve <- setdiff(bluedf$blue, Ofinder_blue)
seventeen <- setdiff(x148$the148,y131$the131)
class(seventeen)
length(seventeen)  ## 12
write.table(seventeen, file="seventeen_newhits.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

## result: list of **17** gene names, appear to be in colm 2 of iwsgc131_CDS_defnohits.blastn, not in colm 1, the query seq names colm of the 131  (tho have not checked all definitively).

03/04/18:

## comments to this point:
i) from blastn run with '-evalue 1e-20', & 'default number of allowable hits per query sequence, found 17 new gene names in column 2 (hits column) not found in column 1 (query genes) using 'sort|uniq'. Note: intended '-evalue 1e-10' this run, but did not get it changed.
ii) will run blastn again using your -evalue 0. Is the following sequence correct, 10 > 0 > 0.01 > 1e-10 > 1e-50 > 0.0? Found URL (http://www.metagenomics.wiki/tools/blast/evalue) indicating value smaller than 0.01 can still be considered good hits for homology matches. This webpage says -evalue smaller than 1e-50 includes database matches of 'very high quality'.
iii) orthoMCL found approx 131 (or 134) RF-like sequences in one (or two) orthogroups. It appears blastn is able to subset these further. The evalues are quite low (0.0, or less than the 1e-50 of the webpage). Fow example, for the 1st query sequence, TraesCS1A01G031600.1, it 'hits' 21 sequences (in this case they are all part of the 131 query sequences). All these evalues are '0.0'. Perhaps one can subset the 131 by for example, removing these 22 as a subset, rerun blastn on remainder, and in this fashion generate related subsets of the 131. The hits are sorted by bitscore (or percent of identical matches) in the blastn output which does not match their location on the chromosome. Possibly by relating location, bitscore, membership in a subset, and later MEME motif, some understanding of evolutionary relationships among these RF-like sequences may be found?

 
## *next*, rerun blastn with 'evalue 0', followed by sort|uniq, count rows. Perhaps, do with evalue 0.01 since not sure what '0' means ?????????????????

## slurm_blastn131_iwgscCDS_defnohits_evdot01.sh
## scp to crane

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp slurm_blastn131_iwgscCDS_defnohits_evdot01.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## run script

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastn131_iwgscCDS_defnohits_evdot01.sh
ls -lh
sbatch slurm_blastn131_iwgscCDS_defnohits_evdot01.sh 12086533  6:58pm => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          12086533     batch TJob_bla   pterry PD       0:00      1 (Priority)

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

sacct -j  12086533 -o start,end
2018-03-04T18:58:30 2018-03-04T18:58:37 
2018-03-04T18:58:30 2018-03-04T18:58:37 
18:58:37 - 18:58:30 = 7 sec

cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -al
## **overwrote** prev. iwsgc131_CDS.blastn (should have named iwsgc131_CDS_defnohits.blastn)
wc -l iwsgc131_CDS_evdot01.blastn
4899 iwsgc131_CDS_evdot01.blastn

less iwsgc131_CDS_evdot01.blastn
## To do, scp this file back, examine.
cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blast131vsiwgscCDS/iwsgc131_CDS_evdot01.blastn .

wc -l iwsgc131_CDS_evdot01.blastn
    4899 iwsgc131_CDS_evdot01.blastn
## 4899 - 4726 = 173 additional rows in blastn output
## 1st, need cut colm 2 from iwsgc131_CDS_evdot01.blastn
cut -f2 iwsgc131_CDS_evdot01.blastn > iwsgc131_CDS_evdot01_col2.blastn
wc -l iwsgc131_CDS_evdot01_col2.blastn
    4899 iwsgc131_CDS_evdot01_col2.blastn

sort iwsgc131_CDS_evdot01_col2.blastn |uniq | wc -l  ## 148

## so, **apparently** none of the additional 173 rows are unique compared to the 148 uniq found when using evalue 1e-20. Looking at a family of proteins, increasing the evalue to 0.01 just allows more hits from the 131 to be detected against the 148. So, the subsets thinking to identify may have additional hits, members? What to think? Anyway, the 17 non131 hits may be all the existing CDS's of this sequenced genome outside the 131?

03/05/18:
# updated github

## talked to vikas
i) subset rows from iwsgc131_CDS_evdot01.blastn using the 17 new hits (seventeen_newhits.txt). cut rows 2-12 from iwsgc131_CDS_evdot01.blastn, then run Philip... to do the subsetting on the 'hits' colm of iwsgc131_CDS_evdot01.blastn
ii) for the 17, locate them in iwsgc annotation file, see if names are PPR proteins?
iii) 1602, 1545, try setdiff these two, identify the 62 seqs by which they differ ??
iv) respond to vikas 'unl box' invitation

## ok, for the subset of iwsgc131_CDS_evdot01.blastn which have one of the 17 in colm 2:
## 1st cut colms 2-12 from iwsgc131_CDS_evdot01.blastn.
cut -f2,3,4,5,6,7,8,9,10,11,12 iwsgc131_CDS_evdot01.blastn > iwsgc131_CDS_evdot01_11colms.blastn

## now set up Philip_iwsgc131_CDScolm2_17subset.sh
## put iwsgc131_CDS_evdot01_11colms.blastn 'inside'.

bash Philip_iwsgc131_CDScolm2_17subset.sh seventeen_newhits.txt > iwsgc131_CDS_evdot01_11colms_17subset.blastn
wc -l iwsgc131_CDS_evdot01_11colms_17subset.blastn
     248 iwsgc131_CDS_evdot01_11colms_17subset.blastn

## could cut colm 11, eyeball for range of evalues
cut -f10 iwsgc131_CDS_evdot01_11colms_17subset.blastn > ev_of17.txt
## smallest see 1e-11 (rest 25 to 30 & smaller). How effectively display the distribution ?? histogram ?? Or, grep lines for each of 17 in turn, see if each has a tight distn, thus conclude variation betw the 17 wi regard to evalue ?????
## or, can one relate queries hitting each of the 17, see some patterns there ????
## perhaps, *next* go to annotation file, see name of each of the 17

# line 2151, annotation file in wheatgff3 dir, iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB

03/06/18:
## copy seventeen_newhits.txt to seventeen_newhits_annotatn.txt. Note: all 17 from chr 1. For the non-PPR, sev'l have **similar** annotation. All non-PPR very close/adjacent to PPR genes. 

## Perhaps see if *relationship* betw. size of evalue & if annotation hit is PPR ??????
## subset each of 17 vs iwsgc131_CDS_evdot01_11colms.blastn, then take mean of evalue colm ??????????
## or, for 1 at time, just try grep ????????
grep "TraesCS1D01G076400" iwsgc131_CDS_evdot01_11colms.blastn  > TraesCS1D01G076400rows.txt

## doc what hit for nonPPR ??  To check: are all these 'response reg' diff. genes ?????

#Subset each of 17 in turn in with Philip_iwsgc131_CDScolm2_17subset.sh in file iwsgc131_CDS_evdot01.blastn. Try correlate query with fcn found in 'annotation' file for 'nonPPR' of the 17?
## now set up Philip_iwsgc131_CDS12colm_17subset.sh
## put iwsgc131_CDS_evdot01.blastn 'inside'.

bash Philip_iwsgc131_CDS12colm_17subset.sh seventeen_newhits.txt > iwsgc131_CDS_evdot01_12colms_17subset.blastn
wc -l iwsgc131_CDS_evdot01_12colms_17subset.blastn
     248 iwsgc131_CDS_evdot01_12colms_17subset.blastn

## now for the 11 of 17 **nonPPR** hits in seventeen_newhits_annotatn.txt in iwsgc131_CDS_evdot01_12colms_17subset.blastn, test what queries hitting them.
--TraesCS1A01G054600, 11 diff. queries hit this, so were the queries PPR seqs, note 'hits' appear to be in cluster of PPR?
--TraesCS1A01G055700, 11 diff. queries hit this, not the same 11 as for TraesCS1A01G054600 above.
--TraesCS1A01G057500, 19 diff. queries hit this
--TraesCS1A01G067100, 8 *diff.* queries hit this
## Next three have same queries in their '23' (Q: but the 'hit' seqs have diff. gene names ??) To check just these in annotation file [**TO DO**]
--TraesCS1B01G074800, 23 *diff* queries hit this
--TraesCS1B01G074900, 23 *diff* queries hit this
--TraesCS1B01G075100, 23 *diff* queries hit this
## Q: if compared genes within the subsets, would there be similar subsets ????? At least the immediate 3 above are the same.
--TraesCS1B01G075400, 6 *diff* queries hit this

--TraesCS1D01G055400, 2 *diff* queries hit this
--TraesCS1D01G056300, 12 *diff* queries hit this
--TraesCS1D01G069200, 20 *diff* queries hit this

## Summary of seventeen_newhits_annotatn.txt: 11 of 17 'nearPPR's'. 8 of these 'response reg' annotation. Similar 'Response reg' distribution thru chroms A, B, D.

03/07/18:
## vikas email response, several misunderstandings need clarification ?????
i) evalues match well, ok
ii) query coverage not checked for the 17 (or subset)?
iii) vicinity, the 11 physically close to annotated PPR genes, but have not checked if close to RF-like genes ?
iv) the 11 have nonPPR annotation ?
v) see seventeen_newhits_annotatn.txt to get overview
vi) show few of the annotation file for the 8 of 11, note, more duplication chrom B, the group of queries hitting 3 are identical!
vi) next ... following preceding 5 parts

## to proceed, 
a) phylogram, with 131 + 6 or more (of 17) + 3 (orthoMCL, 2nd orthogroup). If include (some or all of actually 11 with different annotation) ?????
b) phenogram (whole genome or by chromosome, perhaps both ???)


03/08/18:
## talked to vikas
i) Do check on 0.01 blastn run with 'coverage' calcn, incorporate custom outfmt line from Jean-Jack.
ii) next, run phylogram 131+3+16(?) depending result of (i) ??????
iii) (me), bunch phenograms of various sets of PPRs/RF-like prot. seqs

03/12/18:

## *next*, rerun blastn with 'evalue 0.01', followed by sort|uniq, count rows. This time, change outfmt to '-outfmt "7 qseqid sseqid stitle evalue pident length qlen slen mismatch gapopen qstart qend sstart send bitscore"'.


## slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt7.sh
## scp to crane

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt7.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## run script

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt7.sh
ls -lh
sbatch slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt7.sh 12208753  11:32am => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          12208753     batch TJob_bla   pterry PD       0:00      1 (Priority)


sacct -j  12208753 -o start,end
2018-03-12T12:05:33 2018-03-12T12:05:39 
2018-03-12T12:05:33 2018-03-12T12:05:39 
12:05:39 - 12:05:33 = 6 sec

cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -al
-rw-r--r--  1 pterry amundsen    731966 Mar 12 12:05 iwsgc131_CDS_evdot01_outfmt7.blastn

wc -l iwsgc131_CDS_evdot01_outfmt7.blastn
5555 iwsgc131_CDS_evdot01_outfmt7.blastn  ## ???????????????
#4899 iwsgc131_CDS_evdot01.blastn ## with outfmt6 ????????

less iwsgc131_CDS_evdot01_outfmt7.blastn
## To do, scp this file back, examine.
cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
scp  pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blast131vsiwgscCDS/iwsgc131_CDS_evdot01_outfmt7.blastn .

wc -l iwsgc131_CDS_evdot01_outfmt7.blastn
    5555 iwsgc131_CDS_evdot01_outfmt7.blastn
******************************************************************************
## WOULD PREFER TABULAR outfmt 6 FORMAT, SO TO RERUN WITH 8 CUSTOM FIELDS FOR outfmt 6

## *next*, rerun blastn with 'evalue 0.01', followed by sort|uniq, count rows. This time, change outfmt to '-outfmt "6 qseqid sseqid evalue pident length qlen slen bitscore"'.


## slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt6cust.sh
## scp to crane

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt6cust.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## run script

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt6cust.sh
ls -lh
sbatch slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt6cust.sh 12209624  12:48pm => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

sacct -j  12209624 -o start,end
2018-03-12T12:48:32 2018-03-12T12:48:36 
2018-03-12T12:48:32 2018-03-12T12:48:36 
12:48:36 - 12:48:32 = 4 sec

cd /work/baenziger/pterry/wheatproj/blast131vsiwgscCDS
ls -al
-rw-r--r--  1 pterry amundsen    360860 Mar 12 12:48 iwsgc131_CDS_evdot01_outfmt6cust.blastn

wc -l iwsgc131_CDS_evdot01_outfmt6cust.blastn
4899 iwsgc131_CDS_evdot01_outfmt6cust.blastn

less iwsgc131_CDS_evdot01_outfmt6cust.blastn
## To do, scp this file back, examine.
cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
scp  pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blast131vsiwgscCDS/iwsgc131_CDS_evdot01_outfmt6cust.blastn .

###############################dplyr###########################
## R session
## set dir
setwd("~/macbook2018/vikas18/131RFlike/iwgsc.2to9")
getwd()
## read in iwsgc131_CDS_evdot01_outfmt6cust.blastn
library("dplyr")
blastn01cust6df <- read.delim("iwsgc131_CDS_evdot01_outfmt6cust.blastn", header=FALSE, stringsAsFactors=FALSE, col.names=c("qseqid", "sseqid", "evalue", "pident", "length", "qlen", "slen", "bitscore"))

dim(blastn01cust6df)
View(blastn01cust6df)
head(blastn01cust6df, n=2)

## R code to calc 'fracqryaligned=length/qlen'
frac_qry_targ <- blastn01cust6df %>% select(qseqid,sseqid,evalue,length,qlen,slen) %>% 
  mutate(qryfrac=length/qlen, tarfrac=length/slen) 

dim(frac_qry_targ)
head(frac_qry_targ, n=3)

## write.table frac_qry_targ to file
write.table(frac_qry_targ, file="frac_qry_targ.blastn", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


## perhaps subset rows with qry_frac < 0.50
#filter(starwars, mass > 1000)

frac_qry.50 <- frac_qry_targ %>% filter(qryfrac < 0.50)
dim(frac_qry.50)  ## [1] 2072    8

frac_targ.50 <- frac_qry_targ %>% filter(tarfrac < 0.50)
dim(frac_targ.50)  ## [1] 1887    8

## perhaps check the '16' on these parameters ?????????

## Q: how best to do ??????
## since only 16, perhaps manually in bbedit ????????????

## Q: do I want to look at the data for the hits on the 131 for qryfrac & tarfrac, since many < 0.05  ?????????????????????????

03/15/18:
## talked to vikas yesterday
i) check % coverage for the '17' (over the 131 hits) on blastn with evalue of 0.01, outfmt 6, custom output.
## possible approaches:
a. grep -f seventeen_newhits.txt frac_qry_targ.blastn > targ_17_blastn_hits_248rows.txt
b. 'cat' the 16 files prevly created, they constitute 16 of the 17 rows of 131 qry blastn hits.
c. use like bash script file to subset the 17 new hits from the 3899 frac_qry_targ.blastn file. seventeen_newhits.txt file contains the 'query' file for the task.

03/16/18:

grep -f seventeen_newhits.txt frac_qry_targ.blastn | wc -l  ## 248, same number as Philip_iwsgc131_CDS12colm_17subset.sh when run above.

grep -f seventeen_newhits.txt frac_qry_targ.blastn > targ_17_blastn_hits_248rows.txt

## To do, look at evalue colm, roughly what looks like. Evalues from 09 to 0, only 3 rows at 09. 
Then for the 17 (248 hits), check fraction querys, targets for which length aligned is < 50%? Use dplyr, R.

###############################dplyr###########################
## R session
rm(list=ls())
#
# set dir
setwd("~/macbook2018/vikas18/131RFlike/iwgsc.2to9")
getwd()
## read in targ_17_blastn_hits_248rows.txt
library("dplyr")
blastn01cust6_17_248df <- read.delim("targ_17_blastn_hits_248rows.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("qseqid", "sseqid", "evalue", "length", "qlen", "slen", "qryfrac", "tarfrac"))

dim(blastn01cust6_17_248df)
View(blastn01cust6_17_248df)
head(blastn01cust6_17_248df, n=2)

## perhaps subset rows with qry_frac < 0.50
#filter(starwars, mass > 1000)

frac_qry.50_the17 <- blastn01cust6_17_248df %>% filter(qryfrac < 0.50)
dim(frac_qry.50_the17)  ## [1] 241   8
View(frac_qry.50_the17)
summary(frac_qry.50_the17$qryfrac)
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 0.02899 0.09053 0.15715 0.17108 0.22591 0.48817 
frac_targ.50_the17 <- blastn01cust6_17_248df %>% filter(tarfrac < 0.50)
dim(frac_targ.50_the17)  ## [1] 55  8
View(frac_targ.50_the17)
summary(frac_targ.50_the17$tarfrac)
Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.1149  0.3354  0.3868  0.3818  0.4648  0.4985 

## so, see, 'summary for qryfrac & for tarfrac, for the 241, & 55 rows with coverage fractions < 50%, mean/medians ~ 16%, 38%. 241 of 248 query fractions < 50%.
## WHAT TO THINK ?????????????

ii) initialize box vikas sent(**TO DO**)

iii) send vikas gene names for 131 + 3 + 17 = 151
## prepare a file with these 151 names
## for the 131, could use iwsgc131_CDSnames_minus1stchar.txt for the 131
## for the 3, 
##ref 02/16/18 email to vikas or 02/14/18 above.
To finish analyzing the two orthomcl runs with 4 ctl species, 4 rows of soybean & 3 rows of arabidopsis mapped to orthogroups other than OG5_131220. 6 of these did not also map to a wheat sequence. One, OG5_170290, mapped to three.

TraesCS1A01G060500.1	OG5_170290	osat|NP_001047166	0	-181	48	100
TraesCS1B01G078800.1	OG5_170290	osat|NP_001047166	0	-181	48	100
TraesCS1D01G061400.1	OG5_170290	osat|NP_001047166	0	-181	48	100
A google search of OG5_170290 produces 'Pentatricopeptide repeat'. In PFAM, it hits PF01535 (and 2 others, all say 'PPR repeat'). PF01535 is same pfam hit by OG5_131220.

Note: these additional 3 wheat seqs are in both the 820 'P's & 1545 group, listed above.
 
## finally, the 17. Try get from precursor to seventeen_newhits.txt (want recover '.d' part of each name).

## To try:
cut -f2 targ_17_blastn_hits_248rows.txt > targ_17_blastn_hits_248rows_col2.txt
sort targ_17_blastn_hits_248rows_col2.txt |uniq | wc -l  ## 17
sort targ_17_blastn_hits_248rows_col2.txt |uniq > seventeen_newhits_with.d.txt

## now cat two files, then manually add the three rows (names) above
cat iwsgc131_CDSnames_minus1stchar.txt seventeen_newhits_with.d.txt > iwsgc_131_17_3_151names.d.txt

## vikas email (done)
a. iwsgc_131_17_3_151names.d.txt file (.d form)
b. results for 50% fraction for the 17, for qry, targ vs length

03/17/18:

iv) TO DO: ML phylogram for these 151 prot. seqs following vikas 'notes' file. See 02/16/18 above. Copy 'notes' in .../FRprotseqs/notes_...


1st, need input for muscle MSA, a prot. fasta file.

./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa iwsgc_131_17_3_151names.d.txt > iwsgc151_REPR_PROT_seqs.fa

## 1506 lines, several **very** short proteins ???????????????????????????

## Now run Notes steps ... 

## need new dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir wheat151
cd wheat151
## scp iwsgc151_REPR_PROT_seqs.fa to crane, dir = wheat151
logout
## now for slurm_muscle_wheatproj_wheat151.sh
## cp slurm_muscle_wheatproj_refin131vikas6.sh to slurm_muscle_wheatproj_wheat151.sh
## edit, then scp (done)

cd 
/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp iwsgc151_REPR_PROT_seqs.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/wheat151

scp slurm_muscle_wheatproj_wheat151.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 5991)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/wheat151
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_wheat151.sh
ls -lh
sbatch slurm_muscle_wheatproj_wheat151.sh 12281619 7:07pm => 8:53am, finally done.

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          12281619     batch TJob_mus   pterry PD       0:00      1 (Priority)

cd /work/baenziger/pterry/wheatproj/wheat151
ls -lh

less job.12281619.err
sacct -j  12281619 -o start,end
              Start                 End 
------------------- ------------------- 
2018-03-18T00:30:07 2018-03-18T00:30:41 
2018-03-18T00:30:07 2018-03-18T00:30:41 
00:30:41 - 00:30:07 = 34 sec

less iwsgc151_REPR_PROT_seqs.fa.aln  ## looks to be *in* MSA fasta format.

## next, fasta2stockholm.pl conversion (line 4567)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/wheat151
ls -lh
#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl iwsgc151_REPR_PROT_seqs.fa.aln > iwsgc151_REPR_PROT_seqs.fa.aln.slx
ls -al
#-rw-r--r--  1 pterry amundsen 143768 Mar 18 09:18 iwsgc151_REPR_PROT_seqs.fa.aln.slx
#-rw-r--r--  1 pterry amundsen 3400034 Feb 16 19:28 p820br9rice9soy38arab26.fa.aln.slx

## to check top of stockholm file
less iwsgc151_REPR_PROT_seqs.fa.aln.slx

## now for *hmmbuild*

## see 02/16/18 above (line 6041)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/wheat151
ls -lh

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/wheat151

hmmbuild iwsgc151_REPR_PROT_seqs.fa.aln.hmm iwsgc151_REPR_PROT_seqs.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             iwsgc151_REPR_PROT_seqs.fa.aln.slx
# output HMM file:                  iwsgc151_REPR_PROT_seqs.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     iwsgc151_REPR_PROT_seqs.fa.aln   151   930   794     2.39  0.590 

# CPU time: 2.99u 0.00s 00:00:02.99 Elapsed: 00:00:03.03

exit
less iwsgc151_REPR_PROT_seqs.fa.aln.hmm

#head -n 17 iwsgc151_REPR_PROT_seqs.fa.aln.hmm

STOPPED

## realign using hmm model, hmmalign  (refer 02/16/18, line 6076)
mv slurm_hmmalign_wheatproj_refinorthoMCL131vikas6.sh slurm_hmmalign_wheatproj_wheat151.sh
# see, from dir .../phyml/pyMLorthoMCL131vikas6

## slurm file prepared
cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp slurm_hmmalign_wheatproj_wheat151.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/wheat151
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_wheat151.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_wheat151.sh 12287821  10:26am => ??:??am, 
squeue -u pterry  ## a ST
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
cd /work/baenziger/pterry/wheatproj/wheat151
ls -lh
-rw-r--r-- 1 pterry amundsen 296K Mar 18 10:26 iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln
#-rw-r--r-- 1 pterry amundsen 7.8M Feb 16 22:22 p820br9rice9soy38arab26.fa.aln.hmmaln

sacct -j  12287821 -o start,end
2018-03-18T10:26:07 2018-03-18T10:26:19 
2018-03-18T10:26:07 2018-03-18T10:26:19 
10:26:19 - 10:26:07 = 12 sec

less iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln  ## # STOCKHOLM 1.0 format MSA

## next, stockholm2fasta.pl conversion (line 4653)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/wheat151
ls -al

#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/wheat151
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.fa

ls -al
less iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.fa

grep -c ">Traes" iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.fa  ## 151 as expect
#grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit
#logout

## now fas to phy (line 6141)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/wheat151
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl wheat151
cd wheat151
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/wheat151
module load bioperl

./align_convert_fas_to_phy.pl iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r--  1 pterry amundsen 182730 Mar 18 13:12 iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.phy

exit
less iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.phy
 151 794
'TraesCS1A01G054800.1'  ---------- ---------- ---------- ---------- ---------- ---------- 
logout

## scp back to macbook, (line 6169)

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/wheat151/iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  182730 Mar 18 14:01 iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.phy

less iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.phy

head -n 4 iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.phy
 151 794
'TraesCS1A01G054800.1'  ---------- ---------- ---------- ---------- ---------- ---------- 

## so phy header   151 794, expect the 151

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9/iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT

Name: iwsgc151_REPR_PROT_seqs

The alignment file "iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln.phy" was uploaded, it contains 151 taxons of 794 characters.

Your job was submitted. (2:12pm, sun, 03/18/18)

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20180318-201232_Wu36/cmd.txt

Execution time: 1 hour(s), 9 minute(s)

## Dnloaded from: http://www.atgc-montpellier.fr/phyml/results.php?path=20180318-201232_Wu36/sms.csv

## new location:
/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
/iwsgc151_repr_prot_seqs_fa_aln_hmmaln_phy_phyml.zip

/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9/iwsgc151_repr_prot_seqs_fa_aln_hmmaln_phy_phyml/iwsgc151_repr_prot_seqs_fa_aln_hmmaln_phy_phyml_tree.txt

## to transfer tree file to 'pro'

in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
## Q: should I have inluded any of the other species controls ????????????????

## initial comments of figtree display of file: /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9/iwsgc151_repr_prot_seqs_fa_aln_hmmaln_phy_phyml
/iwsgc151_repr_prot_seqs_fa_aln_hmmaln_phy_phyml_tree.txt

## couple comments for vikas email
a. 15 to 20 very short proteins in the fasta file of the 151 proteins (approximately 60 to 200 aa's)
b. have the phylogram for the 151 proteins in figtree. Looks similar to previous trees with possible RF-like input sequences. Chromosomes 1, 2, 6 clearly subset in the display. A minority of sequences on long branch lengths.

03/19/18:
## script to separate name, seq lines in a fasta file?
## like do 'summary' for the lengths of sequences in 151 protein fasta file?
## checking lengths of the proteins of the 17 in file iwsgc151_REPR_PROT_seqs.fa
## 10 of 17 not annotated as PPR = 64 aa's
## 1 of 17 not annotated as PPR =264
## 5 of 17 annotated as PPR = 263, 392, 303, 342, 363. So borderline or below criterion of 10x35 = 350 aa's.
## 1 not annotated in annotation file = 266
## uploaded iwsgc151_repr_prot_seqs_fa_aln_hmmaln_phy_phyml_tree.txt to vikas 'Box'
## see https://unl.app.box.com/folder/0
## vikas can't access, I note a 'share' button, for moment won't push ??????????????

## to do, upload to github again. Done.

03/25/18:

1st, today, recreate iwsgc_131_17_3_151names.d.txt (made a modifn by mistake)

## now cat two files, then manually add the three rows (names) above
cat iwsgc131_CDSnames_minus1stchar.txt seventeen_newhits_with.d.txt > iwsgc_131_17_3_151names.d.txt

## 3 rows added manually => 151 rows again.
## now create five_17minus12_with.d.txt
cp seventeen_newhits_with.d.txt five_17minus12_with.d.txt
## manually delete 12 rows from five_17minus12_with.d.txt previously agreed, leaving 5 of original 17. (done)
## now, cat 131 + 5
cat iwsgc131_CDSnames_minus1stchar.txt five_17minus12_with.d.txt > iwsgc_131_5_3_139names.d.txt

## then manually add the 3 = 139 (done)

## TO DO: ML phylogram for these potential 139 RF-like prot. seqs following vikas 'notes' file. See 03/17/18 above. Copy 'notes' in .../FRprotseqs/notes_...  (line 6970)

1st, need input for muscle MSA, a prot. fasta file.

./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa iwsgc_131_5_3_139names.d.txt > iwsgc139_REPR_PROT_seqs.fa

## 1467 lines, shortest are 3.
>TraesCS1A01G055500.1 217 aa's
>TraesCS1A01G066500.1 190 aa's
>TraesCS1A01G067500.1 188 aa's

## Now run Notes steps ... 

## need new dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

03/26/18:
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj
mkdir RF139
cd RF139
## scp iwsgc139_REPR_PROT_seqs.fa to crane, dir = RF139
logout
## now for slurm_muscle_wheatproj_RF139.sh
## cp slurm_muscle_wheatproj_wheat151.sh to slurm_muscle_wheatproj_RF139.sh

## edit (done), then scp

cd 
/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp iwsgc139_REPR_PROT_seqs.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/RF139

scp slurm_muscle_wheatproj_RF139.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 7001)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/RF139
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_RF139.sh
ls -lh
sbatch slurm_muscle_wheatproj_RF139.sh 12398498 9:58am => , finally done.

squeue -u pterry  ## a PD

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          12398498     batch TJob_mus   pterry PD       0:00      1 (Priority)

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

## To see, **diff.** way review run time, etc. from QIIME2 workshop ??????

cd /work/baenziger/pterry/wheatproj/RF139
ls -lh

less job.12398498.err
sacct -j  12398498 -o start,end
              Start                 End 
------------------- ------------------- 
2018-03-26T09:59:33 2018-03-26T10:00:03 
2018-03-26T09:59:33 2018-03-26T10:00:03 


less iwsgc139_REPR_PROT_seqs.fa.aln  ## looks to be *in* MSA fasta format.

## next, fasta2stockholm.pl conversion (line 7029)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/RF139
ls -lh
#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl iwsgc139_REPR_PROT_seqs.fa.aln > iwsgc139_REPR_PROT_seqs.fa.aln.slx
ls -al

ls -al
-rw-r--r--  1 pterry amundsen 135124 Mar 26 11:19 iwsgc139_REPR_PROT_seqs.fa.aln.slx
#-rw-r--r--  1 pterry amundsen 143768 Mar 18 09:18 iwsgc151_REPR_PROT_seqs.fa.aln.slx

## to check top of stockholm file
less iwsgc139_REPR_PROT_seqs.fa.aln.slx

## now for *hmmbuild*

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/RF139
ls -lh

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/RF139

hmmbuild iwsgc139_REPR_PROT_seqs.fa.aln.hmm iwsgc139_REPR_PROT_seqs.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             iwsgc139_REPR_PROT_seqs.fa.aln.slx
# output HMM file:                  iwsgc139_REPR_PROT_seqs.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     iwsgc139_REPR_PROT_seqs.fa.aln   139   950   802     1.81  0.591 

# CPU time: 2.56u 0.02s 00:00:02.58 Elapsed: 00:00:02.63
exit
ls -lh
-rw-r--r-- 1 pterry amundsen 366K Mar 26 13:15 iwsgc139_REPR_PROT_seqs.fa.aln.hmm

less iwsgc139_REPR_PROT_seqs.fa.aln.hmm

#head -n 17 iwsgc139_REPR_PROT_seqs.fa.aln.hmm

## realign using hmm model, hmmalign  (refer 03/26/18, line 7086)
## copy slurm_hmmalign_wheatproj_wheat151.sh to slurm_hmmalign_wheatproj_RF139.sh

## slurm file prepared
cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp slurm_hmmalign_wheatproj_RF139.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/RF139
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_RF139.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_RF139.sh 12401484  1:58pm => ??:??am, 
squeue -u pterry  ## a ST
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/RF139
ls -lh
-rw-r--r-- 1 pterry amundsen 273K Mar 26 13:58 iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln
##-rw-r--r-- 1 pterry amundsen 296K Mar 18 10:26 iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln

sacct -j  12401484 -o start,end
              Start                 End 
------------------- ------------------- 
2018-03-26T13:58:20 2018-03-26T13:58:30 
2018-03-26T13:58:20 2018-03-26T13:58:30 

less iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln  ## # STOCKHOLM 1.0 format MSA

## next, stockholm2fasta.pl conversion (line 7117)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/RF139
ls -al

#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/RF139
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.fa

ls -al
less iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.fa

grep -c ">Traes" iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.fa  ## 139 as expect
#grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit
#logout

## now fas to phy (line 7146)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/RF139
ls -al
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl RF139
cd RF139
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/RF139
module load bioperl

./align_convert_fas_to_phy.pl iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.

-rw-r--r--  1 pterry amundsen 169461 Mar 26 19:18 iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.phy

exit
less iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.phy
 139 802
'TraesCS1A01G073700.1'  ---------- ---------- ---------- ---------- ---------- ---------- 
logout

## scp back to macbook, (line 7173)

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/RF139/iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  169461 Mar 26 19:26 iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.phy

less iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.phy

head -n 4 iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.phy
 139 802
'TraesCS1A01G073700.1'  ---------- ---------- ---------- ---------- ---------- ---------- 

## so phy header    139 802, expect the 139

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9/iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT

Name: iwsgc139_REPR_PROT_seqs

The alignment file "iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.phy" was uploaded, it contains 139 taxons of 802 characters.

Your job was submitted. (Mon, 03/26/18, 7:34pm)

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20180327-023402_Ws89/cmd.txt

Execution time: 1 hour(s), 8 minute(s)

## Dnloaded from: 
http://www.atgc-montpellier.fr/phyml/results.php?path=20180327-023402_Ws89/sms.csv

## location of 139 tree file:
/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9/iwsgc139_repr_prot_seqs_fa_aln_hmmaln_phy_phyml/iwsgc139_repr_prot_seqs_fa_aln_hmmaln_phy_phyml_tree.txt


STOPPED
03/27/18:
## to do: transfer to 'pro'. Instead, rather just dnload it from phyml to 'pro' laptop.

in figtree
Initially asked select a name for node values, gave aLRT

 tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 

## initial comments of figtree display of file: 
chroms 1, 2, 6 'mostly' group. Longest branch is a group of 3, on CS1, A, B, & D.

To do, email 'modified tree file, & 'png' file so don't have to take 'pro' to UNL.

## TO DO: the awk pgm to **find** seq lengths of fasta file ?????
## TO DO: **FIX** FOLLOWING PATHs fot the record

/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9/iwsgc151_repr_prot_seqs_fa_aln_hmmaln_phy_phyml
/iwsgc151_repr_prot_seqs_fa_aln_hmmaln_phy_phyml_tree.txt

 


## talked to vikas
1. by Wed, need rmd_wkflow_doc up to date
2. will prepare cartoon overview from
3. intron-exon plot for the 139 (subset gff3)
4. me, awk of fasta lengths for 139 .fa file, 'summary' in R
5. www.wheat-expression.com, browser

## working on wheatflowdocnotestoc4_from_ppointtmp.Rmd
grep -c "!" wheatflowdocnotestoc4_from_ppointtmp.Rmd  ## not working ??????
grep -c "\.png" wheatflowdocnotestoc4_from_ppointtmp.Rmd  ## 26



## update Rmd file, outlining this file. STOPPED (line 7535)
## note, when render, the 'html' file displayed 'IN RSTUDIO' ***has*** captions for images ????  AND, NOW THIS NEW html displayed in firefox now **HAS**
 the captions ?????????????????????????????????

## ok, 
16 images in wheatflowdocnotestoc4_from_ppointtmp.Rmd
19 png in dir .../wheatproj/rmd_wkflowdoc
29 'png' found in wheatflowdocnotestoc4_from_ppointtmp.Rmd
16 '!\[" found by bbedit in wheatflowdocnotestoc4_from_ppointtmp.Rmd

## perhaps, just identify the 'png' for the 16 images, keep only these in dir .../wheatproj/rmd_wkflowdoc ?????????
## then get 'tree' files modified from figtree for these 16 images ???????

## line 2302, 
# bash Philip_realgff3.sh sort147_nodotnum.txt > realbashtofile.gff3
## ran in less than 20 min, 789 rows, Q: should I delete last 3 pattern outputs since no chromosome specified before pass to GSDS display  (or IGV) ?????
## TO prepare for GSDS as this example 

03/28/18:
## talked to vikas
1. run intron discovery on the 139 prot. seqs in 

## to remove '\.\d' from iwsgc_131_5_3_139names.d.txt (139 rows)

## 131 +5 +3 (sorted except last 5+3, so leave like that)
wc -l iwsgc_131_5_3_139names.d.txt  ## 139, **BUT** needed last return after line 139
cat iwsgc_131_5_3_139names.d.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | wc -l  ## 139

cat iwsgc_131_5_3_139names.d.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 139 > iwsgc_131_5_3_139names_minus_dotd.txt
## copy Philip_realgff3.sh from .../wheatgff3 dir to /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9 dir
## check for iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 in .../131RFlike/iwgsc.2to9 dir
## not there, so copy from .../wheatgff3 dir.

03/29/18:
bash Philip_realgff3.sh iwsgc_131_5_3_139names_minus_dotd.txt > 139_131sorted.gff3
## 727 lines, 139 with 'gene'

grep -c "gene" 139_131sorted.gff3  ## 139

grep "gene" 139_131sorted.gff3 > 139_131sorted_gene.gff3

## So (1), submit .../iwgsc.2to9/139_131sorted.gff3 to http://gsds.cbi.pku.edu.cn, request png output (ref line 4788)

## previous file gsds131.png, how got from gsds site ????????????????????????/
## W8BXL5.png
## rename it to gsds139.png
mv W8BXL5.png gsds139.png
## Note: the 4 'indents' are duplicate gene names with '.2' extensions ?????????????
## perhaps they are in the gff3 file, perhaps in one of the 727 lines in 139_131sorted.gff3 file ??????????????????????


## Result: The three long branch seqs in 139 phylogram file are: 
TraesCS1A01G060500
TraesCS1B01G078800
TraesCS1D01G061400
## In gsds139.png, they have **no** introns.

**************************************************************
## ok, trying to get rmd_wkflow_doc dir up to date,
1st, get the 8 'tree' file into the dir with the path to dir. containing the tree file modified by figtree.
## They were:

sec 2.2  2nd => tree file to box, *done*
![Rice9 with 1545 proteins, possible 'P' prots in red](PPRhmmsearchsubset_plus9_clustaltree_coloredPandrice9.png)

sec 2.3.9 3rd => tree file to box, *done*
![829 red and blue](pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors_scrnshot.png)


sec 2.7.9  5th, ONLY ON PRO, SO **NEED** COPY TREE FILE OVER TO mbook rmd_wkflow_doc, before to 'box'
![156_3 seqs](156_3_fa_aln_hmmaln_phy_phyml_tree_copy_bluecolored.png)



sec 2.8.7  6th, APPARENTLY, ONLY ON PRO, SO **NEED** COPY TREE FILE OVER TO mbook rmd_wkflow_doc, before to 'box'
![rice9orthomcl135](rice9orthomcl135_fa_aln_hmmaln_phy_phyml_tree.png)


03/31/18:
sec 2.9.8  7th, APPARENTLY, FIGTREE MODIFIED TREE FILE ONLY ON PRO, SO **NEED** COPY TREE FILE OVER TO mbook rmd_wkflow_doc, before to 'box'
![rice9orthomcl131](rice9orthomcl131_fa_aln_hmmaln_phy_phyml_tree.png)


sec 2.10.7  8th, figtree modified, tree file to box, *done*

![orthomcl131](orthomcl131_fa_aln_hmmaln_phy_phyml_tree.png)


sec 2.12.5  10th, APPARENTLY, FIGTREE MODIFIED TREE FILE ONLY ON PRO, SO **NEED** COPY TREE FILE OVER TO mbook rmd_wkflow_doc, before to 'box'
![131plusvikas6](orthomcl131vikas6_fa_aln_hmmaln_phy_phyml_tree.png)


sec 2.29  16th, figtree modified, tree file to box, *done* ![iwsgc139_repr_prot](iwsgc139_repr_prot_seqs_fa_aln_hmmaln_phy_phyml_tree.png)


## **now, go** in figtree_out_treefiles.txt file, find tree files for these 8 including path to post figtree version. 

## now, go to /Users/bterry/macbook2017/vikas17/wheatproj/rmd_wkflowdoc dir, rename the 4 'original' tree files for which plan bring figtree modified tree files over from 'pro' laptop.
mv 156_3_fa_aln_hmmaln_phy_phyml_tree.txt 156_3_fa_aln_hmmaln_phy_phyml_tree.txt.orig
mv rice9orthomcl135_fa_aln_hmmaln_phy_phyml_tree.txt rice9orthomcl135_fa_aln_hmmaln_phy_phyml_tree.txt.orig

mv rice9orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt rice9orthomcl131_fa_aln_hmmaln_phy_phyml_tree.txt.orig
 
mv orthomcl131vikas6_fa_aln_hmmaln_phy_phyml_tree.txt orthomcl131vikas6_fa_aln_hmmaln_phy_phyml_tree.txt.orig
 
ls -al *.orig  ## check if worked (ok, 4 files listed)

04/01/18:
## Then, copy (email) these 4 tree files over from 'pro' to dir rmd_wkflow_doc. (done)

## **yet** also copy (email) over figtree_out_treefiles.txt into rmd_wkflow_doc dir.

## finally, copy these 4 figtree modified tree files up to the 'box'. (done)

## email vikas with 'key', & Q: when, where phenomics symposium ???????

04/03/18:
talked to vikas
1. prepare sample gsds intron display with 35 input rows. To test if gene names are large enough? Example, try 186 of 727 input lines to GSDS (need split so don't split rows of a gene name across subset files, note that a '.2' gene name occurs along wi its '.1' just at row 186)

04/04/18:
head -n 186 139_131sorted.gff3 > 139_131sorted_sub1st186.gff3
## 139_131sorted.gff3 (727 lines). so want subset 1st 186 lines, submit to gsds.

## So (1), submit .../iwgsc.2to9/139_131sorted_sub1st186.gff3 to http://gsds.cbi.pku.edu.cn, request png output (ref line 7603)

## previous file gsds131.png, how got from gsds site ????????????????????????/
## E6Z54L.png
## rename it to gsds139sub1st186.png
mv E6Z54L.png gsds139sub1st186.png
## Note: the 2 'indents' are duplicate gene names with '.2' extensions ?????????????

04/05/18:
## need check '131' for '.d', is '.2' contained ????
## probably redo GDGS, this time with '.1' rather than just gene name (need be clear on what '.d' am using !!!!!!!!!!!! ????????????/

04/06/18:
## talked to vikas
--proceed wih gsds as did for 1st 186 lines, make 4 images total. For now, just take what got in 139_131sorted_sub1st186.gff3 for 1st image.

139_131sorted.gff3, 2nd image
head -n 364 139_131sorted.gff3 | tail -n 178 > 139_131sorted_sub2nd178.gff3
# check in bbedit that correct rows selected for 2nd image, ok
# 73000 -> 68900
## So (1), submit .../iwgsc.2to9/139_131sorted_sub2nd178.gff3 to http://gsds.cbi.pku.edu.cn, request png output (ref line 7603)
# ## rename it to gsds139sub2nd178.png
**************************************************************
## NOTE: iwgsc_refseqv1.0_HighConf_2017Mar13.gff3 may not be 'REPR' type file, i.e., may list more than one transcript per gene ?????????????

139_131sorted.gff3, 3rd image
head -n 544 139_131sorted.gff3 | tail -n 180 > 139_131sorted_sub3rd180.gff3
# check in bbedit that correct rows (180) selected for 3rd image, ok
# 69100 -> 311600
## So (1), submit .../iwgsc.2to9/139_131sorted_sub3rd180.gff3 to http://gsds.cbi.pku.edu.cn, request png output (ref line 7603)
# ## rename it to gsds139sub3rd180.png

04/07/18:
139_131sorted.gff3, 4th image
tail -n 183 139_131sorted.gff3 > 139_131sorted_sub4th183.gff3
# check in bbedit that correct rows (183) selected for 4th image, ok
# 21200 -> 61400
## So (1), submit .../iwgsc.2to9/139_131sorted_sub4th183.gff3 to http://gsds.cbi.pku.edu.cn, request png output (ref line 7603)
# ## rename it to gsds139sub4th183.png
mv FW5KCI.png gsds139sub4th183.png

## To Do: upload 2nd, 3rd, 4th to the 'box'. Done.
## Note: following file used to subset the '139' genes. Looks like *not* the 'REPR' type file if one exists for '.gff3' this wheat genome.
-rw-r--r--  1 bterry  staff  149076203 Mar  9  2017 iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
 
04/08/18:
# slip a save to ***github*** in here

 2. phenograms (note: omit names *not* mapped to a chromosome)
--all chromosomes
--chr 1
--chr 1, concentrated location for RF-like genes

# ref line 5030, .../phyml/FRprotseqs/
1st task, subset gff3 wheat genome file with these, compare with 727 rows got above.  
##See 03/29/18 above.
-rw-r--r--@ 1 bterry  staff  2916 Mar 28 23:08 iwsgc_131_5_3_139names.d.txt
-rw-r--r--  1 bterry  staff  2638 Mar 28 23:11 iwsgc_131_5_3_139names_minus_dotd.txt
#bash Philip_realgff3.sh iwsgc_131_5_3_139names_minus_dotd.txt > 139_131sorted.gff3
## 727 lines, 139 with 'gene'
## or Philip_5colmgff3.sh
bash Philip_realgff3.sh iwsgc_131_5_3_139names.d.txt > 139_131sorted_dotd_vsfullgff3.gff3
## no **gene** rows
bash Philip_realgff3.sh iwsgc_131_5_3_139names_minus_dotd.txt > 139_131sorted_minusdotd_vsfullgff3.gff3
## 727 rows as above.

bash Philip_5colmgff3.sh iwsgc_131_5_3_139names_minus_dotd.txt > gff3_1345_9names_139.txt
## 139 rows as expect.
## next, how get 'phen_input128.txt' (phen_input131.txt)format?

## now cut colms 1,3  ## Q: will seq names in new colm 3 be a problem ???????????
cut -f 1,3 gff3_1345_9names_139.txt > gff3_cols13_139.txt

## finally, remove 1st 3 char (chr) (each row in gff3_cols13_139.txt with 
cat gff3_cols13_139.txt|perl -pe 's/chr(.+)/\1/' | head -n 139 > gff3_cols13_139nochr.txt


## (from 12/22/17)
## read into R, create 3 colm headers, add a vector, 'RF-like_seq'
## need be in dir /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

setwd("/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9")
colm3 <- rep('RF-like_seq', 139)
class(colm3)
length(colm3)
nchar(colm3)
colm1and2 <- read.delim("gff3_cols13_139nochr.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("chr", "pos"))
phen_input <- data.frame(chr = colm1and2$chr, pos = colm1and2$pos, phenotype = colm3)
dim(phen_input)
head(phen_input, n = 3)
write.table(phen_input, file="phen_input139.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
## remove 3 'U' rows => phen_input136.txt
## Q: do I need to sort phen_input136.txt, the last 8 rows = 5 + 3 rows not sorted ??????
## test sort phen_input136.txt

sort phen_input136.txt |uniq | wc -l  ##     137  as expected if each record in unique. Moved header back to top.
sort phen_input136.txt |uniq > phen_input136sorted.txt
## sorting **not** needed for phenogram pgm

## ready for phenogram plots
## plot all 136, all chromosomes, pheno_gram136.png (input from phen_input136.txt)

## plot chr 1A, 24 genes, from phen_input136.txt -> pheno_gram136_chr1A10to60no_anno.png
## Note: does not give names of genes, did not have names in 3rd colm of phen_input136.txt

05/02/18:
# save github

05/25/18:

# working on updating '.Rmd' file
# lines 7609 to 7725, incorporating 5 gsds139 files
# see /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9 dir
-rw-rw-rw-@ 1 bterry  staff  268185 Mar 29 11:54 gsds139.png
-rw-rw-rw-@ 1 bterry  staff   72930 Apr  4 22:21 gsds139sub1st186.png
-rw-rw-rw-@ 1 bterry  staff   67801 Apr  6 21:31 gsds139sub2nd178.png
-rw-rw-rw-@ 1 bterry  staff   70918 Apr  6 23:49 gsds139sub3rd180.png
-rw-rw-rw-@ 1 bterry  staff   70391 Apr  7 09:17 gsds139sub4th183.png
# none of these 5 are in rmd_wkflow_doc, so copy them over (done)
 
# now for two phenograms (line 7786 & 7788), from dir Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

# plot all 136 (139 minus 3 seqs with no designated chromosome), all chromosomes, pheno_gram136.png (input from phen_input136.txt)
# plot chr 1A, 24 genes, from phen_input136.txt -> pheno_gram136_chr1A10to60no_anno.png
# note: prevly, did single chrom example with all the seq **names**, see 12/26/17.

# working on updating '.Rmd' file
# lines 7786, 7788, incorporating 2 phen136 files in '.Rmd' file. 
# see /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9 dir
-rw-rw-rw-@ 1 bterry  staff   418K Apr  8 22:08 pheno_gram136.png
-rw-rw-rw-@ 1 bterry  staff   220K Apr  8 22:32 pheno_gram136_chr1A10to60no_anno.png

Neither are in rmd_wkflow_doc dir, so copy them there. (done)


05/26/18:

# To get the 11 figtree-modified tree files to treefiles subdir, match figtree_out_treefiles.txt doc with 'box' doc. Add 3 from pro, get these tree files into treefiles dir.

# see figtree_out_treefiles.txt for paths of these files
# fig 1, probably won't use
# fig 2, 1545+9, apparently *not* phyml ????????
# fig 3, 820+9, 
# fig 4, 22plus122plus9, to get from 'pro'  ????????????????
# fig 5, 156_3,
# fig 6, rice9orthomcl135
# fig 7, rice9orthomcl131
# fig 8, orthomcl131
# fig 10, orthomcl131vikas6
# fig 14, p820br9, to get from 'pro'  ????????????????
# fig 15, iwsgc151, to get from 'pro'  ????????????????
# fig 16, iwsgc139,

05/27/18:

# Now, upload the 8 tree files in /Users/bterry/macbook2017/vikas17/wheatproj/rmd_wkflow_doc/treefiles (done)
# Then, upload the 3 tree files still on 'pro' to treefiles folder on 'box' giving a total of 11 files. (done)
# Dnload these 3 files to treefiles dir on mbook (/Users/bterry/macbook2017/vikas17/wheatproj/rmd_wkflow_doc/treefiles) (done)

05/29/18:

# make dupl of rmd_wkflow_doc dir,
# /Users/bterry/macbook2017/rmd_wkflow_doc_052818backup

# remove any tree files from /Users/bterry/macbook2017/vikas17/wheatproj/rmd_wkflow_doc (removed 7, one ended in '.orig')
# deleted listimages.txt
# for now, retain listoftreefiles.txt, JUST NOT USING RIGHT NOW.
# for now, retain oGroups144col1_to_135_nodotnum.txt, JUST NOT USING RIGHT NOW.
# for now, retain ppointtmp.txt, JUST NOT USING RIGHT NOW.
# Note: lot extra files in /Users/bterry/macbook2017/vikas17/wheatproj/rmd_wkflow_doc, FOR NOW, JUST LEAVE, *DON'T* COPY TO 'box' rmd_wkflow_doc folder.

# now, remove any tree files from rmd_wkflow_doc folder in 'box' if any. (removed 8 tree files)

# find 23 image files called in wheatflowdocnotestoc4_from_ppointtmp.Rmd. Copy to 'box' rmd_wkflow_doc folder. (16 left to copy)

# copy .Rmd, .html files to 'box' (https://unl.app.box.com/folder/48208911836)
# wheatflowdocnotestoc4_from_ppointtmp.Rmd
# wheatflowdocnotestoc4_from_ppointtmp.html
 
# *for moment*, retain other extra files from this dir.

# finish figtree_out_treefiles.txt
# copied 3 paths & sizes from ~/macbookpro2018/treefiles_4_10_11.txt file

05/30/18:

# left, *compare* the sizes in the paths with the sizes in the treefiles dir. (done, all match)

# then leave copy figtree_out_treefiles.txt in 'treefiles' dir, both on mbook & box (done)

# perhaps rerun knit for .Rmd file, check html file, make sure all 23 images are present (done, ok)

05/31/18:

06/06/18:
saved to github


STOPPED

# is that all, perhaps cartoon of 'story' in html file

06/16/18:
# working on /.../rmd_wkflow_doc/cartoon_outline_RF_res.pptx

06/18/18:
# wondering why keep the 3 seqs on long phylogram branch in [iwsgc139_repr_prot] (12th tree) in rmd file?

06/28/18:
Trying to learn MEME by studying Yue et al, in Genes 2018 9, 70. Problem: the supplementary file is a '.rar' file.

# from internet:
Mac users should be able to download and use Keka, The Unarchiver, or RAR Extractor Free to unload RAR files.

Another method is to use Unzip-Online, which lets you open RAR files without having any software installed, thanks to the fact that it works through your web browser.

More download links to free RAR extractors can be found in this list of free file extractor programs.

# check HCC, for advice  on opening 'rar' file ??????????????

06/29/18:
# after check adam at hcc, downloaded/installed 'unrar free' from apple app store. Then tried to run with 
/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9/unrarfree/genes-09-00070-s001.rar. Behaves as if opening '.rar' file, but then where is the output ?????????????

06/30/18:
# tried the following online tool, appears to also failed ??????????
https://unzip-online.com/en/Zip

# found refs top my Rmd/html file
# to look for MEME expts there ????????

# Sykes, 2016, p-353, MEME, but don't see any details on its use ?????
# could I use maskfeat to mask out PPR domains, then align & cluster (??) to identify any regions outside PPR domains ????????????????

# barkin & small, ... => lot already known about PPr's

07/02/18:
# email for Kelley: (**done** this date)
--when pub date for wheat genome assembly?
--if delay, would there be a release of annotation version 2 before this pub date ??????

# talked to vikas,
# to try locate RF loci which associated with R (restoration) 
--snp calls, are available
--need groups of lines, R & nonR to compare

07/08/18:
Looking for domains or motifs in a PF-like seq. Following Cheng paper (see reference, top of Rmd file for summarizing data this lab log file), perhaps can use 'P' seq, 1st seq fig 4, p-538 (, do blastp vs one of my RF-like seqs, will it find all the 'P' motifs there ????????
#**********************************************************
Perhaps, the 'Align two or more sequences' choice can align one query vs one subject ???
#***********************************************************
find . -name 'Cheng*' -print  ## ./vikas17/wheatproj/Cheng_et_al-2016-The_Plant_Journal.pdf
# fig 4, PPR-P repeat (1st row). Q: what is the '.' ?? Looks like filling **gap** because of other rows in the figure. So just remove the '.' before a blastp search.

v v T Y N t L I N g y c K s G K I E E A m e L f e E M k e k . G I k P D
# to check, case of 'subject' seq, convert this preceding line to that a candidate 'subject' seq., look in fasta file: 
# so, 
VVTYNTLINGYCKSGKIEEAMELFEEMKEKGIKPD


07/09/18:
# to fine the fasta file, .../vikas18/131RFlike/iwgsc.2to9/iwsgc139_REPR_PROT_seqs.fa

# pick 1st seq, 662/35 = 18.9

>TraesCS1A01G031600.1
MDCCCRACRTDLALAFFGRLLRTGLQAGQVVFNTLLKGLCHTKRADEALDVLLHRMPELG
CTPDVVAYNTVIHGFFREGQVGKACDMFHGMAQKGVMPNVVTYNSVIDGLCKARAMDKAE
TVLSQMVNDGVRPDNVTYNSLIHGYSSLGNWKEAVRVFKEMSRRFTPDVITCTSLMAFLC
KNGKSKEAAEIFDSMAMKGLKRDTVSYAILLHGYATEGCLVDMINLFNSMATDCILPNCH
IFNILINAYAKSGMMGEAMLIFKKMHEQGVSPDVVTYSTVIHAFCKMGSLDIAMDKFNQM
VDMGVRPNAIVYHSLIQGFCTHGDLVKAKELVTEMRNKAMRPPDIKIFHSIMKNLCTEGR
VIEARDILDLMVHIGMRPDVPIFNLLIGGYCLVHKMEDATKMFDDMVSYGLEPCNSTYGI
LINGYCKNGRIDDGLNLFKEMLRKGLKPTTFNYNVILDGLFLAGRTVAAKEKFDEMVESG
VSVCIDTYSIVLGGLCRNNCTGEAITLSKKLSTMNVKFNIAIVNILIGAFFRVRRNQEAK
DLFAAIPANGLVANVVTYSMMMINLIKEGSLEEADDLFLSMEKSGCTADSCMLNHIIRRL
LERGEIVKAGNYMSKVDAKSYSLEAKTVSLLISLFLGKGRYREHMKLLPMKYQFLEEAAT
VE*

# dnloaded file blastp_listbyevalue070918.txt. Note: can display on web in order location on subject, but don't know how dnload in that format ?????

# anyway, following is list locations of hits on subject file:

Range 1: 30 to 64
Range 2: 65 to 99
Range 3: 100 to 134
Range 4: 136 to 168
Range 5: 169 to 203
Range 6: 205 to 238
Range 7: 242 to 273
Range 8: 274 to 308
Range 9: 310 to 342
Range 10: 348 to 379
Range 11: 380 to 413
Range 12: 417 to 448
Range 13: 487 to 517
Range 14: 520 to 551
Range 15: 555 to 589

                            Additional residues  
                              1:29
Range 1: 30 to 64   = 35
Range 2: 65 to 99   = 35
Range 3: 100 to 134   = 35    135 
Range 4: 136 to 168   = 33
Range 5: 169 to 203   = 35     204
Range 6: 205 to 238   = 34    239:241
Range 7: 242 to 273   = 32
Range 8: 274 to 308   = 35    309
Range 9: 310 to 342   = 33    343:347
Range 10: 348 to 379   = 32
Range 11: 380 to 413   = 34   414:416
Range 12: 417 to 448   = 32   449:486 (blast missing 38 residues)
Range 13: 487 to 517   = 31   518:519
Range 14: 520 to 551   = 32   512:514
Range 15: 555 to 589   = 35

# **could** go thru, doc. if considering 'additional residues', can construct 35 aa seqs thru whole seq, TraesCS1A01G031600.1
# result: 3 residues in excess, blast misses 3 motifs ???????

STOPPED

# perhaps accuracy of blastp slightly off. Could **'look'** at places where not seeing '35' lengths & 'additional residues, see if can puzzle out why not seeing all motifs = 35 ?????

#*********************************************************************
look, range 1, note changes in subject from query. So upshot, perhaps best can do is check that 'subject' motifs 'reasonable' compared to query. That is, mutations make alignments in e^-13 to 0.002 for 15 ranges, 38 residues after range 12, and 72 after range 15 not in hit list, but suggest 3 more PPR motifs may be there, total 18 motifs, equal the 18 projected from 662 residue seq with 35 residue motifs plus the 29 residue initial sequence (supposedly mitochondrion finding seq) 
#*************************************************************************

# so, perhaps seq to locate mitochondrion precedes position 30, the 29 residues preceding ??????????????????????????????????
MDCCCRACRTDLALAFFGRLLRTGLQAGQ
# perhaps blastp this vs the 139 seqs in fasta file, see if hits start of each RF-like seq of the 139 seqs ???????????????????????????????????????

# Q: might smartblast help ???????????????????????
# Q: can I group the RF-like seqs by chr 1, 2, 6 as phylogram does using this blastp info  ???????

# saved to github

07/16/18:
# looking into IWGSC RefSeq Annotations (https://wheat-urgi.versailles.inra.fr/Seq-Repository/Annotations), 
# IWGSC RefSeq v1.1 annotation

# Q: https://urgi.versailles.inra.fr/WheatMine/begin.do, what is 'InterMine' ????????
# JBrowse, https://urgi.versailles.inra.fr/jbrowseiwgsc/gmod_jbrowse/?data=myData%2FIWGSC_RefSeq_v1.0&loc=chr1A%3A237605936..356426347&tracks=DNA%2CHighConfidenceGenesv1.1%2CrepeatRegion%2CrepeatMasker%2ClncRNA%2CmiRNA&highlight=

# Q: https://urgi.versailles.inra.fr/download/iwgsc/IWGSC_RefSeq_Annotations/v1.1/ ('genes', 'rnaseq', exacty how use 'rnaseq' file ??????????????????/
 
Dnload: 777ca9dcc04c12e5c92f464321617670	iwgsc_refseqv1.1_genes_2017July06.zip
# currently in Downloads dir.  Put in appropriate dir (/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1)

* to open*, ck md5, they search if still 1602 PPR genes annotated.
# refer line *2395* ??????

.../wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/wheatgff3/iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
#head -n 6 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB > test6.txt

wc -l allcolm5_annotation.txt
  107503 allcolm5_annotation.txt
grep -c "Pentatricopeptide" allcolm5_annotation.txt  ## 1602

07/17/18:

# now try this in iwgsc_refseqv1.1_genes_2017July06.zip
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
md5 iwgsc_refseqv1.1_genes_2017July06.zip 777ca9dcc04c12e5c92f464321617670
# *matches* number above
# unzip, a directory, with 14 files ????????????????

head -n 4 IWGSC_v1.1_HC_20170706_cds.fasta
head -n 4 IWGSC_v1.1_HC_20170706_pep.fasta

# but need a file with the annotation, which ??????

-rwxr-xr-x@  1 bterry  staff  231237082 Jul  6  2017 IWGSC_v1.1_HC_20170706.gff3
-rwxr-xr-x@  1 bterry  staff  225259668 Jul  6  2017 IWGSC_v1.1_HC_20170706.gtf
-rwxr-xr-x@  1 bterry  staff    5539140 May 17  2017 IWGSC_v1.1_HC_20170706.idmapping.csv
-rwxr-xr-x@  1 bterry  staff  197845128 Jul  6  2017 IWGSC_v1.1_HC_20170706_cds.fasta
-rwxr-xr-x@  1 bterry  staff   66503362 Jul  6  2017 IWGSC_v1.1_HC_20170706_pep.fasta
-rwxr-xr-x@  1 bterry  staff  275711825 Jul  6  2017 IWGSC_v1.1_HC_20170706_transcripts.fasta
-rwxr-xr-x@  1 bterry  staff     132338 Jul  6  2017 IWGSC_v1.1_LC.correspondanceTEHC.txt
-rwxr-xr-x@  1 bterry  staff  127144897 Jul  6  2017 IWGSC_v1.1_LC_20170706.gff3
-rwxr-xr-x@  1 bterry  staff   99828748 Jul  6  2017 IWGSC_v1.1_LC_20170706.gtf
-rwxr-xr-x@  1 bterry  staff  118813190 Jul  6  2017 IWGSC_v1.1_LC_20170706_cds.fasta
-rwxr-xr-x@  1 bterry  staff   42417306 Jul  6  2017 IWGSC_v1.1_LC_20170706_pep.fasta
-rwxr-xr-x@  1 bterry  staff  146044299 Jul  6  2017 IWGSC_v1.1_LC_20170706_transcripts.fasta

# Q: diff 'HC' & 'LC' ???????????????????????

# prevly looked in (line 2395) iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB

# has an 'HC', so try that.
head -n 4 IWGSC_v1.1_HC_20170706.gff3
# does not have annotation names ????????
head -n 4 IWGSC_v1.1_HC_20170706.gtf
# does not have annotation names ????????
# try
head -n 4 IWGSC_v1.1_LC_20170706.gtf
# does not have annotation names ????????

# Q: perhaps this iwgsc_refseqv1.1_genes_2017July06.zip does not contain annotation in iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB used prevly ???????????????????????????
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/wheatgff3
head -n 4 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
# has annotation in 5th colm.
wc -l iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
  107502 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB


# talked to vikas, notes:
# 1) check/compare 1.0 gene annotation...zip, 12/06/17 with prev annotation file, number PPR rows
# 2) get rnaseq files

07/18/18:
# 1) The Dec 2017 version for file. Want to check how 1602 Pentatricopeptide rows previously found compares with this apparently newer file.
https://urgi.versailles.inra.fr/download/iwgsc/IWGSC_RefSeq_Annotations/v1.0/ for file iwgsc_refseqv1.0_FunctionalAnnotation_v1.zip
# Expanded file name is:
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/annotation1.0/iwgsc_refseqv1.0_FunctionalAnnotation_v1
 
-rwxr-xr-x@ 1 bterry  staff    117307 Dec  6  2017 README.pdf
-rwxr-xr-x@ 1 bterry  staff  35935545 Apr 21  2017 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
-rwxr-xr-x@ 1 bterry  staff  46988327 Apr 21  2017 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0.TAB
-rwxr-xr-x@ 1 bterry  staff  28684770 Apr 21  2017 iwgsc_refseqv1.0_FunctionalAnnotation_v1__LCgenes_v1.0.TAB

# Looks like the ...TEcleaned.TAB file name matches the previous annotation which found 1602 Pentatricopeptide rows.
# from line 2395
cut -f 5 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB > allcolm5_annotation.txt
## can see much annotation, not PPR
## perhaps search on colm 5 for 'Pentatricopeptide', get a sense if many more than 147 in allcolm5_annotation.txt ??????
wc -l allcolm5_annotation.txt
  107503 allcolm5_annotation.txt
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/annotation1.0/iwgsc_refseqv1.0_FunctionalAnnotation_v1
wc -l iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
#   107502 iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0-repr.TEcleaned.TAB
# **same** as 1602 PPR annotation file working with previously.
  

grep -c "Pentatricopeptide" allcolm5_annotation.txt  ## 1602
# so this new file has **same** number rows with "Pentatricopeptide" as found with previous file.

# Q: but what about the file: iwgsc_refseqv1.0_FunctionalAnnotation_v1__HCgenes_v1.0.TAB ??????????????????

# 2) get rnaseq files
# think at https://urgi.versailles.inra.fr/download/iwgsc/IWGSC_RefSeq_Annotations/v1.1/

47b34ab1d829297c3ac1cc90f9eb27f9	iwgsc_refseqv1.1_rnaseq_mapping_2017July20.zip

philip-terry-2:refseq1.1 bterry$ md5 iwgsc_refseqv1.1_rnaseq_mapping_2017July20.zip

MD5 (iwgsc_refseqv1.1_rnaseq_mapping_2017July20.zip) = 47b34ab1d829297c3ac1cc90f9eb27f9
# so md5 matches.

# investigate what got in the 1.6 Gb ??????????????
 
# talked to vikas:
--forgot to mention paper with PPR motif, that I blastped vs the 1st PR-like seq ??????

--kellye, email, check if annotation file update v1.0 to v1.1 ?????????????

--run original hmmsearch vs new peptide file, 
-rwxr-xr-x@  1 bterry  staff   66503362 Jul  6  2017 IWGSC_v1.1_HC_20170706_pep.fasta
see if still get 1545 hits as did for ver 1.0 (to check for name of that file ??????, (see line 99 above)

--examine new rnaseq directories (gene, transcript)

--check metadata file (for what ?????????)

--note: check plink, subsetting snps within genes ?????????????????

   
07/19/18:
github bkup update

# compare. wc -l
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
-rwxr-xr-x@  1 bterry  staff   66503362 Jul  6  2017 IWGSC_v1.1_HC_20170706_pep.fasta
# with previous hmmsearch which yielded 1545 PPR proteins 


# following, from line 20, above
Sykes, et al., see discussion, p-356, 
## step 1: PPR.hmm on 
iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip
-----------------------------------------------
Contains the protein sequence of all high-confidence (HC) gene models that have been positioned on the IWGSC sequence assembly, without splice variants. Only the representative gene model per locus is given.
#from line 63
unzip iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa.zip
ls -lh
less iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
cd macbook2017/vikas17
find . -name 'iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa' -print
./wheatproj/iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
cd wheatproj/
cd wheatproj/
pwd ## /Users/bterry/macbook2017/vikas17/wheatproj

ls -al iw*03.fa
-rw-r--r--  1 bterry  staff  48634703 Jun 14  2017 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
wc -l iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
  921676 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
grep -c ">Traes" iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
110790
grep -c ">" iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
110790

Now, do for 
-rwxr-xr-x@  1 bterry  staff   66503362 Jul  6  2017 IWGSC_v1.1_HC_20170706_pep.fasta

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/iwgsc_refseqv1.1_genes_2017July06

wc -l IWGSC_v1.1_HC_20170706_pep.fasta
 1049413 IWGSC_v1.1_HC_20170706_pep.fasta

grep -c ">" IWGSC_v1.1_HC_20170706_pep.fasta
133744
grep -c ">Traes" IWGSC_v1.1_HC_20170706_pep.fasta
133744
## so looks like **20,000** more seqs in ver 1.1
head -n 4 IWGSC_v1.1_HC_20170706_pep.fasta
## so looks like **need** do hmmsearch on new prot seqs file ?????????????

# talked to vikas
# prioritize:
--hmmsearch on new 133744 seq wheat prot. seqs, **compare** with prev finding of 1545 ppr seqs.
--to do: weblogo for the 135 after MSA. Then expect 35x?? logos along say 662 aa's of seq.
(weblogo.berkley.edu)
 
STOPPED
07/21/18:
line 107 above
#scp PPR.hmm pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj
cd /Users/bterry/macbook2017/vikas17/wheatproj
-rw-r--r--@ 1 bterry  staff  15607 Jun  2  2017 PPR.hmm
# so, check if this file on crane at that location ???

ssh -Y pterry@crane.unl.edu 
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
ls -lh
# looks like **no** files here, just directories

07/22/18:
# to proceed, refer to line 105 above
# looks like thing to do create new dir, populate it appropriately to conduct this new hmmsearch.

ssh -Y pterry@crane.unl.edu 
# Rrq096mN 
## need scp PPR.hmm to crane
cd /work/baenziger/pterry/wheatproj
# create new dir on crane, 
mkdir hmmsrch_protv1.1
logout

cd /Users/bterry/macbook2017/vikas17/wheatproj
scp PPR.hmm pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1


scp IWGSC_v1.1_HC_20170706_pep.fasta pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1

# ref line 109
ssh -Y pterry@crane.unl.edu 
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1
ls -lh

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
# hmmsearch NB-ARC.hmm Trinity.fasta.transdecoder.pep > hmmsrchshortpep.out
# hmmsearch PPR.hmm iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa > PPR.out
hmmsearch PPR.hmm IWGSC_v1.1_HC_20170706_pep.fasta > PPRv1.1.out
## ran almost *instantly*

ls -lh
#-rw-r--r-- 1 pterry amundsen   6704453 Jun  6 17:14 PPR.out
-rw-r--r-- 1 pterry amundsen 7.8M Jul 22 12:48 PPRv1.1.out

less PPRv1.1.out
wc PPRv1.1.out
 141895  832897 8145244 PPRv1.1.out

# 118172  689922 6704453 PPR.out
exit
# ref line 120
## now what to do with this output ????????

#cd /Users/bterry/macbook2017/vikas17/wheatproj
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/PPRv1.1.out .
#scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/PPR.out .

ls -al
-rw-r--r--   1 bterry  staff    8145244 Jul 22 13:52 PPRv1.1.out

## Hmmer User's Guide, p-21-27, discussing 'hmmsearch' output
## line 8203 (Bdac...)
## note: PPR.out has *no* 'description' colm entries, hmmsrchshortpep.out *does* ????????
## line 8208, ## 3rd colm, 'bias' ...
## line 8210, The next three colms are again an E-value, score, and bias, but only for the **single** best-scoring domain in the sequence, rather than the sum of all its identified domains.
## line 8213, ## So ***operationally***,
if both E-values are significant (<< 1), the sequence is likely to be homologous to your query.

# From 06/12/17:
## Note: p-544, cheng ref., 0.1 for *full*, 100 for *domain* ??????
## Q: few comments:
## PPR.out, line 1540, 'inclusion threshold'
## p-9, sci. reports, RFL genes  >= 10 p-class ppr motifs, (note: sec 2, PPR.out, line 542, # domains < 10) So, should num. domains affect cutoff for hmmsearch hits ?????????????????
## p-533, cheng ref., PPR proteins, 2 to 30 tandem repeats ??????????????
## p-533, cheng ref., PPR.out, line 1562, criteria cutoff, 
(-E 0.1),
(-E 100)

## compare, hmmer doc, p-23, cutoff E-value <= 10.0, catches *all* 1595 lines sec 2, PPR.out 
## hmmer doc, p-24, sec 3, ...

## talked to Vikas, would like to take hits in PPR.out file using cheng, p-544 criterion of 'full' E-value <= 0.1. This line 1562 and above in sec 2.

# For PPRv1.1.out, using this cheng criterion of 'full' E-value <= 0.1, the 1562 last line in PPR.out is 1930 in PPRv1.1.out. So 1930 - 1562 = 368 additional lines (368/1545=23.8%). Q: how many more p-proteins (compared to 820 from PPR.out ??????????????)
# **project** (820/1545 = x/1913, x = 1015, i.e., project 195 more than 820.

## So, to do, start  wi PPRv1.1.out file
i) remove sec 1 above sec 2
## cd /Users/bterry/macbook2017/vikas17/wheatproj
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
head -n 1930 PPRv1.1.out | tail -n 1

ii) get sec 2 rows of PPRv1.1.out, lines 1930 & above
head -n 1930 PPRv1.1.out | tail -n 1914 | head -n 1
head -n 1930 PPRv1.1.out | tail -n 1914 > PPRv1.1sec2_1930.txt

## Left, remove line 1885, 'inclusion threshold' in new file
## try unix commands before doing wi BBedit, remaining, 1913 lines.
head -n 1884 PPRv1.1sec2_1930.txt > top.txt
tail -n 29 PPRv1.1sec2_1930.txt > bottom.txt

cat top.txt bottom.txt > tmp.txt
wc -l tmp.txt  ## expect 1913
    1913 tmp.txt

## examine tmp.txt in BBedit, if line above, below 'inclusion threshold' line ok, (looks good) then
mv tmp.txt PPRv1.1sec2_1930.txt  ## done, now 1913 in length
wc -l PPRv1.1sec2_1930.txt
    1913 PPRv1.1sec2_1930.txt  ## ok, have 10 colms, think will use colm 9, prot names ??

save to github

# next, get 'P' subset of the 1913 from hmmsearch with PPR.hmm

07/24/18:

# from line 174 still going at line 414 (42 RF's, other species ?) line 538, '11', (line 601, 'the 9'), ... to line 675, now have '820' 'P' prot seqs, line 702 (run 'Notes' steps ????
(probably get p subset next, similar to subset of 820 for 1545)

07/29/18:
# ref line 174

## so, try read into **R**, get 'sequence' colm (9) that way ?????????

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
## inside rStudio & R
setwd("/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1")
# line 188
PPRsec2_1930 <- read.delim("PPRv1.1sec2_1930.txt", header=FALSE, stringsAsFactors=FALSE)
dim(PPRsec2_1930)  ## [1] 1545    1   ???????????????????????????????
head(PPRsec2_1930, n=3)
write.table(PPRsec2_1930, file="Testwrite.txt", quote=FALSE, sep="\t", row.names=FALSE) 
# Q: looks like just **skipped** use of R to get tabs as colm separators ????????


#********************************************************************

07/30/18:
# digression: talked to vikas
1) 'Notes' steps on 1913 seqs, no controls
2) 'Notes' steps on 1913 seqs, include 9 rice & 6 vikas control RF-like seqs
3) vikas to email ref for a paper to read.

cat PPRv1.1sec2_1930.txt|perl -pe 's/.+(Traes.+)/\1/'| head -n 3


cat PPRv1.1sec2_1930.txt|perl -pe 's/.+(Traes.+)/\1/'| head -n 1930 > PPRv1.1sec2_1930_Seqscolm.txt
## 1st & last rows look ok.
# Q: ***removed*** the '.d' from each name ??????????????????

sort | uniq | length, see if still have same number as in PPRv1.1sec2_1930.txt (i.e., are there any duplicates)? Name this file PPRv1.1seqnames.txt 

# note, line 1205 is
TraesCS5D02G259395.1  gene=PPRfinder_140


sort PPRv1.1sec2_1930_Seqscolm.txt |uniq | wc -l  ##     ***1746***  ***not*** as expected if each record in unique. Q: might it be that if '.d' extension not removed, that sort/unique would give 1913 ??????????????????
To check ?????????????????????
# To test, take IWGSC_v1.1_HC_20170706_pep.fasta, the input to PPR.hmm, 
head -n 3 IWGSC_v1.1_HC_20170706_pep.fasta
>TraesCS1A02G000100.1 gene=TraesCS1A02G000100
MRVIALSAGVTPSLRIGLPMCKCRSHGTFLLFGLQSSHLNICYYHQDLPRRPLCPGSRPGFCSGRRALLL
IGAWRSSRWPGVGRAL.
# so, each faste seq apparently has both prot name & gene name ???????????
# so try grab colm 9 from PPRv1.1sec2_1930.txt using R (or get the perl -pe to accomplish it)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
## inside rStudio & R
setwd("/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1")
# line 188
PPRv1.1sec2_1930 <- read.delim("PPRv1.1sec2_1930.txt", header=FALSE, stringsAsFactors=FALSE)
dim(PPRv1.1sec2_1930)  ## [1] 1545    1   ???????????????????????????????
head(PPRv1.1sec2_1930, n=3)
# note, bbedit, looks like space character(s) betw colms ????????????????????????????????

write.table(PPRv1.1sec2_1930, file="Testwrite.txt", quote=FALSE, sep="\t", row.names=FALSE)
# Failed ?????????????/

cat PPRv1.1sec2_1930.txt|perl -pe 's/.+(Traes.+\.[0-9]).+/\1/'| head -n 3
TraesCSU02G134400.1
TraesCS6B02G108900.1
TraesCS6A02G081600.4

# got the '.d' colm,  ??????????
# to do, get the whole 1930, colm 9, then check sort|uniq, now see of get 1913 ?????

cat PPRv1.1sec2_1930.txt|perl -pe 's/.+(Traes.+\.[0-9]).+/\1/'| wc -l  ## 1913 as expect
cat PPRv1.1sec2_1930.txt|perl -pe 's/.+(Traes.+\.[0-9]).+/\1/' > PPRv1.1sec2_1930_colm9.txt
wc -l PPRv1.1sec2_1930_colm9.txt
    1913 PPRv1.1sec2_1930_colm9.txt
sort PPRv1.1sec2_1930_colm9.txt |uniq | wc -l  ##     1913
# So, **apparently** 1913 proteins, 1746 genes in PPRv1.1sec2_1930.txt

 
## next use Vikas getsubsetfatofa.awk (getseq.awk) pgm to subset the records selected by 
# hmmsearch PPR.hmm IWGSC_v1.1_HC_20170706_pep.fasta > PPRv1.1.out


1st need copy IWGSC_v1.1_HC_20170706_pep.fasta from dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/iwgsc_refseqv1.1_genes_2017July06
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1

# line 236, now need getseq.awk

07/31/18:

# might **1st** **check** if ver1.0 protein fasta file had both prot **&** gene names ?????????
cd /Users/bterry/macbook2017/vikas17/wheatproj
head -n 3 iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa
>TraesCS1A01G000100.1
MRVIALSAGVTPSLRIGLPMCKCRSHGTFLLFGLQSSHLNICYYHQDLPRRPLCPGSRPG
FCSGRRALLLIGAWRSSRWPGVGRAL*
# so, ver 1.0 ***only*** lists protein name
# ver 1.1 of IWGSC_v1.1_HC_20170706_pep.fasta lists prot name ***&*** gene name.


./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta PPRv1.1sec2_1930_colm9.txt | head -n 3
>TraesCS1A02G023205.1 gene=TraesCS1A02G023205
PVTSASPAPAADDLHAFLRRGLRSRGAVLRAHAFLLRRGLLLGHPVPSGLLLSAAAASXXXXXXXXXXXX
XXLPPPLPLFSLSAALRAVAPRVPFSALLSLFAHLLRAHAPSGFPDAFAFPPLLSAAASARSPRSHLPAA

# Note all the 'X's' ??????????????????????????????????

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta PPRv1.1sec2_1930_colm9.txt > PPRv1.1hmmsearchsubset.fa

wc -l PPRv1.1hmmsearchsubset.fa
   19334 PPRv1.1hmmsearchsubset.fa
#   18284 PPRhmmsearchsubset.fa
#grep -c "^>Tr" PPRhmmsearchsubset.fa   # 1913 as expect
grep -c "^>Tr" PPRv1.1hmmsearchsubset.fa   # 1913 as expect


# compared to 1545 as expect for ver 1.0


# line 631, stopped looking thru to 'Notes', want try muscle **rather** than clustal ?????????
# line 640, 660, figtree colored rows, getseq, 674, 689, muscle
# had to be a MSA above, probably clustal, so, TO DO, substitute with muscle

# talked to vikas, would *like* a protein fasta file in v1.1 with REPR, that is, *not* multiple isoforms for a gene.  Not seeing one from /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/iwgsc_refseqv1.1_genes_2017July06 dir.

So, perhaps subset 1st colm of IWGSC_v1.1_HC_20170706_pep.fasta including the '.d' extension (done, PPRv1.1sec2_1930_colm9.txt)

Sort. Try sort | uniq just to see what happens (above, got 1913 rows)

# now, try sort

sort PPRv1.1sec2_1930_colm9.txt > PPRv1.1sec2_1930_colm9sorted.txt
wc -l PPRv1.1sec2_1930_colm9sorted.txt
    1913 PPRv1.1sec2_1930_colm9sorted.txt

Manually go down thru, see multiply isoforms adjacent. For each set of isoforms, go check 
IWGSC_v1.1_HC_20170706_pep.fasta, determine which longest, delete rest from the colm1 list. 
Note, checked 1st two sets of dupl. gene names in sorted list, '.1' not necessary longest in each set. 1st two sets, **similarity** in lengths within each set. I note some of the seqs are **quite** short.
# So, how to proceed? Given this situation, if would like to take longest in each set, looks like would need examine **each** set. Q: is there way to say graphically examine the sets, to pick longest? Perhaps, check how many sets? If reasonable number, perhaps pick longest manually? Perhaps grep all the prot names in PPRv1.1sec2_1930_colm9sorted.txt wi extension [2-9]?

08/01/18:

grep -c "\.[2-9]" PPRv1.1sec2_1930_colm9sorted.txt  ## 172

# talked to vikas
# suggests go ahead with 'Notes' steps with all 1913 ver1.1 seqs (1913 by self, then 1913 plus 9 (rice) + 6 (vikas6) controls. 
# vikas emailed seqlen.awk script to report length of seqs in fasta file. Could use to report seq length for isoforms in /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/...

08/03/18:

# so lets try it
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
chmod 755 seqlen.awk

# 1st getseq.awk with sorted 1913 prot names

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta PPRv1.1sec2_1930_colm9sorted.txt > PPRv1.1hmmsearchsubset_sorted.fa

wc -l PPRv1.1hmmsearchsubset_sorted.fa
   19334 PPRv1.1hmmsearchsubset_socrted.fa

grep -c "^>Tr" PPRv1.1hmmsearchsubset_sorted.fa   # 1913 as expect

# Now, seqlen.awk 
head -n 22 PPRv1.1hmmsearchsubset_sorted.fa > test_seqlen.fa
./seqlen.awk test_seqlen.fa
TraesCS1A02G023205.1 549
TraesCS1A02G031600.1 784
# to check if these lengths are correct ????????????????????
# they are, Q: the '.' at end of TraesCS1A02G023205.1 ??????????????????

./seqlen.awk PPRv1.1hmmsearchsubset_sorted.fa > PPRv1.1fastaseqlengths.txt
# worked, Q: could subset for longest seq each gene, or subset for some cutoff of sequence length before starting 'Notes steps to produce phylogram of 1913 ????????????????

08/04/18:
# perhaps, cutoff of 29 (leader) + 10*35 = 379  ??????????
# population[order(population$age),]


# start rstudio

#PPRv1.1fastaseqlengths <- read.delim("PPRv1.1fastaseqlengths.txt", header=FALSE, seq="",  stringsAsFactors=FALSE)
Error in read.table(file = file, header = header, sep = sep, quote = quote,  : 
  unused argument (seq = "")

# so try cut, get separate colms of PPRv1.1fastaseqlengths.txt, then read them in individually into R

#cut -d ' ' -f 2 srep35152-s1_tableS1_copy.txt | head -n 42 > NCBIrefcolm.txt
cut -d ' ' -f 1 PPRv1.1fastaseqlengths.txt | wc -l
cut -d ' ' -f 1 PPRv1.1fastaseqlengths.txt > colm1.txt
cut -d ' ' -f 2 PPRv1.1fastaseqlengths.txt > colm2.txt
paste colm1.txt colm2.txt > colms1_2.txt

PPRv1.1fastaseqlengths <- read.delim("colms1_2.txt", header=FALSE,  stringsAsFactors=FALSE)
dim(PPRv1.1fastaseqlengths)
head(PPRv1.1fastaseqlengths, n=3)
PPRv1.1fastaseqlengthssorted <- PPRv1.1fastaseqlengths[order(PPRv1.1fastaseqlengths$V2),]

write.table(PPRv1.1fastaseqlengthssorted, file="PPRv1.1fastaseqlengths_sorted.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

summary(PPRv1.1fastaseqlengths$V2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   99.0   488.0   599.0   603.2   721.0  1562.0 

# So, 1st **233** seqs <= 379 aa's long. Q: should these be excluded from 'Notes steps ??????????
# To start with, apparently not  ????????????????????????????????
# do seq length for '135' RF-like proteins, after 1st 'Notes' steps, do for supposed 'P', 'PLS' subsets of PPR proteins (vs new v1.1 prot fasta file
# so the file with ~135 prot names is iwsgc_131_5_3_139names.d.txt (but check .pptx or html to make sure this producing 12th tree, sec 2.29

# line 7308, check inside file slurm_muscle_wheatproj_RF139.sh, see if input file want to check for length seqs is listed ??????????????????????/

08/05/18:
cd macbook2018/vikas18
find . -name 'slurm_muscle_wheatproj_RF139.sh' -print
./131RFlike/iwgsc.2to9/slurm_muscle_wheatproj_RF139.sh

iwsgc139_REPR_PROT_seqs.fa, file want do seqlen.awk on
copy to /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1

./seqlen.awk iwsgc139_REPR_PROT_seqs.fa > iwsgc139_REPR_PROT_seqs_lengths.txt
# now, sort on 2nd colm

cut -d ' ' -f 1 iwsgc139_REPR_PROT_seqs_lengths.txt | wc -l  ## 139
cut -d ' ' -f 1 iwsgc139_REPR_PROT_seqs_lengths.txt > colm1_139.txt
cut -d ' ' -f 2 iwsgc139_REPR_PROT_seqs_lengths.txt > colm2_139.txt
paste colm1_139.txt colm2_139.txt > colms1_2_139.txt

iwsgc139fastaseqlengths <- read.delim("colms1_2_139.txt", header=FALSE,  stringsAsFactors=FALSE)
dim(iwsgc139fastaseqlengths)
head(iwsgc139fastaseqlengths, n=3)
iwsgc139fastaseqlengthssorted <- iwsgc139fastaseqlengths[order(iwsgc139fastaseqlengths$V2),]

write.table(iwsgc139fastaseqlengthssorted, file="iwsgc139fastaseqlengths_sorted.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

summary(iwsgc139fastaseqlengths$V2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  189.0   381.5   547.0   543.1   715.5   874.0 

# lengths of seqs in iwsgc139fastaseqlengths_sorted.txt range from 189 to 874.
# if were to assign 29 + 350 = 379 as to short to use, 1st 34 woud be eliminated.

# ready go ahead with 'Notes' steps with all 1913 ver1.1 seqs (1913 by self, then 1913 plus 9 (rice) + 6 (vikas6) controls.

# Notes_Alignment_UsingHMMs.txt
cd macbook2017/vikas17
find . -name 'Notes_Alignment_UsingHMMs.txt' -print
./wheatproj/hmmpipeline/FRprotseqs/Notes_Alignment_UsingHMMs.txt

# ref: line 2981, 7277

08/06/18:

## Now run Notes steps ... 

## need new dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

# from 03/26/18:
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1
mkdir Notessteps
cd Notessteps
logout

## scp PPRv1.1hmmsearchsubset.fa to crane, dir = /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps

## now for slurm_muscle_wheatproj_PPRv1.1.sh
## cp slurm_muscle_wheatproj_RF139.sh to slurm_muscle_wheatproj_PPRv1.1.sh

## edit (done), then scp

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1

scp PPRv1.1hmmsearchsubset.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps

scp slurm_muscle_wheatproj_PPRv1.1.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 7001)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if present slurm_muscle_wheatproj_PPRv1.1.sh
ls -lh
sbatch slurm_muscle_wheatproj_PPRv1.1.sh 15503129 2:27pm => , finally done.
logout

squeue -u pterry  ## a PD

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          15503129     batch TJob_mus   pterry PD       0:00      1 (Priority)

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          15503129     batch TJob_mus   pterry  R    6:52:28      1 c1014

# check slurm file, PPRv1.1hmmsearchsubset.fa has 1913 seqs. Looks like may need to rerun with more time requested ???????????????????????????????????
          
cd /Users/bterry/macbook2017/vikas17
find . -name 'slurm_muscle_wheatproj_refin820.sh' -print
./wheatproj/hmmpipeline/FRprotseqs/slurm_muscle_wheatproj_refin820.sh
# ran 1 hr 44 min, line 789

## To see, **diff.** way review run time, etc. from QIIME2 workshop ??????

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
ls -lh

less job.15503129.err  ## Q: lot of '^M' characters ??????????????????/
sacct -j  15503129 -o start,end
              Start                 End 
------------------- ------------------- 
2018-08-06T15:18:41 2018-08-07T02:53:32 
2018-08-06T15:18:41 2018-08-07T02:53:32 
24:00:00 - 15:18:41 = 8hr 42min + 02:53:32 - 0:0:0 = 2hr 52min
# total = 11hr 34min

# Q: how do I know for sure this job finished ?????????????????????

-rw-r--r-- 1 pterry amundsen 9092425 Aug  7 02:53 PPRv1.1hmmsearchsubset.fa.aln
less PPRv1.1hmmsearchsubset.fa.aln  ## looks to be *in* MSA fasta format.
wc -l PPRv1.1hmmsearchsubset.fa.aln
151127 PPRv1.1hmmsearchsubset.fa.aln  

grep -c "^>Tr" PPRv1.1hmmsearchsubset.fa.aln  ## 1913 as expect

# line 7334, next (2nd) step, fasta2stockholm.pl conversion (line 7029)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
#cd /work/baenziger/pterry/wheatproj/RF139
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
ls -lh
#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl PPRv1.1hmmsearchsubset.fa.aln > PPRv1.1hmmsearchsubset.fa.aln.slx
ls -al

-rw-r--r-- 1 pterry amundsen 8897342 Aug  7 12:30 PPRv1.1hmmsearchsubset.fa.aln.slx

## to check top of stockholm file
less PPRv1.1hmmsearchsubset.fa.aln.slx 
# at top is '# STOCKHOLM 1.0'

## now for *hmmbuild* (see line 7357)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
# cd /work/baenziger/pterry/wheatproj/RF139
ls -lh

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps

hmmbuild PPRv1.1hmmsearchsubset.fa.aln.hmm PPRv1.1hmmsearchsubset.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             PPRv1.1hmmsearchsubset.fa.aln.slx
# output HMM file:                  PPRv1.1hmmsearchsubset.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     PPRv1.1hmmsearchsubset.fa.aln  1913  4629   594    18.20  0.590 

# CPU time: 3.82u 0.05s 00:00:03.86 Elapsed: 00:00:03.91
exit
ls -al
-rw-r--r-- 1 pterry amundsen 271K Aug  7 12:48 PPRv1.1hmmsearchsubset.fa.aln.hmm
#-rw-r--r-- 1 pterry amundsen 366K Mar 26 13:15 iwsgc139_REPR_PROT_seqs.fa.aln.hmm

less PPRv1.1hmmsearchsubset.fa.aln.hmm
HMMER3/f [3.1b2 | February 2015]
NAME  PPRv1.1hmmsearchsubset.fa.aln
LENG  594
ALPH  amino

#head -n 17 PPRv1.1hmmsearchsubset.fa.aln.hmm

# ref: line 7391
## realign using hmm model, hmmalign  (refer 03/26/18, line 7086)

cd macbook2018/vikas18
find . -name 'slurm_hmmalign_wheatproj_RF139.sh' -print
./131RFlike/iwgsc.2to9/slurm_hmmalign_wheatproj_RF139.sh

## copy slurm_hmmalign_wheatproj_wheat151.sh to slurm_hmmalign_wheatproj_RF139.sh
## copy slurm_hmmalign_wheatproj_RF139.sh to slurm_hmmalign_wheatproj_PPRv1.1.sh

## slurm file prepared
#cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1

scp slurm_hmmalign_wheatproj_PPRv1.1.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
#cd /work/baenziger/pterry/wheatproj/RF139
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1.sh
ls -lh
sbatch slurm_hmmalign_wheatproj_PPRv1.1.sh 15514302  2:05pm => ??:??am, 

squeue -u pterry  ## a ST
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          15514302     batch TJob_hmm   pterry PD       0:00      1 (Priority)

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
ls -lh
-rw-r--r-- 1 pterry amundsen 273K Mar 26 13:58 iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln
##-rw-r--r-- 1 pterry amundsen 296K Mar 18 10:26 iwsgc151_REPR_PROT_seqs.fa.aln.hmmaln

sacct -j  15514302 -o start,end
              Start                 End 
------------------- ------------------- 
2018-08-07T14:34:25 2018-08-07T14:36:09 
2018-08-07T14:34:25 2018-08-07T14:36:09 
36:09 - 35:25 = 1min 44sec

less PPRv1.1hmmsearchsubset.fa.aln.hmmaln  ## # STOCKHOLM 1.0 format MSA

## ref line 7423, next step, stockholm2fasta.pl conversion (line 7117)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
ls -al

#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g PPRv1.1hmmsearchsubset.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > PPRv1.1hmmsearchsubset.fa.aln.hmmaln.fa

ls -al
less PPRv1.1hmmsearchsubset.fa.aln.hmmaln.fa

grep -c ">Traes" PPRv1.1hmmsearchsubset.fa.aln.hmmaln.fa  ## 1913 as expect
#grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit
#logout

## ref., line 7452, now fas to phy (line 7146)


ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
ls -al
cd ..
cd ..
cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/Notessteps


cd hmmsrch_protv1.1/Notessteps
ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps
module load bioperl

./align_convert_fas_to_phy.pl PPRv1.1hmmsearchsubset.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.

-rw-r--r-- 1 pterry amundsen  1714028 Aug  7 23:40 PPRv1.1hmmsearchsubset.fa.aln.hmmaln.phy
exit
less PPRv1.1hmmsearchsubset.fa.aln.hmmaln.phy

  1913 596
'TraesCS7B02G163000.1'  ---------- ---------- ---------- ---------- --SRLAHRHL PLLLSYATVS
 logout

# ref: line 7480
## scp back to macbook, (line 7173)

#cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/Notessteps/PPRv1.1hmmsearchsubset.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  1714028 Aug  7 23:58 PPRv1.1hmmsearchsubset.fa.aln.hmmaln.phy

less PPRv1.1hmmsearchsubset.fa.aln.hmmaln.phy

head -n 4 PPRv1.1hmmsearchsubset.fa.aln.hmmaln.phy
 1913 596
'TraesCS7B02G163000.1'  ---------- ---------- ---------- ---------- --SRLAHRHL PLLLSYATVS 

## so phy header     1913 596, expect the 1913

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1hmmsearchsubset.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: PPRv1.1hmmsearchsubset_seqs

The alignment file "PPRv1.1hmmsearchsubset.fa.aln.hmmaln.phy" was uploaded, it contains 1913 taxons of 596 characters.

Your You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20180808-071148_Em07/cmd.txt

job was submitted. (Wed, 08/08/18, 12:12am)

#note example, line 6213, a job 1day, 3hrs

08/08/18:
# saved to github

#ref: resume line 7510 for post montpellier analysis

08/09/18:

# done by 11am  (~ 35 hrs)
 Analysis name : pprv1_1hmmsearchsubset_seqs
PhyML results :

    Download (zip format)
    Tree Visualisation

***Unexpected error***
# ??????????????????????????????????????????????????????????????????/
# phyml zip output file **only** has about 10 lines

# from line 613, ran PPRhmmsearchsubset_plus9.fa on clustal omega
# so perhaps try run on https://www.ebi.ac.uk/Tools/msa/clustalo/
the fasta file PPRv1.1hmmsearchsubset.fa 
# I note there limits of 4000 seqs & 4 Mb (I have 1.2 Mb).
# Q: format of file output from phyml (france) ?????????????

# job submitted to https://www.ebi.ac.uk/Tools/msa/clustalo/ 12:40pm.
# Q: when done, is there a way have clustal create phylogram ?????
# Q: file format to use in figtree, prevly did ?????????????????????
# Q: line 629 mentions figtree, so format compatible ????????

# The clustal Omega alignment also has a phylogenetic tree. Try dnload this file on 'pro' laptop, so can display with figtree.
# name PPRv1.1.1913.txt on macbook as /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1.1913.txt
# and on 'pro' as ~/macbookpro2018/PPRv1.1.1913.txt

# displaying in figtree on 'pro', can't tell how to separate phylogram into 'P' & 'PLS' seqs. So, prepare PPRv1.1.1913_plusrice9.fa. Then, run clustal omega, see if these ctl's can indicate which part of phylogram are the 'P' seqs.

# from line 611
# cat PPRhmmsearchsubset.fa FRknownseqs_shtname_9.fa > PPRhmmsearchsubset_plus9.fa
# so, locate FRknownseqs_shtname_9.fa so can cat to PPRv1.1.1913.txt, before next submit to clustal omega MSA & phylogram
# cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
# copied FRknownseqs_shtname_9.fa to /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
# next do the cat
cat PPRv1.1hmmsearchsubset.fa FRknownseqs_shtname_9.fa > PPRv1.1.1913_plusrice9.fa
grep -c ">" PPRv1.1.1913_plusrice9.fa  ## 1922 as expect

# now submit to clustal omega (done 12:44am, 08/10/18)

08/10/18:
# next clustal omega run, "PPRv1.1.1913_plusrice9.fa for 1922 seqs", will 1st dnload to 'pro' for display in figtree.
# Q: what to think of these 'job details' ????????

Job Details
===========

program: clustalo
version: 1.2.4
guidetreeout: false
dismatout: false
dealign: false
mbed: true
mbediteration: true
iterations: 0
gtiterations: -1
hmmiterations: -1
outfmt: clustal_num
order: aligned
stype: protein

grep ">" FRknownseqs_shtname_9.fa  ## to use in figtree

# located at least 6 of 7 'AB' rice ctl's on figtree for PPRv1.1.1913plusrice9.txt 'nexus' (?) file, all 'close' together.
# check for 1st seq, >TraesCS1A01G031600.1, in file iwsgc139_REPR_PROT_seqs.fa. Can't find this single seq, if in phylogram?

# talked to vikas
# when trying to highlight color for figtree phylogram, select 'taxa', not clade.
# for colors, use 3rd on list, from color pallet. 1913 seqs in PPRv1.1hmmsearchsubset.fa, plus seqs 
# if problem coloring 'P' seqs on this phylogram, check wi vikas. **Once** color, can do **checks** on resulting/underlying file to verify what seqs in each section of phylogram. Like check for the 'ctl's, the 139 wheat RF-like seqs, etc.
# to check prev figtree file selected color for, since what doing today not 'marking' seqs like previously ?????????????????????????????????????
#

# next clustal omega, include in fasta file, 1913 seqs in PPRv1.1hmmsearchsubset.fa, plus seqs seqs in p820br9rice9soy38arab26.fa
# so total 1913 + 9 + 9 + 38 + 26 = 1995

# To prepare this fasta file, call it PPRv1.1.1913_br9rice9soy38arab26.fa
need
PPRv1.1hmmsearchsubset.fa
bracky9namesshort.fa
FRknownseqs_shtname_9.fa
soybean41to_ver2names38dot1dotpshort.fa
arab26fujii2011namesshort.fa

08/11/18:

# to access them, place them in a new subdir of /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1
# call it PPRv1.1plus_82ctls (done)
# copy the 4 from /Users/bterry/macbook2018/vikas18/131RFlike/orthomcl

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_82ctls

cat PPRv1.1hmmsearchsubset.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa > PPRv1.1.1913_br9rice9soy38arab26.fa
# 1995 lines

# ref: line 5830
# cat PPRhmmsearchsubset_P_prots820.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa > p820br9rice9soy38arab26.fa

# now ready submit to clustal omega, https://www.ebi.ac.uk/Tools/msa/clustalo
# started, 1:34pm
# dnload result to a file named PPRv1.1.1913plus82ctls.txt (5980 lines) on 'pro' (/Users/bterry/macbookpro2018/PPRv1.1plus_82ctls), also on macbook, at /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_82ctls
# in bbedit, 1913 'Traes' rows, 7 'AB' rows as expect

# THINK FORGOT THE VIKAS6, see line 4514 ??????????????????????????????????????

# displaying on 'pro' figtree, try refer to my prev coloring of figtree phylogram to subset underlying nexus concerning how to accomplish ???????????

# Looking like the 4 sets of controls are in the hypothetical 'P' part of the phylogram, tho may be some of Glyma in 'PLS' part, but just guessing now. So, need 'color' 'P' portion, cause labeling of underlying 'nexus' file like did for 1545 for ver 1.o proteins (see previous logfile steps, as currenty failing to successfully 'mark' 'colored' seqs in figtree ?????????????

# looks like I successfully marked a subset (but not all 'P' ???) of putative 'P' in PPRv1.1.1913plus82ctls.txt file.

# THINK FORGOT THE VIKAS6, see line 4514 ??????????????????????????????????????
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131vikas6

# So get this file (FunctionallyCharacterizedRfs_fasta.txt), (cat to PPRv1.1.1913_br9rice9soy38arab26.fa) in dir 
# so in dir /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls
cat PPRv1.1.1913_br9rice9soy38arab26.fa FunctionallyCharacterizedRfs_fasta.txt > PPRv1.1.1913_br9rice9soy38arab26plusvikas6.fa 
# (so total 88 ctl seqs), 2001 seqs total.

# now ready submit to clustal omega, https://www.ebi.ac.uk/Tools/msa/clustalo PPRv1.1.1913_br9rice9soy38arab26plusvikas6.fa in dir /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls

08/12/18:

# 12:51am, job submitted
# job name: PPRv1.1.1913_br9rice9soy38arab26plusvikas6.fa_88ctls
# nexus file name: PPRv1.1.1913plus88ctls.txt
# dnload also to pro (/Users/bterry/macbookpro2018/PPRv1.1plus_88ctls)
# got figtree to highlight ***mostly*** apparently 'P' seqs while trying to highlight the non-P seqs. ????????????????????????????????????????????
# next try subset the underlying 'nexux' file, check where the 88 ctls are located in attempt to separate the 'P' & 'PLS' seqs ????????????????????????
# 1st 2005 rows in PPRv1.1.1913plus88ctls.txt minus 1st 4 rows are seq names with label for color or not. Should be able to work with this. 

# To do, see my prev work when separating 'P' seqs for ver 1.0 protein seqs ??????
# refer line 640
 
# refer line 640

# Perhaps transfer PPRv1.1.1913plus88ctls1stcolor.txt to box, then to macbook laptop ????? Box is ***'down'*** ?????????????????????
# so used thumbdrive.

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls
# taxlabels, lines 5 thru 2005 in PPRv1.1.1913plus88ctls1stcolor.txt

#cat PPRhmmsearchsubset_plus9_clustaltree_colored_copy | head -n 1560 > PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560
## check number 'Treas' rows, in, '1560' (1545 as expected) in bbedit. Matches number in PPRhmmsearchsubset.fa.

cat PPRv1.1.1913plus88ctls1stcolor.txt | head -n 2005 | tail -n 2001 >  PPRv1.1.1913plus88ctls1stcolor_2001.txt

## check number 'Treas' rows, in, '2001' (1913 as expected) in bbedit. Matches number in PPRv1.1.1913_br9rice9soy38arab26plusvikas6.fa.

# Q: rows in 
-rw-r--r--   1 bterry  staff    68789 Aug 12 14:28 PPRv1.1.1913plus88ctls1stcolor_2001.txt
# ***sorted*** alphabetically by name ????????????????????

# Just looking at since sorted, can see PPRv1.1.1913plus88ctls1stcolor_2001.txt has all 88 ctl seqs as colored, thus ***all*** in putative 'P' seqs.
# Still ***don't*** know if have included some 'PLS' seqs in the red colored seqs ??????????

# now ref, line 648

cat PPRv1.1.1913plus88ctls1stcolor_2001.txt|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 90 | tail -n 10

# now ref, line 652
# cat PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 1560 > PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl
## check number of 'Traes' in bbedit, 1545 as expect.

cat PPRv1.1.1913plus88ctls1stcolor_2001.txt|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 2001 > PPRv1.1.1913plus88ctls1stcolor_2001_aftperl.txt

## check number of 'Traes' in bbedit, 1913 as expect.

# line 655, ## next,
grep "^Traes" PPRv1.1.1913plus88ctls1stcolor_2001_aftperl.txt |  head -n 30

## looks like working, so 

# ref: line 660
#grep "^Traes" PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl > PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560_aftperl_listfile
## 820 rows, matching what expect from number of 'color' rows in PPRhmmsearchsubset_plus9_clustaltree_colored_copy_1560

grep "^Traes" PPRv1.1.1913plus88ctls1stcolor_2001_aftperl.txt > PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile.txt
## 1161 rows, matching what expect from number of 'color' rows in PPRv1.1.1913plus88ctls1stcolor_2001.txt (1249 - 88)

# So, may have 'P' subset (1161) of 1913, or may have ***some*** 'PLS' included ???????
# But, ***all*** 88 ctls in PPRv1.1.1913plus88ctls1stcolor_2001.txt putative 'P' subset.

## check for duplicates (line 663 above)
sort PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile.txt |uniq | wc -l  
##          1161  as expected if each record in unique.

08/13/18:
# slip a save to ***github*** in here

# talked to vikas
# 1) do clustal omega tree with ***just*** the 1913 '>Traes' seqs in PPRv1.1hmmsearchsubset.fa, no ctls. Apparently want to compare phylogram with the preceding ones which each have ctls added.
# 2) take 'P' subset from PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile.txt, presumably just the 1161 'P' seqs from the 1913 in original ver1.1 PPR.hmm output.
# so need to subset original .fa ver1.1 file PPR.hmm output to get .fa file for these 1161.
# then add the 88 ctl seqs, run on clustal, perhaps also phyml, see if all ctls can be viewed in phylogram (if phylogram now simple enough for this purpose ????????)
# get idea if all areas of 'P' seqs 'covered' by ctls ??????????????
# make judgment on how many of the 1161 want to keep as apparent 'P' seqs ?????????

# 3) perhaps try also with apparent 'PLS' seqs. See if added ctls to 'PLS" seqs in clustal phylogram, will they all not map inside 'PLS' group ?????????????????

# ***Figures***: Put two dirs in box today, unl.box.com, 'manuscript' & inside, 'figures'
# concerning figures, from figtree, save as pdf. Then, from preview, 'file/export', format 'tiff', comp = LZW, resol = 300. But need to clarify as not working ok when vikas demonstrating ???????????????????????????????


08/14/18:
# so 1) above,
# /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1hmmsearchsubset.fa, has the 1913 PPR.hmm output  seqs from ver 1.1, IWGSC_v1.1_HC_20170706_pep.fasta (see line 8409)
# submit this file, **no** ctls to clustal omega, https://www.ebi.ac.uk/Tools/msa/clustalo
# subitted, 11:19pm

# job name: PPRv1.1hmmsearchsubset.fa_1913wheat seqs_no_ctls
# to do, dnload to 'pro', name the file: .../PPRv1.1_1913_no_ctls/PPRv1.1.1913_no_ctls.txt
# bbedit shows 1913 rows 'Tr' at start of line.
# now, make a copy, then load this file into figtree,
# Would seem lot **similarity** to previous PPRv1.1.1913pus88ctls.txt in figtree, on 'pro'. For moment, **no** attempt to color any seqs in figtree.
 
# so 2) above, create appropriate fasta file for the 1161 putative 'P' seqs, 
# names of the 1161, get fasta, then add 88 ctls, 
# so file with the 1161 names, PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile.txt
# use getseq.awk 
# see line 8436
# copy IWGSC_v1.1_HC_20170706_pep.fasta from .../annotation1.1 dir.

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile.txt > PPRv1.1_1161_P_seqs_subset.fa
# PPRv1.1_1161_P_seqs_subset.fa has 1161 '>' ('P') seqs as expect

08/15/18:

# next, need append the fasta file for the 88 ctls to PPRv1.1_1161_P_seqs_subset.fa to give 1249 seqs.

copy to .../PPRv1.1plus_88ctls 4 ctl .fa files from .../PPRv1.1plus_82ctls

-rw-r--r--@  1 bterry  staff     6604 Jul  2  2017 FRknownseqs_shtname_9.fa
-rw-r--r--@  1 bterry  staff    14550 Feb 10  2018 arab26fujii2011namesshort.fa
-rw-r--r--@  1 bterry  staff     7305 Feb 10  2018 bracky9namesshort.fa
-rw-r--r--@  1 bterry  staff    21001 Feb 10  2018 soybean41to_ver2names38dot1dotpshort.fa

# 5th ctl file to append is 
FunctionallyCharacterizedRfs_fasta.fa

# ref line 8966
# cat PPRv1.1hmmsearchsubset.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa > PPRv1.1.1913_br9rice9soy38arab26.fa
# 1995 lines

cat PPRv1.1_1161_P_seqs_subset.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa FunctionallyCharacterizedRfs_fasta.fa > PPRv1.1_1161_P_seqs_plus_88ctls.fa

# 1249 rows as expected.

# submit this file, PPRv1.1_1161_P_seqs_plus_88ctls.fa, 1249 seqs to clustal omega, https://www.ebi.ac.uk/Tools/msa/clustalo
# title: PPRv1.1_1161_P_seqs_plus_88ctls.fa_ total_1249seqs
# subitted, 11:20am

# job name: PPRv1.1_1161_P_seqs_plus_88ctls.fa_ total_1249seqs
# to do, dnload to 'pro', name the file: .../PPRv1.1_1161_88ctls/PPRv1.1.1161_88ctls.txt
# bbedit shows 1161 rows 'Tr' at start of line.
# now, make a copy, then load this file into figtree,
# looks like, finding ctls in figtree phylogram, perhaps covering approx. 1/4 of phylogram. Tried find one Traes... seq, cursory look not locating ?????????


# Now, try (3) above, perhaps try also with apparent 'PLS' seqs. See if added ctls to 'PLS" seqs in clustal phylogram, will they all not(?)  map inside 'PLS' group ????????????

# to accomplish, need get the non 'P' seqs from the 1913. Perhaps, the query to grab the 1161 'P' seqs from the 1913 can be 'reversed', try 'grep -v'

# ref line 9051
# grep "^Traes" PPRv1.1.1913plus88ctls1stcolor_2001_aftperl.txt > PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile.txt
## 1161 rows, matching what expect from number of 'color' rows in PPRv1.1.1913plus88ctls1stcolor_2001.txt (1249 - 88)

grep -v "^Traes" PPRv1.1.1913plus88ctls1stcolor_2001_aftperl.txt > PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile_PLS.txt

## 840 rows, matching what expect from number of 'color' rows in PPRv1.1.1913plus88ctls1stcolor_2001.txt (1913 - 1161 = 752+88=840)

PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile_PLS.txt
# next remove 88 ctl rows in this file, new name
PPRv1.1.1913_ls1stcolor_aftperl_listfile_PLS_752.txt

# next perl -pe to remove quotes
cat PPRv1.1.1913_1stcolor_aftperl_listfile_PLS_752.txt|perl -pe 's/.+(Traes.+\d).+/\1/' | head -n 3  ## ok

cat PPRv1.1.1913_1stcolor_aftperl_listfile_PLS_752.txt|perl -pe 's/.+(Traes.+\d).+/\1/' > PPRv1.1_1stcolor_aftperl_752_PLS_seqs.txt
# has 752 as expect

# think getseq.awk vs 1913.fa or orig PPR.hmm output to give .fa of the 752 'PLS' seqs

# ./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta PPRv1.1.1913plus88ctls1stcolor_2001_aftperl_listfile.txt > PPRv1.1_1161_P_seqs_subset.fa
# PPRv1.1_1161_P_seqs_subset.fa has 1161 '>' ('P') seqs as expect

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta PPRv1.1_1stcolor_aftperl_752_PLS_seqs.txt > PPRv1.1_752_PLS_seqs.fa
# PPRv1.1_752_PLS_seqs.fa has 752 '>' ('PLS') seqs as expect


# then append 88 ctls .fa files, give 840 seqs to submit to clustal.

cat PPRv1.1_752_PLS_seqs.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa FunctionallyCharacterizedRfs_fasta.fa > PPRv1.1_752_PLS_seqs.fa_plus_88ctls.fa

# 840 rows as expected.

# submit this file, PPRv1.1_752_PLS_seqs.fa_plus_88ctls.fa, 840 seqs to clustal omega, https://www.ebi.ac.uk/Tools/msa/clustalo
# title: PPRv1.1_752_PLS_seqs.fa_plus_88ctls.fa_total_840_seqs
# submitted, 3:14pm

08/16/18:

# job name: PPRv1.1_752_PLS_seqs.fa_plus_88ctls.fa_total_840_seqs
# to do, dnload to 'pro', name the file: .../PPRv1.1_752_88ctls/PPRv1.1.752_PLS_88ctls.txt
# bbedit shows 752 rows 'Tr' at start of line.
# now, make a copy, then load this file into figtree,
# looks like, finding ctls in figtree phylogram, perhaps covering approx. 1/5 of phylogram.  The ctls on one branch **together**. Tried find one Traes... seq (TreasCS1A02G060500). Note: there are some 'Traes' seqs on branch **with** ctls, for example this one.
# **Comments** from this 752PLS_88ctls phylogram, ctls only in one section, but some 'PLS' (?) in this section also.

08/17/18:
# talked to vikas
1) read wheat genome paper, RF proteins may be described within?
#************************
# v1.1 annotation, how get ?????????????
#******************************	
2) for clustal phylograms prepared, further handling
i) spot check the 'U' in 1913, no ctls, see if in 'red' or 'black' in 1913plus88ctls
3) 'final' phylogram, 1913, no ctls, & 1913plus88ctls
4) 'Traes' in PLSplus88ctls, 'mixed' section, check location on 1913, no ctls
5) in 'figtreetemp' dir on 'box', place 5 clustal phylogram files, & list of ctl names
6) 'labeling', 1913, no ctls phylogram (Q: how to do ??????????????)
7) make phyml phylograms, inputs with fewer seqs ???????


08/19/18:
# eaar7191.full.pdf, science 361 eaar7191 (2018)
# see p-9, 3rd colm, top, RFL = 207, BUT, **no** listing of them?
# distal R1, R3 regions?
# p-9, fig 4C, fig S54, ref 44, 45 (prev new), 165 - 168 (cant't find 166 (?)
# Q: annotation v1.1 mentioned (to list ref where found ??????). Q: how access ??????????
# supplemental, fig S54, Rf1, Rf3, etc., can I get a 'wheat' name for these genes ?????

# summary page, DNA marker platform ???????????????
# now, 'limits' article'
# p-1 
# haploid genome, 1C = ???????//
# 85% repetitive ?????
# coexpression networks
# 14.5 Gb,
# rice, arabidopsis genomes much smaller ????
# transposable elements, families ???????
# p-3 
# 5 million yrs ago
# microRNAs, tRNAs
# 11,000 nuclear inserted mitochondrial DNA segments  ??
# centromeres
# 3rd colm, RefSeq Annotation ***v1.1***
# chr zones R1, R2a, C, R2b, R3 ?????????????????????
# Q: cM/Mb ????????????????
# fig2, ***v1.1***
# fig2a, pseudogenes, large number ???????????????
# chi sq test ????????????
# fig 2b, BUSCO v3, ???????????????????????
# phylogenomic approach, **EXACTLY HOW DONE** ????????????????
# p-4
# triad
# synteny
# p-5
# Atlas of transcription, 
# PCA, 
# distal regions, R1, R3 ?????????????????? (ref to centromere ????????
# global patterns, network, WGCNA ??????, chi sq, 
# p-8
# fig 3g, to look at figtree ***not*** in circular format
# p-9
# gene families, expansion, defn ??????????????????
# PPR, 207, Q: where a ***list*** ????????????????????????
# fertility restoration QTLs in wheat ???????
# ref 44, sykes, ryegrass
# ref 45, melonek, rice
# chr 1, 2, 6, 'fertility-restoration QTLs in wheat, Q: ref paper ????????
# fig S54, 
# ref 131
# ref 164
# ref 165, may be one prevly seen papers ????????
# Rf1, Rf3 restorer genes, map to chr 1,  ???????????????????
# ref 166, CAN'T FIND, ???????????????????, 
# ref 167, Rf4, chr 6
# ref 168, Rf8, 2013 paper, ??????????
# black asterisk, Rf genes (Q: where list of these ????????????????)





08/20/18:
# looking thru ref 167 (2018). p-459, 'penetrance' ???? oligo- ??????
# Q: how useful this approach? Would we do anything like this?
 # looked thru Science 361, eaar6089 (2018), The transcriptional landscape
of polyploid wheat
# looks like **lot interaction** between homoeologs on A, B & D genomes for each of chromosomes 1 thru 7.
 
08/22/18:
# to do, summarize what know of the 207 PPR seqs from Science papers?
# put stuff on 'box'

08/24/18:
# talked to vikas
# compose email to kellye asking about list of 207 RFL genes (p-9, 'limits' paper.
# upload 5 figtree phylogram files to 'box', see 08/17/18 above after do tasks listed there.

08/25/18:
# so in figtree, tried to highlight the 'U' group near putative PLS group in file 1913no ctls, compare/see what group they in in 1913+88ctls, where 'red' colored seqs putative 'P' proteins. Trouble coloring all these green, got lot of them, BUT also a few in putative PLS GROUP, need check back, remove ones not in 'U'.note: looks like could come back for 2nd try, get next group to left, check where they are in 1913+88ctls. Finally, not for sure that all captured by green in RHS two branches in 'U' ???????
  
08/26/18:
# perhaps try whatever prevly did to compare the geen colored seqs for  .../PPRv1.1_1913_no_ctls/1913noctlsgreen.txt on 'pro' with the seqs in 'P' or 'PLS' section derived from of .../PPRv1.1plus_88ctls/PPRv1.1_1913plus88ctls1stcolor.txt.
# possible options:
1) bash Philip_iwsgc131_CDScolm2_17subset.sh (see line 6689)
2) %in%
3) setdiff (ref., for example, line 6604)
# *steps* needed before one of these:
# head, tail, grep green seqs from 1913noctlsgreen.txt
# have seqs for 'PLS' & 'P' seqs in files ...
# see PPRv1.1.1161_88ctls, how get these seq nqmes ?????? (possibly input name to clustal ????)
# see PPRv1.1.752_PLS_88ctls, how get these seq nqmes ?????? (see line 9170, PPRv1.1_752_PLS_seqs.fa_plus_88ctls.fa) Perhaps grep ">Traes" to get 752 'PLS' names ???

# created 'figtreetmp' dir on box at https://unl.app.box.com/folder/52855291477
# think try setup to use %in% to compare 'green' seqs in 1913noctlsgreen.txt with 'P', & 'PLS' seqs in PPRv1.1_1stcolor_aftperl_752_PLS_seqs.txt, line 9160.
# 
# 
.../annotation1.1/PPRv1.1plus_88ctls/PPRv1.1_1stcolor_aftperl_752_PLS_seqs.txt
# has 752 'Tr' seqs, prot. names wi .\d at end.
# need bring over thru box from pro (.../PPRv1.1_1913_no_ctls/1913noctlsgreen.txt) to 
macbook, dir. (.../annotation1.1/PPRv1.1plus_88ctls)
# ok, now, 

08/27/18:
# 49 of 1913noctlsgreen.txt are green color seqs (bbedit)
head -n 1917 1913noctlsgreen.txt | tail -n 1913 > 1913noctlsgreen1917.txt
# ok, 1913 in output file

# ref line 9038
cat 1913noctlsgreen1917.txt|perl -pe 's/.+(Traes.+\d).+color.+/\1/' | head -n 1913 > 1913noctlsgreen_aftperl.txt

grep "^Traes" 1913noctlsgreen_aftperl.txt > 1913noctlsgreen_aftperl_49.txt
# now, just 49 prot names

# ready use with %in% operator
# 1st, with 752 PLS file
# .../annotation1.1/PPRv1.1plus_88ctls/PPRv1.1_1stcolor_aftperl_752_PLS_seqs.txt
# has quote marks, need remove
cat PPRv1.1_1stcolor_aftperl_752_PLS_seqs.txt|perl -pe 's/.+(Traes.+\d).+/\1/' | head -n 752 > PPRv1.1_1stcolor_aftperl_752_PLS_seqs_minusquotes.txt
# got 752 minus quotes
# now for %in%
# start R
rm(list=ls())

PLS752 <- read.delim("PPRv1.1_1stcolor_aftperl_752_PLS_seqs_minusquotes.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("thepls752"))
class(PLS752)
PLS752[1:3,]

gr49 <- read.delim("1913noctlsgreen_aftperl_49.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("green49"))
class(gr49)
#gr49 %in% PLS752
str(gr49)
gr49$green49 %in% PLS752$thepls752
 [1] FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE
[18]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE
[35] FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE

# 18 of 49 from 1913noctlsgreen_aftperl_49.txt are in PPRv1.1_1stcolor_aftperl_752_PLS_seqs_minusquotes.txt
# expected some, BUT this many.
# in figtree, go light up a few of the 49, see where they light up in 1913noctlsgreen.txt
# in 752, but TraesCS3A02G097906.1 in 'green P region'. NOTE: in PPRv1.11913plus88ctls.txt, more branches in 'U' section than in PPRv1.1.1913_no_ctls.txt.
# so, seeing a seq in 'green P section **not** an indicator of if 'P' or 'PLS'.
# perhaps, if 'break' highlighting color **not** using borderline seqs, could use figtree to distinguish P, PLS ????
# yet to test, perhaps do some checking in PPRv1.1.752_PLS_88ctls.txt, mixed section, if Traes seqs in mixed section are in what section in PPRv1.1.1913_no_ctls.txt ?????

# conclusion: phylogram not definitive in cataloging all 'P', 'PLS' seqs, so run following orthoMCL (blast based ??) for 
# 1913+88ctls
# 1913noctls
# compare orthogroup(s) with ctl seqs, the Treas seqs in this orthogroup with seqs from clustal phylogram 'P' seqs.

08/28/18:
# may start wi Rmd html file for where in log file to start to run orthoMCL.

http://orthomcl.org/orthomcl/proteomeUpload.do
# looks like currently, online orthomcl ***not*** available ????????????

08/29/18:
# do a github save


# to do, start rmd file for v1.1 research.


STOPPED

# talked to vikas
# two figtree files to box manuscript dir.
# do orthomcl for all red + 88 ctls (figtree file, 1161 + 88 ctls)
# 207 email (done)
# ctl section of 752 & 88 ctls, the mixed section, color, subset these, get the Treas seq names, see where they locate in 1913+88ctls ??????


08/30/18:
# talked to vikas,
# ***suggested*** to try RF-like seqs on phylogram by looking at non-circular format, look for Treas... seqs close to ctl branches, try build list of relationships of Treas. seqs with these ctl seqs.

09/01/18:
# *to do*, retrieve 752 PLS + 88 ctls .fa file, see what happens when blast wi query pentricopeptide repeat motif present in P-class proteins vs a PLS seq (Cheng, fig 4) near 662 residues in length.

# Query: VVTYNTLINGYCKSGKIEEAMELFEEMKEKGIKPD


09/03/18:
# find 35 aa PPR motif ?????
# line 7943, looks like may have just manually entered this 35 aa PPR motif seq in online blasp manually.

# similar to line 7968, get a PLS seq from 752+88ctls fasta file. The file (see line 9159).

.../PPRv1.1plus_88ctls/PPRv1.1_752_PLS_seqs.fa_plus_88ctls.fa

#py pgm (fastaseqlen.py), get lengths of fasta seqs in this .fa file. Note: currently need hard code output file (done)

# from dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls
#**********************************************************
# Q: note a '.' at end of each sequence ?????????????????
#**********************************************************

# python3 fastaseqlen.py PPRv1.1_752_PLS_seqs.fa_plus_88ctls.fa
# output file: fastaSeqLen752PLSplus88ctls.txt

sort --key=2,2r --key=2n fastaSeqLengths.txt  ## worked
sort --key=2,2 --key=2n fastaSeqLen752PLSplus88ctls.txt  > fastaSeqLen752PLSplus88ctls_sorted.txt

# Not sorting properly ?????????????????????????
# sorting by each digit rather than whole number ?????????????
# perhaps return, sort in R ????????????????
# anyway, about 7 seqs are 662 aa's long. Perhaps pick from one of them for test blastp ???????

TraesCS1D02G234800.1	662  ## PPRv1.1.1913_no_ctls.txt => in 'PLS' grp, near 'top' border wi 'P' ?????
TraesCS1D02G379400.1	662  ## PPRv1.1.1913_no_ctls.txt => in 'PLS' grp, near 'lower' border wi 'P' ?????
TraesCS3B02G123400.1	662  ## PPRv1.1.1913_no_ctls.txt => in 'PLS' grp, near 'top' border wi 'P', farther from 'P' border than 1 of 7 ?????
TraesCS3B02G327900.1	662  ## PPRv1.1.1913_no_ctls.txt => in 'PLS' grp, near 'lower' border wi 'P', to right of 'gap' ?????
TraesCS3D02G292900.1	662  ## PPRv1.1.1913_no_ctls.txt => in 'PLS' grp, near 'lower' border wi 'P', to right of 'gap', near  4 of 7?????
TraesCS6A02G085900.1	662  ## PPRv1.1.1913_no_ctls.txt => in 'PLS' grp, near 'lower' border wi 'P', to right of 'gap', near  5 of 7, but 'higher ?????
TraesCSU02G078000.1	662  ## PPRv1.1.1913_no_ctls.txt => in 'PLS' grp, near 'lower' border wi 'P', to right of 'gap', near  6 of 7, but 'higher ?????

# so check in figtree for one well into middle of putative PLS seqs. 
# pick say 6 or 7 of 7 to blastp, as they are closer to center of 'PLS' section than 1 thru 5 seqs.

Try 1st, 6 of 7, as subject seq 
TraesCS6A02G085900.1
>TraesCS6A02G085900.1 gene=TraesCS6A02G085900
MIRTFQKLLQPTRGPHWASTPLRRFCGRAPAPPAPAGGDIFQWNSAITSHLRGGRVAAARRLFDEMPERN
VFTWNCMISGFVQNRMLADARRAFDAMPARNSVSWAALLTGYARSGRVVEARELFDRMPDRNVVSWNAMM
SGYMRNGMVEQARELFDAMPSRNDVSWLTMISGYIRRRCVHEARELFDRAPSPSTSVCNALLSGYVALGC
LKDAEELFVRMQRRNPVSWNVMITGYARAGRMQVAQSLFDEMPQKDTISRTAIMRGYLQNGDVDASWKVF
EEMPDRDAIAWNTMIGGFVQSERVDDALRLFAEMPNRDLVSWNTILQGYVQQGDMASANTWFRRMPEKDE
TSWNTLISGYKDEGALALLSEMTRGGLRPNQATLSVVISICASLVALGCGKMVHLCAVKTGFERDALVMS
SLISMYSKCGLIAEASQVFELMLQRDTVTWNAMIATYAYHGMAAEALKLFHKMTEDGFRPDHATFLSVLS
SCAHKGYLYEGCRYFRSMQEDWNLIPRSDHYSCMVDLLGRSGFVHQAYAFTRKIPSDLQVNAWETLFSAC
NAHGDVQLGEVIAKNVLQAQPSDGGMYTLLANLYAAKEMWSSAANVRGFMKEQGLKKETGCSWVELKGEV
VSFSSNDNTHPLIDQICQEVDNLSVMIEGAM.

# now, ready for blastp
 
# getting e-09 to 0.016, 13 hits/ranges. Prevly with a RF-like 'subject, got 0.002 to e-23.
#***************************************************
# Q: could one subset 'P', 'PLS' by difference in blastp e-values ??????? That is, sep 'P' from 'PLS' but perhaps can't sep 'P' from RF-like ??????????
# perhaps, test few RF-like, & more of the 7 above for PLS group. See if can distinguish 'P', 'PLS' by blastp e-values.

# Follow Vikas suggestion document phylogram tree branches near the 88 RF-like ctls in figtree for file .../PPRv1.1plus_88ctls/PPRv1.1.1913pluss88ctls1stcolor.txt to try identify RF-like values in the 1913 seqs.
# Q: or perhaps use 'orig' file if any problem with this colored one ???????
#************************************************************

09/04/18:
# line 7947, from .../vikas18/131RFlike/iwgsc.2to9/iwsgc139_REPR_PROT_seqs.fa, pick say 3 more seqs in addition to the 1st seq (refer line 7951). Q: should I try select for length also? Perhaps don't worry as long as reasonably sized?
# so', say 50th seq
>TraesCS1B01G092500.1
MARLCFTTPMPHLRRRYSSFTSPPSRRWDPRPAFAAATERVRAGTLSPEDAHHLFDELLL
QANPVPERSLNGFLAALARAPSSATLRDGPSLALALFNRVCREEAGPPVAPPTVRTYNIL
MDSCCRARRPDLGLAFFGRFLRAGLKVNLIVASTLLKCLCHARRTDEAVNMLLHRMSEFG
CVPDAISYSIVLKGLCDNSRSQQALDLLQMVRKGGACSLSVVAYSIIIHGFFKEGEVSKA
CNLFHEMMQQGVVPDVVTYSSIIDALCKVRAMDKAKLVLQQMVNNGVRPNMYTWNSFMYS
LCKHGRSKEAAEFFNSMTAKGLKPDIVAYSTLLHGYATEGCLTDMINFFNSMERNGIVAN
CKVFTILIDGYAKCGMTDEAMLIFTKMQEQGVSPNVFTYAIVTAALCRMGRLSDAMEKLN
EMIAMGLQPNKVVYHSLIQVFCTHGDLVKAKALVSEMMNKGIPRPNIVFFNSVINSLCKE
GRVTDAHDIFDLAINIGERPDVITFNSLIDGYCLAGKMDKAFGVLDAMVSSGIEPNVVTY
NTLVGGYSRNGRIDDGLTLFREMMHIKIKPTTATYGAILHGLFRAGRTFSAKKMFNEMIE
SGTTVNISIYAIILGGLCRNNCVDEAIVLFEKLGAMNVKLDVGIFNTMINAMYAVKGREE
AEDLFAAISANGLVPNASSYGVMITNLLREGLVEEADNMFSSMDKSGCAPSSRLLNNIIR
MLLEKGEISKAGNYMSKVDGKNISLEASTTSLLLSLFSREGKYREQIKLLPAKYQFFDGS
SHS*
# 17 hits, e-12 to 0.13

# and 100th seq
>TraesCS2D01G532600.1
MPTGRLSSIFTSNATSSFRAPSPQPRAPLAALAAATERVRAGTLSRQDAHHLFDELLSQA
ATVPVRTLNNFLAALARAPPSAACGDGPALAIALFNRMSQGAGARVVSPTLCTYSILMDC
CCRAGRPDLVVAFFGRLIRLGLRLNVIPFNNLLKGLCKAKRSNEALDLLLHRMPELDCAP
DVFSYSIVINGCFKEGEVDKACNLFHGMIQLGVQPNVVIYTSIIDALSKCGAMDKAEVVF
RQMVDKGIGPDVMTCTSLIHGYSISGRWKAAVRVFKEMISLGVVPDTVMWNSFVDSLCKH
RRTKEARVIFDSMAAKGQKPDTVSYSIMLNGYVKEGCFDDMTGLFNSMLQNGVVPNHHIF
NILINAYAKRGLMDEAMHMFEVMRQQGVNPDVVDYLVVMDSLCKMGRMDAALDKFNQMVN
QGVSPNKAVYQCLVLGFCSHGDFVKAKELISETINRGLCSNNVFFYPVINDLCKEGKVKE
AQDMFDFIVGIGQRPDVIMYNSLMDGYCLVGKVEEALRVLDAMKSAGLQPDAITYAILLN
GYCKIGRIADGLSLFREMSLSGVKPTTIMYSIILDGLFRSGRTVSAKEKFNTMVESGLPV
DVRTYNIVLHGLCRNNCTGEAIELFKKLCATNVKINVITFNTMISAMFKTRRIGEAKDLF
ATISAIGLVPSVVTYSVMTTNFIKEGLLAEADDMFLAMEKAGCAPNSRLLNHVVRVLLEN
GAVVKAATYLAKLDAKQLSLEASTVSLIVSLFSRKGKLREHVKLLPVKYQPPEMLD*
# 15 hits, e-13 to 0.003

# and 139th
>TraesCSU01G090200.1
MSGHFVPVDRRILEQNIKARYHAGDIGTEDALHLFDELLQCAGSSSIRAINYLVTTVGRD
SPALGVSLFNRVASANVAPNSMTYTILVDCCCRAGRLDLGFAAMGHIIKMGFAADAIVTF
SHLLKAICAEKKTSYAMDIVLRIMPMFNCVPDNFSYNILFKGLCNERRSQEALELIHMMV
QHGGSCQPNVVSYNTVVDGLLKEGEVGKAYTLFSEMLRQGISPDVVTCTSIISGMCKVHA
MDKAEEVLQQMLDRRILPDAATYNCLIHGYYLLGQCEEVDRIFKEMSRNGVQPNIVTYNI
QMDYLCKSGRCAEARKIFDSMIGLGQKPVVTTYSILLHGYAMEKSFHDMHCLIDLMVENG
IAPNHPVYNILISACAQEEMVSEVMHIFTKMRQQGLNPNVANYGVVVNLLSRIGRMDDAM
SLFNQMITEGLAPDIIVFTPPY*
# 10 hits, e-11 to 0.022

# So looks like seq blasp'd previously had smallest e-value. The latter 3 today not significantly different from the one 'PLS' (?) seq prevly blastp'd ????

# Can try blastp couple more of the putative 'PLS' seqs, just to see what get ????
# 7 of 7

>TraesCSU02G078000.1 gene=TraesCSU02G078000
MIRTFQKLLQPTHGPHRASAPLRRFCRRAPAPPSPAGGDIFQWNSAITAHLRAGRVAAARQLFDEMPERN
VFTWNCMISGFVQNRMLADARRAFDAMPGRNSVSWAALLTGYARSGRVAEARELFDRMPDRNMVSWNAMM
SGYTRNGMAEQARELFDAMPARNDVSWLTMISGYIRRRRVREARELFDRAPSPSTSVCNALLSGYIALGC
LKDAEELFGRMQRRNPVSWNVMITGYARAGRMQVAQSLFDEMPQKDTISRTAIMRGYLQNGDVDASWKVF
QEMPDRDAVAWNTMIGGFVQSERVDDALRLFAEMPNRDLVSWNTILQGYVQQGDMASANTWFRRMPEKDE
TSWNTLISGYKDEGALALLSEMTRGGLRPNQATLSVVISICASLVALGCGKMVHLCAVKTGFERDALVMS
SLISMYSKCGLISEASQVFELMLQRDTVTWNAMIATYAYHGMAAEALKLFDKMTEDGFRPDHATFLSVLS
SCAHKGYLYEGCRYFRSMQEDWNLIPRSDHYSCMVDLLGRSGFVHQAYAFTRKIPSDLQVNAWETLFSAC
NAHGDVQLGEVIAKNVLQAQPPDGGMYTLLANLYAAKEMWSSAANVRGFMKEQGLKKETGCSWVELKGEV
VSFSSNDNTHPLIDQICQEVDNLSVMIEGAT
# 13 hits, e-09 to 0.049

#**************************************************************
# So conclusion, can't use blastp e-values to distinguish 'P' from 'PLS' seqs ???????
#****************************************************************
 
# so on 'pro', on to trying to identify RF-like seqs, 1st, color rice ctls in .../PPRv1.1plus_88ctls/PPRv1.1.1913pluss88ctls_color_riceRF.txt by their relation to ctls in figtree. Use non-circular display for this purpose.

# so working on 'pro' with figtree, 

09/05/18:
# result: 12 of the 16 are in the .fa file. RECHECKED SINCE NEED CONVERT BETW '01G' & '02G' 1st. 

# next, check for AT (arabidopsis ctls)
# so on 'pro', on to trying to identify RF-like seqs, 1st, color rice ctls in .../PPRv1.1plus_88ctls/PPRv1.1.1913pluss88ctls_color_Arab.txt by their relation to ctls in figtree.
# looks like perhaps 3 locations in figtree, all in putative 'P' section of phylogram. 
# Q: why 'Q76...' lighting up (its in the rice branch) with 'AT'  ?????????????????????
# so Arab 'AT' ctls *not* all grouped as were rice ctls.
# **to check**	 closest Treas seqs 

# looks like 23 arab, glyma ctls on same branch

09/06/18:

# next, check for BRAD (?? ctls)
# so on 'pro', on to trying to identify RF-like seqs, 1st, color BRAD ctls in .../PPRv1.1plus_88ctls/PPRv1.1.1913pluss88ctls_color_BRAD.txt by their relation to ctls in figtree.

# looks like 3 locations for the 9 BRAD seqs in phylogram
# a singleton, a 6-mer, & a 2-mer, total = 9

# next, check for Glyma, soybean ctls
# so on 'pro', on to trying to identify RF-like seqs, 1st, color Glyma ctls in .../PPRv1.1plus_88ctls/PPRv1.1.1913pluss88ctls_color_Glyma.txt by their relation to ctls in figtree.
# total 38 seqs
# a 2-mer, a 1-mer, a 1-mer, 33-mer (near rice 9), 1-mer, 

# Q: relationship of main 4 species to wheat ??? Any correlation betw this and relative phylogram locations ??????
# looks like at least all 88 locate in 'P' area, not in 'PLS' area. On PPRv1.1.752_PLSW_88ctls.txt, all 88 'not' in 'PLS' ares.


09/07/18:

# Q: perhaps in figtree, ***highlight*** few (perhaps every 10th one) of the putative '139' (most from orthoMCL) RF-like Treas names from file ?????, see if they 'group' on phylogram ?????????????????????
# Q: is naming scheme same betw v1.0, v1.1 ?????????????????????
# Note: '01G' in 139, '02G' in v1.1 differ. Perhaps take all 139, change '1' digit to '2' ?????????
# '31600', near (above on 'line' graph), but not near BRAD 2-mer
# '57300', near (above on 'line' graph), but not near BRAD 2-mer

09/10/18:

# Q: can I color more than one seq at a time (diff colors) ?????????? in trying to see how the random 15 of the 139 are located on PPRv1.1.1913plus88ctls_color139testing.txt
#***************************************************************
# Q: if can even use phylogram to select RF-like seqs ??????????
#*****************************************************************

# rand15of139.txt
# to do, sort, then doc bit about relative location of the 15 on phylogram
# see line 9399
# sort as position of the 15 on PPRv1.1.1913plus88ctls_color139testing.txt in figtree on 'pro'.
From dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls

sort --key=2,2 --key=2n rand15of139.txt  ## will work for my task

STOPPED

sort --key=2,2 --key=2n rand15of139.txt > rand15of139_sorted.txt
# then manually moved 10 thru 15 to bottom of file.

# then locate these 15 on PPRv1.1.1913plus88ctls_composite.txt
# comments: 13 of 15 relatively close to rice & BRAD ctls. Not close to Glyma or Arab. All except possible #1 in putative 'P' region.
# Q: for purpose of identifying RF-like seqs, 
--note phylogram can 'mostly' (but not all) group ctl seqs.
--Except for the 12 0f 16 seqs near rice which also in 139 file, can something be made of the random 15's locations to identify RF-like seqs. That is, the random 15 not grouping as well as ctls in general ?????????
-- evolutionarywise are rice & BARD closer to wheat than soybean & arabidopsis ?????

09/12/18:
# talked to vikas yesterday. 
# **to do**, match my 'P' (RF-like) seqs with science genome seq paper, some wheat RF seqs discussed there
# try use blastp queries with 88 ctls applied to 1161 targets/'P's' previously prepared from v1.1 seqs. Filter by i) eval < e-05, & ii) % idenity > 30%.
# subsequently may apply the tool to display introns (probably would have to go back, get gene seqs for the protein seqs want to check for introns ???????) Think prevly used blastn.
# ref line 6846, custom blast output ????? Q: was this for genes, & will it work for proteins ????????

# also, ref line 6814
#cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

#slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt6cust.sh
# can this work for blastp (ck JJ)

# could also **try** online blastp.

# 1st to do, get a file for the 88 ctls (protein fasta)
# ref, line 9120
# dir: /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls

cat PPRv1.1_1161_P_seqs_subset.fa bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa FunctionallyCharacterizedRfs_fasta.fa > PPRv1.1_1161_P_seqs_plus_88ctls.fa
# to do, cat the 5 files wi the 88 ctls to obtain a fasta file wi just the 88 ctls.

# ref, line 9120
# get a file for protein fasta for 1161 putative 'P' proteins. Q: if got a file with both 1161 & ctl seqs, could compare strength of hits ???????????????
#-rw-r--r--  1 bterry  staff  798011 Aug 15 11:13 PPRv1.1_1161_P_seqs_plus_88ctls.fa
#-rw-r--r--  1 bterry  staff  744413 Aug 15 00:35 PPRv1.1_1161_P_seqs_subset.fa

09/13/18:
cat bracky9namesshort.fa FRknownseqs_shtname_9.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa FunctionallyCharacterizedRfs_fasta.fa > 88ctls.fa

# Initially, online, try query 1 rice seq (AB110443), & the 1249 seqs in PPRv1.1_1161_P_seqs_plus_88ctls.fa just to see what happens.
# adjust max target seqs under algorithm parameters, try from default of 100 to 250
# output (additional) rows in dnloaded file, than on online display, like online display only shows row with highest % identity for particular hit ????????????????????
# what to do with this output ?????
# If use dnloaded output, perhaps could do uniq (??) on 'subject acc.ver' and % identity to get uniq rows with say % identity > 30% (in R or linux prompt ?????????)

# then, have a set of uniq hit rows, repeat for just 1161 row target file, and for each ctl as query (or initially, just one seq from 'group' in phylogram for each ctl species ???). Then %in% (or a 'union operation) to get hits common (found) to all the ctl searches ?????
# What if basically all of the 1161 are selected by this approach ??????????//

# try rice seq (AB110443) vs target, select PPRv1.1_1161_P_seqs_subset.fa (1161 seqs), max target seqs = 250
# NOTE: % identities significantly lower (1161 wheat seqs) than when ctl seqs (1161+88=1249) in the target file.
# TPF..., 1250 rows ?????????? 
# rice query, rice & BRAD ctls at top hits list, Glyma, arabidopsis not near top of hit list.

09/14/18:
# so, comments after two test blastp online runs
--rice ctl query hits other ctls than BRAD well down list for target list PPRv1.1_1161_P_seqs_plus_88ctls.fa 
--wheat hits & non-rice ctls have significanly lower % identities with rice query AB110443 and PPRv1.1_1161_P_seqs_plus_88ctls.fa target file.
# perhaps run one query from 'group' for each ctl species, take union of the hits above 30% Identity from each? Perhaps roughly as effective as all 88 ctls as queries, easier to run online.
# checking into do blastp runs on crane?

# talked to vikas:
# would like two searches initially:
# files in /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls

# online blastp: query: 88ctls.fa
# subject seqs: PPRv1.1_1161_P_seqs_subset.fa
# max subject seqs: 5000
# expect threshold: 1e-06 (blastp help says this common setting at ncbi)
# run started: 3:25pm
# Job Title: BRADI1G14190.1 (867 letters)
# RID-TS6A74YU11N

STOPPED

# at 3:32pm, **job aborted**, message to contact helpdesk. **(TO DO)**
# think problem wi 88ctls.fa
# so, make new 'query' file, new ctl seq at beginning, check in bbedit for anything may be wrong, then try another online blastp run

cat FRknownseqs_shtname_9.fa bracky9namesshort.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa FunctionallyCharacterizedRfs_fasta.fa > rice1st_88ctls.fa
# Q: Glyma seqs spread across page ?????????????
# In bbedit, apply 'view'. Glyma now wrapped, but now has multiple '...' line extensions ???? None of the non-Glyma seqs have this wrap ???????????????????
# Thinking have not fixed the .fa file ??????????????
# When I run a BLAST search, why do I get a “Process terminated by SIGXCPU” error? BLAST searches online are limited to the total amount of CPU time per individual search. ...
# so, assume my error due to to large a submitted job.
# perhaps try split run wi 88 ctls into 5 runs, one for each of the 5 ctl files constituting the 88 ctls

# online blastp: query: FRknownseqs_shtname_9.fa
# subject seqs: PPRv1.1_1161_P_seqs_subset.fa
# max subject seqs: 5000
# expect threshold: 1e-06 (blastp help says this common setting at ncbi)
# run started: 11:28pm
# Job Title: AB110443 (791 letters)
# RID-TT2JW17N11N
# by 11:31pm, online page stopped refreshing periodically ????????????????????

# perhaps start another run (rice9)
# online blastp: query: FRknownseqs_shtname_9.fa
# subject seqs: PPRv1.1_1161_P_seqs_subset.fa
# max subject seqs: 5000
# expect threshold: 1e-06 (blastp help says this common setting at ncbi)
# run started: 11:40pm
# Job Title: rice9query
# RID-TT39P5HS114

# perhaps, would take this dnloaded descriptions table, process it 1st, for % identity > 30, then perhaps cut out colm 2, run sort|uniq, have hit list for rice9query.
# repeat for other ctl files. Will then be harvesting results from 5 output files. Perhaps cat the 5 output files, do sort|uniq giving Treas hits.

09/15/18:
# perhaps start another run (Glyma)
# online blastp: query: soybean41to_ver2names38dot1dotpshort.fa (the file without line endings in the seqs ???????????????????
# subject seqs: PPRv1.1_1161_P_seqs_subset.fa
# max subject seqs: 5000
# expect threshold: 1e-06 (blastp help says this common setting at ncbi)
# run started: 9:40am
# Job Title: soy38
# RID-TU6G348R114
# Q: by 9:48am, online blastp no longer 'updating' its page, and ***no*** results displayed, just white field on screen ???????????????????????????????????????//

# perhaps start another run (bracky)
# online blastp: query: bracky9namesshort.fa
# subject seqs: PPRv1.1_1161_P_seqs_subset.fa
# max subject seqs: 5000
# expect threshold: 1e-06 (blastp help says this common setting at ncbi)
# run started: 10:15am
# Job Title: bracky9query
# RID-TU8H10JW114

# perhaps start another run (arab)
# online blastp: query: arab26fujii2011namesshort.fa
# subject seqs: PPRv1.1_1161_P_seqs_subset.fa
# max subject seqs: 5000
# expect threshold: 1e-06 (blastp help says this common setting at ncbi)
# run started: 1:01pm
# Job Title: arab26query
# RID-??????
# reverts to input page after only few seconds of run ?????????????????????
# so **no** results
#**************************************************
# So, only got rice9 & bracky9 to run online
# one problem is soy38 fasta file, problem length lines in seqs ????????????
#***************************************************


# and submit the same query & subject to crane thru slurm file. Assume need new crane dir.
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj
ls -al
mkdir blastpctls88vs_prots1161
cd blastpctls88vs_prots1161
# /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
 
# ref line 6816
#scp slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt6cust.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/


# ref: line 6816
#slurm_blastn131_iwgscCDS_defnohits_evdot01_outfmt6cust.sh
# can this work for blastp (ck JJ), says yes.

# prep slurm file (done)
slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh
 
scp slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

# get two files to dir. /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
# from dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls
# FRknownseqs_shtname_9.fa
# PPRv1.1_1161_P_seqs_subset.fa

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls
scp FRknownseqs_shtname_9.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161

scp PPRv1.1_1161_P_seqs_subset.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161

## run script

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh
ls -lh
sbatch slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh 15990927  11:45pm => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
ls -lh  ## ck dir contents?
less job.15990927.err
USAGE
  blastp [-h] [-help] [-import_search_strategy filename]
    [-export_search_strategy filename] [-task task_name] [-db database_name]
    [-dbsize num_letters] [-gilist filename] [-seqidlist filename]
    [-negative_gilist filename] [-entrez_query entrez_query]
    [-db_soft_mask filtering_algorithm] [-db_hard_mask filtering_algorithm]
    [-subject subject_input_file] [-subject_loc range] [-query input_file]
    [-out output_file] [-evalue evalue] [-word_size int_value]
    [-gapopen open_penalty] [-gapextend extend_penalty]
    [-qcov_hsp_perc float_value] [-max_hsps int_value]
    [-xdrop_ungap float_value] [-xdrop_gap float_value]
    [-xdrop_gap_final float_value] [-searchsp int_value]
    [-sum_stats bool_value] [-seg SEG_options] [-soft_masking soft_masking]
    [-matrix matrix_name] [-threshold float_value] [-culling_limit int_value]
    [-best_hit_overhang float_value] [-best_hit_score_edge float_value]
    [-window_size int_value] [-lcase_masking] [-query_loc range]
    [-parse_deflines] [-outfmt format] [-show_gis]
    [-num_descriptions int_value] [-num_alignments int_value]
    [-line_length line_length] [-html] [-max_target_seqs num_sequences]
    [-num_threads int_value] [-ungapped] [-remote] [-comp_based_stats compo]
    [-use_sw_tback] [-version]

DESCRIPTION
   Protein-Protein BLAST 2.4.0+

Use '-help' to print detailed descriptions of command line arguments
========================================================================

Error: Unknown argument: "dust"
Error:  (CArgException::eInvalidArg) Unknown argument: "dust"

# so, dust apparently not an argument for blastp ???????????????? Tho, '-task' is.
# perhaps change slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh by ***removing*** '-dust no' parameter from blastp command ?????????????

# retry run slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh again.
sbatch slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh 15991043  12:15pm (09/16/18) => ??:??am, 
squeue -u pterry  ## 
less job.15991043.err

DESCRIPTION
   Protein-Protein BLAST 2.4.0+

Use '-help' to print detailed descriptions of command line arguments
========================================================================

Error: Argument "task". Illegal value, expected Permissible values: 'blastp' 'blastp-fast' 'blastp-short' :  `megablast'
Error:  (CArgException::eConstraint) Argument "task". Illegal value, expected Permissible values: 'blastp' 'blastp-fast' 'blastp-short' :  `megablast'

# Q: but
 I used "-task megablast", but flagging as error ?????????????????
 
STOPPED
09/16/18:
# saved this log file to github

# copy soybean41to_ver2names38dot1dotpshort.fa to soy38fixedseqs60perline.fa. In latter, fixed absence of return characters to 60 char/line.
# perhaps start another run (Glyma)
# online blastp: query: soy38fixedseqs60perline.fa
# subject seqs: PPRv1.1_1161_P_seqs_subset.fa
# max subject seqs: 5000
# expect threshold: 1e-6 (blastp help says this common setting at ncbi)

# run started: 1:50pm
# Job Title: soy38fixedseqs60perline
# RID-TU6G348R114
# Q: by 1:52pm, 
# after say < 1 min, online blastp no longer 'updating' its page, and ***no*** results displayed, just white field on screen ???????????????????????????????????????
 
09/17/18:
Test: if can run preceding soy38 file search from 'pro' laptop. To do, thru box, copy 
--PPRv1.1_1161_P_seqs_subset.fa
--soy38fixedseqs60perline.fa
# to dir PPRv1.1_1161_88ctls/blastptest
# try run online blastp with settings, 5000 & 1e-6.
# run started: 9:36am
# Job Title: forget give job title, so will be name 1st seq in query
# RID-TZEZJCJ911N
# By 5 min, online blastp no longer 'updating' its page, and ***no*** results displayed, just white field on screen ???????????????????????????????????????

# to send email to JJ, when he would be available for blastp questions
jeanjack@unl.edu
 
09/18/18:
# to try FunctionallyCharacterizedRfs_fasta.fa online
# perhaps start another run (vikas6)
# online blastp: query: FunctionallyCharacterizedRfs_fasta.fa
# subject seqs: PPRv1.1_1161_P_seqs_subset.fa
# max subject seqs: 5000
# expect threshold: 1e-6 (blastp help says this common setting at ncbi)

# run started: 2:14pm
# Job Title: vikas6
# RID-U2KMR2SD113, dnloaded
# so, online, 3 queries ran (9, 9, 6 seqs in query), soy (38 seqs) did not?

# perhaps retry slurm blastp with '-task blastp' in place of '-task megablast' ????
# ref, line 9732
# prep slurm file, here  '-task blastp' (done)
slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh
 
scp slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh
ls -lh
sbatch slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh 16005496 2:44pm => ??:??am, 
squeue -u pterry  ## 
less job.16005496.err

BLAST Database error: No alias or index file found for protein database [PPRv1.1_1161_P_seqs_subset.fa] in search path [/lustre/work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161::]
job.16005496.err (END) 

# looks like need prepare index file 1st ????????
# looks like can use slurm_makeblastdb_iwgscCDS.sh from dir: /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
# as template. Q: 'dbtype nucl' will need to be modified ??????????? Internet example has 'dbtype prot'.
# rename to slurm_makeblastdb_protv1.1_1161.sh, of course in dir: /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls

scp slurm_makeblastdb_protv1.1_1161.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
ls -al  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_makeblastdb_protv1.1_1161.sh
ls -lh
sbatch slurm_makeblastdb_protv1.1_1161.sh 16008211 11:33pm => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16008211     batch TJob_mak   pterry  R       0:50      1 c3617

09/19/18:
# crane down, can't check status of job # 16008211 now. I note crane down before I started job last night, it seemed to be taking long time, perhaps related ?????????

less job.16008211.err
slurmstepd: error: *** JOB 16008211 ON c3617 CANCELLED AT 2018-09-19T05:33:24 DUE TO TIME LIMIT ***
job.16008211.err (END) 

less job.16008211.out
Building a new DB, current time: 09/19/2018 00:03:07
New DB name:   /lustre/work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161/PPRv1.1_1161_P_seqs_subset.fa
New DB title:  PPRv1.1_1161_P_seqs_subset.fa
Sequence type: Protein
Keep MBits: T
Maximum file size: 1000000000B
job.16008211.out (END) 
# Q: what to think of this max file size ????????????

# try again, perhaps up request to 8 hr, set number nodes to 1

scp   pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
ls -al  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_makeblastdb_protv1.1_1161.sh
ls -lh
sbatch slurm_makeblastdb_protv1.1_1161.sh 16012779 1:31pm => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
ls -al
less job.16012779.err
FASTA-Reader: Ignoring invalid residues at position(s): On line 9: 59
FASTA-Reader: Ignoring invalid residues at position(s): On line 34: 42
FASTA-Reader: Ignoring invalid residues at position(s): On line 39: 60
# not liking '.' at end many lines ???????????????????????????????????????????

less job.16012779.out
Building a new DB, current time: 09/19/2018 13:30:42
New DB name:   /lustre/work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161/PPRv1.1_1161_P_seqs_subset.fa
New DB title:  PPRv1.1_1161_P_seqs_subset.fa
Sequence type: Protein
Keep MBits: T
Maximum file size: 1000000000B
Adding sequences from FASTA; added 1161 sequences in 0.293911 seconds.
job.16012779.out (END) 
# looks like crerated these 4 files
-rw-r--r--  1 pterry amundsen 744413 Sep 15 22:54 PPRv1.1_1161_P_seqs_subset.fa
-rw-r--r--  1 pterry amundsen 125239 Sep 19 13:30 PPRv1.1_1161_P_seqs_subset.fa.phr
-rw-r--r--  1 pterry amundsen   9384 Sep 19 13:30 PPRv1.1_1161_P_seqs_subset.fa.pin
-rw-r--r--  1 pterry amundsen 680849 Sep 19 13:30 PPRv1.1_1161_P_seqs_subset.fa.psq
# for moment, pretend this successful run of makeblastdb ??????????????

# with 4 files created from makeblastdb run, try again run slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh again

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh
ls -lh
sbatch slurm_blastp_rice9_vs_prot1161_ev06_outfmt6cust.sh 16013863 2:22pm => ??:??am, 
squeue -u pterry
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16013863     batch TJob_bla   pterry PD       0:00      1 (Priority)

sacct -j  16013863 -o start,end
              Start                 End 
------------------- ------------------- 
2018-09-19T14:33:41 2018-09-19T14:33:53 
2018-09-19T14:33:41 2018-09-19T14:33:53 
33:53 - 33:41 = 12 sec
-rw-r--r-- 1 pterry amundsen 1.6M Sep 19 14:33 rice9_prot1161_ev06_outfmt6cust.blastp
wc -l rice9_prot1161_ev06_outfmt6cust.blastp
26193 rice9_prot1161_ev06_outfmt6cust.blastp

less rice9_prot1161_ev06_outfmt6cust.blastp
AB110443        TraesCS7D02G487500.1    0.0     51.373  765     791     715     763
AB110443        TraesCS1D02G068800.1    0.0     48.516  775     791     816     748
# Q: is the 5th field, the 'length' field, the 'alignment length' of the online blastp report ??????????????????????????????

# Perhaps compare this output with the online output for query is the rice9 ctls ??????
# 1st few rows matching well (for 1st duplicate hits, such as row 8 & 9, 
AB110443        TraesCS6D02G047700.1    0.0     52.149  698     791     691     729
AB110443        TraesCS6D02G047700.1    1.68e-80   28.205  585     791     691     268

# for duplicate subject hits, signif diff for evalue, %ID, length
 
# talked to JJ
# **strategy** to analyze output of blastp
1) select an evalue target
2) since expect several hits per subject protein, bracket hits to select as per example, if set cutoff at e-200, then, perhaps bracket acceptable values e-200 to e-190 or 180.
3) make sure sufficient portion of subject is aligned when trying to subset multiple hits same subject. Could just compare this field for this purpose ??????
4) Then % identity. Think he indicated 30% is quite low ????????????????????

09/20/18:
# talked to vikas
# next on crane try run all 88 ctls in query in one run.
# 1st have to remake the 88 .fa query file, to incorporate soy seqs, this time, row length 60, by manually adding 'carriage returns'.

#cat FRknownseqs_shtname_9.fa bracky9namesshort.fa soybean41to_ver2names38dot1dotpshort.fa arab26fujii2011namesshort.fa FunctionallyCharacterizedRfs_fasta.fa > rice1st_88ctls.fa

cat FRknownseqs_shtname_9.fa bracky9namesshort.fa soy38fixedseqs60perline.fa arab26fujii2011namesshort.fa FunctionallyCharacterizedRfs_fasta.fa > rice1st_88ctls_soyfixed.fa

# this new cat uses soy38fixedseqs60perline.fa

# now, try crane blastp, with 88 ctls query vs 1161 'P' (?) seqs.

# prep slurm file, here  '-task blastp' (done)
slurm_blastp_88ctls_vs_prot1161_ev06_outfmt6cust.sh


scp slurm_blastp_88ctls_vs_prot1161_ev06_outfmt6cust.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/
 
scp rice1st_88ctls_soyfixed.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161

# finally run blastp 88 query vs 1161 subject
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_blastp_88ctls_vs_prot1161_ev06_outfmt6cust.sh
ls -lh
sbatch slurm_blastp_88ctls_vs_prot1161_ev06_outfmt6cust.sh 16027252  10:47pm => ??:??am, 
squeue -u pterry  ## 
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16027252     batch TJob_bla   pterry  R       0:38      1 c0409

cd /work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161
-rw-r--r--  1 pterry amundsen 16533587 Sep 20 22:48 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
less rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
wc -l rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
237410 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
# 237410/102168 = 2.32 hits per query seq.
head 

09/21/18:
sacct -j  16027252 -o start,end
              Start                 End 
------------------- ------------------- 
2018-09-20T22:46:47 2018-09-20T22:48:19 
2018-09-20T22:46:47 2018-09-20T22:48:19 
48:19 - 46:47 = 1 min 32 sec

head -n 5 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161/rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp .
grep -c "^AB" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 19967
grep -c "^KJ" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 6226
grep -c -v "^AB" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 217443
grep -c "^AT" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 66841
grep -c "^BR" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 23589
grep -c "^Gl" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 103829
# leaves 16958 for vikas6

grep "^AB" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > rice7_AB_ctls_prot1161hits.blastp
wc -l rice7_AB_ctls_prot1161hits.blastp  ##    19967 rice7_AB_ctls_prot1161hits.blastp
grep "^KJ" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > rice2_KJ_ctls_prot1161hits.blastp
wc -l rice2_KJ_ctls_prot1161hits.blastp  ##     6226 rice2_KJ_ctls_prot1161hits.blastp
cat rice7_AB_ctls_prot1161hits.blastp rice2_KJ_ctls_prot1161hits.blastp > rice9_ctls_prot1161hits.blastp
wc -l rice9_ctls_prot1161hits.blastp  ##    26193 rice9_ctls_prot1161hits.blastp

# Analysis:
1) subsetting of wheat hits by ctl species (tho may have to use evalue in addition to what follows ???)
--grep rows by query species as filter
--perhaps in R, subset rows by 'length/slen'
--cut wheat hit colm
--sort|uniq

# Q: what was the range in seq length for subject 1161 putative 'P' seqs ??????
# may affect analysis, looks like would need use "length/slen' if trying to filter the hit list since range seq lengths may be large ????? Is this an R task ???????

# for the rice9, 

cut -f 2  rice9_ctls_prot1161hits.blastp | wc -l  ##    26193
cut -f 2  rice9_ctls_prot1161hits.blastp > rice9_colm2_hits.txt  
wc -l rice9_colm2_hits.txt  ##    26193 rice9_colm2_hits.txt

sort rice9_colm2_hits.txt |uniq | wc -l  ##  562 (evalue cutoff was 1e-6
# so less than half of the 1161 subject seqs in the preceding blastp run.
# perhaps filter by 'length/slen' perhaps >= 0.50 ????????

STOPPED

09/22/18:
# so set up R session to accomplish, add calcn as colm 9.

# start R (ref line 9323)

rm(list=ls())
setwd("~/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls")
getwd()
#PLS752 <- read.delim("PPRv1.1_1stcolor_aftperl_752_PLS_seqs_minusquotes.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("thepls752"))

rice9hits <- read.delim("rice9_ctls_prot1161hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("qnam", "snam", "eval", "pid", "len", "qlen", "slen", "bscor"))
class(rice9hits)
dim(rice9hits)  ## [1] 26193     8

rice9hits[1:3,]
rice9hits$frac_align <- rice9hits$len/rice9hits$slen
rice9hits[1:3,]
summary(rice9hits$frac_align)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#0.0852  0.5391  0.6928  0.6810  0.8304  1.2656 
# Q: how have value over 1.0 ?????????????????????????
summary(rice9hits$eval)
#Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#0.000e+00 0.000e+00 0.000e+00 3.203e-09 0.000e+00 9.420e-07 
summary(rice9hits$pid)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#16.98   24.79   26.59   27.74   28.57   61.22 
summary(rice9hits$len)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#52     286     384     391     482     883 
summary(rice9hits$slen)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#106.0   482.0   609.0   609.6   746.0  1561.0 

# Q: can I filter these seqs further? 1e-6 cutoff has reduced 1161 putative 'P' seqs to 562.
# perhaps, set cutoffs for len/slen, and/or %identity. But then what to set it at?
 
# Would it help to repeat preceding for other ctl species? Perhaps try for soy or arab (different from rice & bracky). See if diff in summary stats for one of them?

# vikas, would like copy of rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp in .../RF_GeneFamily/figtreetmp directory on box. (sent)

# prepare 'summary' results as above for say 'soy38 (Glyma)
# ref: line 10057
grep "^Glyma" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > soy38_ctls_prot1161hits.blastp
wc -l soy38_ctls_prot1161hits.blastp  ## 103829 soy38_ctls_prot1161hits.blastp

09/23/18:

# ref line 10074
cut -f 2  soy38_ctls_prot1161hits.blastp | wc -l  ##      103829
cut -f 2  soy38_ctls_prot1161hits.blastp > soy38_colm2_hits.txt  
wc -l soy38_colm2_hits.txt  ##      103829 soy38_colm2_hits.txt

sort soy38_colm2_hits.txt |uniq | wc -l  ##    619 (evalue cutoff was 1e-6
# so little over half of the 1161 subject seqs in the preceding blastp run.

# start R (ref line 10089)

rm(list=ls())
setwd("~/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls")
getwd()

soy38hits <- read.delim("soy38_ctls_prot1161hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("qnam", "snam", "eval", "pid", "len", "qlen", "slen", "bscor"))
class(soy38hits)
dim(soy38hits)  ## [1] 26193     8
soy38hits[1:3,]
soy38hits$frac_align <- soy38hits$len/soy38hits$slen
soy38hits[1:3,]

summary(soy38hits$frac_align)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#0.05606 0.44864 0.58824 0.57995 0.70511 1.17162 
summary(soy38hits$eval)
#Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#0.000e+00 0.000e+00 0.000e+00 3.517e-09 0.000e+00 9.990e-07 
summary(soy38hits$pid)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#16.09   24.93   26.89   26.90   28.86   43.94 
summary(soy38hits$len)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#55.0   276.0   361.0   360.7   453.0   746.0 
summary(soy38hits$slen)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#158.0   537.0   657.0   660.4   791.0  1561.0 

09/24/18:
# note ave fraction aligning with soy38 queries approxly 10% less than rice9. Would this obsn be of any value ????????? Perhaps run bracky9, arab26 analysis, see if get comparable results?

# 1st try bracky9
# ref line 10134
# prepare 'summary' results as above for Bracky9, 'BRAD'.

grep "^BRAD" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > bracky9_ctls_prot1161hits.blastp
wc -l bracky9_ctls_prot1161hits.blastp
##    23589 bracky9_ctls_prot1161hits.blastp

# ref line 10134
cut -f 2  bracky9_ctls_prot1161hits.blastp | wc -l  ##     23589
cut -f 2  bracky9_ctls_prot1161hits.blastp > bracky9_colm2_hits.txt  
wc -l bracky9_colm2_hits.txt  ##         23589 bracky9_colm2_hits.txt

sort bracky9_colm2_hits.txt |uniq | wc -l  ##         564 (evalue cutoff was 1e-6
# so little over half of the 1161 subject seqs in the preceding blastp run.

# start R (ref line 10142)

rm(list=ls())
setwd("~/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls")
getwd()

bracky9hits <- read.delim("bracky9_ctls_prot1161hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("qnam", "snam", "eval", "pid", "len", "qlen", "slen", "bscor"))
class(bracky9hits)
dim(bracky9hits)  ## [1] 26193     8
bracky9hits[1:3,]
bracky9hits$frac_align <- bracky9hits$len/bracky9hits$slen
bracky9hits[1:3,]

summary(bracky9hits$frac_align)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#0.08624 0.53612 0.67598 0.67226 0.81538 1.37209 
summary(bracky9hits$eval)
#Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#0.000e+00 0.000e+00 0.000e+00 4.618e-09 0.000e+00 9.940e-07 
summary(bracky9hits$pid)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#17.36   24.34   26.06   28.25   28.05   79.31 
summary(bracky9hits$len)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#49.0   272.0   386.0   383.5   480.0   943.0 
summary(bracky9hits$slen)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#120.0   477.0   620.0   607.8   752.0  1561.0

# similar to rice9 in 'frac_align' for mean, median

# now to test arab26

# Now try bracky9
# ref line 10174
# prepare 'summary' results as above for Bracky9, 'BRAD'.

grep "^AT" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > arab26_ctls_prot1161hits.blastp
wc -l arab26_ctls_prot1161hits.blastp
##    66841 arab26_ctls_prot1161hits.blastp

STOPPED

# ref line 10182
cut -f 2  arab26_ctls_prot1161hits.blastp | wc -l  ##     66841
cut -f 2  arab26_ctls_prot1161hits.blastp > arab26_colm2_hits.txt  
wc -l arab26_colm2_hits.txt  ##       66841 arab26_colm2_hits.txt

sort arab26_colm2_hits.txt |uniq | wc -l  ##    595 (evalue cutoff was 1e-6
# so little over half of the 1161 subject seqs in the preceding blastp run.

# start R (ref line 10190)

rm(list=ls())
setwd("~/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls")
getwd()

arab26hits <- read.delim("arab26_ctls_prot1161hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("qnam", "snam", "eval", "pid", "len", "qlen", "slen", "bscor"))
class(arab26hits)
dim(arab26hits)  ## [1] 66841     8
arab26hits[1:3,]
arab26hits$frac_align <- arab26hits$len/arab26hits$slen
arab26hits[1:3,]

summary(arab26hits$frac_align)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#0.0788  0.4741  0.6066  0.6024  0.7282  1.1509
summary(arab26hits$eval)
#Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#0.000e+00 0.000e+00 0.000e+00 2.571e-09 0.000e+00 9.980e-07 
summary(arab26hits$pid)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#16.93   24.90   26.82   26.79   28.74   41.96 
summary(arab26hits$len)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#64.0   294.0   377.0   375.7   457.0   710.0 
summary(arab26hits$slen)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#191.0   534.0   649.0   659.8   790.0  1561.0 

#*****************************************************************
# so looks like hypothesis that frac_align parameter close betw. rice9 & bracky9 and close betw. soy38 & arab26 but different betw. the two pairs groups holding. So, the more closely related ctls have roughly .68 for len/slen, while more distantly related ctls have roughly .594 for len/slen. Translates to about 50 aa residues difference.
I note, mean or median for %ID similar for both groups of ctls, but max for more closely related ctls larger than less closely related ctls.
I note, mean & medium slen for rice9 & bracky9 smaller than for soy38 & arab26.
Perhaps, can compare s.start, s.end betw. these ctl groups, see if a part of the subject seqs which aligning for more closely relaed ctl species, but not for more distantly related ctl species. But need rerun crane blastp with these two colms. Q: need name of these two colms (sstart, send) so can include in custom output slurm file ???????????????? The online version includes them.
Q: but would this advance goal of identifying RF-seqs ????????????????
#********************************************************************

09/25/18:
# talked to vikas
# plan:
# run phyml phylogram by 'Notes ...' steps for 4 .fa files, 35, 40, 45 & 50% ID. Verify I get same set of wheat seqs for these criteria. Looks like 35, 40 & 45 will be run without 88 ctls. For 50%, run *1st*, do *both* wi & without 88 ctls.

cd vikas_filter
# /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
head -n 3 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
wc -l rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  
  237410 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
 cut -f2 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > col2.txt
wc -l col2.txt  ##   237410 col2.txt
sort col2.txt|uniq > col2_uniq.txt
wc -l col2_uniq.txt  ##      706 col2_uniq.txt
# check if any have 'd' > 1
# yes, several

# checking this code:
#Unique loci (excluding the splice variants)
cut -f2 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp_WithHeader.txt|tail -n+2|sort|uniq|perl -pe 's/(Traes.+)\.\d/\1/'|sort|uniq|wc -l

perl -pe 's/(Traes.+)\.\d/\1/'
col2_uniq.txt 

cat col2_uniq.txt|perl -pe 's/(Traes.+)\.\d/\1/'|wc -l
cat col2_uniq.txt|perl -pe 's/(Traes.+)\.\d/\1/'|sort|uniq|wc -l  ## 630

# get 50% ID
# Q: I would like do this wi R or python ????????????????????
#***********************************
# Q: vikas has 206, all hits (including 'd' > 1) ?????????????????????????????/
#**************************************

09/26/18:
# to replicate with R

rm(list=ls())
setwd("~/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter")
getwd()
pid50_88ctlshits <- read.delim("rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("qnam", "snam", "eval", "pid", "len", "qlen", "slen", "bscor"))
class(pid50_88ctlshits)
dim(pid50_88ctlshits)  ## [1] 237410      8
pid50_88ctlshits[1:3,]
pid50_88ctlshits_gtr50pid <- pid50_88ctlshits[pid50_88ctlshits$pid > 50,]
dim(pid50_88ctlshits_gtr50pid)  ## [1] 1668    8
write.table(pid50_88ctlshits_gtr50pid, file="pid50_88ctlshits_gtr50pid.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

cut -f2 pid50_88ctlshits_gtr50pid.txt | wc -l  ##     1668
cut -f2 pid50_88ctlshits_gtr50pid.txt |sort|uniq| wc -l  ##  206, matches vikas
cut -f2 pid50_88ctlshits_gtr50pid.txt |sort|uniq > pid50_88ctlshits_gtr50pid_srtuniq.txt
# vikas file, mine same names top, bottom of colm, so **assume** the same.
# mine (pid50_88ctlshits_gtr50pid_srtuniq.txt), & vikas (list_WheatIDs_pid50.txt)

# ready to prepare .fa file from vikas list (list_WheatIDs_pid50.txt), then 'Notes ...' steps
# from dir /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta list_WheatIDs_pid50.txt > list_WheatIDs_pid50.fa
# check have 206 '>' in bbedit, yes.

# ready for steps of 'Notes ...' protocol
# ref: line 8585

## Now run Notes steps ... 

## need new dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

# from 08/05/18:
ssh -Y pterry@crane.unl.edu
# Rrq096mN
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1
mkdir blastp
cd blastp
pwd ## /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
logout

cd /Users/bterry/macbook2018/vikas18
find . -name 'slurm_muscle_wheatproj_PPRv1.1.sh' -print
./131RFlike/annotation1.1/slurm_muscle_wheatproj_PPRv1.1.sh
# copy to /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# rename to slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh
# modify as needed (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp list_WheatIDs_pid50.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

scp slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 8610)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh
ls -lh
sbatch slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh  16097148 9:19pm => , finally done.

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16097148     batch TJob_mus   pterry  R       0:48      1 c3721
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh

less job.16097148.err

MUSCLE v3.8.425 by Robert C. Edgar

http://www.drive5.com/muscle
This software is donated to the public domain.
Please cite: Edgar, R.C. Nucleic Acids Res 32(5), 1792-97.

# followed by lot of '^M' characters ??????????????????/

list_WheatIDs_pid50 206 seqs, lengths min 106, max 987, avg 483


sacct -j  16097148 -o start,end
              Start                 End 
------------------- ------------------- 
2018-09-26T21:19:27 2018-09-26T21:20:30 
2018-09-26T21:19:27 2018-09-26T21:20:30 
1 min 3 sec         
# output file:
-rw-r--r-- 1 pterry amundsen 247K Sep 26 21:20 list_WheatIDs_pid50.fa.aln
less list_WheatIDs_pid50.fa.aln
# top of file looks ok.

wc -l list_WheatIDs_pid50.fa.aln
4326 list_WheatIDs_pid50.fa.aln

grep -c "^>Tr" list_WheatIDs_pid50.fa.aln  ## 206 as expect

#ref line 8660, next (2nd) step, fasta2stockholm.pl conversion
logout

09/27/18:

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
#cd /work/baenziger/pterry/wheatproj/RF139
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al
#cd ..
#cd refinPprots131vikas6
cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl list_WheatIDs_pid50.fa.aln > list_WheatIDs_pid50.fa.aln.slx
ls -al
-rw-r--r-- 1 pterry amundsen 242889 Sep 27 15:00 list_WheatIDs_pid50.fa.aln.slx

## to check top of stockholm file
less list_WheatIDs_pid50.fa.aln.slx 
# STOCKHOLM 1.0
TraesCS7A02G407400.1 ---------------------------------------------------------------------
# at top is '# STOCKHOLM 1.0'

## now for *hmmbuild* (see line 8683)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
# cd /work/baenziger/pterry/wheatproj/RF139
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

hmmbuild list_WheatIDs_pid35.fa.aln.hmm list_WheatIDs_pid35.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             list_WheatIDs_pid50.fa.aln.slx
# output HMM file:                  list_WheatIDs_pid50.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     list_WheatIDs_pid50.fa.aln   206  1157   813     2.73  0.590 

# CPU time: 3.22u 0.01s 00:00:03.23 Elapsed: 00:00:03.28
exit
ls -al *.hmm
-rw-r--r-- 1 pterry amundsen 370713 Oct  7 14:45 list_WheatIDs_pid35.fa.aln.hmm
less list_WheatIDs_pid35.fa.aln.hmm
HMMER3/f [3.1b2 | February 2015]
NAME  list_WheatIDs_pid35.fa.aln
LENG  795
ALPH  amino


# ref: line 8749
## realign using hmm model, hmmalign  (refer 03/26/18, line 7086)

## copy from /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/slurm_hmmalign_wheatproj_PPRv1.1.sh to slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh in dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# make needed changes (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh
ls -al
sbatch slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh 16113542  11:22pm => ??:??am, 

squeue -u pterry  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16113542     batch TJob_hmm   pterry PD       0:00      1 (Priority)
# bit later
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al

-rw-r--r-- 1 pterry amundsen 462613 Sep 27 23:22 list_WheatIDs_pid50.fa.aln.hmmaln

sacct -j  16113542 -o start,end
              Start                 End 
-------------------------------------- 
2018-09-27T23:22:40 2018-09-27T23:22:54 
2018-09-27T23:22:40 2018-09-27T23:22:54 
22:54 - 22:40 = 14 sec

less list_WheatIDs_pid50.fa.aln.hmmaln  ## # STOCKHOLM 1.0

## ref line 8767, next step, stockholm2fasta.pl conversion

09/28/18:

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al

cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g list_WheatIDs_pid50.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > list_WheatIDs_pid50.fa.aln.hmmaln.fa

ls -al
less list_WheatIDs_pid50.fa.aln.hmmaln.fa

grep -c ">Traes" list_WheatIDs_pid50.fa.aln.hmmaln.fa  ## 206 as expect
#grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit
#logout

## ref., line 8796, now fas to phy (line 8796)
 
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
#cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
#ls -al
#cd ..
#cd ..
#cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/blastp

#cd hmmsrch_protv1.1/blastp
#ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load bioperl

./align_convert_fas_to_phy.pl -rw-r--r-- 1 pterry amundsen 206862 Sep 30 00:36 list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.fa

ls -al *,phy
## Q: will it create file & name for output, yes.

-rw-r--r-- 1 pterry amundsen 254017 Sep 28 10:12 list_WheatIDs_pid50.fa.aln.hmmaln.phy
exit
less list_WheatIDs_pid50.fa.aln.hmmaln.phy
 206 815
'TraesCS5B02G250800.1'  ---------- ---------- ---------- ---NIKDRYH AGCIGTEDAL HLFDELLQVA 
logout

## scp back to macbook, (line 8829)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid50.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  254017 Sep 28 10:35 list_WheatIDs_pid50.fa.aln.hmmaln.phy

less list_WheatIDs_pid50.fa.aln.hmmaln.phy
 206 815
'TraesCS5B02G250800.1'  ---------- ---------- ---------- ---NIKDRYH AGCIGTEDAL HLFDELLQVA 


head -n 4 list_WheatIDs_pid50.fa.aln.hmmaln.phy
 206 815
'TraesCS5B02G250800.1'  ---------- ---------- ---------- ---NIKDRYH AGCIGTEDAL HLFDELLQVA 
'TraesCS6B02G114300.1'  ---------- ---------- ---------- ---------- ---------- ---------- 
'TraesCS1B02G072900.2'  --LIPRLRLL RRCSTSTSTS SPSRSWSPRD AFAAATERVR AGTLSLEDAH KLFDELLGQA

## so phy header      206 815, expect the 206

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_WheatIDs_pid50.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: list_WheatIDs_pid50.fa.aln.hmmaln.phy

The alignment file "list_WheatIDs_pid50.fa.aln.hmmaln.phy" was uploaded, it contains 206 taxons of 815 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20180928-174956_Sc83/cmd.txt

job was submitted. (Fri, 09/28/18, 10:50am)
#*******************************************************************

#was finished by < 6 hrs later
# output file, list_wheatids_pid50_fa_aln_hmmaln_phy_phyml_tree.txt renamed  list_wheatids_pid50_phyml_tree.txt
#  next take it to unl.box.com, then to 'pro' laptop.
# from (on pmtmbook15) /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_wheatids_pid50_fa_aln_hmmaln_phy_phyml
# to on 'pro', dir .../macbookpro2018/PPRv1.1_1161_88ctls
# create new dir on pro, .../PPRv1.1_1161_88ctls/vikas_filter

in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 

# Note: *overview* of phylogram, similar look to several from v1.0 of approx 135 wheat seqs, that is,*5* significant size groups similar, geometry. 
# uploaded to unl.box.com, list_wheatids_pid50_phyml_tree.pdf file.
# to do: send vikas note name, location on box.


09/29/18:
#talked to vikas yesterday
# interest in GSDS for 35pid (306 seqs), 50pid seqs (206 seqs). ME: add in 88 ctls, see if they low on 'introns'. will need nucleotide seqs for, may only be avail. for wheat ?????
# apparently Venny quick way subset seqs, perhaps can do for 35pid, 50pid seqs. Venny will find 'overlap' then a button to print out list of seqs in common ???????????

# next, prepare, submit 50pid_plus88ctls .fa file for processing thru 'Notes ...' steps.
# 1st cat 88ctls onto the 206 wheat seqs '.fa' file

# see line 10362
list_WheatIDs_pid50.fa
# cat preceding file to 88 ctl fasta seqs
# see line 10003, 
copy rice1st_88ctls_soyfixed.fa file to /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# from .../annotation1.1/PPRv1.1plus_88ctls dir.
# now cat this file with list_WheatIDs_pid50.fa will give 206+88=294 seqs

cat rice1st_88ctls_soyfixed.fa list_WheatIDs_pid50.fa > list_WheatIDs_pid50_plus88ctls.fa
# bbedit shows 294 seqs.

## Now run Notes steps ...  (ref line 10340)

cp slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh slurm_muscle_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh
# modify as needed (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp list_WheatIDs_pid50_plus88ctls.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

scp slurm_muscle_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 8610)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if slurm_muscle_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh
ls -lh
sbatch slurm_muscle_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh  16128382 2:24pm => , finally done.
# *messed* up, ran job twice

squeue -u pterry  ## a PD
[pterry@login.crane scripts]$ squeue -u pterry
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16128382     batch TJob_mus   pterry  R       1:13      1 c3709

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh
less job.16128393.err
list_WheatIDs_pid50_plus88ctls 294 seqs, lengths min 54, max 1045, avg 514
# followed by lot of '^M' characters ??????????????????/

sacct -j  16128393 -o start,end
              Start                 End 
------------------- ------------------- 
2018-09-29T14:27:01 2018-09-29T14:29:49 
2018-09-29T14:27:01 2018-09-29T14:29:49 
29:49 - 27:01 = 2 min 48 sec
-rw-r--r-- 1 pterry amundsen 456K Sep 29 14:29 list_WheatIDs_pid50_plus88ctls.fa.aln

less list_WheatIDs_pid50_plus88ctls.fa.aln
# top of file looks ok.

wc -l list_WheatIDs_pid50_plus88ctls.fa.aln
7938 list_WheatIDs_pid50_plus88ctls.fa.aln

grep -c "^>" list_WheatIDs_pid50_plus88ctls.fa.aln  ## 294 as expect
logout

#ref line 10413, next (2nd) step, fasta2stockholm.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al
#cd ..
#cd refinPprots131vikas6
#cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
#ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl list_WheatIDs_pid50_plus88ctls.fa.aln > list_WheatIDs_pid50_plus88ctls.fa.aln.slx
ls -al
-rw-r--r-- 1 pterry amundsen 453541 Sep 29 23:29 list_WheatIDs_pid50_plus88ctls.fa.aln.slx

## to check top of stockholm file
less list_WheatIDs_pid50_plus88ctls.fa.aln.slx
# STOCKHOLM 1.0
AT1G12770.1 ------------------------------------------------------------------------------

## now for *hmmbuild* (see line 10440)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
# cd /work/baenziger/pterry/wheatproj/RF139
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

hmmbuild list_WheatIDs_pid50_plus88ctls.fa.aln.hmm list_WheatIDs_pid50_plus88ctls.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             list_WheatIDs_pid50_plus88ctls.fa.aln.slx
# output HMM file:                  list_WheatIDs_pid50_plus88ctls.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     list_WheatIDs_pid50_plus88ctls.fa.aln   294  1522   682     5.10  0.590 

# CPU time: 2.83u 0.00s 00:00:02.83 Elapsed: 00:00:02.89
ls -al *.hmm
-rw-r--r-- 1 pterry amundsen 346544 Oct  8 13:08 list_WheatIDs_pid35_plus88ctls.fa.aln.hmm

less list_WheatIDs_pid35_plus88ctls.fa.aln.hmm
HMMER3/f [3.1b2 | February 2015]
NAME  list_WheatIDs_pid50_plus88ctls.fa.aln
LENG  682
ALPH  amino

# ref: line 10476
## realign using hmm model, hmmalign  (refer 03/26/18, line 7086)

## copy from 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh to
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/slurm_hmmalign_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh

# make needed changes (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp slurm_hmmalign_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh
ls -al
sbatch slurm_hmmalign_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh 16130726  12:22am => ??:??am, 

squeue -u pterry  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  *.hmmaln
-rw-r--r-- 1 pterry amundsen 861794 Sep 30 00:21 list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln

sacct -j  16130726 -o start,end
              Start                 End 
------------------- ------------------- 
2018-09-30T00:21:34 2018-09-30T00:21:50 
2018-09-30T00:21:34 2018-09-30T00:21:50 
21:50 - 21:34 = 1 sec

less list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln
# STOCKHOLM 1.0

## ref line 10514, next step, stockholm2fasta.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al

#cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
#ls -al
#-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.fa

ls -al
less list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.fa

grep -c ">Traes" list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.fa  ## 206 as expect
grep -c ">" list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.fa  ## 294 as expect

exit
#logout

## ref., now fas to phy (line 10543)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
#cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
#ls -al
#cd ..
#cd ..
#cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/blastp

#cd hmmsrch_protv1.1/blastp
#ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load bioperl

./align_convert_fas_to_phy.pl list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.fa
ls -al
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 306089 Sep 30 00:48 list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy
exit
less list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy
 294 684
'TraesCS7D02G487500.1'  ---------- -------VGR RILEQNIKAW YHAGDIGTKD ALHRFDELLQ DAGSSSIRAV 
logout

## scp back to macbook, (line 8829)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  254017 Sep 28 10:35 list_WheatIDs_pid50.fa.aln.hmmaln.phy

less list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy
  294 684

head -n 3 list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy
 294 684
'TraesCS7D02G487500.1'  ---------- -------VGR RILEQNIKAW YHAGDIGTKD ALHRFDELLQ DAGSSSIRAV 
'TraesCS1B02G315436.1'  ---------- ---------- ---------- ---------- ---------- ---------- 

## so phy header        294 684, expect the 294

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections: (line 10597)

browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy

The alignment file "list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy" was uploaded, it contains 294 taxons of 684 characters.

Your job was submitted. (1:03am, 09/30/18)

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20180930-080328_Bt70/cmd.txt

09/30/18:
#dnloaded from http://www.atgc-montpellier.fr/phyml/results.php?path=20180930-080328_Bt70/sms.csv
-rw-r--r--@ 1 bterry  staff  8769 Sep 30 10:00 list_wheatids_pid50_plus88ctls_fa_aln_hmmaln_phy_phyml.zip
# the 294 seqs pid50 plus 88 ctls
#was finished by < 4 hrs later
# output tree file: /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_wheatids_pid50_plus88ctls_fa_aln_hmmaln_phy_phyml/list_wheatids_pid50_plus88ctls_fa_aln_hmmaln_phy_phyml_tree.txt

-rw-r--r--@  1 bterry  staff  15696 Sep 30  2018 list_wheatids_pid50_plus88ctls_fa_aln_hmmaln_phy_phyml_tree.txt
# copy, then rename it to:
list_wheatids_pid50_plus88ctls_phyml_tree.txt
-rw-r--r--@ 1 bterry  staff  15696 Sep 30  2018 list_wheatids_pid50_plus88ctls_phyml_tree.txt

#  next take it to unl.box.com, then to 'pro' laptop.
# from (on pmtmbook15) 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_wheatids_pid50_plus88ctls_fa_aln_hmmaln_phy_phyml/list_wheatids_pid50_plus88ctls_phyml_tree.txt

# to on 'pro', dir .../macbookpro2018/PPRv1.1_1161_88ctls/vikas_filter

in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 

# some diffs in overview of this phylogram compared to 50pid_206 seqs. As *expect* since initial MSA has additional 88 seqs. Try *relate* using location of some of the 206 50pid seq names. Note: ctls sort of *spread* around the 50pid+88ctls phylogram. Might benefit by using hmm from just 50pid (MSA from just 50pid), then bring in 88 ctls for hmmsearch step ??????????????????? 

# next, see if 50pid phylogram is grouping seqs for chr 1, 2, 6 ????????????????
# result: they basically 'group', with a few stragglers spread outside each chr's group.
 
# now check phylogram list_wheatids_pid50_plus88ctls_phyml_tree.txt file for groupings.
# result: mostly the chr's form groups, but with some stragglers. The four species of ctls roughly cluster each by themselves, but with some stragglers. Rice & BRAD closest to wheat seqs, Arab & soy farther away, but few stragglers don't follow this pattern.
# there are a few long branches.

# comments: Perhaps, run GSDS, looking for introns. Run two groups, 206 50pid seqs, and 88 ctls seqs separately.
#**********************
# updated this log file to github
#********************

10/01/18:
# Consider try do phyml phylogram with
# i. 206 50pid seqs for MSA, hmmbuild hmm
# ii. then for hmmsearch, let input file be 206 50pid seqs + 88 ctls seqs.
# idea, the 206 50pid seqs will display as did for 50pid MSA, hmmbuild phylogram. Perhaps easier see relationship these seqs to 88 ctls. In 50pid+88ctls MSA, & hmmbuild, the MSA & hmmbuild are different than the 50pid MSA & hmmbuild. So in 50pid+88ctls MSA & hmmbuild, the geometry of the 50pid seqs in the phylogram will be different than when just in 50pid MSA, & hmmbuild.

# so, start following preparation of 50pid MSA & hmmbuild above. That is, start with the hmmalign step, this time using 50pid+88ctls .fa input seq. See line 

10/02/18:
# so 1st need copy 
## copy from /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/slurm_hmmalign_wheatproj_PPRv1.1.sh to slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh in dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# new name: slurm_hmmalign_wheatproj_PPRv1.1combo_blastp50pidplus88ctls.sh
# make needed changes (done)

# ref line 10482
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp slurm_hmmalign_wheatproj_PPRv1.1combo_blastp50pidplus88ctls.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1combo_blastp50pidplus88ctls.sh
ls -al
sbatch slurm_hmmalign_wheatproj_PPRv1.1combo_blastp50pidplus88ctls.sh 16149483  9:58pm => ??:??am, 

squeue -u pterry  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al
-rw-r--r-- 1 pterry amundsen 824624 Oct  2 21:59 list_WheatIDs_pid50plus88combo.fa.aln.hmmaln

sacct -j  16149483 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-02T21:59:05 2018-10-02T21:59:24 
2018-10-02T21:59:05 2018-10-02T21:59:24 
59:24 - 59:05 = 19 sec

less list_WheatIDs_pid50plus88combo.fa.aln.hmmaln  ## # STOCKHOLM 1.0

## ref line 10514, next step, stockholm2fasta.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al

#cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
#-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g list_WheatIDs_pid50plus88combo.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.fa

ls -al
less list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.fa

grep -c ">Traes" list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.fa  ## 206 as expect
grep -c ">" list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.fa  ## 294 as expect
exit
#logout

## ref., line 10543, now fas to phy (line 10543)
 
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
#cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
#ls -al
#cd ..
#cd ..
#cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/blastp

#cd hmmsrch_protv1.1/blastp
#ls -al  ## 755 after cp

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load bioperl

./align_convert_fas_to_phy.pl list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.fa

ls -al
## Q: will it create file & name for output, yes.

-rw-r--r-- 1 pterry amundsen 362539 Oct  2 23:25 list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.phy
exit
less list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.phy
 294 815
'TraesCS1A02G067500.1'  ---------- ---------- ---------- ---------- ---------- ----------
logout

## scp back to macbook, (line 10573)
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  362539 Oct  2 23:32 list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.phy

less list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.phy

 294 815
'TraesCS5B02G250800.1'  ---------- ---------- ---------- ---NIKDRYH AGCIGTEDAL HLFDELLQVA 


head -n 3 list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.phy
 294 815
'TraesCS1A02G067500.1'  ---------- ---------- ---------- ---------- ---------- ---------- 
'TraesCS6D02G089400.1'  ---------- -----RPGSS SSSVSSRADQ LLNKLKDHLG PRTLQPERAH QLFDKLLRQT 

## so phy header      294 815, expect the 294

# ref line 10594
Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: list_WheatIDs_pid50plus88combo

The alignment file "list_WheatIDs_pid50plus88combo.fa.aln.hmmaln.phy" was uploaded, it contains 294 taxons of 815 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20181003-064144_Bg58/cmd.txt

job was submitted. (Fri, 10/02/18, 11:42pm)
#*******************************************************************
# done within by 8 hrs

10/03/18:
# outputfile: -rw-r--r--@  1 bterry  staff  15696 Oct  3  2018 list_wheatids_pid50plus88combo_fa_aln_hmmaln_phy_phyml_tree.txt
# location:
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_wheatids_pid50plus88combo_fa_aln_hmmaln_phy_phyml/list_wheatids_pid50plus88combo_fa_aln_hmmaln_phy_phyml_tree.txt

#  next take it to unl.box.com (../BLASTP_Filtering dir.), then to 'pro' laptop from (on pmtmbook15) 
# but 1st, make copy, shorten name to pid50plus88combo_phyml_tree.txt

# dir on pro, .../figtreetmp/PPRv1.1_1161_88ctls/vikas_filter

in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
#**********************
# Q: many/all the leaves don't have the seq name ??????????????????
# select tip labels/Names, *now* have names
#***********************
# **summary** comments for *combo*: soy, arab farther from 'Traes' seqs than BRAD & rice, but some 'mixing' in Traes groups. Mostly, no Treas out in 'ctrl' group.
# Takehome: Probably these 206 of 1161 are PPR seqs. The extl ctls are mostly but not all distinguishable from 'Traes' seqs.  If were to add some of the putative 'PLS' seqs to this 1161, *probably* would distinguish ????????????????????
# Looks like *combo* not helping ????????
# Could map (phenogram ??) this (blastp) subset of of 1161, see if most as previously on chr 1, 2, 6.

10/07/18:

# next, do 35pid, phyml, phenogram, see if more from 305 - 206 group can filter/locate on phylogram with the 206.

# line 10331, 
# ready to prepare .fa file from vikas list (list_WheatIDs_pid35.txt), then 'Notes ...' steps

# dnload list_WheatIDs_pid35.txt from box .../figtreetmp/BLASTP_Filtering dir. Copy to .../PPRv1.1plus_88ctls/vikas_filter dir. Has 305 seq names.

# from dir /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta list_WheatIDs_pid35.txt > list_WheatIDs_pid35.fa
# check have 305 '>' in bbedit, yes.

# ready for steps of 'Notes ...' protocol
# ref: line 10337

## Now run Notes steps ... 

## will work in dir /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

# in dir /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# copy slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh to slurm_muscle_wheatproj_PPRv1.1blastp35pid.sh
# modify as needed (done)

# refer line 10360
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp list_WheatIDs_pid35.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

scp slurm_muscle_wheatproj_PPRv1.1blastp35pid.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 10366)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if slurm_muscle_wheatproj_PPRv1.1blastp35pid.sh
ls -lh
sbatch slurm_muscle_wheatproj_PPRv1.1blastp35pid.sh  16177288 11:59am => , finally done.

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16177288     batch TJob_mus   pterry PD       0:00      1 (Priority)

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh

less job.16177288.err

MUSCLE v3.8.425 by Robert C. Edgar

# followed by lot of '^M' characters ??????????????????/
sacct -j  16177288 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-07T12:05:05 2018-10-07T12:08:53 
2018-10-07T12:05:05 2018-10-07T12:08:53 
08:53 - 05:05 = 3 min 48 sec

# output file:
-rw-r--r-- 1 pterry amundsen 793619 Oct  7 12:08 list_WheatIDs_pid35.fa.aln

less list_WheatIDs_pid35.fa.aln
# top of file looks ok.

wc -l list_WheatIDs_pid35.fa.aln
13115 list_WheatIDs_pid35.fa.aln

grep -c "^>Tr" list_WheatIDs_pid35.fa.aln  ## 305 as expect

#ref line 10414, next (2nd) step, fasta2stockholm.pl conversion
logout

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al
#cd ..
#cd refinPprots131vikas6
#cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl list_WheatIDs_pid35.fa.aln > list_WheatIDs_pid35.fa.aln.slx
ls -al *.slx
-rw-r--r-- 1 pterry amundsen 773493 Oct  7 14:40 list_WheatIDs_pid35.fa.aln.slx

## to check top of stockholm file
less list_WheatIDs_pid35.fa.aln.slx 
# STOCKHOLM 1.0
TraesCS7A02G407400.1 ---------------------------------------------------------------------
# at top is '# STOCKHOLM 1.0'

## now for *hmmbuild* (see line 10441)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
# cd /work/baenziger/pterry/wheatproj/RF139
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

hmmbuild list_WheatIDs_pid35.fa.aln.hmm list_WheatIDs_pid35.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             list_WheatIDs_pid35.fa.aln.slx
# output HMM file:                  list_WheatIDs_pid35.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     list_WheatIDs_pid35.fa.aln   305  2514   795     6.18  0.590 

# CPU time: 6.57u 0.01s 00:00:06.58 Elapsed: 00:00:06.62

# ref: line 10478
## realign using hmm model, hmmalign  (refer 03/26/18, line 7086)

## copy from slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh in dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/ to slurm_hmmalign_wheatproj_PPRv1.1blastp35pid.sh 
# make needed changes (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp slurm_hmmalign_wheatproj_PPRv1.1blastp35pid.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  *.hmmaln ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1blastp35pid.sh
ls -al *35*
sbatch slurm_hmmalign_wheatproj_PPRv1.1blastp35pid.sh 16177579  3:06pm => ??:??am, 

squeue -u pterry  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16177579     batch TJob_hmm   pterry PD       0:00      1 (Priority)

-rw-r--r-- 1 pterry amundsen 1251837 Oct  7 15:37 list_WheatIDs_pid35.fa.aln.hmmaln
sacct -j  16177579 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-07T15:37:05 2018-10-07T15:37:36 
2018-10-07T15:37:05 2018-10-07T15:37:36 
37:36 - 37:05 = 31 sec

less list_WheatIDs_pid35.fa.aln.hmmaln  ## # STOCKHOLM 1.0

## ref line 10517, next step, stockholm2fasta.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al

#cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
#ls -al
#-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g list_WheatIDs_pid35.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > list_WheatIDs_pid35.fa.aln.hmmaln.fa

ls -al *.fa
less list_WheatIDs_pid35.fa.aln.hmmaln.fa
# looks like .fa file

grep -c ">Traes" list_WheatIDs_pid35.fa.aln.hmmaln.fa  ## 305 as expect
#grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit
#logout

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
#ls -al
#cd ..
#cd ..
#cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/blastp

#cd hmmsrch_protv1.1/blastp
#ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load bioperl

./align_convert_fas_to_phy.pl list_WheatIDs_pid40.fa.aln.hmmaln.fa

ls -al *.phy
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 369982 Oct  7 21:46 list_WheatIDs_pid35.fa.aln.hmmaln.phy

exit
less list_WheatIDs_pid40.fa.aln.hmmaln.phy
 305 797
'TraesCS1B02G038400.1'  ---------- ---------- ---------- ---------- ---------- ---------- 
logout

## scp back to macbook, (line 10576)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid40.fa.aln.hmmaln.phy .

Passcode or option (1-3): 1
list_WheatIDs_pid35.fa.aln.hmmaln.phy                     0%    0     0.0KB/s - stalled -^CKilled by signal 2.
philip-terry-2:vikas_filter bterry$ scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid35.fa.aln.hmmaln.phy .
Password: 
Duo two-factor login for pterry

Enter a passcode or select one of the following options:

 1. Duo Push to XXX-XXX-1502
 2. Phone call to XXX-XXX-1502
 3. SMS passcodes to XXX-XXX-1502 (next code starts with: 2)

Passcode or option (1-3): 1
packet_write_wait: Connection to 129.93.227.113 port 22: Broken pipe

#*****************************************
# two scp attempts, both error message ??????????????????????????????????

#Try another file, one that previously was scp'd, see if it will scp.
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/testscp.phy .
# packet_write_wait: Connection to 129.93.227.113 port 22: Broken pipe
# also fails ???????????????????????????????????????

10/08/18:
try again next morning, appears to work fine ???????
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid40.fa.aln.hmmaln.phy .

#****************************************

ls -al *.phy
-rw-r--r--  1 bterry  staff  369982 Oct  8 09:25 list_WheatIDs_pid35.fa.aln.hmmaln.phy

STOPPED

less list_WheatIDs_pid35.fa.aln.hmmaln.phy
 305 797
'TraesCS1B02G038400.1'  ---------- ---------- ---------- ---------- ---------- ----------

#head -n 4 list_WheatIDs_pid35.fa.aln.hmmaln.phy

## so phy header       305 797, expect the 305

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_WheatIDs_pid35.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: list_WheatIDs_pid35.fa.aln.hmmaln.phy

The alignment file "list_WheatIDs_pid35.fa.aln.hmmaln.phy" was uploaded, it contains 305 taxons of 797 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20181008-165423_Sc32/cmd.txt

job was submitted. (Mon, 10/08/18, 9:54am)
# file back from phyml in France:
-rw-r--r--@ 1 bterry  staff  8656 Oct  8 17:10 list_wheatids_pid35_fa_aln_hmmaln_phy_phyml.zip

# outputfile:
-rw-r--r--@  1 bterry  staff  16709 Oct  8  2018 list_wheatids_pid35_fa_aln_hmmaln_phy_phyml_tree.txt

# location:
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_wheatids_pid35_fa_aln_hmmaln_phy_phyml/`list_wheatids_pid35_fa_aln_hmmaln_phy_phyml_tree.txt

#  next take it to unl.box.com (../BLASTP_Filtering dir.), then to 'pro' laptop from (on pmtmbook15) 
# but 1st, make copy, shorten name to pid35_phyml_tree.txt

# dir on pro, .../figtreetmp/PPRv1.1_1161_88ctls/vikas_filter

in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
#**********************
# Q: many/all the leaves don't have the seq name ??????????????????
# select tip labels/Names, *now* have names
#***********************
# comments: phylogram looks like has 88 ctls, but writing in the 1st few letters of each of the 4 ctl species, nothing 'lights up'. So, apparently correct 305 '35pid' seqs are all have in this phylogram.

# test chr's, see if they group. They do, with a few of each scattered in the 'spread' section not in pid50 phylogram. Geometry of pid50 & pid35 groups similar.


#*******************************************************************

# mean while, go on, start 'Notes steps for 35pidplus88ctls

# ref 10646
# next, prepare, submit 35pid_plus88ctls .fa file for processing thru 'Notes ...' steps.
# 1st cat 88ctls onto the 305 wheat seqs '.fa' file

# see line 10649
list_WheatIDs_pid35.fa
# cat preceding file to 88 ctl fasta seqs
# see line 10003, 
#copy rice1st_88ctls_soyfixed.fa file to /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# from .../annotation1.1/PPRv1.1plus_88ctls dir.
# now cat this file with list_WheatIDs_pid50.fa will give 206+88=294 seqs

cat rice1st_88ctls_soyfixed.fa list_WheatIDs_pid35.fa > list_WheatIDs_pid35_plus88ctls.fa
# bbedit shows 393 seqs.

## Now run Notes steps ...  (ref line 10660)

cp slurm_muscle_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh slurm_muscle_wheatproj_PPRv1.1blastp35pid_plus88ctls.sh
# modify as needed (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp list_WheatIDs_pid35_plus88ctls.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

scp slurm_muscle_wheatproj_PPRv1.1blastp35pid_plus88ctls.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 10671)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if slurm_muscle_wheatproj_PPRv1.1blastp35pid_plus88ctls.sh
ls -lh
sbatch slurm_muscle_wheatproj_PPRv1.1blastp35pid_plus88ctls.sh  16181083 10:16am => , finally done.

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16181083     batch TJob_mus   pterry  R       0:29      1 c3618

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh
less job.16181083.err

sacct -j  16181083 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-08T10:16:05 2018-10-08T10:23:35 
2018-10-08T10:16:05 2018-10-08T10:23:35 
23:35 - 16:05 = 7 min 30 sec

-rw-r--r-- 1 pterry amundsen  937543 Oct  8 10:23 list_WheatIDs_pid35_plus88ctls.fa.aln

less list_WheatIDs_pid35_plus88ctls.fa.aln
# top of file looks ok.

wc -l list_WheatIDs_pid35_plus88ctls.fa.aln
15720 list_WheatIDs_pid35_plus88ctls.fa.aln

grep -c "^>" list_WheatIDs_pid35_plus88ctls.fa.aln  ## 393 as expect
logout

#ref line 10711, next (2nd) step, fasta2stockholm.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al
#cd ..
#cd refinPprots131vikas6
#cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
#ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl list_WheatIDs_pid35_plus88ctls.fa.aln > list_WheatIDs_pid35_plus88ctls.fa.aln.slx
ls -al *.slx
-rw-r--r-- 1 pterry amundsen 914900 Oct  8 11:33 list_WheatIDs_pid35_plus88ctls.fa.aln.slx

## to check top of stockholm file
less list_WheatIDs_pid35_plus88ctls.fa.aln.slx
# STOCKHOLM 1.0
AT1G12770.1 ------------------------------------------------------------------------------

## now for *hmmbuild* (see line 10733)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
# cd /work/baenziger/pterry/wheatproj/RF139
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
#**************************
# srun: Job step creation temporarily disabled, retrying   ????????
#****************************
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

hmmbuild list_WheatIDs_pid35_plus88ctls.fa.aln.hmm list_WheatIDs_pid35_plus88ctls.fa.aln.slx

# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             list_WheatIDs_pid35_plus88ctls.fa.aln.slx
# output HMM file:                  list_WheatIDs_pid35_plus88ctls.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     list_WheatIDs_pid35_plus88ctls.fa.aln   393  2307   743     8.12  0.590 

# CPU time: 6.86u 0.01s 00:00:06.87 Elapsed: 00:00:06.90

less list_WheatIDs_pid35_plus88ctls.fa.aln.hmm
HMMER3/f [3.1b2 | February 2015]
NAME  list_WheatIDs_pid35_plus88ctls.fa.aln
LENG  743
ALPH  amino

# ref: line 10769
## realign using hmm model, hmmalign  (refer 03/26/18, line 7086)

## copy from 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/slurm_hmmalign_wheatproj_PPRv1.1blastp50pid_plus88ctls.sh
 to
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/slurm_hmmalign_wheatproj_PPRv1.1blastp35pid_plus88ctls.sh
# make needed changes (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp slurm_hmmalign_wheatproj_PPRv1.1blastp35pid_plus88ctls.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  *.hmm ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1blastp35pid_plus88ctls.sh
ls -al hmmalign*
sbatch slurm_hmmalign_wheatproj_PPRv1.1blastp35pid_plus88ctls.sh 16181573  1:33pm => ??:??am, 

squeue -u pterry  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

# ref 10794
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  *.hmmaln
-rw-r--r-- 1 pterry amundsen 2057307 Oct  8 13:34 list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln

sacct -j  16181573 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-08T13:33:35 2018-10-08T13:34:02 
2018-10-08T13:33:35 2018-10-08T13:34:02
34:02 - 33:35 = 27 sec

less list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln
# STOCKHOLM 1.0

## ref line 10808, next step, stockholm2fasta.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  *.hmmaln

#cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
#ls -al
#-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.fa

ls -al *hmmaln.fa
less list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.fa
# looks like .fa file
grep -c ">Traes" list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.fa  ## 305 as expect
grep -c ">" list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.fa  ## 393 as expect

exit
#logout
## ref., now fas to phy (line 10836)

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
#ls -al
#cd ..
#cd ..
#cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/blastp

#cd hmmsrch_protv1.1/blastp
#ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load bioperl

./align_convert_fas_to_phy.pl list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.fa
ls -al  *.phy
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 445303 Oct  8 18:37 list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.phy

exit
less list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.phy
 393 746
'TraesCS6D02G083300.1'  ---------- ---------- ---------- ---------- ---------- ---------- 

logout

## scp back to macbook, (line 10864)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  445303 Oct  8 19:00 list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.phy

less list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.phy
 393 746

#head -n 3 list_WheatIDs_pid50_plus88ctls.fa.aln.hmmaln.phy

## so phy header         393 746, expect the 393

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections: (line 10885)

browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: list_WheatIDs_pid35_plus88ctls

The alignment file "list_WheatIDs_pid35_plus88ctls.fa.aln.hmmaln.phy" was uploaded, it contains 393 taxons of 746 characters.

Your job was submitted. (7:08pm, 10/08/18)

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20181009-020819_Og00/cmd.txt

10/09/18:
ref: line 11400
# outputfile:
-rw-r--r--@ 1 bterry  staff  10578 Oct  9 14:42 list_wheatids_pid35_plus88ctls_fa_aln_hmmaln_phy_phyml.zip

# location:
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_wheatids_pid35_plus88ctls_fa_aln_hmmaln_phy_phyml/list_wheatids_pid35_plus88ctls_fa_aln_hmmaln_phy_phyml_tree.txt

#  next take it to unl.box.com (../BLASTP_Filtering dir.), then to 'pro' laptop from (on pmtmbook15) 
# but 1st, make copy, shorten name to pid35_plus88ctls_phyml_tree.txt

# dir on pro, .../macbookpro2018/PPRv1.1_1161_88ctls/vikas_filter

in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
#**********************
# Q: many/all the leaves don't have the seq name ??????????????????
# select tip labels/Names, *now* have names
#***********************
# comments: phylogram looks like has 88 ctls, but writing in the 1st few letters of each of the 4 ctl species, nothing 'lights up'. So, apparently correct 305 '35pid' seqs are all have in this phylogram.

# test chr's, see if they group. They do, with a few of each scattered in the 'spread' section not in pid50 phylogram. Geometry of pid50 & pid35 groups similar.

# comments: for pid35_plus88ctls_phyml_tree.txt in figtree display.See 7 groups on phylogram. 5 similar to 50pid phylogram. A 6th similar to 'new' group on pid35 relative to pid50. Finally, a group with mostly (?) seqs from the 88 ctl seqs. To check, if bracky mostly there? Cretainly at least 1 bracky seq is in the chr1 group ??????


# uploaded two pid35 tree files exposed to figtree from 'pro' to box (BLASTP_Filtering).


# vikas, plan, make phylogram for 40pid. 

10/10/18:
# ref line 11117
make phylogram for 
-rw-r--r--@ 1 bterry  staff  4531 Oct  9 23:01 list_WheatIDs_pid40.txt
# has 216 seqs. 
# place in dir: /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

# compare to previous phylogram of list_WheatIDs_pid35.txt.

# list_WheatIDs_pid40.txt dnloaded from box .../figtreetmp/BLASTP_Filtering dir.

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta list_WheatIDs_pid40.txt > list_WheatIDs_pid40.fa
# check have 216 '>' in bbedit, yes.

# ready for steps of 'Notes ...' protocol
# ref: line 11130

## Now run Notes steps ... 

## will work in dir /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

# in dir /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# copy slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh to slurm_muscle_wheatproj_PPRv1.1blastp40pid.sh
cp slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh slurm_muscle_wheatproj_PPRv1.1blastp40pid.sh
# modify as needed (done)

10/11/18:

# refer line 11140
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp list_WheatIDs_pid40.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

scp slurm_muscle_wheatproj_PPRv1.1blastp40pid.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 11147)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if slurm_muscle_wheatproj_PPRv1.1blastp40pid.sh
ls -lh *40pid*
sbatch slurm_muscle_wheatproj_PPRv1.1blastp40pid.sh  16204187 2:59pm => , finally done.

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16204187     batch TJob_mus   pterry  R       0:33      1 c3616

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al list*40*
# output file:
-rw-r--r-- 1 pterry amundsen 400259 Oct 11 15:00 list_WheatIDs_pid40.fa.aln
ls -al *.err
less job.16204187.err

MUSCLE v3.8.425 by Robert C. Edgar

# followed by lot of '^M' characters ??????????????????/

sacct -j  16204187 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-11T14:59:06 2018-10-11T15:00:37 
2018-10-11T14:59:06 2018-10-11T15:00:37
00:37 - 59:06 = 1 min 31 sec

less list_WheatIDs_pid40.fa.aln
# top of file looks ok.

wc -l list_WheatIDs_pid40.fa.aln
6696 list_WheatIDs_pid40.fa.aln

grep -c "^>Tr" list_WheatIDs_pid40.fa.aln  ## 216 as expect

#ref line 11190, next (2nd) step, fasta2stockholm.pl conversion
logout

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al
#cd ..
#cd refinPprots131vikas6
#cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
#ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl list_WheatIDs_pid40.fa.aln > list_WheatIDs_pid40.fa.aln.slx
ls -al *.slx
-rw-r--r-- 1 pterry amundsen 388598 Oct 11 15:16 list_WheatIDs_pid40.fa.aln.slx

## to check top of stockholm file
less list_WheatIDs_pid40.fa.aln.slx 
# STOCKHOLM 1.0
TraesCS7A02G407400.1 ---------------------------------------------------------------------
# at top is '# STOCKHOLM 1.0'

## now for *hmmbuild* (see line 11214)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
# cd /work/baenziger/pterry/wheatproj/RF139
#ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

hmmbuild list_WheatIDs_pid40.fa.aln.hmm list_WheatIDs_pid40.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             list_WheatIDs_pid40.fa.aln.slx
# output HMM file:                  list_WheatIDs_pid40.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     list_WheatIDs_pid40.fa.aln   216  1777   826     2.96  0.590 

# CPU time: 4.86u 0.01s 00:00:04.87 Elapsed: 00:00:04.90

# ref: line 11241
## realign using hmm model, hmmalign  (refer 03/26/18, line 11241)

## copy from slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh in dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/ to slurm_hmmalign_wheatproj_PPRv1.1blastp40pid.sh 
cp slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh slurm_hmmalign_wheatproj_PPRv1.1blastp40pid.sh
# make needed changes (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp slurm_hmmalign_wheatproj_PPRv1.1blastp40pid.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  *.hmm ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1blastp40pid.sh
ls -al *40*
sbatch slurm_hmmalign_wheatproj_PPRv1.1blastp40pid.sh 16204560  3:58pm => ??:??am, 

squeue -u pterry  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

ls -al  *.hmmaln
-rw-r--r-- 1 pterry amundsen  642093 Oct 11 15:58 list_WheatIDs_pid40.fa.aln.hmmaln

sacct -j  16204560 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-11T15:58:27 2018-10-11T15:58:41 
2018-10-11T15:58:27 2018-10-11T15:58:41 
58:41 - 58:27 = 14 sec

less list_WheatIDs_pid40.fa.aln.hmmaln  ## # STOCKHOLM 1.0

## ref line 11274, next step, stockholm2fasta.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al

#cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
#ls -al
#-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g list_WheatIDs_pid40.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > list_WheatIDs_pid40.fa.aln.hmmaln.fa

ls -al *hmmaln.fa
less list_WheatIDs_pid40.fa.aln.hmmaln.fa
# looks like .fa file

grep -c ">Traes" list_WheatIDs_pid40.fa.aln.hmmaln.fa  ## 216 as expect
#grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit
#logout

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
#ls -al
#cd ..
#cd ..
#cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/blastp

#cd hmmsrch_protv1.1/blastp
#ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load bioperl

./align_convert_fas_to_phy.pl list_WheatIDs_pid45.fa.aln.hmmaln.fa

ls -al *.phy
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 269370 Oct 11 22:51 list_WheatIDs_pid40.fa.aln.hmmaln.phy

exit
less list_WheatIDs_pid40.fa.aln.hmmaln.phy
 216 828
'TraesCS1B02G084563.1'  ---------- ---------- ---------- ---------- ---------- ----------
logout

## scp back to macbook, (line 11330)
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid40.fa.aln.hmmaln.phy .

ls -al *.phy
-rw-r--r--  1 bterry  staff  269370 Oct 11 22:58 list_WheatIDs_pid40.fa.aln.hmmaln.phy

less list_WheatIDs_pid40.fa.aln.hmmaln.phy
 216 828
'TraesCS1B02G084563.1'  ---------- ---------- ---------- ---------- ---------- ---------- 

#head -n 4 list_WheatIDs_pid35.fa.aln.hmmaln.phy

## so phy header       216 828, expect the 216

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_WheatIDs_pid40.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: list_WheatIDs_pid40

The alignment file "list_WheatIDs_pid40.fa.aln.hmmaln.phy" was uploaded, it contains 216 taxons of 828 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20181012-060413_Fd59/cmd.txt

job was submitted. (Mon, 10/11/18, 11:04pm)

# ref line 11400
# file back from phyml in France:
-rw-r--r--@ 1 bterry  staff   7082 Oct 12 10:39 list_wheatids_pid40_fa_aln_hmmaln_phy_phyml.zip

# outputfile:
-rw-r--r--@  1 bterry  staff  11815 Oct 12 08:55 list_wheatids_pid40_fa_aln_hmmaln_phy_phyml_tree.txt

# location:
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_wheatids_pid40_fa_aln_hmmaln_phy_phyml/list_wheatids_pid40_fa_aln_hmmaln_phy_phyml_tree.txt

#  next take it to unl.box.com (../BLASTP_Filtering dir.), then to 'pro' laptop from (on pmtmbook15) 
# but 1st, make copy, shorten name to pid40_phyml_tree.txt
cp list_wheatids_pid40_fa_aln_hmmaln_phy_phyml_tree.txt pid40_phyml_tree.txt

# dir on pro, .../macbookpro2018/PPRv1.1_1161_88ctls/vikas_filter
 
in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
# Q: colour by: user selection currently, **what** about something other like aLRT ??????? 

# Describe pid40 phylogram !!!!!!!!!!!!!!!
# similar to pid 50 (216 compared to 206 seqs).
#***********************************************************
# ref line 11725
# vikas, plan, make phylogram for 45pid. 

# ref line 11728
# list_WheatIDs_pid45.txt dnloaded from box .../figtreetmp/BLASTP_Filtering dir.

make phylogram for 
ls -al *45.txt
-rw-r--r--@ 1 bterry  staff  4447 Oct 11 23:24 list_WheatIDs_pid45.txt
# has 212 seqs. 
# place in dir: /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

# to compare to previous phylogram of list_WheatIDs_pid35.txt.

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta list_WheatIDs_pid45.txt > list_WheatIDs_pid45.fa
# check have 212 '>' in bbedit, yes.

# ready for steps of 'Notes ...' protocol
# ref: line 11742

## Now run Notes steps ... 

## will work in dir /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.

# in dir /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# copy slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh to slurm_muscle_wheatproj_PPRv1.1blastp45pid.sh
cp slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh slurm_muscle_wheatproj_PPRv1.1blastp45pid.sh
# modify as needed (done)

# refer line 11762
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp list_WheatIDs_pid45.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

scp slurm_muscle_wheatproj_PPRv1.1blastp45pid.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 11762)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if slurm_muscle_wheatproj_PPRv1.1blastp45pid.sh
ls -lh *45pid*
sbatch slurm_muscle_wheatproj_PPRv1.1blastp45pid.sh  16206433 11:44pm => , finally done.

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16206433     batch TJob_mus   pterry  R       0:06      1 c1302

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al list*45*
# output file:
-rw-r--r-- 1 pterry amundsen 389667 Oct 11 23:46 list_WheatIDs_pid45.fa.aln


ls -al *.err
less job.16206433.err

MUSCLE v3.8.425 by Robert C. Edgar

# followed by lot of '^M' characters ??????????????????/

sacct -j  16206433 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-11T23:44:37 2018-10-11T23:46:10 
2018-10-11T23:44:37 2018-10-11T23:46:10 
46:10 - 44:37 = 1 min 23 sec

less list_WheatIDs_pid45.fa.aln
# top of file looks ok.

wc -l list_WheatIDs_pid45.fa.aln
6572 list_WheatIDs_pid45.fa.aln

grep -c "^>Tr" list_WheatIDs_pid45.fa.aln  ## 212 as expect

#ref line 11803, next (2nd) step, fasta2stockholm.pl conversion
logout

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al
#cd ..
#cd refinPprots131vikas6
#cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
#ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl list_WheatIDs_pid45.fa.aln > list_WheatIDs_pid45.fa.aln.slx
ls -al *.slx
-rw-r--r-- 1 pterry amundsen 378222 Oct 12 22:45 list_WheatIDs_pid45.fa.aln.slx

## to check top of stockholm file
less list_WheatIDs_pid45.fa.aln.slx 
# STOCKHOLM 1.0
TraesCS7A02G407400.1 ---------------------------------------------------------------------
# at top is '# STOCKHOLM 1.0'

## now for *hmmbuild* (see line 11214)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
# cd /work/baenziger/pterry/wheatproj/RF139
#ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

hmmbuild list_WheatIDs_pid45.fa.aln.hmm list_WheatIDs_pid45.fa.aln.slx
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             list_WheatIDs_pid45.fa.aln.slx
# output HMM file:                  list_WheatIDs_pid45.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     list_WheatIDs_pid45.fa.aln   212  1762   829     2.65  0.590 

# CPU time: 7.13u 0.01s 00:00:07.14 Elapsed: 00:00:07.16

# ref: line 11854
## realign using hmm model, hmmalign

## copy from slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh in dir. /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/ to slurm_hmmalign_wheatproj_PPRv1.1blastp45pid.sh 
cp slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh slurm_hmmalign_wheatproj_PPRv1.1blastp45pid.sh
# make needed changes (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp slurm_hmmalign_wheatproj_PPRv1.1blastp45pid.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  *.hmm ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1blastp45pid.sh
ls -al *45*
sbatch slurm_hmmalign_wheatproj_PPRv1.1blastp45pid.sh 16212957  11:05pm => ??:??am, 

squeue -u pterry  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  *.hmmaln
-rw-r--r-- 1 pterry amundsen  591490 Oct 12 23:05 list_WheatIDs_pid45.fa.aln.hmmaln

sacct -j  16212957 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-12T23:05:41 2018-10-12T23:05:56 
2018-10-12T23:05:41 2018-10-12T23:05:56 
05:56 - 05:41 = 15 sec

less list_WheatIDs_pid40.fa.aln.hmmaln  ## # STOCKHOLM 1.0

## ref line 11890, next step, stockholm2fasta.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al

#cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
#ls -al
#-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g list_WheatIDs_pid45.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > list_WheatIDs_pid45.fa.aln.hmmaln.fa

ls -al *hmmaln.fa
-rw-r--r-- 1 pterry amundsen 180625 Oct 12 23:14 list_WheatIDs_pid45.fa.aln.hmmaln.fa

less list_WheatIDs_pid45.fa.aln.hmmaln.fa
# looks like .fa file

grep -c ">Traes" list_WheatIDs_pid45.fa.aln.hmmaln.fa  ## 212 as expect
#grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit
#logout

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
#ls -al
#cd ..
#cd ..
#cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/blastp

#cd hmmsrch_protv1.1/blastp
#ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load bioperl

./align_convert_fas_to_phy.pl list_WheatIDs_pid45.fa.aln.hmmaln.fa

ls -al *.phy
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 265230 Oct 12 23:20 list_WheatIDs_pid45.fa.aln.hmmaln.phy
exit
less list_WheatIDs_pid45.fa.aln.hmmaln.phy
 212 831
'TraesCS1D02G067703.1'  ---------- ---------- ---------- ---------- ---------- ----------

logout

## scp back to macbook, (line 11946)
cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/list_WheatIDs_pid45.fa.aln.hmmaln.phy .

ls -al *.phy
-rw-r--r--  1 bterry  staff  265230 Oct 12 23:24 list_WheatIDs_pid45.fa.aln.hmmaln.phy

less list_WheatIDs_pid45.fa.aln.hmmaln.phy
 212 831
'TraesCS1D02G067703.1'  ---------- ---------- ---------- ---------- ---------- ---------- 

#head -n 4 list_WheatIDs_pid35.fa.aln.hmmaln.phy

## so phy header        212 831216 828, expect the 212

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.

Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_WheatIDs_pid45.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: list_WheatIDs_pid45

The alignment file "list_WheatIDs_pid45.fa.aln.hmmaln.phy" was uploaded, it contains 212 taxons of 831 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20181013-063157_Pu85/cmd.txt

job was submitted. (Mon, 10/12/18, 11:31pm)

# ref line 11986
# file back from phyml in France:
-rw-r--r--@ 1 bterry  staff   6998 Oct 13 09:24 list_wheatids_pid45_fa_aln_hmmaln_phy_phyml.zip

# outputfile:
-rw-r--r--@ 1 bterry  staff  11595 Oct 13 09:04 list_wheatids_pid45_fa_aln_hmmaln_phy_phyml_tree.txt

# location:
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/list_wheatids_pid45_fa_aln_hmmaln_phy_phyml/list_wheatids_pid45_fa_aln_hmmaln_phy_phyml_tree.txt

#  next take it to unl.box.com (../BLASTP_Filtering dir.), then to 'pro' laptop from (on pmtmbook15) 
# but 1st, make copy, shorten name to pid45_phyml_tree.txt
cp list_wheatids_pid45_fa_aln_hmmaln_phy_phyml_tree.txt pid45_phyml_tree.txt

# dir on pro, .../macbookpro2018/PPRv1.1_1161_88ctls/vikas_filter
 
in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
# Q: colour by: user selection currently, **what** about something other like aLRT ??????? 

# Describe pid45 phylogram !!!!!!!!!!!!!!!
# similar to pid 40 (212 compared to 216 seqs).
# quick look, *could* be the fewer 4 seqs could be all on long branches betw pid 40 & 45

# slip a save to ***github*** in here

# log file uploaded to figtreetmp

10/21/18:
# to do: want to identify RF-like subset of 1161 'P' proteins. Perhaps tentatively select the 206 form pid50 tree. Plan remove couple 'long branch' seqs. Compare with pid45 (212), pid40 (216), decide final set to keep.
# Of interest, perhaps check if any of the 88 ctls in pid35 + 88ctls are in the Traes chr 1, 2, 6 groups ?????????????????????? Or, if any Traes are in the 88 ctls group ???????
# pid35 has lot Traes outside chr 1, 2, 6 groups. What to think ????????

# so 1st, get list of seq names (206) for pid50 phylogram. 
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

-rw-r--r--@ 1 bterry  staff  4322 Sep 25 22:06 list_WheatIDs_pid50.txt

# now, need remove 'long branch' seqs, view list_WheatIDs_pid50_phyml_tree.txt in figtree to do.

# two long branches coming betw & off of the two chr 6 groups
# off one of group 6 are 4 seqs
TraesCS1B02G084581.1
# etc

# 6 seqs on long branches *betw.* chr6 groups, all chr7.

# 15 seqs are chr 7 or CSU seqs

# so long branch seqs are 6 + 4 = 10. Removing leaves 206 - 10 = *196*.

# to do, remove these 10 from this tree file, display, make sure now no more long branches.

# list_WheatIDs_pid50.txt, prune 10 LBranch seqs giving file:
list_WheatIDs_pid50LB10prunedto196.txt

# next, compare to pid45, pid40. Document differences. Perhaps use my bash script ????
# or setdiff examples from: https://stackoverflow.com/questions/1837968/how-to-tell-what-is-in-one-vector-and-not-another

# compare to file, has 212 seqs
-rw-r--r--@ 1 bterry  staff  4447 Oct 11 23:24 list_WheatIDs_pid45.txt

#******************R code start**********************
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter")
getwd()
pid50_196 <- read.delim("list_WheatIDs_pid50LB10prunedto196.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("pid50pruned"))
dim(pid50_196)
head(pid50_196)
class(pid50_196)

pid45_212 <- read.delim("list_WheatIDs_pid45.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("pid45"))
dim(pid45_212)
head(pid45_212)
class(pid45_212)

intersect196_212 <- intersect(pid50_196$pid50pruned, pid45_212$pid45)
length(intersect196_212)
class(intersect196_212)
head(intersect196_212)

zero <- setdiff(pid50_196$pid50pruned, pid45_212$pid45)
length(zero)

sixteen <- setdiff (pid45_212$pid45, pid50_196$pid50pruned)
length(sixteen)

head(sixteen)

write.table(sixteen, file="sixteen_pid45_pid50.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)
#*********************R code end********************************
# ok, 10 of 16 are the 10 removed from pid50 as long branch seqs.
# now go to figtree, locate the 6 which must be the 212 - 206 = 6 betw. pid50 & pid45.
# result: 4 basically indistinguishable from '<50pid' seqs, 2 extending out a bit in phylogram.

# next to do, compare pid50_196 (196) with pid40 (216), pid35 (305)
 
10/22/18:
# so need setdiff for list_WheatIDs_pid50LB10prunedto196.txt & 
-rw-r--r--@ 1 bterry  staff  4531 Oct  9 23:01 list_WheatIDs_pid40.txt

#******************R code start**********************
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter")
getwd()
pid50_196 <- read.delim("list_WheatIDs_pid50LB10prunedto196.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("pid50pruned"))
dim(pid50_196)
head(pid50_196)
class(pid50_196)

pid40_216 <- read.delim("list_WheatIDs_pid40.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("pid40"))
dim(pid40_216)
head(pid40_216)
class(pid40_216)

intersect196_216 <- intersect(pid50_196$pid50pruned, pid40_216$pid40)
length(intersect196_216)
class(intersect196_216)
head(intersect196_216)

zero <- setdiff(pid50_196$pid50pruned, pid40_216$pid40)
length(zero)

twenty <- setdiff (pid40_216$pid40, pid50_196$pid50pruned)
length(twenty)

head(twenty)

write.table(twenty, file="twenty_pid40_pid50.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)
#*********************R code end********************************

# ok, 10 of 16 are the 10 removed from pid50 as long branch seqs.
# now go to figtree, locate the 10 which must be the 216 - 206 = 10 betw. pid50 & pid40.

# <50 who are not LB's could be additional candidates ??????
# result: 5 basically indistinguishable from '<50pid' 'basic' seqs, 2 extending out a bit in phylogram & 3 out on long branches. So 5 or 7 could be added to 196 as RF-like seqs ??????????????

# next to do, compare pid50_196 (196) with pid35 (305). Just see what have beyond the 196?

10/22/18:
# talked to vikas
# 1. new phylogram, from pid40 (216) list of seqs, subtr the ten which took pid50 from 206 to 196. Subtract the three seqs from pid40_phyml_tree.txt which are on a LB on phylogram yielding 203 seqs for new phylogram. Display colors for chr 1, 2, 6.
# 2. GSDS for 
# the 203 seqs on 203 phylogram
# the 13 seqs removed from pid40 phylogram list (216 - 13 = 203)
# 3. phenogram of the 203 seqs


# to prepare for new 203 seqs phylogram, 1st identify the 3 LB seqs on pid40_phyml_tree,txt, using figtree.
Identified in 
-rw-r--r--  1 bterry  staff  419 Oct 22 09:40 twenty_pid40_pid50.txt
# seqs 4th, 7th, 16th rows.
# next, remove these three and the ten (refer: 206 (pid50) - 10 = 196 prevly removed from pid50 to obtain list_WheatIDs_pid50LB10prunedto196.txt.

# so, take list_WheatIDs_pid40.txt, copy to pid40pruned13to203.txt
cp list_WheatIDs_pid40.txt pid40_216pruned13to203.txt
# manually deleted 10 (206 - 10 from pid50 giving 196) & 3 seqs on LB in pid40 resulting in 203 seqs in file.
# to ck 216 vs 203 with setdiff
list_WheatIDs_pid40.txt, pid40_216pruned13to203.txt
#******************R code start**********************
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter")
getwd()
pid40_216 <- read.delim("list_WheatIDs_pid40.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("pid40"))
dim(pid40_216)
head(pid40_216)
class(pid40_216)

pid40_203 <- read.delim("pid40_216pruned13to203.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("pid40pr"))
dim(pid40_203)
head(pid40_203)
class(pid40_203)

intersect203_216 <- intersect(pid40_216$pid40, pid40_203$pid40pr)
length(intersect203_216)
class(intersect203_216)
head(intersect203_216)

zero <- setdiff(pid40_203$pid40pr, pid40_216$pid40)
length(zero)  ## 0

thirteen <- setdiff (pid40_216$pid40, pid40_203$pid40pr)
length(thirteen)  ## 13

head(thirteen)

# write.table(twenty, file="twenty_pid40_pid50.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)
#*********************R code end********************************
# so checks

10/24/18:

# to do, the 'Notes' steps thru to phyml phylogram.
# ref line 10331
# ready to prepare .fa file from vikas pruned pid40 list (pid40_216pruned13to203.txt), 

./getseq.awk IWGSC_v1.1_HC_20170706_pep.fasta pid40_216pruned13to203.txt > pid40_216pruned13to203.fa
# check have 203 '>' in bbedit, yes.

then 'Notes ...' steps
# from dir /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

## Now run Notes steps ... 

## dir on crane to do 1st three steps, muscle, fasta2stockholm.pl, & hmmbuild.
pwd ## /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

# rename to slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh to slurm_muscle_wheatproj_PPRv1.1blastp40pid_203.sh
cp slurm_muscle_wheatproj_PPRv1.1blastp50pid.sh slurm_muscle_wheatproj_PPRv1.1blastp40pid_203.sh
# modify as needed (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pid40_216pruned13to203.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

scp slurm_muscle_wheatproj_PPRv1.1blastp40pid_203.sh pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

## now, ready sbatch this slurm (see line 10366)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh  ## ck dir contents?
cd /home/baenziger/pterry/scripts

## ck if slurm_muscle_wheatproj_PPRv1.1blastp40pid_203.sh
ls -lh
sbatch slurm_muscle_wheatproj_PPRv1.1blastp40pid_203.sh  16298730 11:10am => , finally done.

squeue -u pterry  ## a PD
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          16298730     batch TJob_mus   pterry  R       0:30      1 c3716
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh
ls -al *16298730*
less job.16298730.err
MUSCLE v3.8.425 by Robert C. Edgar

http://www.drive5.com/muscle
This software is donated to the public domain.
Please cite: Edgar, R.C. Nucleic Acids Res 32(5), 1792-97.

# followed by lot of '^M' characters ??????????????????/

sacct -j  16298730 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-24T11:10:32 2018-10-24T11:11:57 
2018-10-24T11:10:32 2018-10-24T11:11:57 
11:11:57 - 11:10:32 = 1 min 25 sec

# output file:
-rw-r--r-- 1 pterry amundsen 369K Oct 24 11:11 pid40_216pruned13to203.fa.aln
less pid40_216pruned13to203.fa.aln
# top of file looks ok.

wc -l pid40_216pruned13to203.fa.aln
6293 pid40_216pruned13to203.fa.aln

grep -c "^>Tr" pid40_216pruned13to203.fa.aln  ## 203 as expect

#ref line 10414, next (2nd) step, fasta2stockholm.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
#cd /work/baenziger/pterry/wheatproj/RF139
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al
#cd ..
#cd refinPprots131vikas6
#cp /work/baenziger/pterry/wheatproj/refinPprots820/fasta2stockholm.pl .
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load perl/5.22
perl fasta2stockholm.pl pid40_216pruned13to203.fa.aln > pid40_216pruned13to203.fa.aln.slx
ls -al
-rw-r--r-- 1 pterry amundsen  366023 Oct 24 12:08 pid40_216pruned13to203.fa.aln.slx

## to check top of stockholm file
less pid40_216pruned13to203.fa.aln.slx 
# STOCKHOLM 1.0
TraesCS7B02G372755.1 ---------------------------------------------------------------------
# at top is '# STOCKHOLM 1.0'

## now for *hmmbuild* (see line 10441)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
# cd /work/baenziger/pterry/wheatproj/RF139
ls -al

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
module load compiler/gcc/4.8 openmpi/1.8 hmmer
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp

hmmbuild pid40_216pruned13to203.fa.aln.hmm pid40_216pruned13to203.fa.aln.slx
# hmmbuild :: profile HMM construction from multiple sequence alignments
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# input alignment file:             pid40_216pruned13to203.fa.aln.slx
# output HMM file:                  pid40_216pruned13to203.fa.aln.hmm
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# idx name                  nseq  alen  mlen eff_nseq re/pos description
#---- -------------------- ----- ----- ----- -------- ------ -----------
1     pid40_216pruned13to203.fa.aln   203  1781   785     2.79  0.590 

# CPU time: 3.13u 0.01s 00:00:03.13 Elapsed: 00:00:03.17
exit
ls -al *.hmm
-rw-r--r-- 1 pterry amundsen 366066 Oct 24 12:14 pid40_216pruned13to203.fa.aln.hmm

less pid40_216pruned13to203.fa.aln.hmm
HMMER3/f [3.1b2 | February 2015]
NAME  pid40_216pruned13to203.fa.aln
LENG  785
ALPH  amino

# ref: line 10478
## realign using hmm model, hmmalign

## copy from /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh
# to slurm_hmmalign_wheatproj_PPRv1.1blastp40pid_203.sh
cp slurm_hmmalign_wheatproj_PPRv1.1blastp50pid.sh slurm_hmmalign_wheatproj_PPRv1.1blastp40pid_203.sh
# make needed changes (done)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp slurm_hmmalign_wheatproj_PPRv1.1blastp40pid_203.sh  pterry@crane.unl.edu:/home/baenziger/pterry/scripts/

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al  ## ck dir contents?
cd /home/baenziger/pterry/scripts
## ck if present slurm_hmmalign_wheatproj_PPRv1.1blastp40pid_203.sh
ls -al *_203.sh
sbatch slurm_hmmalign_wheatproj_PPRv1.1blastp40pid_203.sh ## 16299658  1:38pm => ??:??am, 

squeue -u pterry  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)

cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al *hmmaln
-rw-r--r-- 1 pterry amundsen  595058 Oct 24 13:38 pid40_216pruned13to203.fa.aln.hmmaln
sacct -j  16299658 -o start,end
              Start                 End 
------------------- ------------------- 
2018-10-24T13:37:50 2018-10-24T13:38:07 
2018-10-24T13:37:50 2018-10-24T13:38:07 
13:38:07 - 13:37:50 = 17 sec

less pid40_216pruned13to203.fa.aln.hmmaln  ## # STOCKHOLM 1.0

## ref line 10517, next step, stockholm2fasta.pl conversion

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -al *hmmaln

#cp /work/baenziger/pterry/wheatproj/refinPprots820/stockholm2fasta.pl .
ls -al
-rwxr-xr-x  1 pterry amundsen    1398 Feb 16 23:21 stockholm2fasta.pl

# Convert the realigned file from Stockholm to fasta format using Vikas perl script stockholm2fasta.pl.

srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load perl/5.22

perl stockholm2fasta.pl -c 999999 -g pid40_216pruned13to203.fa.aln.hmmaln|perl -ne 'if (/^(>.+)/) {print $1,"\n"} if (/^[^>]/) {while (m/([A-Z-])/g) { print $1 }; print "\n" }' > pid40_216pruned13to203.fa.aln.hmmaln.fa

ls -al *hmmaln.fa
less pid40_216pruned13to203.fa.aln.hmmaln.fa  ## looks ok

grep -c ">Traes" pid40_216pruned13to203.fa.aln.hmmaln.fa  ## 203 as expect
#grep -c ">" p820br9rice9soy38arab26.fa.aln.hmmaln.fa  ## 902 as expect
exit

## ref., line 10546, now fas to phy

ssh -Y pterry@crane.unl.edu
# Rrq096mN 
#cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
#ls -al
#cd ..
#cd ..
#cp refinPprots820/align_convert_fas_to_phy.pl hmmsrch_protv1.1/blastp

#cd hmmsrch_protv1.1/blastp
#ls -al  ## 755 after cp

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
module load bioperl

./align_convert_fas_to_phy.pl pid40_216pruned13to203.fa.aln.hmmaln.fa

ls -al *.phy
## Q: will it create file & name for output, yes.
-rw-r--r-- 1 pterry amundsen 243618 Oct 24 20:57 pid40_216pruned13to203.fa.aln.hmmaln.phy
exit
less pid40_216pruned13to203.fa.aln.hmmaln.phy
 203 785
'TraesCS6B02G045200.1'  ---------- ---------- ---------- ---VPVGRRI LEQNIKARYH AGDIGTEDAL 

logout

## scp back to macbook, (line 10576)

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/pid40_216pruned13to203.fa.aln.hmmaln.phy .
ls -al *.phy
-rw-r--r--  1 bterry  staff  243618 Oct 24 21:02 pid40_216pruned13to203.fa.aln.hmmaln.phy

less pid40_216pruned13to203.fa.aln.hmmaln.phy
 203 785
'TraesCS6B02G045200.1'  ---------- ---------- ---------- ---VPVGRRI LEQNIKARYH AGDIGTEDAL

head -n 4  pid40_216pruned13to203.fa.aln.hmmaln.phy
 203 785
'TraesCS6B02G045200.1'  ---------- ---------- ---------- ---VPVGRRI LEQNIKARYH AGDIGTEDAL 
'TraesCS1A02G057400.1'  -------TPI SRIRIRLRRS RLFSSSATTP PPARSWSPHT AFA------- ---------- 
'TraesCS1B02G038400.1'  ---------- ---------- ---------- ---------- ---------- ----------

## so phy header       203 785, expect the 203

Then run this thru PhyMl online at http://www.atgc-montpellier.fr/phyml/
--in PhyML, could use 'aLRT', faster than bootstrapping, get similar info.


Selections:
browse: 
/Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/pid40_216pruned13to203.fa.aln.hmmaln.phy

Data type: aa's
Still, no bootdstrap, rather aLRT SH-like
# Q: other choices  ????????????????????????????????????

Perform bootstrap, no

Name: pid40_216pruned13to203

The alignment file "pid40_216pruned13to203.fa.aln.hmmaln.phy" was uploaded, it contains 203 taxons of 785 characters.

Your job was submitted.

You can check your job status here:
http://www.atgc-montpellier.fr/job_status/index.php?path=20181025-044646_Zm85/cmd.txt

job was submitted. (Wed, 10/24/18, 9:47pm)
#*******************************************************************

# line 10622, job finished by < 6 hrs later

10/25/18:
-rw-r--r--@ 1 bterry  staff   6904 Oct 25 14:31 pid40_216pruned13to203_fa_aln_hmmaln_phy_phyml.zip
# dnloaded from phyml site

# output file, in dir.:
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/pid40_216pruned13to203_fa_aln_hmmaln_phy_phyml
-rw-r--r--@  1 bterry  staff  11100 Oct 25 07:02 pid40_216pruned13to203_fa_aln_hmmaln_phy_phyml_tree.txt
# rename by coping to:
pid40_216pruned13to203_phyml_tree.txt
cp pid40_216pruned13to203_fa_aln_hmmaln_phy_phyml_tree.txt pid40_216pruned13to203_phyml_tree.txt

#  next take it to unl.box.com, then to 'pro' laptop.
# from (on pmtmbook15) 
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/pid40_216pruned13to203_fa_aln_hmmaln_phy_phyml

# to on 'pro', dir .../macbookpro2018/PPRv1.1_1161_88ctls
# create new dir on pro, .../PPRv1.1_1161_88ctls/vikas_filter

in figtree
Initially asked select a name for node values, gave aLRT

tree/root tree/midpoint
'Node labels', (display aLRT, format=%, sig. digits =2, for now left on 2)
## on taxa 
# figtree pattern pretty much matches pid40_phyml_tree.txt tree.

# talked to vikas
# note, 1 chr5 (magenta), 5 chr7 (blue-green), 5 chrU (orange) in the 203 seqs. They are only co-located in groups chr2 & chr6. pid40_216pruned13to203_phyml_tree_other.txt

# note: pid40_216pruned13to203_phyml_tree_color.txt has colored chr1 (red), chr2 (green), & chr6 (blue).

# note: for chr 1, 2, 6, A, B, D figtree pattern *not* skewed.

# tasks:
# Rmd, (abstract)
# GSDS (203, 13)
# phenogram
# codon usage

# think 1st, Rmd starting v1.1 on log file. Put in abstr in here. Stopped v1.0 Rmd file at line 7788.

10/30/18:
# working on images for Rmd file. 

# 1st, PPRv1.11913_no_ctls_forRmd.txt, no initial request for aLRT, then with node labels, not seeing aLRT, etc., ????????????? .png file looks fine in 'preview' ??????
# Q: display node ages ?????????????????
 
# 2nd, PPRv1.1.1913_plusrice9_forRmd.png
# Q: same issues as #1 ????, .png file looks fine in 'preview' ??????

# 3rd, PPRv1.1.1913_plus88ctlsplus88ctls_guess_P_PLS_forRmd.png

# 4th, PPRv1.1.1913_plus88ctlsplus88ctls_4color_forRmd.png
# note a yellow color near end of 'P' portion of 1913 ????????
# AB = red, AT = green, BRAD = blue, Glyma = yellow


10/31/18:
# 5th, PPRv1.1.752_plus88ctlsplus88ctls_4color_forRmd.png
# all colored ctls off by selves in a section, so perhaps rest seqs are 'PLS' ???
# color key as 4th.

# 6th, PPRv1.1.1161_plus88ctlsplus88ctls_4color_forRmd.png
# color key as 4th.
# here, colors mixed thru the 1161 seqs, perhaps arab & Glyma closer together, and rice & bracky sort of grouped. But some arab & Glyma seqs spread around.

# Following blastp:

# 7th, list_wheatids_pid50_phyml_tree_chrcolor_forRmd.png, 206 seqs
# chr1=red, chr2=green, chr6=blue

# 8th, list_wheatids_pid50_plus88_phyml_tree_chrcolor_forRmd.png, 206+88 seqs
# key as 7th

# 9th, list_wheatids_pid50_plus88_phyml_tree_4ctlscolor_forRmd.png, 206+88 seqs
# key as 7th

11/01/18:

TO GO
# 10th, pid35_phyml_tree_chrcolor_forRmd.png
key as 7th

# 11th, pid35_plus88ctls_phyml_tree_chrcolor_forRmd.png, 305+88 seqs
key as 7th

# 12th, pid35_plus88ctls_phyml_tree_4ctlscolor_forRmd.png, 305+88 seqs
key as 4th

11/02/18:

# 13th & 14th, pid40_phyml_tree_chrcolor_forRmd.png
But to capture 'up close' view in figtree,
SShot2018-11-02pid40chrcolor_forRmd.png
key as 7th

# 15th & 16th, pid45_phyml_tree_chrcolor_forRmd.png
But to capture 'up close' view in figtree,
SShot2018-11-02pid45chrcolor_forRmd.png
key as 7th

# 17th & 18th & 19th & 20th, pid40216pfruned13to203chrcolor_forRmd.png
Note: exported png more 'close up' due to absence of long branches.
But to capture 'up close' view in figtree,
SShot2018-11-02pid40_216pruned13to203chrcolor_forRmd.png
key as 7th
pid40216pfruned13to203_phyml_tree_otherchrcolor_forRmd.png
chr5=magenta, chr7=cyan, chrU=orange
preceding exported
SShot2018-11-02pid40_216pruned13to203otherchrcolor_forRmd.png
key as preceding file

# Now, upload these 20 images to box (new dir, say v1.1Rmd_doc)

11/03/18:
# dnload to v1.1 Rmd dir, v1.1Rmd_doc

11/04/18:
# slip a save to ***github*** in here

# fix Rmd file -> html file

11/17/18:
#talked to vikas on 11/12/18.
--frac-align at some point, for seqs want to call RF-like ???
--vikas table: see /Users/bterry/mbook2018/vikas18/v1.1Rmd_doc/SShot2018-11-17vikas_table.png
To put in v1.1_logfile_doc.Rmd, (done)

--note: pid50+88, ??? **what** this ???????

-- sequence lists

# 206
pid50 (206 rows): /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
/list_WheatIDs_pid50.txt

# 196
(pid50 minus 10 LB's, = 196 rows)
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
/list_WheatIDs_pid50LB10prunedto196.txt

# 216
pid40 (216 rows)
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
/list_WheatIDs_pid40.txt

# 203
203, (216(40pid) - 10(50pid LB's) - 3 addl LBs on 40pid) 
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
/pid40_216pruned13to203.txt

# ten
# pid50_the_10_LBs.txt
comm -23 list_WheatIDs_pid50.txt list_WheatIDs_pid50LB10prunedto196.txt > pid50_the_10_LBs.txt  ## (subset, 4 from chr 1,2,6, 6 from chr 7, note: only 7 genes for the 10 seqs, isomorphs)

# 'ten_addl'
pid40_216minus_pid50_206_10seqs.txt (3 are LB's, thus excluded from 203 'final')
comm -23 list_WheatIDs_pid40.txt list_WheatIDs_pid50.txt > pid40_216minus_pid50_206_10seqs.txt
# **TO CHECK**: in figtree, pid40_phyml_tree.txt, confirm names of the 3 LB's of the 10. *Confirmed*, the 3 are all on same LB.

# 7
# 3 LB's excluded from 'ten_addl' yielding 7 added to the 196.
cp pid40_216minus_pid50_206_10seqs.txt pid40_216minus10_7_SBs.txt
# then manually remove the 3 LBs

# **TO DO**: upload these 7 files up to 'box' (RF_GeneFamily/figtreetmp/BLASTP_Filtering/RFseqlists dir.)
list_WheatIDs_pid50.txt
list_WheatIDs_pid50LB10prunedto196.txt
list_WheatIDs_pid40.txt
pid40_216pruned13to203.txt
pid50_the_10_LBs.txt
pid40_216minus_pid50_206_10seqs.txt
pid40_216minus10_7_SBs.txt
# (done)

# work on the ***'table'*** (like Zhang et al, 2018)
# some Q's:
# wheat v1.1, both gene name, prot. seq name indicates the chr name, so, perhaps skip chr. name colm ????????
# location: can I get gff3 file for for v1.1 (note: v1.1 have difference in each name (v1.0 has '01G', v1.1 has '02G' as part on gene/protein name, ????????????)
# 'domain number', ??????????????
# sub. location (Q: is this needed ??????????)
# Q: table in Rmd, 'kable', ??????????????????????? For **moment**, create dataframe for table, **see** how Rmd displays it, may be adequate for now ?????????????????

# colm 1, 203 seqs, initially protein name ???, pid40_216pruned13to203.txt
# order: (file is in order of chroms, then trailing numbers already)
grep -c "TraesCS1A" pid40_216pruned13to203.txt  ## 31
grep -c "TraesCS1B" pid40_216pruned13to203.txt  ## 43
grep -c "TraesCS1D" pid40_216pruned13to203.txt  ## 38

grep -c "TraesCS2A" pid40_216pruned13to203.txt  ## 10
grep -c "TraesCS2B" pid40_216pruned13to203.txt  ## 8
grep -c "TraesCS2D" pid40_216pruned13to203.txt  ## 10

grep -c "TraesCS6A" pid40_216pruned13to203.txt  ## 19
grep -c "TraesCS6B" pid40_216pruned13to203.txt  ## 19
grep -c "TraesCS6D" pid40_216pruned13to203.txt  ## 14

5B = 1, 7B = 2, 7D = 3, 'U' = 5

Total = 203

11/19/18:
md5 number:
777ca9dcc04c12e5c92f464321617670	iwgsc_refseqv1.1_genes_2017July06.zip
777ca9dcc04c12e5c92f464321617670, so matches
# looks like I prevly downloaded this file.
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06/IWGSC_v1.1_HC_20170706.gff3

11/20/18:
# talked to vikas
# to table, add a GC content colm
# to table, add a GC3 content colm
# number of domains colm, use pfam or blastp to get this number
# later: locate snps in RF seqs (genes)


# ok, look back in log file, how access perhaps gene rows for desired protein (think bash script will be used (or python if did ??????) to access the 203 RF-like seqs ?????

##########################################
# refs for building Zhang, 2018 table
line 2169
line 2191
line 2195 => line 2220, gff3_1345_9names.txt
/Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/wheatgff3
# still need length (aa's), perhaps from .fa file before phylogram of '203' seqs ???
line 2302
bash Philip_realgff3.sh sort147_nodotnum.txt > realbashtofile.gff3
#############################################


# perhaps, start df in R, create 1st colm, from these 203 seqs (get their gene seq, expect <203 since apparently isoforms in the 203 proteins ???????)

# from line 2161
# wc -l iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
# 1743281 iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
wc -l IWGSC_v1.1_HC_20170706.gff3
 2028209 IWGSC_v1.1_HC_20170706.gff3

cd /Users/bterry/mbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/orthogrp/o_mclonline/wheatgff3

grep -c '^chr.*$' iwgsc_refseqv1.0_HighConf_2017Mar13.gff3  ## 1743281
grep -c '.*gene.*$' iwgsc_refseqv1.0_HighConf_2017Mar13.gff3  ## 110790
# Q: so ***fewer*** 'gene' records in v1.1 than v1.0, but the reverse for 'chr' lines ??????????????????????

cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06

# ref line 2169
#grep '.*gene.*TraesCS1A01G031600.*$' iwgsc_refseqv1.0_HighConf_2017Mar13.gff3
#grep '.*gene.*TraesCS1A01G031600.*$' iwgsc_refseqv1.0_HighConf_2017Mar13.gff3

grep -c '^chr.*$' IWGSC_v1.1_HC_20170706.gff3  ## 1920295
grep -c '.*gene.*$' IWGSC_v1.1_HC_20170706.gff3  ## 107903

# ref line 2195
grep '.*gene.*$' IWGSC_v1.1_HC_20170706.gff3 > v1.1_gff3_genes.txt
wc -l v1.1_gff3_genes.txt
  107903 v1.1_gff3_genes.txt
# Q: **smaller** than v1.0, line 2195 ????????????????????????????????
less v1.1_gff3_genes.txt

11/21/18:
line 2198
# next, try cut 1,3,4,5,7 in one step ??????????????
cut -f 1,3,4,5,7 v1.1_gff3_genes.txt > v1.1_gff3_genes_col13457.txt
head -n 3 v1.1_gff3_genes_col13457.txt
wc -l v1.1_gff3_genes_col13457.txt
  107903 v1.1_gff3_genes_col13457.txt

line 2200
cut -f 9 v1.1_gff3_genes.txt > v1.1_gff3_genes_col9.txt
head -n 3 v1.1_gff3_genes_col9.txt  ## looks like 'Trae' numbers 'incrementing' ????
# ID=TraesCS1A02G000100;previous_id=TraesCS1A01G000100;primconf=HC;Name=TraesCS1A02G000100
# so will need do some editing to get just gene name
cat v1.1_gff3_genes_col9.txt|perl -pe 's/^ID=(Tr.+);.+/\1/' | wc -l  ##     107903 as expect.
tail -n 3 v1.1_gff3_genes_col9.txt  ## can't use :p to **stop** relative expn

cat v1.1_gff3_genes_col9.txt|perl -pe 's/^ID=(Tr.+);.+/\1/' | head -n 3 > test1
cat test1|perl -pe 's/^ID=(Tr.+);.+/\1/' | head -n 3 

cat test1|perl -pe 's/^ID=(Tr.+\d);.+/\1/' | head -n 3 
cat v1.1_gff3_genes_col9.txt|head -n 3 > testinp.txt

#echo testinp.txt | tr ';' '\11'
cut f1 testinp.txt | tr ';' '\11'
cat testinp | tr ';' '\11'
echo frabacbable | tr 'a' 'b'
cut -c4-21 testinp.txt > testout
# looks like this will work ???????
cut -c4-21 v1.1_gff3_genes_col9.txt | wc -l  ##   107903 as expect
cut -c4-21 v1.1_gff3_genes_col9.txt > v1.1_gff3_genes_col9gnames.txt
wc -l v1.1_gff3_genes_col9gnames.txt
  107903 v1.1_gff3_genes_col9gnames.txt
head -n 3 v1.1_gff3_genes_col9gnames.txt
tail -n 3 v1.1_gff3_genes_col9gnames.txt

# 1st 105210 rows v1.1_gff3_genes_col9gnames.txt, no ';' in row
# 2691 rows have ';' starting from row 105211
# but, 107903 - 105210 = 2693. So two lines not accounted for ??????
# to do, tail n = 2691, manually check, where 1st row matches in v1.1_gff3_genes_col9gnames.txt.
tail -n 2691 v1.1_gff3_genes_col9gnames.txt > bottom2691.txt
tail -n 2693 v1.1_gff3_genes_col9gnames.txt > bottom2693.txt

11/23/18:
# to try two things, 'perl -pe' & cut commands, see if can work at 
accessing just gene name in colm 9 in v1.1_gff3_genes_col9.txt
cat testinp.txt
cat testinp.txt|perl -pe 's/^ID=(Tr.+);.+;.+;.+$/\1/'
# appears to work ????
# retry
wc -l v1.1_gff3_genes_col9.txt
  107903 v1.1_gff3_genes_col9.txt
cat v1.1_gff3_genes_col9.txt|perl -pe 's/^ID=(Tr.+);.+;.+;.+$/\1/' | head -n 107903 > v1.1_gff3_genes_col9names_2prl.txt
wc -l v1.1_gff3_genes_col9names_2prl.txt
  107903 v1.1_gff3_genes_col9names_2prl.txt
# for v1.1_gff3_genes_col9names_2prl.txt, ***not*** all rows properly handled ????
# to try
cut -d ';' -f 1 v1.1_gff3_genes_col9.txt | wc -l  ##   107903 as expect
cut -d ';' -f 1 v1.1_gff3_genes_col9.txt | head -n 107903 > v1.1_gff3_genes_col9names_cut.txt
wc -l v1.1_gff3_genes_col9names_cut.txt
  107903 v1.1_gff3_genes_col9names_cut.txt
# Still need remove 'ID=' from start ????? but 13 rows with '.d', for example, 
ID=TraesCS5B02G311400
ID=TraesCS5B02G311400.1
ID=TraesCS5B02G311400.1.exon1
# Perhaps **manually**, remove the '.' from gene name, & extra rows if 'a' gene has more than one row, in file v1.1_gff3_genes_col9names_cut_man.txt
cp v1.1_gff3_genes_col9names_cut.txt v1.1_gff3_genes_col9names_cut_man.txt
wc -l v1.1_gff3_genes_col9names_cut_man.txt
  107891 v1.1_gff3_genes_col9names_cut_man.txt
# so, 12 rows removed
# check uniqueness
sort v1.1_gff3_genes_col9names_cut_man.txt |uniq | wc -l   ##   107891, so all uniq
# now no ';' or '.' characters, the goal over a day ago.
# **but** now issue when paste 1,3,4,5,7 colms, 107903 rows together with col9 with now only 107891 rows ????????????

# so, after all that, **new plan**:
# for file v1.1_gff3_genes_col9names_cut.txt, has 13 rows with "." character, all 107903 rows, 1st paste back with 1,3,4,5,7 file, v1.1_gff3_genes_col13457.txt, then manually remove 12 ?? rows with '.'s or multiple rows with particular gene name.
# yet to remove 'ID=' from start of v1.1_gff3_genes_col9names_cut.txt
cut -d '=' -f 2 v1.1_gff3_genes_col9names_cut.txt | head -n 107903 > v1.1_gff3_genes_col9names_cut_ID.txt
head -n 3 v1.1_gff3_genes_col9names_cut_ID.txt  # 'ID=' now gone from output 

# ref line 2217
wc -l v1.1_gff3_genes_col13457.txt 
  107903 v1.1_gff3_genes_col13457.txt
wc -l v1.1_gff3_genes_col9names_cut_ID.txt
   107903 v1.1_gff3_genes_col9names_cut.txt
## now, paste back together colms 1,3,4,5, 7 with colm9.

paste v1.1_gff3_genes_col13457.txt v1.1_gff3_genes_col9names_cut_ID.txt > v1.1_gff3_13457_9names.txt
head -n 3 v1.1_gff3_13457_9names.txt
tail -n 3 v1.1_gff3_13457_9names.txt
# now remove rows with '.' chars, fix so just one row for each gene name (prevly 12 rows removed ???
# 1st, copy
cp v1.1_gff3_13457_9names.txt v1.1_gff3_13457_9names_man.txt
# **WAIT**, 12 rows for mRNA, cause have like 'pseudogene' in the row.

grep '.*\tgene\t.*$' IWGSC_v1.1_HC_20170706.gff3 | wc -l  ## 107891 the **correct** number
grep '.*\tgene\t.*$' IWGSC_v1.1_HC_20170706.gff3 > v1.1_gff3_genes_only.txt
wc -l v1.1_gff3_genes_only.txt
  107891 v1.1_gff3_genes_only.txt
# but, 109864 occurrences of 'gene' using bbedit to search for count of 'gene ???????
# for bbedit search '\tgene\t', gives 107891, so go with this number of gege rows in IWGSC_v1.1_HC_20170706.gff3.
# now repeat get colms 1.3.4.5.7 & separately colm9.
cut -f 1,3,4,5,7 v1.1_gff3_genes_only.txt > v1.1_gff3_genes_only_col13457_.txt
head -n 3 v1.1_gff3_genes_only_col13457_.txt
wc -l v1.1_gff3_genes_only_col13457_.txt
  107891 v1.1_gff3_genes_only_col13457_.txt, believed to be correct no. rows

# process colm9 to get just gene name,
v1.1_gff3_genes_only.txt
line 2200
cut -f 9 v1.1_gff3_genes_only.txt > v1.1_gff3_genes_only_col9.txt
head -n 3 v1.1_gff3_genes_only_col9.txt  ## looks like 'Trae' numbers 'incrementing' ????
# ID=TraesCS1A02G000100;previous_id=TraesCS1A01G000100;primconf=HC;Name=TraesCS1A02G000100
wc -l v1.1_gff3_genes_only_col9.txt
  107891 v1.1_gff3_genes_only_col9.txt
# so will need do some editing to get just gene name
# try cut *twice*
# try
cut -d ';' -f 1 v1.1_gff3_genes_only_col9.txt | wc -l  ##     107891 as expect
cut -d ';' -f 1 v1.1_gff3_genes_only_col9.txt | head -n 107891 > v1.1_gff3_genes_only_col9names_cut.txt
wc -l v1.1_gff3_genes_only_col9names_cut.txt
  107891 v1.1_gff3_genes_only_col9names_cut.txt
head -n 3 v1.1_gff3_genes_only_col9names_cut.txt

# Still need remove 'ID=' from start ????? but 13 rows with '.d', for example, 
cut -d '=' -f 2 v1.1_gff3_genes_only_col9names_cut.txt | head -n 107891 > v1.1_gff3_genes_only_col9names_cut_ID.txt
head -n 3 v1.1_gff3_genes_only_col9names_cut_ID.txt  # 'ID=' now gone from output 
wc -l v1.1_gff3_genes_only_col9names_cut_ID.txt
  107891 v1.1_gff3_genes_only_col9names_cut_ID.txt
# bbedit, v1.1_gff3_genes_only_col9names_cut_ID.txt has no ';'s or '.'s, good.

# finally, paste back to get 1,3,4,5,7,9 colms in one file.
paste v1.1_gff3_genes_only_col13457.txt v1.1_gff3_genes_only_col9names_cut_ID.txt > v1.1_gff3_genes_only_13457_9names.txt
head -n 3 v1.1_gff3_genes_only_13457_9names.txt
tail -n 3 v1.1_gff3_genes_only_13457_9names.txt
wc -l v1.1_gff3_genes_only_13457_9names.txt
  107891 v1.1_gff3_genes_only_13457_9names.txt
# bbedit v1.1_gff3_genes_only_13457_9names.txt, no ';'s or '.'s, good.
## preceding checks look ok.

11/24/18:
# slip a save to ***github*** in here
cd ~/planets
git status
git add wheatprojdoc060117.txt
git commit -m "update 11/24/18 wheatprojdoc060117.txt"
git status
git push origin master
# git remote -v

sort pid40_216pruned13to203.txt |uniq | wc -l  ## 203 as expect if unique
sort v1.1_gff3_genes_only_13457_9names.txt | uniq | wc -l  # 107891 as expect if unique

# now, need remove '.d' from pid40_216pruned13to203.txt
# ref line 2273
#cat sort147.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 147 > sort147_nodotnum.txt
cat pid40_216pruned13to203.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 203 > pid40_216pruned13to203_nodotnum.txt
head -n 3 pid40_216pruned13to203_nodotnum.txt  ## looks ok
wc -l pid40_216pruned13to203_nodotnum.txt
     203 pid40_216pruned13to203_nodotnum.txt

need subset the 203, so bash script ??????
Philip_gff3_the203.sh
# inside will be file v1.1_gff3_genes_only_13457_9names.txt

# ref: line 2301
# bash Philip_no_echo.sh sort147_nodotnum.txt > testbashtofile.gff3
bash Philip_gff3_the203.sh pid40_216pruned13to203_nodotnum.txt > pid40_216pruned13to203_colm134579.gff3
# done, < 7 min.
wc -l pid40_216pruned13to203_colm134579.gff3
     203 pid40_216pruned13to203_colm134579.gff3
# note, last 5 rows, for example, have a location, but no chrom number ?????????
chrUn	gene	79854237	79856213	+	TraesCSU02G089563

# num. PPR domains in prot. structure column. Try SMART, Zhang, 2018 paper, p-3.
# 'Genomic mode', try enter 1st prot. on '203' seqs list, TraesCS1A02G031600. So look on .fa file used for MSA with muscle.

line 12475
pid40_216pruned13to203.fa in
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter
# 1st seq:
>TraesCS1A02G031600.1 gene=TraesCS1A02G031600
MSPPRLRLLLLLLLLLCARHSSSTSHPSRIWDPHAAFAAATERARSGRLTTEDAHHLFDELLRQGNPVQE
RPLNNFLAALARAPASASCSDGPALAVALFGRLSRGAGQRVAQPNVFTYGVLMDCCCRACRTDLALAFFG
RLLRTGLQAGQVVFNTLLKGLCHTKRADEALDVLLHRMPELGCTPDVVAYNTVIHGFFREGQVGKACDMF
HGMAQKGVMPNVVTYNSVIDGLCKARAMDKAETVLSQMVNDGVRPDNVTYNSLIHGYSSLGNWKEAVRVF
KEMSRRFTPDVITCTSLMAFLCKNGKSKEAAEIFDSMAMKGLKRDTVSYAILLHGYATEGCLVDMINLFN
SMATDCILPNCHIFNILINAYAKSGMMGEAMLIFKKMHEQGVSPDVVTYSTVIHAFCKMGSLDIAMDKFN
QMVDMGVRPNAIVYHSLIQGFCTHGDLVKAKELVTEMRNKAMRPPDIKIFHSIMKNLCTEGRVIEARDIL
DLMVHIGMRPDVPIFNLLIGGYCLVHKMEDATKMFDDMVSYGLEPCNSTYGILINGYCKNGRIDDGLNLF
KEMLRKGLKPTTFNYNVILDGLFLAGRTVAAKEKFDEMVESGVSVCIDTYSIVLGGLCRNNCTGEAITLS
KKLSTMNVKFNIAIVNILIGAFFRVRRNQEAKDLFAAIPANGLVANVVTYSMMMINLIKEGSLEEADDLF
LSMEKSGCTADSCMLNHIIRRLLERGEIVKAGNYMSKVDAKSYSLEAKTVSLLISLFLGKGRYREHMKLL
PMKYQFLEEAATVE

# to supply this to 'SMART', see if get count of ppr domains ???????
# tried, what to think of the output ????????????
# output:
# "There were no features detected in the selected region."
# Q: did I use it right ??????????????

11/25/18:

# next, chek Mapchart s/w, Zhang, 2018 ref., p-3.
# https://www.wur.nl/en/show/Mapchart.htm (available for windows platform ***only***)
# may have to count PPR domains wi blastp as before ????????

line 9395
# get .fa seq lengths
# python3 fastaseqlen.py PPRv1.1_752_PLS_seqs.fa_plus_88ctls.fa
# output file: fastaSeqLen752PLSplus88ctls.txt

/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

# testing
python3 fastaseqlen.py test_seqlen.fa
python3 fastaseqlen_copy.py test_seqlen.fa  ## commented out sev'l testing output prints
# fastaSeqLengths.txt mv'd to fastaSeqLengths_2testseqs.txt
python3 fastaseqlen_copy.py pid40_216pruned13to203.fa
# output: fastaSeqLengths.txt, the lengths of the 203 proteins
# rename fastaSeqLengths203.txt
#****************************************
#Note: 53 seqs < 300 aa in length, Zhang table, shortest is 443 ??????????????????????
#*******************************************************

# to check, at https://urgi.versailles.inra.fr/download/iwgsc/IWGSC_RefSeq_Annotations/v1.1/
# the manualy curated gene families folder has a gff3 for PPR gene family. TO SEE. PPR.gff3. Thousands of lines. Need grep \tgene\t to get just genes.

line 13094
grep '.*\tgene\t.*$' PPR.gff3 | wc -l  ## 1690, in v1.0, I had approx 1602
# So, looks like these all PPR seqs, *not* helpful for finding RF-like seqs.

11/26/18:
# do 'summary' of 203 lengths.
# try ggplot2 of 203 lengths vs 1:203 after 1st sort on 'length' colm2 ?????????

rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter")
getwd()
pid40_203_lens <- read.delim("fastaSeqLengths203.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("gene", "len"))
dim(pid40_203_lens)
head(pid40_203_lens)
class(pid40_203_lens)
###########################################################
summary(pid40_203_lens$len)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#106.0   280.5   477.0   485.1   689.5  1562.0 
# skewed wi 1562 ??????
###############################################################
library(ggplot2)
# need a sort
library(dplyr)
pid40_203_lens_sort <- arrange(pid40_203_lens, len)
head(pid40_203_lens_sort, n=4)
sp <- ggplot(pid40_203_lens_sort, aes(x=1:203, y=len))
sp2 <- sp + geom_point()
sp2             
# plot does not have signif. 'jumps', but has two *outlier* points, ~1000, 1562, esp. the latter. The next largest length ~ 900. See pid40_203_len.png
# could do box plot ??????????

# Task: count domains in seqs, submit to https://pfam.xfam.org/search#tabview=tab1
pid40_216pruned13to203.fa. Try 'Gathering threshold'
# error, "." characters at end of seqs
# *test*, see if pfam site gives *counts*, perhaps take 1st 285 lines of '.fa' file, manually, remove the 20 '."s, submit to pfam
cat pid40_216pruned13to203.fa | head -n 285 > pid40_216pruned13to203_rem_dots.fa
# submit, 11:20pm, done say 10am, so < 11hrs for 1st 34 seqs of pid40_216pruned13to203.fa
# no email message received when done ??????????????????????????????
# pfam output giving 'counts'. **Perhaps** blastp couple of these seqs with PPR 35 aa seq, compare number counts. Perhaps online at ncbi.

11/27/18:
# dnloaded pfam hmmer output from the ~ 11 hr run above (for gene ...1A...031600.1). 
######################################
Q: have several questions about what looking at. How to use this output ?????????
# talked to vikas,
# concerning output:
# Searched 34 out of 34 uploaded sequences.
# Database Searched: pfam
#
# If you have any comments or questions about the use of this service,
# please contact us at: hmmer-help@ebi.ac.uk

# You can retrieve the full results by going to:
# http://www.ebi.ac.uk/Tools/hmmer/results/score/32843E48-F204-11E8-9BEB-C362F75AEC3D
score results | HMMER
www.ebi.ac.uk
Biosequence analysis using profile hidden Markov Models using HMMER
#*******************************************
NOTE: remaining portion of 203 **yet** to submit.
#*********************************************
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/domain_hmmer/hmmer_email_out_34subset.txt
file has email summary for **only** 1st 34/203 seqs.
################################

11/28/18:
wc -l hmmer_email_out_34subset.txt
     918 hmmer_email_out_34subset.txt
# further work on hmmer_email_out_34subset.txt file, Vikas interest in extracting hmm colm, for ' PPR ' in 'hmm' colm. 316 rows.
grep -c '.*\sPPR\s.*$' hmmer_email_out_34subset.txt | wc -l
# Q: failing with grep & search in bbedit. Could a modified shell script, Philip_gff3_the203.sh help ??????????

# STOPPED

# ***subcellular*** location of RFL seqs: check out TargetP for this task. http://www.cbs.dtu.dk/services/TargetP/
# For now, take default, 'no cutoff'. Select 'plant'. Selecting 'perform cleavage site predictions'.	Submit file pid40_216pruned13to203.fa.
# my site 'banned' ???????????
# sent email: hhs+webface@cbs.dtu.dk => later to 2nd address
############################################
# Got message when submitted job: 'Your site cpe-97-98-138-58.neb.res.rr.com (%.neb.res.rr.com) has been banned'.
# Don't know a reason why my computer is banned????????????????????????/
# **BUT** ran at UNL, to **see** bottom output for 'Explain the output"
#######################################

11/29/18:
# vikas **interest** in comparing GC, domains, & qqch else (??) when available ????

# resuming attempt to extract PPR records from hmmer_email_out_34subset.txt

cut -d ' ' -f 2,3,4,7,8 test_himmer_out.txt
gene=TraesCS1A02G031600    
# only outputting out colm 2, ???????????????????????????

# perhaps try read into R, split colms this way ????????????
#arab26hits <- read.delim("arab26_ctls_prot1161hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("qnam", "snam", "eval", "pid", "len", "qlen", "slen", "bscor"))

rm(list=ls())
tsthimmerout <- read.delim("test_himmer_out.txt", header=FALSE, stringsAsFactors=FALSE, sep="")
dim(tsthimmerout)
head(tsthimmerout, n=2)
#                     V1                      V2  V3  V4  V5  V6        V7    V8 V9 V10 #V11   V12     V13
#1 >TraesCS1A02G031600.1 gene=TraesCS1A02G031600 532 563 531 564 PF12854.7 PPR_1  2  33  34 38.67 5.9e-10
#2 >TraesCS1A02G031600.1 gene=TraesCS1A02G031600 566 599 566 599 PF12854.7 PPR_1  1  34  34 24.19 2.0e-05
#      V14 V15 V16    V17
#1 2.3e-13   1   1 CL0020
#2 7.7e-09   1   1 CL0020
write.table(tsthimmerout, file="tsthimmerout_tabs.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

# ok, try, cut & grep
cut -f 2,3,4,7,8 tsthimmerout_tabs.txt  # got 5 colms as expect
cut -f 2,3,4,7,8 tsthimmerout_tabs.txt >  tsthimmerout_tabs_23478.txt
cut -f 8,2,3,4,7 tsthimmerout_tabs.txt  # no change in order ???????????

# perhaps read into R, place colm 8 1st, write out. Possibly then would work wi grep or bbedit ??
 
grep -c '.*\tPPR$' tsthimmerout_tabs_23478.txt | wc -l # perhaps need car retn, line feed in relative expn following 'PPR' to succeed ???????????????

# perhaps read into R, place colm 8 1st, write out. Possibly then would work wi grep or bbedit ??

11/30/18:
grep -c '.*\tPPR\r' tsthimmerout_tabs_23478.txt | wc -l  ## fails

rm(list=ls())
tst23478 <- read.delim("tsthimmerout_tabs_23478.txt", header=FALSE, stringsAsFactors=FALSE)
dim(tst23478)
head(tst23478, n=2)
tst82347 <- data.frame(hmm=tst23478$V5, gene=tst23478$V1, start=tst23478$V2, end=tst23478$V3, name=tst23478$V2)
head(tst82347, n=2)
write.table(tst82347, file="tsthimmerout_tabs_82347.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

# back at bash prompt,
grep -c '^PPR\t.*$' tsthimmerout_tabs_82347.txt | wc -l  ## fails
grep -c 'PPR\t' tsthimmerout_tabs_82347.txt | wc -l  ## fails
grep 'PPR\t' tsthimmerout_tabs_82347.txt  ## seems to have worked.
#####################################################
# so why prev. two lines *inconsistent* ???????????????
########################################################
grep '^PPR\t' tsthimmerout_tabs_82347.txt  ## seems to have worked.

# in view of preceeding, to test when have tabs, 'PPR' still at end of line
grep '^.*\tPPR\r' tsthimmerout_tabs_23478.txt  ## fails
# so try following:
# convert the seq 34 hmmer output file from spaces to tabs
# then convert 'PPR' to 1st colm, perhaps same R session ??
# then try grep with 'PPR\t' as above

rm(list=ls())
setwd("~/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/domain_hmmer")
getwd()
tst23478 <- read.delim("hmmer_email_out_34subset.txt", header=FALSE, stringsAsFactors=FALSE, sep="")
dim(tst23478)  ## [1] 918  30
head(tst23478, n=2)
#tst82347 <- data.frame(hmm=tst23478$V5, gene=tst23478$V1, start=tst23478$V2, end=tst23478$V3, name=tst23478$V2)
#head(tst82347, n=2)
write.table(tst23478, file="hmmer_email_out_34subset_tabs.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)
head -n 3 hmmer_email_out_34subset_tabs.txt
# Q: why still have colm header line ????????
# remove **manually** hmmer_email_out_34subset_tabs.txt

cut -f 2,3,4,7,8 hmmer_email_out_34subset_tabs.txt >  hmmer_email_out_34subset_tabs_23478.txt
wc -l hmmer_email_out_34subset_tabs_23478.txt
     917 hmmer_email_out_34subset_tabs_23478.txt
head -n 3 hmmer_email_out_34subset_tabs_23478.txt

# trying put 'PPR' colm as 1st colm, so can make grep work.
rm(list=ls())
setwd("~/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/domain_hmmer")
getwd()
tst23478 <- read.delim("hmmer_email_out_34subset_tabs_23478.txt", header=FALSE, stringsAsFactors=FALSE)
dim(tst23478)  ## [1] 918  30
head(tst23478, n=2)
#tst82347 <- data.frame(hmm=tst23478$V5, gene=tst23478$V1, start=tst23478$V2, end=tst23478$V3, name=tst23478$V4)
head(tst82347, n=2)
write.table(tst82347, file="hmmer_email_out_34subset_tabs_82347.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

hmmer_email_out_34subset_tabs_82347.txt # looks ok

grep 'PPR\t' hmmer_email_out_34subset_tabs_82347.txt | wc -l  ## 316, seems to have worked.
grep '^PPR\t' hmmer_email_out_34subset_tabs_82347.txt | wc -l ## 316 seems to have worked.
grep '^PPR\t' hmmer_email_out_34subset_tabs_82347.txt > hmmer_email_out_34subset_tabs_82347_PPR.txt
head -n 3 hmmer_email_out_34subset_tabs_82347_PPR.txt

# Now have gene (??) names with start/end location in 34 (203) prot. seqs, thus number PPR domains (PF01535.20) for each protein seq.
# Q: sum these each prot/gene (??) for domain colm each table ????
# Q: vikas compare GC wi these domains (but all the same domains ??). Perhaps go back check evalues, bit scores ???
# Q: additional/different colms from hmmer output ???????

# talked to vikas
--he demo'd how handle 'hmmer_email_out_34subset.txt' *from command line* to get info for 'Zhang Table'. See file 'vikasexamples.txt'.

12/01/18:

--*next*, since takes some time for online hmmer to run, remove '.' from all 203 seqs, submit to hmmer. Finally process to yield Zhang Table colms for 'domain number'. 
###################################################
Still Q: if gene or prot names in our 'Table' ?????? *For now*, get prot. names, cause, can process them to a gene name.
################################################
# attempt to remove '.'s from pid40_216pruned13to203.fa with command line tools
cat pid40_203test_3seqs.fa | grep -v "^>"  ## ok
cat pid40_203test_3seqs.fa | grep -v "^>" |perl -pe 's/(.*)\./\1/'
# looks like it worked.
# send to file, check in bbedit.
cat pid40_203test_3seqs.fa | grep -v "^>" |perl -pe 's/(.*)\./\1/' > pid40_203test_3seqs_tstoutput.fa
# BUT, how arrange so new file has 'name' lines **&** seq lines minus '.' characters ?????????????????
# don't know how to do without spending time programming this. So make a copy of pid40_216pruned13to203.fa, pid40_216pruned13to203man_dots.fa, then **manually** remove the '.' at end some seqs.
cp pid40_216pruned13to203.fa pid40_216pruned13to203man_dots.fa
# now, no more '.'s in seqs this file. 203 dots in '>' rows remain

# now ready to submit to hmmer online site.
# Task: count domains in seqs, submit to https://pfam.xfam.org/search#tabview=tab1
pid40_216pruned13to203man_dots.fa from /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter.
Try 'Gathering threshold' setting.
# start, 10:59pm. Q: queued behind zero other jobs, began running immedly ?????? Done 11:01pm.
# save 'summary' from email to file hmmer_email_out203.txt in directory /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs
wc -l hmmer_email_out203.txt
    5968 hmmer_email_out203.txt

#############################################
From: hmmer-help@ebi.ac.uk <hmmer-help@ebi.ac.uk>
Sent: Saturday, December 1, 2018 11:01 PM
To: pterry@huskers.unl.edu
Subject: Your search results for job 02659F74-F5EF-11E8-9F94-8EA853F04F9B
 
# Your job id was: 02659F74-F5EF-11E8-9F94-8EA853F04F9B

# Please find a summary of your search results below.
#
# If you have any comments or questions about the use of this service,
# please contact us at: hmmer-help@ebi.ac.uk
#
#-------------------------------------------------------------------------------
#
# Searched 203 out of 203 uploaded sequences.
# Database Searched: pfam
#
# You can retrieve the full results by going to:
# http://www.ebi.ac.uk/Tools/hmmer/results/score/02659F74-F5EF-11E8-9F94-8EA853F04F9B
#################################################
# removed lines above header line manually
# initially, follow vikas example, retain '.1' on protein name ???????????  Can always change if want.

cat hmmer_email_out203.txt|tr -s " " "\t"|grep "PF01535.20"|cut -f1,8|sort|uniq -c|perl -pe 's/(\d+).+>(\S+).+/\2\t\1/' | wc -l  ## 203 as expect

cat hmmer_email_out203.txt|tr -s " " "\t"|grep "PF01535.20"|cut -f1,8|sort|uniq -c|perl -pe 's/(\d+).+>(\S+).+/\2\t\1/' > hmmer_email_out203_domain_ct.txt
# note: has 2 or 3 'spaces' on left side of 1st colm
# so redo as follows:
cat hmmer_email_out203.txt|tr -s " " "\t"|grep "PF01535.20"|cut -f1,8|sort|uniq -c|perl -pe 's/(\d+).+>(\S+).+/\2\t\1/' | tr -d " " > hmmer_email_out203_domain_ct.txt

12/02/18:

join -t'\t' fastaSeqLengths203.txt hmmer_email_out203_domain_ct.txt | head -n 3
# tried sevl ways specify delimiter, no success with any ????????????????

# so just proceed to try input the two files into R, ..., make ggplot2 scatter plot
# make ggplot2 scatterplot, seq length vs seq PPR count.
# files needed, hmmer_email_out203_domain_ct.txt (seq PPR count) & fastaSeqLengths203.txt (seq lenths, dir .../vikas_filter)
# consider producing a file with 3 colms, seq name, seq len., PPR domains/seq from these two files before bringing into R for ggplot2.
# failed above.

rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()
fastalens <- read.delim("fastaSeqLengths203.txt", header=FALSE, stringsAsFactors=FALSE)
dim(fastalens)  ## [1] 203   2
head(fastalens, n=2)
PPRcts <- read.delim("hmmer_email_out203_domain_ct.txt", header=FALSE, stringsAsFactors=FALSE)
dim(PPRcts)  ## [1] 203   2
head(PPRcts, n=2)

all(fastalens$V1 %in% PPRcts$V1)
all(PPRcts$V1 %in% fastalens$V1)
# if identical, expect TRUE for both

df <- data.frame(names=fastalens$V1, lens=fastalens$V2, cts=PPRcts$V2)

head(df, n=2)
library(ggplot2)
sp <- ggplot(df, aes(x=lens, y=PPRcts))
sp2 <- sp + geom_point()
sp2             
write.table(df, file="table_names_lens_cts.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

# comments on lengths_vs_cts.png
# Only about 3-4 points fall outside plot pattern.
# sevl lengths wi same number of cts, so some flexibility of length for given cts ???

# Now, take stock, come up wi overview of next steps ?????????????/
--finish table
# Q: use gene or prot. names ??????
# chrom number (to get from gene/prot name), to modify query from vikasexamples.txt. Use on 1st colm in file:
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06/pid40_216pruned13to203_colm134579.gff3
# location: get start, stop, strand by modifying query from vikasexamples.txt. On 3rd, 4th, & 5th colm of file:
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06/pid40_216pruned13to203_colm134579.gff3
 # intron: will try GSDS
# length(aa):
have in file /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs/table_names_lens_cts.txt
# domain number:
Have in file:
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs/table_names_lens_cts.txt
# sub location: 
Have in output from targetP

# Note: plotted PPRcts vs lengths, description results above.
# Note: consider couple more analyses relative to 'table'. 
# regression analysis for colms in 'table' ????????
# plot extra space on seqs (not in PPR domain) vs seq length

--GC content: have code from vikas
--graph of RF-like seq locations of 203 seqs, use phenogram
--snps

12/03/18:
# of items listed above, have not tried GC content. Perhaps try next, in case a problem.
# use .fa file have removed '.' characters from end of aa seq, pid40_216pruned13to203man_dots.fa in directory: /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter.
# wait, need *gene* seqs, not prot.seqs for this Q: how get?
# needed file to subset to 203 genes:
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06/IWGSC_v1.1_HC_20170706_cds.fasta

cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/GC_est
#usuage: perl GC_estimate_VB.pl Fasta_File > outputfile
perl GC_estimate_VB.pl pid40_216pruned13to203man_dots.fa > pid40_216pruned13to203man_dots_GC.txt
# *ERROR*
# GC_estimate_VB.pl line 8.
# BEGIN failed--compilation aborted at GC_estimate_VB.pl line 8.
# perhaps check wi JJ? Perhaps 'use Bio::SeqIO;' available on crane ?????????

# 1st, try run like did on crane with 'align_convert_fas_to_phy.pl'.

STOPPED

##################################################
# talked to Vikas, *to doc.* pencil, 12/03/18
...
###################################################

12/09/18:
# TO DO, build 'zhang table' in dframe, incorporate in Rmd file with appropriate  phylograms.
# start wi 'table' file: /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs/table_names_lens_cts.txt
# for gff3 file: /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06/pid40_216pruned13to203_colm134579.gff3
#now, modify 1st colm pid40_216pruned13to203_colm134579.gff3, remove 'chr' from colm 1
#then, load 'table' & gff3 file minus 'chr' in R. When load gff3 file, add colm names (chr, gene, start, end, strand, & gname).

12/10/18:
cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs
cat pid40_216pruned13to203_colm134579.gff3 | perl -pe 's/chr(\w+)/\1/' | wc -l ## 203
cat pid40_216pruned13to203_colm134579.gff3 | perl -pe 's/chr(\w+)/\1/' > pid40_216pruned13to203_colm134579_chr.gff3
# read in the two data files

# now in R
rm(list=ls())
setwd("~/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()
table3 <- read.delim("table_names_lens_cts.txt", stringsAsFactors=FALSE)
dim(table3)  ## [1] 203   3
head(table3, n=2)

gff3_6 <- read.delim("pid40_216pruned13to203_colm134579_chr.gff3", header=FALSE, stringsAsFactors=FALSE, col.names=c("chr", "gene", "start", "end", "str", "gname"))
dim(gff3_6)  ## [1] 203   6
head(gff3_6, n=2)

#create new dframe wi the 7 avail. colms (see if assigning colm names while create df will #set colm names, whatever names were before ????????

#all(table3$names %in% PPRcts$V1)
#all(PPRcts$V1 %in% fastalens$V1)
# if identical, expect TRUE for both

table7col <- data.frame(RFL_prot_ID=table3$names, Chr=gff3_6$chr, Start=gff3_6$start, End=gff3_6$end, Strand=gff3_6$str, Len=table3$lens, domain_number=table3$cts)

dim(table7col)  ## [1] 203   7
head(table7col, n= 3)

#write.table(df, file="table_names_lens_cts.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
write.table(table7col, file="table7cols.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

# then check output file in bbedit ??????
# manually, spot check gene/prot name colms at 5 rows betw. the two files, each matches.
# **yet** to add, two colms, '**intron**' & '**subcel location**' to total 9 colms.

12/11/18:
# for sub. cellular location colm in new table, using targetP. I note colms separated by 'spaces'. So, try vikas 'squeezing' approach to replace with '\t' chars.

/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/targetP/targetP_203_out.txt

cat targetP_203_out.txt | head -n 216 | tail -n 203 | more  ## ok
cat targetP_203_out.txt | head -n 216 | tail -n 203 |tr -s " " "\t" | head -n 5
cat targetP_203_out.txt | head -n 216 | tail -n 203 |tr -s " " "\t" > targetP_203_out_tabs.txt
Now cut colms 1 & 8 (f1,8)
cat targetP_203_out.txt | head -n 216 | tail -n 203 |tr -s " " "\t" |cut -f1,7 > targetP_203_out_tabs_col_1_7.txt

12/12/18:
# slip a save to ***github*** in here

# note: try plotting few things from 'table'. For example, names for particular chrom, vs 
'start', or length, or domain number. 

12/13/18:
# **ready** read into R, add to 'table' sub. cell location, 8th colm
# copy targetP_203_out_tabs_col_1_7.txt to hmmer203seqs dir.

# now in R
rm(list=ls())
setwd("~/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()
#table3 <- read.delim("table_names_lens_cts.txt", stringsAsFactors=FALSE)
#dim(table3)  ## [1] 203   3
#head(table3, n=2)

table7col <- read.delim("table7cols.txt", stringsAsFactors=FALSE)
dim(table7col)  ## [1] 203   7
head(table7col, n=2)

targetp <- read.delim("targetP_203_out_tabs_col_1_7.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("name", "subcel"))
dim(targetp)  ## [1] 203   2
head(targetp, n=2)

#create new dframe wi the 7 avail. colms (see if assigning colm names while create df will #set colm names, whatever names were before ????????

all(table7col$RFL_prot_ID %in% targetp$name)
all(targetp$name %in% table7col$RFL_prot_ID)
# if identical, expect TRUE for both

table8col <- data.frame(RFL_prot_ID=table7col$RFL_prot_ID, Chr=table7col$Chr, Start=table7col$Start, End=table7col$End, Strand=table7col$Strand, Len=table7col$Len, domain_number=table7col$domain_number, Subcel=targetp$subcel)

dim(table8col)  ## [1] 203   8
head(table8col, n= 3)

#write.table(df, file="table_names_lens_cts.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
write.table(table8col, file="table8cols.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

# ck table8cols.txt in bbedit
# TO DO, doc. 'S', 'C' ??????????????????

12/15/18:
# a 9th colm, intron, try use GSDS
# comments: Perhaps, run GSDS, looking for introns. Run two groups, 203 seqs, and 88 ctls seqs separately.
# or run 203, then 88
# go find .gff3 files for these ??
# red line 4787
# line 4142 ## looks like where I subset 
# bash Philip_realgff3.sh oGroups144col1_to_131_nodotnum_sort.txt > 131_sort.gff3
# using iwgsc_refseqv1.0_HighConf_2017Mar13.gff3, subsets 691 rows, 'gene' and other rows. 
# oGroups144col1_to_131_nodotnum_sort.txt ## has 131 seqs minus '.d'.
# run whole 691 rows with GSDS ???????????????
# output from GSDS saved as '.png' file.

# from line 13155
#cat pid40_216pruned13to203.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 203 > pid40_216pruned13to203_nodotnum.txt ## ok 
cat pid40_216pruned13to203.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' > pid40_216pruned13to203_nodotnum.txt ## ok 

#cat pid40_216pruned13to203.txt|perl -pe 's/(Tr.+)\.[0-9]$/\1/' | head -n 203 
head -n 3 pid40_216pruned13to203_nodotnum.txt  ## looks ok
wc -l pid40_216pruned13to203_nodotnum.txt
     203 pid40_216pruned13to203_nodotnum.txt
# ok, now, 
# create Philip_203gff3.sh

bash Philip_203gff3.sh pid40_216pruned13to203_nodotnum.txt > 203.gff3
# started ~ 12:15am, 12/16/18.
# was done by 6am.

12/16/18:
wc -l 203.gff3
    1212 203.gff3

cat 203.gff3 | grep "gene" | wc -l  ## 203
cat 203.gff3 | grep "gene" | wc -l  ## 203
cat 203.gff3 | grep "gene" | cut -f3,9 |more

# ref:line 4188
## 1212 rows, 203 with 'gene' rows. 27 rows of 'chrUn' for the 5 gene names in the 203.

# could do following, further check on the 203 ?????
#cat gff3_genes_col9.txt|perl -pe 's/^ID=(Tr.+);.+/\1/' | head -n 110790 > gff3_genes_col9names.txt

## sort gff3_genes_col9names.txt |uniq | wc -l   ## 691 as expect
sort 131.gff3 |uniq | wc -l   ## 110790 as expect
     691  ## thus, all rows unique.

cat 203.gff3 | grep "gene" | cut -f9 |perl -pe 's/^ID=(Tr.+);.+/\1/' |head -n 3
## not working ???????????????????????

# finally submit 203.gff3 to GSDS site. http://gsds.cbi.pku.edu.cn
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs/203.gff3
## 1:35pm
# to retrieve from GSDS site, rt click, 'save image', as '.png', 5MT41V.png. Then manually score this. Create new file, beginning from file with protein names (since couple rows with '.d' where 'd'=2). That file would be pid40_216pruned13to203.txt. So, copy this file to pid40_216pruned13to203_intron.txt
cp pid40_216pruned13to203.txt pid40_216pruned13to203_intron.txt
# Manually edit by adding 'tab' plus intron count to each row.
##################################################################
# Q: TraesCS1A02G067000.1, TraesCS1A02G067400.1, TraesCS1A02G067600.1, TraesCS1B02G038300.1, TraesCS1B02G038400.1, TraesCS1B02G038500.1, TraesCS1B02G072900.2, TraesCS1B02G073100.1, TraesCS1B02G074600.1, TraesCS1B02G085300.1, TraesCS1B02G085900.1, TraesCS1B02G092600.1, TraesCS1D02G033100.1, TraesCS1D02G055300.1, TraesCS1D02G056200.1, TraesCS1D02G058200.1, TraesCS1D02G058200.1, TraesCS1D02G067600.1, TraesCS1D02G068700.1, TraesCS1D02G068800.1, TraesCS1D02G068800.2, TraesCS1D02G076500.1, TraesCS5B02G250800.1, TraesCS6A02G014800.1, TraesCS6A02G099100.1, TraesCS6A02G099118.1, TraesCS6B02G021200.1, TraesCS6B02G021600.1, TraesCS6B02G021641.1, TraesCS6B02G045200.1, TraesCS6B02G127603.1, TraesCS6B02G129200.1, TraesCS6D02G018941.1, TraesCS6D02G047700.1, TraesCS6D02G076500.1, TraesCS6D02G083100.1, TraesCS6D02G083400.1, TraesCSU02G089563.1, TraesCSU02G090200.1 and introns betw UTRs ??????????????????????????
###################################################################
12/17/18:

################################,####################################
TraesCS1B02G039620 (TraesCS1B01G038600LC ???????????, note differences in number, PROBABLY REMOVE, ALL FOULED UP, TO KEEP IN REGISTER, PERHAPS NAME THE PROTEIN FROM THE GENE WITH PROTEIN EXTENSION, OR PERHAPS SOME OTHER SOLUTION ???????) For now, perhaps place a 'blank' ???????????????????????? row 39.
####################################################################

12/18/18:
# now, try incorporate 'intron' colm into 'table8' to create 'table9'.

table8col <- read.delim("table8cols.txt", stringsAsFactors=FALSE)
dim(table8col)  ## [1] 203   7
head(table8col, n=2)

introndf <- read.delim("pid40_216pruned13to203_intron.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("name", "intron"))
dim(introndf)  ## [1] 203   2
head(introndf, n=2)

#create new dframe wi the 8 + 1 = 9 avail. colms (see if assigning colm names while create df will #set colm names, whatever names were before ????????

all(table8col$RFL_prot_ID %in% introndf$name)
all(introndf$name %in% table8col$RFL_prot_ID)
# if identical, expect TRUE for both

table9col <- data.frame(RFL_prot_ID=table8col$RFL_prot_ID, Chr=table8col$Chr, Start=table8col$Start, End=table8col$End, Intron=introndf$intron, Strand=table8col$Strand, Len=table8col$Len, domain_number=table8col$domain_number, Subcel=table8col$Subcel)

dim(table9col)  ## [1] 203   8
head(table9col, n= 3)

#write.table(df, file="table_names_lens_cts.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
write.table(table9col, file="table9cols.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

#################################################################
# ck table9cols.txt in bbedit, looks ok, perhaps change underscores 'Subcel' colm to dashes ???????
###################################################################

# next, perhaps phenograms
#pheno_gram.33904.png
#pheno_gram.1A.10.60protnames128.png

# to start, perhaps create input file like phen_input131protnames.txt for my 203 seqs
chr	pos	phenotype
1A	14577948	TraesCS1A01G031600
1A	14584912	TraesCS1A01G031700

12/21/18:
# perhaps start with gff3 input file to GSDS, perhaps 203.gff3,  or rather 'table9cols.txt. Q: could use gene or protein name ???????
pheno_gram.33904.png
# *phen_input131.txt*, use template for form input file for 203 seqs to phenogram.
# Q: will I need chrom lengths for phenogram? Perhaps at start of say wheat genome gff3 file ???????

##gff-version 3
##sequence-region   chr1A 40098 594002067
##sequence-region   chr1B 168082 689851782
# Q: why two numbers RHS of these rows ???????????????????????????????????
########################################################################
# Q: where should one look for 'chrom. lengths' for v1.1 wheat genome ????????????
##########################################################################

# /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs/table9cols.txt

cat table9cols.txt | cut -f2,3 > phen_203_all_chroms.txt
# rep("my_string", 2)

# now in R
rm(list=ls())
setwd("~/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()
table9 <- read.delim("table9cols.txt", stringsAsFactors=FALSE)
dim(table9)  ## [1] 203   9
head(table9, n=2)

phenotype <- rep("RF-like_seq", 203)
head(phenotype, n=3)
length(phenotype)  ## 203
phen_all_rows <- data.frame(chr=table9$Chr, pos=table9$Start, phenotype=phenotype)

write.table(phen_all_rows, file="phen_all_203rows.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

##########################################################
# don't forget remove chrUN rows before submit to phenogram ??????????
################################################################
cp phen_all_203rows.txt phen_all_203minus5rows.txt

# now try phenogram for **all** chroms: 
# input: phen_all_203minus5rows.txt
# title: all203minus5giving198

# genome: apparently prevly used file Chr_Size_Refv1.txt in dir .../pyMLorthoMCL131norice9. Compared size colm wih RHS colm top IWGSC_v1.1_HC_20170706.gff3 file in dir. /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06
#################################################################
# percentwise, small diffs so use top of v1.1 file (IWGSC_v1.1_HC_20170706.gff3) for these size values.
################################################################
# to 'get' the size values, chr_chr_size_Refv1.1.txt
cat chr_size_Refv1.1.txt | cut -f4 | more  ## fails
cat chr_size_Refv1.1.txt | tr -s " " "\t"| cut -f4| more  ## ok
cat chr_size_Refv1.1.txt | tr -s " " "\t"| cut -f2,4 | perl -pe 's/chr(\w+\t\d+)/\1/' | more
################################################################
# should chrUn rows be excluded ???????? They have 'start' value, and 'chrom' length ???????????????
##################################################################
cat chr_size_Refv1.1.txt | tr -s " " "\t"| cut -f2,4 | perl -pe 's/chr(\w+\t\d+)/\1/' > chr_size_Refv1.1_colm2and4.txt
# then add header (ID	size), removed 'Un' row for now ???????????????????

12/22/18:

# now resume run *all* chroms phenogram again
# genome file: chr_size_Refv1.1_colm2and4minus_Un.txt
# phenotype spacing: default: 'proximity' alg ?????????????????
# phenotype color: default: 'exhaustive search colors' ??????????????????
# image format: default: png
# chromosome only: left unchecked, ???????????????????
# zoom options: none selected this run
# additional options: none selected this run, but possibly some might be useful for this **all** chroms run ?????????????????????
# click 'plot'
# 'Download higher resolution image': pheno_gram.79071.png
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs
# ok, pheno_gram.79071.png looks good.

# 2nd, now try *single* chrom (say all seqs on 1A, etc.). See if can use same input file ???
 # input: template will be phen_input128protnames.txt (actually gene names)
 
# now in R
rm(list=ls())
setwd("~/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()
table9 <- read.delim("table9cols.txt", stringsAsFactors=FALSE)
dim(table9)  ## [1] 203   9
head(table9, n=2)

#phenotype <- rep("RF-like_seq", 203)
#head(phenotype, n=3)
#length(phenotype)  ## 203
phen_all_rows <- data.frame(chr=table9$Chr, pos=table9$Start, phenotype=table9$RFL_prot_ID)

write.table(phen_all_rows, file="phen_inp203rows_protnames.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
# phen_inp203rows_protnames_minus5_198.txt

# template for *single* chrom.
/Users/bterry/mbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL131norice/phen_input128protnames.txt

# input: phen_inp203rows_protnames_minus5_198.txt 
# title: all203minus5giving198_just_1A
# genome file: chr_size_Refv1.1_colm2and4minus_Un.txt
# phenotype spacing: default: 'proximity' alg ?????????????????
# phenotype color: default: 'exhaustive search colors' ??????????????????
# image format: default: png

# chromosome only: try *check* it ???????????????????
# zoom options: 
# chromosome: 1A
# start bp: none this run
# end bp: none this run

# additional options: none selected this run, but possibly some might be useful for this 
# annotation: check it
# click 'plot'
######################################################################
# Q: *not* getting 'annotation' did previously ???????????????????????????
#######################################################################
# try rerun with start=10000000, end=100000000
# title: 	203_1A.10to100mill
# output file: pheno_gram.74130.png
##########################################################
# Q: can't get annotation names from phenotype colm to be displayed as did previously ????????? **Sent** email for help.
#############################################################

# retry, don't select 'chromosome only', voila, worked!

12/23/18:
# to run phenogram for chroms 1A (so can retitle) 1B, 1D, & for 2 & 6.
title: 203_1A_10to100mill
# pheno_gram.45569.png

title: 203_1B_10to100mill
# pheno_gram.82973.png

title: 203_1B_10to150mill
# pheno_gram.43901.png

12/24/18:
# title: 203_1D_10to100mill
# pheno_gram.50648.png

#################################################################
# So, precursor to chroms 1A, 1B, 1D still apparently reflected in distribution **pattern** see on phenograms, since patterns are similar.
#################################################################

12/26/18:

# finish chrom's 2 & 6 phenograms,
# title: 203_2A_700to780mill
# pheno_gram.18055.png

# title: 203_2B_680to780mill
# pheno_gram.61626.png

# title: 203_2D_550to650mill
# pheno_gram.11229.png

# title: 203_6A_1to100mill
# pheno_gram.28181.png

# title: 203_6B_1to125mill
# pheno_gram.39033.png

# title: 203_6D_1to100mill
# pheno_gram.76450.png

#################################################################
# relative number seqs concentrated together similar for chroms A, B, D within chrom 1, 2, 6. Like ancestor sequence for 1, 2, or 6 common to current A, B, or D within a numbered chrom.
#################################################################

#################################################################
# then, do GC analysis of the 203 genes assoc'd with the RF-like protein seqs.
# exactly **why** vikas interested ????????????????????????????????????????
#################################################################
# Q: how get the appropriate seqs ??????????????????????????????????????????
# /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06
# which of following ?????????????????????????????????
IWGSC_v1.1_HC_20170706_cds.fasta ## Q: **organization** of this file ????????????????
IWGSC_v1.1_HC_20170706_transcripts.fasta
head -n 50 IWGSC_v1.1_HC_20170706_transcripts.fasta > test.fa
# Note: Q: transcripts longer than whatever organization is in 'cds' file ????????

# ref: line 12475
# getseq.awk ??????
 
./getseq.awk IWGSC_v1.1_HC_20170706_transcripts.fasta pid40_216pruned13to203.txt > pid40_216pruned13to203_tx.fa
# 203 '>' as expect

# now, copy pid40_216pruned13to203_tx.fa over to dir. /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/GC_est

/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

12/27/18:

# then prepare to run GC_estimate_VB.pl on Crane so can use 'Bio::SeqIO' ????????
cd /Users/bterry/mbook2017/vikas17
find . -name 'align_convert_fas_to_phy.pl' -print
./wheatproj/hmmpipeline/FRprotseqs/align_convert_fas_to_phy.pl
# to do:
# copy GC_estimate_VB.pl to crane (from /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/GC_est)
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp
ls -lh  ## ck dir contents?
mkdir GC_est
cd GC_est
pwd
logout
cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/GC_est)
scp GC_estimate_VB.pl pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est

# copy pid40_216pruned13to203_tx.fa to crane (from /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs)

ref: line 11758
cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs

scp pid40_216pruned13to203_tx.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est

# try run these two on crane
# ref: line 12663
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est
ls -al
chmod 755 GC_estimate_VB.pl
ls -al

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est
module load bioperl

#./align_convert_fas_to_phy.pl pid40_216pruned13to203.fa.aln.hmmaln.fa

perl GC_estimate_VB.pl pid40_216pruned13to203_tx.fa > pid40_216pruned13to203_tx_GCest.txt
ls -al
wc -l pid40_216pruned13to203_tx_GCest.txt
203 pid40_216pruned13to203_tx_GCest.txt
less pid40_216pruned13to203_tx_GCest.txt
exit
logout
cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/GC_est
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est/pid40_216pruned13to203_tx_GCest.txt .
# check in bbedit, looks fine.
#################################################################
# check wi vikas what to do with this, if this what wanted  ??????????????????????????????????
#################################################################

# slip a save to ***github*** in here

# Now what next ?????????????????????????????????????????
So, copied 
pheno_gram.79071.png
pheno_gram.45569.png
lengths_vs_cts.png
to /Users/bterry/mbook2018/vikas18/v1.1Rmd_doc dir.

# next, render, modify as needed 21 + 3 = 24 images to this point in /Users/bterry/mbook2018/vikas18/v1.1Rmd_doc/v1.1_logfile_doc.Rmd file.

# then, Rmd/html manuscript template ?????????
# call it v1.1_manuscript_template.Rmd

STOPPED

# initially copy v1.1_logfile_doc.Rmd to start v1.1_manuscript_template.Rmd.
cp v1.1_logfile_doc.Rmd v1.1_manuscript_template.Rmd

01/02/18:
# working on python3 script as *workshop* in process
# from .../vikas17
find . -name '*red_wheatnames.txt' -print
./wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthoMCL135price9/pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt
# place in /Users/bterry/mbook2019/python010319
# worked on 122 'ids', 135 'entries'

# find getseq.awk
find . -name 'getseq.awk' -print
./131RFlike/getseq.awk

01/09/19:
############################################################################
# talked to Vikas today, comments, issues:
# looking thru Table1
# 'No. of wheat seqs including isoforms', 'unique wheat sequences without isoforms'
# to do frac_align for the final 203 seqs
# try get list 207 seqs at pag
# phylogram of pid50 (vikas to get info on choice of pid for degree of relatedness of the seqs)
# elaborate on 'pid50+88ctls section
# Q: the 196 section ?
# Q: issue 203, 53 < 300 aas ?????? (Zhang table shortest 443
# Q: for moment not throwing out 1592 aa seq in 203 group
# vikas would like see tablecol9, whole file
# GSDS/introns, TO DO: DON'T COUNT introns between UTRs
# GC estimate, vikas purpose: 'signature'
# vikas, to check into whether use to GC estimate for 'CDS', or 'transcripts' or both ??????
# Q: FORGOT TO ASK, WHERE TO LOOK FOR 'chrom' LENGTHS ???????????????
# vikas, exclude 'chrUN' seqs from phenogram ??????, then just display 'all', and 1 individual chrom.
###########################################################################

01/10/19:
# slip a save to ***github*** in here
cd ~/planets
git status
git add wheatprojdoc060117.txt
git commit -m "update 01/10/19 wheatprojdoc060117.txt"
git status
git push origin master
# git remote -v

# mkdir '011019', on 3 tb extl drive.
# backup mbook2018, mbook2019, & ~/planets/wheatprojdoc060117.txt to this dir.

01/11/19:
# at PAGxxvii

01/27/19:
# resuming work on RF-like proteins research
# put the 203 table on box for vikas (tablecol9), perhaps split into two tables to so can see all of each colm.
--calc frac_align for the 203 seqs
--redo GSDS count of introns with vikas comments (i.e., introns **only between** exons).
--GC calcn colm in Zhang style table (transcripts **&** 'cds')
# phylogram of pid50 (vikas to get info on choice of pid for degree of relatedness of the seqs)
# Q: FORGOT TO ASK, WHERE TO LOOK FOR 'chrom' LENGTHS ???????????????
# finish up Rmd file, html to box & vikas
# vikas, **exclude** 'chrUN' seqs from phenogram ??????, then just display 'all', and 1 individual chrom.

01/28/19:
# so redo GSDS count of introns (i.e., introns **only between** exons): 
cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs

# ok, copy pid40_216pruned13to203_intron.txt (from line 13711) to pid40_216pruned13to203_intron-exons.txt
cp pid40_216pruned13to203_intron.txt pid40_216pruned13to203_intron-exons.txt
# now manually edit pid40_216pruned13to203_intron-exons.txt to count only introns between exons. done.

# next, run GC content, for both transcripts, & cds (prevly did for transcripts, see file pid40_216pruned13to203_tx_GCest.txt)
# ref line 13948

IWGSC_v1.1_HC_20170706_transcripts.fasta
IWGSC_v1.1_HC_20170706_cds.fasta
# from line 13941
./getseq.awk IWGSC_v1.1_HC_20170706_transcripts.fasta pid40_216pruned13to203.txt > pid40_216pruned13to203_tx.fa
# 203 '>' as expect

# line 13965
/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est

# so, for 'cds' file, 1st, create 'cds.fa' for cds seqs
copied IWGSC_v1.1_HC_20170706_cds.fasta to /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs
# now, to run getseq.awk
./getseq.awk IWGSC_v1.1_HC_20170706_cds.fasta pid40_216pruned13to203.txt > pid40_216pruned13to203_cds.fa
# Note: top of IWGSC_v1.1_HC_20170706_cds.fasta misleading. Actual seqs in the 203 much longer in pid40_216pruned13to203_cds.fa.
# Next, scp to crane for run with GC_estimate_VB.pl.

scp pid40_216pruned13to203_cds.fa pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est

# ref line 13974
# try run these two on crane
ssh -Y pterry@crane.unl.edu
# Rrq096mN 
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est
ls -al
#chmod 755 GC_estimate_VB.pl
ls -al

--try srun, 
srun --pty --ntasks-per-node=4 --mem 4gb --qos=short $SHELL
cd /work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est
module load bioperl

#./align_convert_fas_to_phy.pl pid40_216pruned13to203.fa.aln.hmmaln.fa

perl GC_estimate_VB.pl pid40_216pruned13to203_cds.fa > pid40_216pruned13to203_cds_GCest.txt
ls -al
wc -l pid40_216pruned13to203_cds_GCest.txt
203 pid40_216pruned13to203_cds_GCest.txt
less pid40_216pruned13to203_cds_GCest.txt
exit
logout
cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/GC_est
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est/pid40_216pruned13to203_cds_GCest.txt .
# check in bbedit, looks fine, **NEARLY THE SAME** values as in pid40_216pruned13to203_tx_GCest.txt

# perhaps now, create table10cols.txt. Do like recreating table9cols.txt since have to include new 'intron' colm plus add pid40_216pruned13to203_tx_GCest.txt. Then create two tables from this 10 colm table by selecting colms from table10cols.txt that want to display together.

# Note: comparing pid40_216pruned13to203_cds.fa & pid40_216pruned13to203_tx.fa, 1st seq for each the same length, just additional doc. in '>' like for 'tx' file. Note, 2nd seq in each file differences, for example, 'CDS' does **not** start at 1 ?????????????????

# ref: line 13723
# now, try incorporate 'intron' & 'GCest' colms into 'table8' to create 'table10'.
cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs

01/29/19:
# start R
table8col <- read.delim("table8cols.txt", stringsAsFactors=FALSE)
dim(table8col)  ## [1] 203   7
head(table8col, n=2)

introndf <- read.delim("pid40_216pruned13to203_intron-exons.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("name", "intron"))
dim(introndf)  ## [1] 203   2
head(introndf, n=2)

gc_tx <- read.delim("pid40_216pruned13to203_tx_GCest.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("name", "GC_tx"))
dim(gc_tx)  ## [1] 203   2
head(gc_tx, n=2)

#create new dframe wi the 8 + 2 = 10 avail. colms (see if assigning colm names while create df will #set colm names, whatever names were before ????????

all(table8col$RFL_prot_ID %in% introndf$name)
all(introndf$name %in% table8col$RFL_prot_ID)
# if identical, expect TRUE for both

all(table8col$RFL_prot_ID %in% gc_tx$name)
all(gc_tx$name %in% table8col$RFL_prot_ID)
# if identical, expect TRUE for both

table10col <- data.frame(RFL_prot_ID=table8col$RFL_prot_ID, Chr=table8col$Chr, Start=table8col$Start, End=table8col$End, Intron=introndf$intron, Strand=table8col$Strand, Len=table8col$Len, domain_number=table8col$domain_number, GC_tx=gc_tx$GC_tx, Subcel=table8col$Subcel)

dim(table10col)  ## [1] 203   8
head(table10col, n= 3)

#write.table(df, file="table_names_lens_cts.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
write.table(table10col, file="table10cols.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

#################################################################
# ck table10cols.txt in bbedit, looks ok, perhaps change underscores 'Subcel' colm to dashes ???????
# note: when print, **two** colms wrap
###################################################################

# upload one or more tables to box.
# placed copy of table10cols.txt in box at GeneFamily/manuscript dir.

# then, subset colms with 'cut' command to get two subset tables ????????????

# talked to vikas,
--bigpint R package
--'summary' for table10.txt colms GC_tx, Len, domain_number
--vikas wanted rename one of colms ????????????????
--histogram, boxplot for GC_tx, Len
--within a cluster, (chr 1), GC_tx. Decide how to cluster, see phenogram chr1A. Perhaps also 1B, 1D if clustered enough ?????? Perhaps within each band ??????????
--finish new Rmd file, removing all the 'links' the details in res. log file
-- for snp analysis, need chr, start, end

01/30/19:
# in dir /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs
pheno_gram.45569.png, 1A, 10to100mill has all 31
pheno_gram.82973.png, 1B, 10to100mill has 37 of 43, so a group well away from cluster, perhaps a cluster itself ?????????
pheno_gram.43901.png, 1B, 10to150mill has 39 of 43
pheno_gram.50648.png, 1D, 10to100mill  has 38 of 38

# ok, do box plot wi ggplot2 for chr 1A, 1B, 1D

rm(list=ls())
setwd("~/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()

table10df <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
str(table10df)
dim(table10df)  ## [1] 203   10
head(table10df, n=2)

table10df112 <- head(table10df, 112)
# produces 112 rows seqs
dim(table10df112)  ## [1] 112  10
head(table10df112, n=2)

table10df112$Chr <- factor(table10df112$Chr)
head(table10df112$Chr)

str(table10df112)
# ref. huber book, sect. 3.62
library(ggplot2)
p = ggplot(table10df112, aes( x = Chr, y = GC_tx, fill = Chr))
p + geom_boxplot()
##############################################################
# saved as GCbox1A1B1D112.png. Note, median similar for each chrom. Also, each has 2 outliers similarly located.
#################################################################
# to do, try use dplyr to subset the rows for 1A, 1B, 1D in order to run summary fcn.

#meta_citplus <- metadata %>%
#  filter(cit == "plus") %>%
#  select(sample, generation, clade)

#meta_citplus


library("dplyr")
table10df1A31 <- table10df112 %>% 
  filter(Chr == "1A") %>% 
  select(Chr, GC_tx)  
dim(table10df1A31)  ## [1] 31  2
head(table10df1A31, 2)
summary(table10df1A31$GC_tx)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#  37.27   40.42   45.58   45.80   47.22   63.00 
# summary can't **quickly** see diffs can see easily with boxplot

01/31/19:
# talked to vikas
# for now prioritize 'snp' and locations of 203 RF-like seqs
 
02/01/19:
# today, screen would not light up, did reboot of 3.5 yr old macbook, seems to be working now.
##################################################################
# slipped a save to ***github*** in here
##################################################################

# now,prioritizing 'snp' task, trying familiarize with 'Tassel' s/w
# **requires** java 1.8, I have 1.6.0_29-b11-402

# Downloaded wi vikas, upgraded to java 1.8
# and installed tassel 5 thru the '.dmg'.
# next, try look thru some of the doc. to see how tassel runs.
# tassel youtube videos, 
#############################################################
Q: which tassel 5 topic/task interested in ???????
################################################################
# 1. TASSEL installation and increasing heap size
# Note: heap size default was 8Gb, inc'd to 10Gb in tutorial (but may be too much for this macbook ??????????)
# TASSEL GWAS101, ... viewed several more videos

02/03/19:
# /Users/bterry/mbook2019/vikas19/tassel5/TASSELTutorialData5
philip-terry-2:TASSELTutorialData5 bterry$ ls
282_GBS2.7_Depth7Mask.h5		mdp_genotype.vcf
NAM_RILs1-5_GBS2.7_Depth7Mask.h5	mdp_kinship.txt
d8_sequence.phy				mdp_phenotype.txt
mdp_genotype.hmp.txt			mdp_population_structure.txt
mdp_genotype.plk.map			mdp_traits.txt
mdp_genotype.plk.ped

# ok, how to proceed ???????
# vikas, think starts with tassel5 user interface, but videos, start with command line ?????
# which one(s) of these tutorial data files to explore ?????
# How much help would looking back at Gota course, spr2018 ????????
wc -l mdp_genotype.hmp.txt
    3094 mdp_genotype.hmp.txt


 
02/06/19:
Back to working on v1.1_manuscript_template.Rmd, to divide 'Zhang' table into two tables, so won't cutoff protein ID colm.

# so run R, create two tables
# ref, line 14147
# start R
setwd("~/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()

rm(list=ls())

table10col <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
dim(table10col)  ## [1] 203   10
head(table10col, n=2)
# next, create table1st5col.txt, then table2nd7col.txt

# line 14160
#create 1st new dframe wi 5 colms (see if assigning colm names while create df will #set colm names, whatever names were before ????????

# ref line 14170
#table10col <- data.frame(RFL_prot_ID=table8col$RFL_prot_ID, Chr=table8col$Chr, Start=table8col$Start, End=table8col$End, Intron=introndf$intron, Strand=table8col$Strand, Len=table8col$Len, domain_number=table8col$domain_number, GC_tx=gc_tx$GC_tx, Subcel=table8col$Subcel)

table1st5col <- data.frame(RFL_prot_ID=table10col$RFL_prot_ID, Chr=table10col$Chr, Start=table10col$Start, End=table10col$End, Len=table10col$Len, domain_number=table10col$domain_number)

dim(table1st5col)  ## [1] 203   6
head(table1st5col, n= 3)

write.table(table1st5col, file="table1st6cols.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

table2nd7col <- data.frame(RFL_prot_ID=table10col$RFL_prot_ID, Chr=table10col$Chr, Start=table10col$Start, Intron=table10col$Intron, Strand=table10col$Strand, GC_tx=table10col$GC_tx, Subcel=table10col$Subcel)

dim(table2nd7col)  ## [1] 203   7
head(table2nd7col, n= 3)

write.table(table2nd7col, file="table2nd7cols.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

#################################################################
# ck table1st5cols.txt, table2nd7cols.txt in bbedit, looks ok, perhaps change underscores 'Subcel' colm to dashes ???????

# now, place these two tables in v1.1_manuscript_template.Rmd file, to check if 'wraps' ???????
# no missing prot names, so ok.
# perhaps, move GC_tx, 2nd to 1st table, 'End', 1st to 2nd ??????????????
###################################################################

02/07/19:

# back to tassel task.
file from vikas , Variant_Files dir. on 'box', cp to: /Users/bterry/mbook2019/vikas19/tassel5/R_and_NonR_lines_VariantCalls2018_MAF0.05_Max-missSNPs0.20_MaxMissLine20p.recode.vcf

-rw-rw-rw-@  1 bterry  staff  33829910 Feb  7 12:53 R_and_NonR_lines_VariantCalls2018_MAF0.05_Max-missSNPs0.20_MaxMissLine20p.recode.vcf


wc -l R_and_NonR_lines_VariantCalls2018_MAF0.05_Max-missSNPs0.20_MaxMissLine20p.recode.vcf
   27367 R_and_NonR_lines_VariantCalls2018_MAF0.05_Max-missSNPs0.20_MaxMissLine20p.recode.vcf
# Q: only ~27000 lines ????????????????????????

less R_and_NonR_lines_VariantCalls2018_MAF0.05_Max-missSNPs0.20_MaxMissLine20p.recode.vcf



less R_and_NonR_lines_VariantCalls2018.recode.vcf
# need learn about format of this file ???????????????????????


02/08/19:
# talked to vikas yesterday, items
# vikas used Ensembl VEP to produce /Users/bterry/mbook2019/vikas19/tassel5/VEP/VariantEffectPredictor_Run1.txt
# Q: take gene colm, snp ID colm ?????????
# find any overlap between these rows, and the rows of the 203/216 RF-like seqs (think have python script for this ??????

# try learn tassel5 later ????????????????

# talked to vikas, venny, grep -F, python3, ways to subset ...Run1.txt rows for proteins wi snps & in 203/216.
grep -x -f A.txt B.txt
grep -xF -f A.txt B.txt   ## not clear on this, but can try ?????????

## think have a python script (/Users/bterry/mbook2019/python010319
/testing.py ?????) to find list protein names in one file present in a 2nd file. Q: if multiple occurrences of the protein in rows 2nd file, will all rows in 2nd file be reported (think it should) ??????????????
# test input:
head -n 3 pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt > teststd_inp.txt

head -n 5 pprhmmsearchsubset_p_prots820plus9_fa_aln_hmmaln_phy_phyml_tree_nexus_2colors.835_red_wheatnames.txt > test1starg_inp.txt

# now, 
cat teststd_inp.txt | python3 testing.py test1starg_inp.txt  ## ok,
# now test if for ...Run1.txt as 1st arg input, if teststdinp.txt with say just 2 rows of gene names, say the 1st & 3rd protein name in VariantEffectPredictor_Run1.txt.

cd /Users/bterry/mbook2019/vikas19/tassel5/VEP
head -n 25 VariantEffectPredictor_Run1.txt > Run1_1st25.txt

TraesCS1A02G001800.1
TraesCS1A02G006100.1

# create teststdinp2.txt file with these two prot. names
cat teststdinp2.txt | python3 testing.py Run1_1st25.txt  ## seems ok, might want not to print out the query prot. name, but for now, leave.

# so ready to run testing.py wi query colm 1 of table10cols.txt (as std inp) vs VariantEffectPredictor_Run1.txt, see if any snps located inside any of the 203 RF-like genes.
# Q: what to do with the 5 'Un' rows at bottom end of 203 prot. names in colm 1 of table10cols.txt ??????????????????????????????????????????????????
# Q: for now, leave them in ?????????????????????
cat table10cols.txt | cut -f1 | tail -n 203 | head -n 5
wc -ld 
   36330 VariantEffectPredictor_Run1.txt
cat table10cols.txt | cut -f1 | tail -n 203 | python3 testing.py VariantEffectPredictor_Run1.txt
# RESULT: 75 rows of output, does it mean 75 snps associated with an RF gene/protein, i.e., within or +- 5000 of gene ???????

02/09/19:
# to email vikas with this result (done)

######################################################
https://stackoverflow.com/questions/16706005/exact-grep-f-command-in-linux
# testing grep -f ????????????
grep -f A.txt B.txt
grep -f teststd_inp.txt test1starg_inp.txt
# finds same output as testing.py, but in different order.
grep -f teststdinp2.txt Run1_1st25.txt
# similar to testing.py, just without the prot. name from teststdinp2.txt as he 1st column.

# don't know how to put this in a pipeline for 'grep -f' ?????
# so create the input file 1st, then apply 'grep -f'
cat table10cols.txt | cut -f1 | tail -n 203 > table10col1.txt
# now, 
grep -f table10col1.txt VariantEffectPredictor_Run1.txt | wc -l  ## 75 as expected
grep -f table10col1.txt VariantEffectPredictor_Run1.txt > vep_Run1_203map_grepf.txt
# result: 75 rows, same order as with testing.py. Since no duplicate rows, therefore same order as testing.py.
# so, since preceding worked, won't test following command now:
grep -x -f A.txt B.txt
######################################################

02/10/19:
# not 'following' vikas email response of 02/09/19?
# don't follow "Transcript" and "SNPIDs" separately ????????????????????????/

The next step will be to run sort|uniq on "Transcript" and "SNPIDs" separately and make a list of SNPs that are within RFL and unique transcripts that contain these SNPs.

02/11/19:
# 1st, 
cat vep_Run1_203map.txt | cut -f1 | wc -l  ## 75
cat vep_Run1_203map.txt | cut -f1 | sort|uniq > vep_Run1_203map_col1sortuniq.txt
# failed, cause 'space' rather than tab betw. 1st & 2nd colms.

cat table10cols.txt | cut -f1 | tail -n 203 | python3 testing.py VariantEffectPredictor_Run1.txt > test203stdout.txt

# both the '>' std out & the 'output.write' stmnt within testing.py file both produced the 'tab' colm splitting desired. Since the '>' produced blank lines between rows of output, go with the 'output.write' output.

cat vep_Run1_203map.txt | cut -f1 | sort|uniq > vep_Run1_203map_col1sortuniq.txt
# gives 36 rows, protein names.

# now, do 'sort|uniq for colm 2, the snp name colm
cat vep_Run1_203map.txt | cut -f2 | sort|uniq > vep_Run1_203map_col2sortuniq.txt
########################################################
# Q: 59 rows (snp column) ???????????????????????????
###########################################################
# ok, see if get same thing if do for colm 1 of vep_Run1_203map_grepf.txt
cat vep_Run1_203map_grepf.txt | cut -f1 | sort|uniq > vep_Run1_203map_col1grepfsortuniq.txt
# 59 rows as above (snp column), spot check every 10 rows, exact match.
################################################################
# Q: rows 7 & 8, same snp mapping to two protein names ??????????????
# Q: I assume diff. genes since different protein names ??????????????
################################################################

################################################################
# Q: vikas mention snp input file to VEP. Q: was it R_and_NonR_lines_VariantCalls2018_MAF0.05_Max-missSNPs0.20_MaxMissLine20p.recode.hmp.txt
 ?????????????????????????????
# Q: think vikas translated from '.vcf' to '.hmp' ????????????????????
# Q: apparently did not use tassel5 yet ???????????????????
################################################################


02/12/19:
# Following Vikas email today, try reproduce his excel spreadsheet in R.
# To accomplish, take vep_Run1_203map.txt file. Take colm 1, check if sequence same as colm 1 of table10cols.txt.

# Note: vikas request list uniq snps (already have, 59, either vep_Run1_203map_col2sortuniq.txt or vep_Run1_203map_col1grepfsortuniq.txt files.
################################################################
# Q: where get info. to subset into R, non-R the 59 snps ???????????????
################################################################


02/13/19:
# talked to vikas
# apparently, can find R & nonR snps by inputing sort|uniq list of snps 59 snps from vep_Run1_203map_col2sortuniq.txt to either Tassel5 or VCF tools ?????????????????
# tomorrow, 3pm, will learn how to do. input file can be R_and_NonR_lines_VariantCalls2018_MAF0.05_Max-missSNPs0.20_MaxMissLine20p.recode.hmp.txt
 or the .vcf file this hmp file came from.
 # get flapjact s/w (flapjack_macos_1_18_06_29.dmg)
 # done installing
 
 # for now, Try repeat some of what vikas did in join_vep_Run1_203map_table10cols_v2.xlsx
# If want to display 75 snps from vep_Run1_203map.txt along with their calc'd position relative to genes (inside, or up or downstream +-5000 nucleotides), 
# 1st, get colms 1 & 2 from vep_Run1_203map.txt (75 rows) & 1,3,4 from table10cols.txt. 

cat table10cols.txt | cut -f1,3,4 > table10cols_cols134.txt
cat vep_Run1_203map.txt | cut -f1,2 > vep_Run1_203map_cols12.txt

02/14/19:

Then, see https://stat545.com/bit001_dplyr-cheatsheet.html,
# In R session, prepare two df's, coerce to tibbles

rm(list=ls())
setwd("~/mbook2019/vikas19/tassel5/VEP")
getwd()

table10cols_cols134 <- read.delim("table10cols_cols134.txt", header=TRUE, stringsAsFactors=FALSE)

dim(table10cols_cols134) ## [1] 203   3
View(table10cols_cols134)
head(table10cols_cols134, n=2)

vep_Run1_203map_cols12 <- read.delim("vep_Run1_203map_cols12.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("RFL_prot_ID", "snp"))

dim(vep_Run1_203map_cols12)  ## [1] 75  2
View(vep_Run1_203map_cols12)
head(vep_Run1_203map_cols12, n=2)

#install.packages("tidyverse")
library(tidyverse) ## dplyr provides the join functions
#as_tibble(pedestrian)
table10cols_cols134_tb <- as_tibble(table10cols_cols134)
vep_Run1_203map_cols12_tb <- as_tibble(vep_Run1_203map_cols12)

ijtabvep_tb <- inner_join(table10cols_cols134_tb, vep_Run1_203map_cols12_tb)
dim(ijtabvep_tb) ## [1] 75  4
View(ijtabvep_tb)
head(ijtabvep_tb, n=2)

write.table(ijtabvep_tb, file="ijtabvep4cols.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

inner_join(x, y): Return all rows from x where there are matching values in y, and all columns from x and y. If there are multiple matches between x and y, all combination of the matches are returned. This is a mutating join.

# next, do 3 calc's. Use 'mutate'
# 1st, remove 1st 4 char from snp colm

02/15/19:
rm(list=ls())
setwd("~/mbook2019/vikas19/tassel5/VEP")
getwd()
iftabvec <- read.delim("ijtabvep4cols.txt", header=TRUE, stringsAsFactors=FALSE)
dim(iftabvec) ## [1] 203   3
View(iftabvec)
head(iftabvec, n=2)

colm4 <- read.delim("colm4.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("snpaddr"))
dim(colm4)  ## [1] 75  1
View(colm4)
head(colm4, n=2)

ijtabvec_addr <- data.frame(RFL_prot_ID=iftabvec$RFL_prot_ID, Start=iftabvec$Start, End=iftabvec$End, snpaddr=colm4$snpaddr)

dim(ijtabvec_addr)  ## [1] 75  4
View(ijtabvec_addr)
head(ijtabvec_addr, n=2)

write.table(ijtabvec_addr, file="ijtabvep_snpaddr.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

library(dplyr)
ingenecalc <- ijtabvec_addr %>% mutate(ingene=ifelse(((snpaddr > Start) & (snpaddr < End)),1,0))
head(ingenecalc, n=2)
View(ingenecalc)

upstrdist <- ingenecalc %>% mutate(updist=ifelse((snpaddr < Start), snpaddr - Start, "NA"))
head(upstrdist, n=2)
View(upstrdist)

dnstrdist <- upstrdist %>% mutate(dndist=ifelse((snpaddr > End), snpaddr - End, "NA"))
head(dnstrdist, n=2)
View(dnstrdist)

write.table(dnstrdist, file="ijtabvep3calccols.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

# so have calcs if snp in, up or down stream in a file.

# to do, compare vikas 1, 0 prot names from the '75' with mine in file ijtabvep3calccols.txt.
# try filter/select/distinct wi dplyr 

rm(list=ls())
setwd("~/mbook2019/vikas19/tassel5/VEP")
getwd()
iftabvec3calcs <- read.delim("ijtabvep3calccols.txt", header=TRUE, stringsAsFactors=FALSE)
dim(iftabvec3calcs) ## [1] 75  7
View(iftabvec3calcs)
head(iftabvec3calcs, n=2)

library(dplyr)

ingenegrps <- iftabvec3calcs %>% filter(ingene == 1)
head(ingenegrps, n=2)
View(ingenegrps)  ## 33 rows

ingenegrps_0 <- iftabvec3calcs %>% filter(ingene == 0)
head(ingenegrps_0, n=2)
View(ingenegrps_0)  ## 42 rows

RFLprots1uniq <- ingenegrps %>% select(RFL_prot_ID) %>% distinct()
View(RFLprots1uniq)  ## 18 as vikas

write.table(RFLprots1uniq, file="RFLprots1uniq.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)

RFLprots0uniq <- ingenegrps_0 %>% select(RFL_prot_ID) %>% distinct()
View(RFLprots0uniq)  ## 20 as vikas

write.table(RFLprots0uniq, file="RFLprots0uniq.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=TRUE)
##########################################################################
# so match vikas wi 18 uniq prot seqs wi snp within gene, & 20 outside gene.
##########################################################################

# Now, work with Tassel5, VCF tools, Flapjack. Yesterday, Vikas placed 4 files on 'box'.
/Users/bterry/mbook2019/vikas19/tassel5/VEP/vikas_box

ForFlapjack_R_and_NonR_lines_RFL_SNPs.recode.txt
R_and_NonR_lines_RFL_SNPs.log
R_and_NonR_lines_RFL_SNPs.recode.hmp.txt
R_and_NonR_lines_RFL_SNPs.recode.vcf


02/18/19:
# vikas indicated he uploaded 3 more files, think for FlapJack ????????
# looking in the box, looks like only two files are new ???????????????
ForFlapjack_Subgroup2R_and_NonR_lines_RFL_SNPs.recode.txt
ForFlapjack_Subgroup2Homogeneous_R_and_NonR_lines_RFL_SNPs.recode.txt


# apparently, try display in FlapJack
# initially, try ForFlapjack_Subgroup2R_and_NonR_lines_RFL_SNPs.recode.txt
# 23 rows
# next, ForFlapjack_Subgroup2Homogeneous_R_and_NonR_lines_RFL_SNPs.recode.txt
# 21 rows
# both of these, **appear** to be colms which distinguish R, nonR rows.

02/19/19:
# slipped a save to ***github*** in here

# talked to vikas
# need redo 21, 23 row flapJack files in FlapJack (previously, cut off RHS colms)
# so, one '1', four '2's in FlapJack display of the '21' lines.
# Q: only 2 of my five rating '1' or '2' are from chrom 1. Two from chrom 2, one from chrom 6.
# the '1' is in a **cluster** of RF-like proteins on chrom 2B
###########################################################################
# Q: discarding some apparently reasonable colms by avoiding colm with 'het' snps ?????
###########################################################################
# test outputting image from FlapJack
# image.png (note: my screen shot has **better** resolution)
# Q: could a combination of the snps be used to relate to an 'R' line ???????

02/20/19:
vikas tasks:
i) make list of '1's
TraesCS2A02G530700.1	748437526	748439046	S2A_748437723
(see ijtabvep4cols.txt)
ii) what gene is it in (if is in)
TraesCS2A02G530700.1	748437526	748439046	748437723	1	NA	NA
# so is within a gene (see ijtabvep3calccols.txt)
iii) to check 'science' genome pub paper for exptly verified R lines in wheat
IWGSC, *Science* **361**, 661 (2018)


02/21/19:
# talked to vikas
--to create table wi two colms, gene name & snp name (note are 4 such snps). To upload to box
# to accomplish, start with file: ijtabvep4cols.txt, copy to ijtabvep4cols4snps.txt, then manually remove all but the 4 snps to be saved. 
Finally use cut command to select colms 1 & 4. 
# in dir /Users/bterry/mbook2019/vikas19/tassel5/VEP

cat ijtabvep4cols4snps.txt | cut -f1,4 > ijtabvep2cols4snps.txt

Check to see if still have colm headers => yes
Uploaded to box
Emailed vikas as to the name of file uploaded.

02/22/19:
cd ~/mbook2017/vikas17

find . -name 'FunctionallyCharacterizedRfs_fasta.txt' -print
mbook18/vikas18

--vikas 6 exptl R genes, from other species (part of the 88 ctls I using previously). To do, check their location in phylogram compared to these four snps locations.

FunctionallyCharacterizedRfs_fasta.txt
cd ~/mbook2017/vikas17

find . -name 'FunctionallyCharacterizedRfs_fasta.txt' -print
/Users/bterry/mbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthomcl131vikas6
cd /Users/bterry/mbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs/phyml/pyMLorthomcl131vikas6
grep -c "^>" FunctionallyCharacterizedRfs_fasta.txt  ## 6  ??????
grep "^>" FRknownseqs.fa > grepoutput  ## 11 rows as expect
grep "^>" FunctionallyCharacterizedRfs_fasta.txt
>CAR70003.1_At1g12700_Arabidopsis_thaliana
>BAM64814.1_bvCRP-1_Beta_vulgaris
>API57808.1_RFP1_Brassica_rapa
>AAM52339.1_fertilityrestorer_Petuniaxhybrida
>AJG06104.1_restorer-of-fertility_Raphanus_sativus
>Q76C99.1_Rf1_Oryza_sativa


# Get names of the 6 ctls, check Rmd/html output for image to search location these seqs in phylogram ?????????

--also, check whether the (2) snps are in/outside their gene ?????????


--try relate RF1, RF3 (fig 4, IWGSC, *Science* **361**, 661 (2018, chrom 1A, 1B) to the 34 chrom 1A & 1B snps in this study ???????????? Get whatever can from literature ?????

cd /Users/bterry/mbook2018
find . -name 'eaar*' -print

02/23/19:
IWGSC, *Science* **361**, 661 (2018)
# looking for location of Rf1, Rf3, Rf8, Rf4, see Fig.4c, Fig.S54. Also refs 
45, 165, 166, 168
# Note, Fig S54, states '**approximate** position of the mapped Rf genes is indicated' 
# Rf1, Rf3, (see see ref 166, 167)
# Rf4, (see ref 166)
# Rf8, (see ref 168)
# ref 166: Journal of Agriculture Biotechnology, j. agric. biotechnol. (ncbi, unl libr **don't have** ??????
# ref 167, for Rf1, Geyer, Mol. Genet. Genomics 293 451 (2018)
# Q: T. timopheevii, looks like this reference says Rf1 (apparently on chrom 1A), wi modifier on chrom 1B of **T. timopheevii**. Looks like **don't** have a specific genome address on T. timopheevii? Also, **how** relating this to new hexaploid wheat genome?

# I note, fig. S54A, the breakdown by number of RFL genes per chrom. and subgenome compared to the breakdown in our 203 protein sequences matches probably within +-1 for each category.

02/24/19:
# to email vikas wi some of these comments ??????????????????

02/25/19:
# appears no list of the 207 RFL genes advertised in wheat genome seq. science paper ?????

Q: what now, pub what have, any possible initiative involving some expts with wheat plants ?????????

02/27/19:
PPRv1.1.1913_br9rice9soy38arab26plusvikas6.fa 
find . -name 'PPRv1.1.1913_br9rice9soy38arab26plusvikas6.fa ' -print
# talked to vikas yesterday. 
# 1st, open from list_wheatids_pid50_plus88ctls_phyml_tree_chrcolor_forRmd.txt from dir: note '.png' in .../v1.1Rmd_doc, but forRmd.txt still on 'pro'.

# Note: **could(??)** still check on pid35 + 88, compare position vikas6 file as did for list_wheatids_pid50_plus88ctls_phyml_tree_chrcolor_forRmd.txt above, same pro dir ??????????????

#######################################################################
# TO DO, make table for RFs (fig S54(B)
#######################################################################


# talked to vikas
# blast genes (or proteins) or both ???????
# Q: what is query, target ?????????????
#######################################################################
# Wants 216 (pid40 blastp hits). TO CHECK: THAT THE 4 snp HITS ARE INCLUDED ????????????
# YES, see .../cikas19/tassel5/VEP/ijtabvep4cols4snps.txt
#######################################################################

02/28/19:
# ref: line 10025
find . -name 'slurm_blastp_88ctls_vs_prot1161_ev06_outfmt6cust.sh' -print

line 9917
slurm_makeblastdb_protv1.1_1161.sh
rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp

# prevly,
Attempting to identify most closely related seqs of the 1161 to RF-like ctls, blastp 88 RF-like ctls (query) vs 1161 seqs (target).
# think here, do vikas6 (query) wi 203 seqs as target ???????????

#######################################################################
# to check if TraesCS1A02G067500.1 is still outlier on pid50 phylogram with **no** 88ctls ?????
#######################################################################

/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter

list_WheatIDs_pid40.fa  ## target of new blastp run
list_WheatIDs_pid40.txt

line 9884, 09/18/18
slurm_makeblastdb_protv1.1_1161.sh

03/01/19:
# see line 10048
#cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls
#scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/blastpctls88vs_prots1161/rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp .

wc -l rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
  237410 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp

# head -n 6 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp

# leaves 16958 for vikas6

>CAR70003.1_At1g12700_Arabidopsis_thaliana  
grep -c "^CAR70003" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 2792

>BAM64814.1_bvCRP-1_Beta_vulgaris
grep -c "^BAM64814" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 2625

>API57808.1_RFP1_Brassica_rapa
grep -c "^API57808" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 2873

>AAM52339.1_fertilityrestorer_Petuniaxhybrida
grep -c "^AAM52339" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 2666

>AJG06104.1_restorer-of-fertility_Raphanus_sativus
grep -c "^AJG06104" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 3090

>Q76C99.1_Rf1_Oryza_sativa
grep -c "^Q76C99" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp  ## 2912

#################################################################
sum(c(2792,2625,2873,2666,3090,2912))  ## [1] 16958, matches line 10055
#################################################################

# ready proceed, appropriately subsetting to get what want.

03/02/19:

# see line 10057
# perhaps subset for the 6 vikas6 ctls above, copy to ../vikas6hits
# /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits

# to save memory, do from command line with grep

grep "^CAR70003" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > /vikas6hits/arabctl.blastp

grep "^BAM64814" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Betactl.blastp

grep "^API57808" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Brassica.blastp

grep "^AAM52339" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Petun.blastp

grep "^AJG06104" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Raphanus.blastp

grep "^Q76C99" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Oryza.blastp

# next, subset each of the 6 with python pgm

#line 14434
#cat table10cols.txt | cut -f1 | tail -n 203 | python3 testing.py VariantEffectPredictor_Run1.txt > test203stdout.txt

cat list_WheatIDs_pid40.txt | python3 testing.py arabctl.blastp > vikas6arabpid40_216_hits.blastp

# have 7 rows of TraesCS1A02G031600.1 ??????????????????????????
# check 88 query blastp input for multiple CAR70003? Result: just '1' as expect.
# check 1161 input file for multiple TraesCS1A02G031600.1 ?????????
# from /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls

cd /Users/bterry/mbook2018
find . -name 'PPRv1.1_1161_P_seqs_subset.fa' -print
#############################################################
# TraesCS1A02G031600.1 present just once in PPRv1.1_1161_P_seqs_subset.fa
#############################################################

# Q: why 7 hits in vikas6arabpid40_216_hits.blastp ????????
TraesCS1A02G031600.1	CAR70003.1_At1g12700_Arabidopsis_thaliana	TraesCS1A02G031600.1	3.00e-83	29.958	474	602	784	273
TraesCS1A02G031600.1	CAR70003.1_At1g12700_Arabidopsis_thaliana	TraesCS1A02G031600.1	1.26e-75	25.994	654	602	784	253
TraesCS1A02G031600.1	CAR70003.1_At1g12700_Arabidopsis_thaliana	TraesCS1A02G031600.1	1.42e-66	27.130	575	602	784	228
TraesCS1A02G031600.1	CAR70003.1_At1g12700_Arabidopsis_thaliana	TraesCS1A02G031600.1	1.64e-56	30.056	356	602	784	200
TraesCS1A02G031600.1	CAR70003.1_At1g12700_Arabidopsis_thaliana	TraesCS1A02G031600.1	2.38e-48	26.087	414	602	784	176
TraesCS1A02G031600.1	CAR70003.1_At1g12700_Arabidopsis_thaliana	TraesCS1A02G031600.1	2.42e-23	30.811	185	602	784	100
TraesCS1A02G031600.1	CAR70003.1_At1g12700_Arabidopsis_thaliana	TraesCS1A02G031600.1	1.75e-15	23.077	234	602	784	75.9

# the seven have different evalues, pid's ??????????????????????
# Q: why seven ????????????????
# Q: might this affect original blastp pid values? For example, if ran a sort|uniq without checking for duplications, then would not have noted multiple values for a prot. seq. 
# Q: how were the 216 for 40 pid selected ???????????????
################################################################
# PROBABLY NEED GO BACK CHECK IF THERE WAS DUPLICATION IN THE PROT. SEQ HITS BEFORE THE PID SELECTION ??? 
###############################################################

03/03/19:
# rename test_output.txt to vikas6arabpid40_216_hits.blastp (done)

# then run testing.py on rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp, see if get same output as when ran on subset, arabctl.blastp.

wc -l rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
tail -n 37410 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > last37410.txt

head -n 200000 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp | tail -n 100000 > test100000_200000.blastp
# so 7 

# following not needed
#cat list_WheatIDs_pid40.txt | python3 testing.py rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6arabpid40_216_hits.blastp

# since find 7 TraesCS1A02G031600.1 associated with 'CAR...' in rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp, 
########################################################
# Q: none in 7 have pid > 31%. So, how does TraesCS1A02G031600.1 appear in pid40 (216) ????????????????
# Q: so 1 CAR... in 88 ctls in blastp query, 1 TraesCS1A02G031600.1 in 1161 target .fa file, BUT 7 COMBINATION CAR... and TraesCS1A02G031600.1 rows in rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp, each with different evalues & pid's. And the highest pid is ~ 31%, so should not have been scored in pid >= 40% ???????????
#########################################################

03/04/19:
# check blastp target file for unique rows, PPRv1.1_1161_P_seqs_subset.fa
# bbedit of PPRv1.1_1161_P_seqs_subset.fa shows 1161 '>' rows
grep -c "^>" PPRv1.1_1161_P_seqs_subset.fa   # 1161 as expect
grep "^>" PPRv1.1_1161_P_seqs_subset.fa | wc -l  # 1161 as expect
################################################################
grep "^>" PPRv1.1_1161_P_seqs_subset.fa | sort|uniq | wc -l  ## 1161 unique rows
################################################################

# Try repeat say pid40 from blastp output. Lets see what we get ???????????????

STOPPED

# try find pid >= 40 in rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
wc -l rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp
  237410 rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp

# try wi dplyr (filter, arrange)

/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls

R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls")
getwd()

blastphits <- read.delim("rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(blastphits) ## [1] 237410      8
View(blastphits)
head(blastphits, n=2)

library(dplyr)
pid40test <- blastphits %>% filter(pid > 40)
dim(pid40test)  ## [1] 3432    8
head(pid40test, n=4)
View(pid40test)  ## 3432 rows

pid40testsortrev <- blastphits %>% filter(pid > 40) %>% arrange(desc(pid))
dim(pid40testsortrev)  ## [1] 3432    8
head(pid40testsortrev, n=4)
tail(pid40testsortrev, n=4)
View(pid40testsortrev)  ## 3432 rows

write.table(pid40testsortrev, file="pid40testsortrev.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

###########################################################################
# Q: perhaps vikas did thru sort|uniq. So do a write, later do sort|uinq from unix command line.
cat pid40testsortrev.txt | cut -f2 | sort|uniq | wc -l  ## 216 as prev pid40
###########################################################################

03/05/19:

STOPPED

pid40testsortrevuniq <- blastphits %>% filter(pid > 40) %>% arrange(desc(pid)) %>% distinct(sseqid, .keep_all= TRUE)
dim(pid40testsortrevuniq)  ## [1] 216   8
head(pid40testsortrevuniq, n=4)
tail(pid40testsortrevuniq, n=4)
# ALSO WRITE pid40testsortrevuniq TO FILE, SO CAN CHECK IF HAS ...031600.1 seq ??????????
write.table(pid40testsortrevuniq, file="pid40testsortrevuniq.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)
#################################################################
# result, ...031600.1 seq, present once. Note: spread pid ~ 40% to 79%
#################################################################

###############################################################
# Q: check on if can help by using 'evalue' colm ??????????????????????
###############################################################
pid40testevalsortuniq <- blastphits %>% filter(pid > 40) %>% arrange(eval) %>% distinct(sseqid, .keep_all= TRUE)
dim(pid40testevalsortuniq)  ## [1] 216   8
head(pid40testevalsortuniq, n=4)
tail(pid40testevalsortuniq, n=4)
#################################################################
# range 0 to e-11
#################################################################

##############################################################
# TO DO: perhaps box plot pid, eval for the 216 (ref 01/30/19)
##############################################################



# finally back to vika6. Might 1st subset all hits for each of 6 (think done above, 873 for 'CAR70003.1), then sort by evalue, examine. Then subset by uniq seq namehits, for each of the vikas6, then compare to phylogram. Sort initially by eval, & later by pid. Could also boxplot.


# /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits

/vikas6hits/arabctl.blastp
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()
CAR70003hits <- read.delim("vikas6arabpid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(CAR70003hits) ## [1] 873   9
View(CAR70003hits)
head(CAR70003hits, n=2)

library(dplyr)
CAR70003hitssorteval <- CAR70003hits %>% arrange(eval)
dim(CAR70003hitssorteval)  ## [1] 873   9
head(CAR70003hitssorteval, n=4)
tail(CAR70003hitssorteval, n=4)
# range eval = e-96 to e-07
write.table(CAR70003hitssorteval, file="CAR70003hitssorteval.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

# now, make uniq, then write.

CAR70003hitssortevaluniq <- CAR70003hits %>% arrange(eval) %>% distinct(sseqid, .keep_all= TRUE)
dim(CAR70003hitssortevaluniq)  ## [1] 160   9
head(CAR70003hitssortevaluniq, n=4)
tail(CAR70003hitssortevaluniq, n=4)
write.table(CAR70003hitssortevaluniq, file="CAR70003hitssortevaluniq.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)
# range to e-96 e-40, so making unique removed bunch of larger eval rows ??


03/06/19:
# talked to vikas yesterday
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits
i) best hit(s) each of vikas6 ctls on the pid40 216 seqs. Create CAR70003hitssorteval.txt for other 5 of vikas6. For this file, take top 3 for this file.

# for 2nd vikas6 ctl: 
#grep "^BAM64814" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Betactl.blastp

#cat list_WheatIDs_pid40.txt | python3 testing.py arabctl.blastp > vikas6arabpid40_216_hits.blastp

cat list_WheatIDs_pid40.txt | python3 testing.py Betactl.blastp > discard2.blastp

# rename test_output.txt to vikas6Betapid40_216_hits.blastp (done)
wc -l vikas6Betapid40_216_hits.blastp
     824 vikas6Betapid40_216_hits.blastp

# R/dplyr to get sorted on eval colm
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()

BAM64814hits <- read.delim("vikas6Betapid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(BAM64814hits) ## [1] 824   9
View(BAM64814hits)
head(BAM64814hits, n=2)

library(dplyr)
BAM64814hitssorteval <- BAM64814hits %>% arrange(eval)
dim(BAM64814hitssorteval)  ## [1] 824   9
head(BAM64814hitssorteval, n=4)
tail(BAM64814hitssorteval, n=4)
# range eval = e-175 to e-07
write.table(BAM64814hitssorteval, file="BAM64814hitssorteval.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


# for 3rd vikas6 ctl: refer 14812, 
#grep "^API57808" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Brassica.blastp

#cat list_WheatIDs_pid40.txt | python3 testing.py arabctl.blastp > vikas6arabpid40_216_hits.blastp

cat list_WheatIDs_pid40.txt | python3 testing.py Brassica.blastp > discard3.blastp

# rename test_output.txt to vikas6Brassicapid40_216_hits.blastp (done)
wc -l vikas6Brassicapid40_216_hits.blastp
     906 vikas6Brassicapid40_216_hits.blastp

# R/dplyr to get sorted on eval colm
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()

API57808hits <- read.delim("vikas6Brassicapid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(API57808hits) ## [1] 906   9
View(API57808hits)
head(API57808hits, n=2)

library(dplyr)
API57808hitssorteval <- API57808hits %>% arrange(eval)
dim(API57808hitssorteval)  ## [1] 906   9
head(API57808hitssorteval, n=4)
tail(API57808hitssorteval, n=4)
# range eval = e-97 to e-07
write.table(API57808hitssorteval, file="API57808hitssorteval.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


# for 4th vikas6 ctl: refer 14814, 
#grep "^AAM52339" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Petun.blastp

#cat list_WheatIDs_pid40.txt | python3 testing.py arabctl.blastp > vikas6arabpid40_216_hits.blastp

cat list_WheatIDs_pid40.txt | python3 testing.py Petun.blastp > discard4.blastp

# rename test_output.txt to vikas6Petunpid40_216_hits.blastp (done)
wc -l vikas6Petunpid40_216_hits.blastp
     913 vikas6Petunpid40_216_hits.blastp

# R/dplyr to get sorted on eval colm
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()

AAM52339hits <- read.delim("vikas6Petunpid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(AAM52339hits) ## [1] 913   9
View(AAM52339hits)
head(AAM52339hits, n=2)

library(dplyr)
AAM52339hitssorteval <- AAM52339hits %>% arrange(eval)
dim(AAM52339hitssorteval)  ## [1] 913   9
head(AAM52339hitssorteval, n=4)
tail(AAM52339hitssorteval, n=4)
# range eval = e-96 to e-07
write.table(AAM52339hitssorteval, file="AAM52339hitssorteval.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


# for 5th vikas6 ctl: refer 14816, 
#grep "^AJG06104" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Raphanus.blastp

#cat list_WheatIDs_pid40.txt | python3 testing.py arabctl.blastp > vikas6arabpid40_216_hits.blastp

cat list_WheatIDs_pid40.txt | python3 testing.py Raphanus.blastp > discard5.blastp

# rename test_output.txt to vikas6Raphanuspid40_216_hits.blastp (done)
wc -l vikas6Raphanuspid40_216_hits.blastp
     963 vikas6Raphanuspid40_216_hits.blastp

rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()
AJG06104hits <- read.delim("vikas6Raphanuspid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(AJG06104hits) ## [1] 963   9
View(AJG06104hits)
head(AJG06104hits, n=2)

library(dplyr)
AJG06104hitssorteval <- AJG06104hits %>% arrange(eval)
dim(AJG06104hitssorteval)  ## [1] 963   9
head(AJG06104hitssorteval, n=4)
tail(AJG06104hitssorteval, n=4)
# range eval = e-111 to e-07
write.table(AJG06104hitssorteval, file="AJG06104hitssorteval.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


# for 6th vikas6 ctl: refer 14818, 
#grep "^Q76C99" rice1st_88ctls_prot1161_ev06_outfmt6cust.blastp > vikas6hits/Oryza.blastp

#cat list_WheatIDs_pid40.txt | python3 testing.py arabctl.blastp > vikas6arabpid40_216_hits.blastp

cat list_WheatIDs_pid40.txt | python3 testing.py Oryza.blastp > discard6.blastp

# rename test_output.txt to vikas6Oryzapid40_216_hits.blastp (done)
wc -l vikas6Oryzapid40_216_hits.blastp
    1058 vikas6Oryzapid40_216_hits.blastp

rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()
Q76C99hits <- read.delim("vikas6Oryzapid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(Q76C99hits) ## [1] 1058    9
View(Q76C99hits)
head(Q76C99hits, n=2)

library(dplyr)
Q76C99hitssorteval <- Q76C99hits %>% arrange(eval)
dim(Q76C99hitssorteval)  ## [1] 1058    9
head(Q76C99hitssorteval, n=4)
tail(Q76C99hitssorteval, n=4)
# range eval = 0 to e-07
write.table(Q76C99hitssorteval, file="Q76C99hitssorteval.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)
 
# talked to vikas
# try calc 'frac_align' for the vikas6 ctl hits (dplyr, mutate fcn)
# note on internet, https://www.biostars.org/p/164403/
"I would personally feel relatively confident with something like qlen/slen=1±0.25 && qlen/alen=1±0.25."
# ok, so qlen/slen would be colms 7 over 8 in file


# so calc 'cov' (coverage) for arabidopsis ctl (CAR70003) (1st vikas6 ctl)
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()
CAR70003hits <- read.delim("vikas6arabpid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(CAR70003hits) ## [1] 873   9
View(CAR70003hits)
head(CAR70003hits, n=2)

library(dplyr)
CAR70003hitssortevalcov <- CAR70003hits %>% arrange(eval) %>% mutate(qs = qlen/slen, ql = qlen/len)
dim(CAR70003hitssortevalcov)  ## [1] 873  11
head(CAR70003hitssortevalcov, n=4)
tail(CAR70003hitssortevalcov, n=4)
# range eval = e-96 to e-07
write.table(CAR70003hitssortevalcov, file="CAR70003hitssortevalcov.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


03/07/19:
# slip a save to ***github*** in here
# email vikas on above 'coverage', web site comment. (done)


# for 2nd vikas6 ctl: (BAM64814)
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()

BAM64814hits <- read.delim("vikas6Betapid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(BAM64814hits) ## [1] 824   9
View(BAM64814hits)
head(BAM64814hits, n=2)

library(dplyr)
BAM64814hitssortevalcov <- BAM64814hits %>% arrange(eval) %>% mutate(qs = qlen/slen, ql = qlen/len)
dim(BAM64814hitssortevalcov)  ## [1] 824  11
head(BAM64814hitssortevalcov, n=4)
tail(BAM64814hitssortevalcov, n=4)
# range eval = e-175 to e-07
write.table(BAM64814hitssortevalcov, file="BAM64814hitssortevalcov.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


# for 3rd vikas6 ctl: refer 14812, (API57808)
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()

API57808hits <- read.delim("vikas6Brassicapid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(API57808hits) ## [1] 906   9
View(API57808hits)
head(API57808hits, n=2)

library(dplyr)
API57808hitssortevalcov <- API57808hits %>% arrange(eval) %>% mutate(qs = qlen/slen, ql = qlen/len)
dim(API57808hitssortevalcov)  ## [1] 906  11
head(API57808hitssortevalcov, n=4)
tail(API57808hitssortevalcov, n=4)
# range eval = e-97 to e-07
write.table(API57808hitssortevalcov, file="API57808hitssortevalcov.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


# for 4th vikas6 ctl: refer 14814, (AAM52339)
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()

AAM52339hits <- read.delim("vikas6Petunpid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(AAM52339hits) ## [1] 913   9
View(AAM52339hits)
head(AAM52339hits, n=2)

library(dplyr)
AAM52339hitssortevalcov <- AAM52339hits %>% arrange(eval) %>% mutate(qs = qlen/slen, ql = qlen/len)
dim(AAM52339hitssortevalcov)  ## [1] 913  11
head(AAM52339hitssortevalcov, n=4)
tail(AAM52339hitssortevalcov, n=4)
# range eval = e-96 to e-07
write.table(AAM52339hitssortevalcov, file="AAM52339hitssortevalcov.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


# for 5th vikas6 ctl: refer 14816, (AJG06104)
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()
AJG06104hits <- read.delim("vikas6Raphanuspid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(AJG06104hits) ## [1] 963   9
View(AJG06104hits)
head(AJG06104hits, n=2)

library(dplyr)
AJG06104hitssortevalcov <- AJG06104hits %>% arrange(eval) %>% mutate(qs = qlen/slen, ql = qlen/len)
dim(AJG06104hitssortevalcov)  ## [1] 963  11
head(AJG06104hitssortevalcov, n=4)
tail(AJG06104hitssortevalcov, n=4)
# range eval = e-111 to e-07
write.table(AJG06104hitssortevalcov, file="AJG06104hitssortevalcov.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)


# for 6th vikas6 ctl: refer 14818, (Q76C99)
R
rm(list=ls())
setwd("~//mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits")
getwd()
Q76C99hits <- read.delim("vikas6Oryzapid40_216_hits.blastp", header=FALSE, stringsAsFactors=FALSE, col.names=c("seqs216", "qseqid", "sseqid", "eval", "pid", "len", "qlen", "slen", "bitsc"))
dim(Q76C99hits) ## [1] 1058    9
View(Q76C99hits)
head(Q76C99hits, n=2)

library(dplyr)
Q76C99hitssortevalcov <- Q76C99hits %>% arrange(eval) %>% mutate(qs = qlen/slen, ql = qlen/len)
dim(Q76C99hitssortevalcov)  ## [1] 1058   11
head(Q76C99hitssortevalcov, n=4)
tail(Q76C99hitssortevalcov, n=4)
# range eval = 0 to e-07
write.table(Q76C99hitssortevalcov, file="Q76C99hitssortevalcov.txt", quote=FALSE, sep="\t", row.names=FALSE, col.names=FALSE)

#####################################################################
# could do a box plot for 'cov' colm, to judge if coverage is adequate here, i.e., all 6 vikas6 ctls on same plot ?????
#####################################################################

03/08/19:
# talked to vikas
# create file with top hits for 6 ...cov... above. Check where the 4 flapjack 'identified' seqs appear in these files.

# the 6 files: /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas6hits

AAM52339hitssortevalcov.txt	BAM64814hitssortevalcov.txt
AJG06104hitssortevalcov.txt	CAR70003hitssortevalcov.txt
API57808hitssortevalcov.txt	Q76C99hitssortevalcov.txt

1. CAR70003hitssortevalcov.txt
2. BAM64814hitssortevalcov.txt
3. API57808hitssortevalcov.txt
4. AAM52339hitssortevalcov.txt
5. AJG06104hitssortevalcov.txt
6. Q76C99hitssortevalcov.txt

head -n 3 CAR70003hitssortevalcov.txt > vikas6tops.txt
head -n 5 BAM64814hitssortevalcov.txt >> vikas6tops.txt
head -n 3 API57808hitssortevalcov.txt >> vikas6tops.txt
head -n 1 AAM52339hitssortevalcov.txt >> vikas6tops.txt
head -n 2 AJG06104hitssortevalcov.txt >> vikas6tops.txt
head -n 3 Q76C99hitssortevalcov.txt >> vikas6tops.txt

#########################################################################
# vikas6tops.txt, 17 *arbitrary* rows from 6 vikas6 'cov' blastp output files.
#########################################################################

# location of best hit for each of the 4 seqs identified wi flapjack (see file ijtabvep4cols4snps.txt) in dir /Users/bterry/mbook2019/vikas19/tassel5/VEP

# the 4 seqs (last 3 digits of snp)   593       723          430         111 

1. CAR70003hitssortevalcov.txt(1strow) 83       214          302         238
2. BAM64814hitssortevalcov.txt         94        93          346         355
3. API57808hitssortevalcov.txt         65       217          327         209
4. AAM52339hitssortevalcov.txt         21       148           50         177
5. AJG06104hitssortevalcov.txt         75       266          425         308
6. Q76C99hitssortevalcov.txt           15(1row)  98          131         102

# only pattern, '593' snp on average, smallest evalue, or closest related to the 6 ctls.
# TO DO: go to 'tair', look for'CAR70003' ?????????????

# talked to vikas
# requests to box (.../Variant_Files/vikas6ctls)
--vikas6tops.txt
--the 6 'cov' files (see above)

############################################################################
TO DO: look for arabidopsis CAR70003... on 'tair' site, person talked to at pag2019 ???
#############################################################################

03/09/19:
# upload to box two requested phenograms (done)

03/11/19:
# to go to GSDS site, split current file into number subsets so readable size print. Place in v1.1_logfile_doc.Rmd file in /Users/bterry/mbook2018/vikas18/v1.1Rmd_doc dir.

03/12/19:
# test a 1st subfile of 203.gff3 (/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs/203.gff3). 1st 304 lines hits a 'cutoff' between two of the 203 seqs.
cd /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs
ls 203*
head -n 304 203.gff3 > 203_1st304lines.gff3
# submit 203.gff3 to GSDS site. http://gsds.cbi.pku.edu.cn
# output file: IPVUDS.png (35 rows)
################################################################
# Q: line 39, WHAT TO DO WITH THIS LINE ???????????
# in 203_1st304lines.gff3 file, lines 205-262 refer to this gene. Don't see anything in these lines indicating the issue with output line 39 in IPVUDS.png file ???????????
# check vikas, if this .png file big enough format, will go ahead with following 3 subsets ??????
# need settle 'output line 39 in .png file 1st' ???????????????????????????
################################################################
# test subset the 2nd subset, as 'issue' there to resolve also ?????????????


03/13/19:
head -n 608 203.gff3 | tail -n 304 > 203_2nd304lines.gff3  ## 608, another ok break.
wc -l 203_2nd304lines.gff3
     304 203_2nd304lines.gff3
072300 (gene) -> 067980 (cds)
# 9:20am, http://gsds.cbi.pku.edu.cn not responding  ???????????????????????
# 9:1pm, site back up
# input format: gff3
# browse for 203_2nd304lines.gff3
# image format: PNG
# submit
# rt clk, 'save image as' => G3N6CF.png  (52 rows)
# Note: 35 + 52 rows = 87, uneven in output, so, TO DO, redo, arrange so 41 seqs in each of 5 output gsds images (except last is 39). So the cutoffs in 203.gff3 to achieve this are: (LHS integers are row in table10cols.txt file.

42 TraesCS1B02G039700.1  gff3 line 1 thru 270
83 TraesCS1D02G056600.1   gff3 line 271 thru 529
124 TraesCS2B02G126900.1  gff3 line 530 thru 784
165 TraesCS6B02G021600.1  gff3 line 785 thru 996
204 TraesCSU02G090205.1  gff3 line 997 thru 1212

# now, create 5 files from 203.gff3 according to the lines above, run each file on GSDS site. Should have the five gsds files, but check the above Q's for think 3 rows ????????

03/14/19:
head -n 270 203.gff3 > 203_1stof5subsets.gff3
wc -l 203_1stof5subsets.gff3
     270 203_1stof5subsets.gff3
# submit to http://gsds.cbi.pku.edu.cn => LYCF24.png
head -n 529 203.gff3 | tail -n 259 > 203_2ndof5subsets.gff3
wc -l 203_2ndof5subsets.gff3
     259 203_2ndof5subsets.gff3
# submit to http://gsds.cbi.pku.edu.cn => P3YUJP.png
#######################################################################
# Note, for ...072900 gene, gff3 has **diff.** rows for for '.1', '.2' prot. seqs 
#######################################################################
#######################################################################
# Q: WHAT IS OUTPUT(PHYLOGENETIC TREE/ORDER) ?????????????????????
#######################################################################

03/15/19:
# TO CHECK: FOR '39' ROW, CHECK IN GFF3 FILE FOR ...039620 gene, if 'LC' ref in one of the rows ???????????????????
# 117 occurrences of TraesCS1B02G039620 in 203.gff3.
# rows 205-262
############################################################################
# note lines 205, 206 of 203.gff3, TraesCS1B01G038600LC found in each ???????
############################################################################

chr1B	IWGSC_v1.1_201706	gene	19053658	19068672	26	-	.	ID=TraesCS1B02G039620;Name=TraesCS1B02G039620,TraesCS1B01G038600LC;derived_from=PPRFinder_96;manually_curated=yes;curation_team=IWGSC_steinn;primconf=HC
chr1B	IWGSC_v1.1_201706	mRNA	19053658	19068672	26	-	.	ID=TraesCS1B02G039620.1;Parent=TraesCS1B02G039620;Name=TraesCS1B02G039620;Note=TraesCS1B01G038600LC;primconf=HC;secconf=HC5

# talked to vikas
# check what version of iwgsc used to prepare 203.gff3 ??????????
# line 13680
# create Philip_203gff3.sh
#bash Philip_203gff3.sh pid40_216pruned13to203_nodotnum.txt > 203.gff3
###################################################################
# so check Philip_203gff3.sh file, should have name iwgsc file used to prepare 203.gff3 ?
# it is: IWGSC_v1.1_HC_20170706.gff3
###################################################################
# check gene before/ after TraesCS1B02G039620 in 203.gff3 file, the seq producing TraesCS1B01G038600LC on gsds image.

# TraesCS1B02G039200 (lines 201-204)
# TraesCS1B02G039625 (lines 263-66)
############################################################################
# comment: 'gene' line never has '.d' ending in its line, rest of line types do. Also diff. for problem gene TraesCS1B02G039620, the TraesCS1B01G038600LC has the **wrong** gene name number, 038600, but gene name number is 039620 ('gene' & 'mRNA' lines. Rest of 56 lines for this gene the correct 039620 number. If kept this gene, still the 'unusual' number of introns if just removed incorrect 038600 number in gene, mRNA lines. But if tried this, perhaps should have producer of gff3 file do, since I don't know how to create gff3 files ??????
# perhaps send Kellye email, explain issue with this gff3 file entry, ask what to think. For gsds image, would think not keep line 39? Q: might one still keep this RF-like prot. seq, based on rest of data ????????? But if length is an outlier, as are the number of introns ??????????
############################################################################
email vikas wi these two findings (see betw # rows above).

03/16/19:

03/18/19:
# to finish remaining three GSDS images for the 203 RF-like seqs, place all five in ???? dir, incorporate in .Rmd file
# see 03/13/19 to finish 3rd thru 5th gsds image for 203.gff3
# /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs
head -n 784 203.gff3 | tail -n 255 > 203_3rdof5subsets.gff3
wc -l 203_3rdof5subsets.gff3
     255 203_3rdof5subsets.gff3
# submit to http://gsds.cbi.pku.edu.cn => Y4YZV8.png
# 'save image as' => Y4YZV8.png

head -n 996 203.gff3 | tail -n 212 > 203_4thof5subsets.gff3
wc -l 203_4thof5subsets.gff3
     212 203_4thof5subsets.gff3
# submit to http://gsds.cbi.pku.edu.cn => YSIFYF.png
# 'save image as' => YSIFYF.png

head -n 1212 203.gff3 | tail -n 216 > 203_5thof5subsets.gff3
wc -l 203_5thof5subsets.gff3
     216 203_5thof5subsets.gff3
# submit to http://gsds.cbi.pku.edu.cn => 6MBKBL.png
# 'save image as' => 6MBKBL.png

# now, copy 2 of these 5 .png files initially over to /Users/bterry/mbook2018/vikas18/v1.1Rmd_doc
dir., arrange so they display thru v1.1_logfile_doc.Rmd file.
 
203_1stof5subsets.gff3  LYCF24.png  copied
203_2ndof5subsets.gff3  P3YUJP.png  copied
203_3rdof5subsets.gff3  Y4YZV8.png
203_4thof5subsets.gff3  YSIFYF.png
203_5thof5subsets.gff3  6MBKBL.png

03/19/19:

##############################################################################
# next, reknit, display html file, see if these two images ok. Done, but not done, but **NOT** showing the legends for the two gsds example plots??? Check vikas if big enough ??????
##############################################################################

03/20/19:

03/24/19:
# slipped a save to ***github*** in here

STOPPED

# now, extend v1.1_logfile_doc.Rmd file from line 14010 (tho, used subset of higher numbered lines to obtain GSDS images).


03/25/19:
# talked to vikas
# upload a version of 'manuscript' to box with add'l lines from last 1500 lines of log file. Place date in file name title.
SO, from /Users/bterry/mbook2018/vikas18/v1.1Rmd_doc dir
copy v1.1_manuscript_template.Rmd v1.1_manuscript_template032519.Rmd
Then, append below section 6, stuff from ~ 14000 to 15500 lines from log file, currently in v1.1_logfile_doc.Rmd
# done to let vikas use to prepare subset of information.
# upload to box, in RF_GeneFamily/manuscript dir.
# note: Appended the lines from last ~1500 lines of res. log file to bottom of Rmd/html file, section 7 in that file.


03/27/19:
# build relevant pub list for RF-like sequences. So new list as 19 items. So, place in v1.1_manuscript_template.Rmd, 'Some references' section.

03/29/19:
# to do:
append sec 7 to v1.1_manuscript_template032519.Rmd (done)
update sec 6, references section, 7 to 19 references (done), 

02/30/19:

insert comments for subsets of the references by some category definitions, & list in this order. (done)

03/31/19:

Copy to v1.1_manuscript_template033119.Rmd
cp v1.1_manuscript_template.html v1.1_manuscript_template033119.html
# upload to box, remove any previously 'dated' '.html' file (done)
# email vikas

 
# table or phenogram for RF1,  RF3, RF4, RF8 in S54B in sci genome paper. Q: where did these come from ????????????????

# figure S54B,
**Approximate** location on IWGSC RefSeq v1.0
RF1, chr1A (within cluster)
RF3, chr1B (within cluster)
RF4, chr6B (within cluster)
RF8, chr2D (not within cluster)
###############################################################
# Q: need see references where these RF genes found ?????????????????????????//
###############################################################

# section: pot'l genome seq errors (for example, seqs in ch1 area from ch2 or ch6 in phylogram)
# go to phylogram ????????????? on mbook
# dnload from 'pro'& 'box', 
/Users/bterry/mbook2019/vikas19/potlwheatgeneerrors
/pid40_216pruned13to203_phyml_tree_chrcolor_forRmd.txt

# make pid40_216pruned13to203_phyml_tree_chrcolor_forRmd_scrshot.png
# manually find genes/proteins in '203' from chr 2 & 6 associated with chrom 1.
# so 3 areas in chr1 area of phylogram which has chr 2 or 6 seqs
# area1: 2 chr2, two 'single' seqs
TraesCS2B02G126900.1
TraesCS2B02G126905.1

# area2: 5 chr2 seqs
TraesCS2A02G478045.1
TraesCS2A02G478046.1
TraesCS2B02G501396.1
TraesCS2D02G477278.1
TraesCS2D02G477283.1

# area3: 3 chr6 seqs
TraesCS2D02G477283.1
TraesCS6B02G341800.1
TraesCS6D02G290900.1

#############################################################################
# patterns: in group of 5 & grp of 3, spread across subchromosomes ????????????
#############################################################################


04/02/19:
# while trying to learn bit more about Rf genes in fig. S54B (IWGSC, Science 361, 661 (2018)), reading ref 167, Geyer et al, 2018, WHAT TO THINK ????????????? QTL, etc., NOT REAL DEFINITIVE RESULTS ?????????????
# Appears 'penetrance' not being under control. Authors cannot definitively say what loci are controlling restoration of function). So given theses Geyer results, how best to proceed? Can any of the marker loci in Geyer paper help locate them in bread wheat genome?
If we just use snp locations wih 203 RF genes, if non RF genes impt, we will miss them?

04/04/19:
# talked to vikas
# find location in phylogram for 5 'Un' seqs in the 203 seqs

use following file in figtree:
/Users/bterry/mbook2019/vikas19/potlwheatgeneerrors
/pid40_216pruned13to203_phyml_tree_chrcolor_forRmd.txt

cp Screen_Shot_2019-04-04_9.09.16_PM.png pid40_216pruned13to203_phyml_tree_chrcolor_forRmd_scrshot_Un_purple.png

# so the 5 'Un' seqs of the 203 all in one of the two blue chr 6 groups on the phylogram. Split into two groups, group of 2 & group of 3

1st grp of 2
TraesCSU02G089563.1	Un
TraesCSU02G089705.1	Un

2nd grp of 2
TraesCSU02G089700.1	Un
TraesCSU02G090200.1	Un

Adjacent to 2nd grp of 2
TraesCSU02G090205.1	Un

# copy 2 of possible 5 GSDS images to 'manuscript' Rmd file from 'log' Rmd file
# now, GSDS/introns section of /Users/bterry/mbook2018/vikas18/v1.1Rmd_doc
/v1.1_manuscript_template.Rmd has 1st 2 of 5 GSDS images for the 203 Rf genes.

cp v1.1_manuscript_template.html v1.1_manuscript_template040419.html
# now, copy v1.1_manuscript_template040419.html up to box, 'manuscript dir. (done)

# send vikas email
--new 'manuscript.html' file with 1st two of 5 GSDS images uploaded to manuscript dir in box.
--located the five 'Un' seqs of the 203 in 203 seq phylogram.
All located in one of the two chr 6 groups. One group of 2, then a 2nd group of 2 near the 5th Un seq.

04/05/19:
# some vikas Q's:
line 8999
# number of each ctl group in clustal submit comment.
PPRv1.1.1913_br9rice9soy38arab26plusvikas6.fa_88ctls (clustal submit comment)
# Q: how these ctl seqs selected ????????????????

# nexus file name: PPRv1.1.1913plus88ctls.txt
# latter may be name of file work with on figtree ????????
# Q: name after 'red' seqs selected in figtree ????????????

cd /Users/bterry/macbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls
# taxlabels, lines 5 thru 2005 in PPRv1.1.1913plus88ctls1stcolor.txt

PPRv1.1.1913plus88ctls_orig.txt ## (try in figtree, see if looks like PPRv1.1.1913plus88ctls1stcolor.txt but with no coloring ?????????????

line 5790
grep -c "^>" arab26fujii2011namesshort.fa   # 26 as expect
# Q: perhaps got some of the ctls seqs from 'fujii' reference ???????

line 5756
## talked to vikas, comments

line 5737
## file used to manually select RFlike names originally from Fujii, 2011, table S1, 
# so check S1 from Fujii ???????

line 5676
i. resume search for soybean seqs as follows:
https://soybase.org/dlpages/, try submit list of 41 soybean genes from Fujii, 2011,table S1.

line 5645
ii) perhaps check fujii, 2011 list, table S1, with sykes sup. table 1, see how compares, if any proteins want to use from Sykes?  

###############################################################
# slip a save to ***github*** in here
################################################################

# talked to vikas
# would like figtree viewable file, /Users/bterry/mbook2019/vikas19/potlwheatgeneerrors
/pid40_216pruned13to203_phyml_tree_chrcolor_forRmd.txt
# to upload to box.
# table10cols.txt, which GC calc file did I use for table10cols.txt, cds or tx's ?????
line 14135
scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/hmmsrch_protv1.1/blastp/GC_est/pid40_216pruned13to203_cds_GCest.txt .
# check in bbedit, looks fine, **NEARLY THE SAME** values as in pid40_216pruned13to203_tx_GCest.txt
line 14156
gc_tx <- read.delim("pid40_216pruned13to203_tx_GCest.txt", header=FALSE, stringsAsFactors=FALSE, col.names=c("name", "GC_tx"))
# built table10cols.txt with GC_tx calc
#######################################################################
# will look back, doc in rmd/html file, the input files for 'tx' & 'cds" GC calcs
#######################################################################

04/06/19:
#######################################################################
ok, "rough" documentation of the sources for prepn of the 4 ctl species + vikas6 ctls (total 88 seqs)

bracky9namesshort.fa
FRknownseqs_shtname_9.fa
soybean41to_ver2names38dot1dotpshort.fa
arab26fujii2011namesshort.fa
FunctionallyCharacterizedRfs_fasta.txt

soybean: soybean41to_ver2names38dot1dotpshort.fa

cd /Users/bterry/mbook2018/vikas18
find . -name 'soybean41to_ver2names38.txt' -print
line 5737
find . -name 'Glyma_Correspondence_Report_20180207232909.csv' -print
./131RFlike/soybeanstuff/Glyma_Correspondence_Report_20180207232909.csv

colm 1 this file has entries from table S1, so translating betw names for genes in different versions of soybean names ?????

line 5737
https://www.soybase.org/correspondence/index.php
Q: what was list I submitted ?????????
probably the 41 from Fijii, table S1

line 5740
so new file with manually selected ver2 name for Fujii, 2011 soybean names will be soybean41to_ver2names38.txt. 41 seqs reduced to 38 with this mapping.

line 5744
now, submit this file to https://soybase.org/dlpages/#dnarna, 'Download longest transcript or predicted protein sequence for gene calls' section using soybean41to_ver2names38.txt file.
output file was soybean41to_ver2names38.txt.prot.fa (had 54 '>' ?????
Q: tried today, gave 38 '>' ?????????
line 5749
soybean41to_ver2names38.txt => soybean41to_ver2names38dot1dotp.txt (done)
think some bbedit/reg expns here

line 5880
soybean41to_ver2names38dot1dotp.fa =bbedit=> soybean41to_ver2names38dot1dotpshort.fa

bracky: bracky9namesshort.fa

bracky9names.fa
cd /Users/bterry/mbook2018/vikas18/131RFlike
find . -name 'bracky9names.fa' -print
./bracky9names.fa
line 5614
From ftp://ftp.ensemblgenomes.org/pub/plants/release-38/fasta/brachypodium_distachyon/pep/ got Brachypodium_distachyon.v1.0.pep.all.fa (31029 '>' lines). 

line 5652
./getseq.awk Brachypodium_distachyon.v1.0.pep.all.fa bracky9namesCAPS.txt > bracky9names.fa

line 5793
bracky9names.fa  =bbedit=> bracky9namesshort.fa

arabidopsis: arab26fujii2011namesshort.fa

line 5787
arab26fujii2011names.fa =bbedit=> arab26fujii2011namesshort.fa

line 5731
./getseq.awk Arabidopsis_thaliana.TAIR10.pep.all.fa arab26fujii2011namesCAPS.txt > arab26fujii2011names.fa

rice: FRknownseqs_shtname_9.fa

line 601
create FRknownseqs_shtname_9.fa from FRknownseqs_shtname.fa (remove '408' & '444')

vikas6 ctl seqs

FunctionallyCharacterizedRfs_fasta.txt
###########################################################################

04/08/19:
cp v1.1_manuscript_template.html v1.1_manuscript_template040819.html

04/10/19:
###########################################################################
# doc. input seqs (tx vs cds) for GC percent calculations.
line 13990
perl GC_estimate_VB.pl pid40_216pruned13to203_tx.fa > pid40_216pruned13to203_tx_GCest.txt
line 14093-4
# two possible inputs from IWGSC_v1.1 for tx, cds
IWGSC_v1.1_HC_20170706_transcripts.fasta
IWGSC_v1.1_HC_20170706_cds.fasta
line 14127
perl GC_estimate_VB.pl pid40_216pruned13to203_cds.fa > pid40_216pruned13to203_cds_GCest.txt
# Note: more info in header of tx file than cds ??????????
line 14140
# Note: comparing pid40_216pruned13to203_cds.fa & pid40_216pruned13to203_tx.fa, 1st seq for each the same length, just additional doc. in '>' like for 'tx' file. Note, 2nd seq in each file differences, for example, 'CDS' does **not** start at 1 ?????????????????
# Q: any reason to choose one of these, tx or cds for GC estimate calcn ????????
###########################################################################

cp v1.1_manuscript_template.html v1.1_manuscript_template041019.html
# upload v1.1_manuscript_template041019.html to box 'manuscript' dir. (done)

04/11/19:
# doc rice9 ctls


## create FRknownseqs_shtname_9.fa from FRknownseqs_shtname.fa (remove '408' & '444')

line 569
## To do, same test for FRknownseqs_copy.fa
line 436
NCBIrefcolm.txt file,
line 425
cut -d ' ' -f 2 srep35152-s1_tableS1_copy.txt | head -n 42 > NCBIrefcolm.txt
line 414
To do: from srep35152-s1.pdf, table S1, take the 42 rows (see p-2, srep35152.pdf), the values in colm 3, 'NCBI reference', get the protein sequences from batch entrez search.
## 1st get colm 3 out of table S1. For now, use BBedit, but later like to put in unix command line with pipes ???????????????
line 406
--get 'cloned' RFSs (see sykes, p-2, sci reports, 1st full paragraph ?????????????
06/25/17:
In Sykes paper, p-354, section 'Phylogenetic Analysis of the RFL Cluster', refers to supplementary table S1, 143 rows, *multiple* species.

In sci. reports paper, page 2, 1st full paragraph, refers to CMS/Rf systems in supp. table S1 (*all* rice species).

cd
cd mbook2017
find . -name 'srep35152-s1.pdf' -print
./vikas17/wheatproj/srep35152-s1.pdf

04/12/19:
#talked to vikas
i. check out 'BMC Plant Biology' journal, & 'The Plant Journal'
ii. KASP marker design (use 'Polymarker')
iii. finish documenting '88 ctls'

#################################################################################
# resume documenting rice9 ctls
# to check, the steps I followed starting with srep35152.pdf ref paper ??????
line 426
find . -name 'NCBIrefcolm.txt' -print
./vikas17/wheatproj/NCBIrefcolm.txt

04/13/19:
line 436
manually examine table S1. Sort of curate which select for 'restorer for CMS' genes to use in phylogeny with wheatproj PPR proteins.

line 526 - 537
# 11 ncbi refs of the table S1 oroteins, chosen *from* ncbi doc.

line 548
cd /Users/bterry/macbook2017/vikas17/wheatproj/hmmpipeline/FRprotseqs
ls -lh
cat *seq.txt > FRknownseqs.fa  ## 11 seqs
line 571
## looks like success, so rename FRknownseqs_shtname.fa
line 602
## create FRknownseqs_shtname_9.fa from FRknownseqs_shtname.fa (remove '408' & '444')
## subtracting two seqs < 10 domains long (see line 526)
# TO DO: doc rice9 to 'manuscript' Rmd

# CHECK VIKAS AS TO DOC. FOR EACH OF THE 'RICE9' ??????????????
# Q: are the NCBI reference numbers ok the reference, or looking into the NCBI doc. for each, perhaps some modification or name should be used ??????????

grep "^>" FRknownseqs_shtname_9.fa  ## 9 rows as expect
>AB110443
>AB112811
>AB179840
>AB900791
>AB900792
>AB900793
>AB900794
>KJ680249
>KJ680248
#################################################################################

04/14/19:
#############################################################################
# resume documenting vikas6 (ref vikas email of 04/10/19)
# reference, line 14679, contents of FunctionallyCharacterizedRfs_fasta.txt

Arabidopsis thaliana: https://www.ncbi.nlm.nih.gov/protein/CAR70003.1
DEFINITION  pentatricopeptide repeat(PPR)-containing protein At1g12700

bvCRP-1 [Beta vulgaris]: https://www.ncbi.nlm.nih.gov/protein/BAM64814.1
TITLE     Unusual and typical features of a novel restorer-of-fertility gene
            of sugar beet (Beta vulgaris L.)

Brassicarapa_RFP1: https://www.ncbi.nlm.nih.gov/protein/API57808.1
fertility restorer gene, BrRfp1

Petunia x hybrida: https://www.ncbi.nlm.nih.gov/nuccore/AY102719
TITLE     A pentatricopeptide repeat-containing gene restores fertility to
            cytoplasmic male-sterile plants

# Q: does this match >AAM52339.1_fertilityrestorer_Petuniaxhybrida ==> yes

https://www.ncbi.nlm.nih.gov/pmc/articles/PMC125068/
# Q: a paper, where get seq ????????
# Q: species, abstract saying 'Petunia' ???????????????????

RF1_ORYSI: https://www.ncbi.nlm.nih.gov/protein/Q76C99.1
DEFINITION  RecName: Full=Protein Rf1, mitochondrial; AltName: Full=Fertility
            restorer; AltName: Full=Protein PPR; AltName: Full=Restorer for
            CMS; Flags: Precursor.
ORGANISM  Oryza sativa Indica Group

# TO DO: check thru wi vikas, see if looks ok for vikas6 ???????????????
# TO Doc. in Rmd files. (done)
#############################################################################

# Then additional tasks discussed on Fri.

i. BMC Plant Biology, The Plant Journal

ii. Kasp marker

PolyMarker, http://www.polymarker.info/, description on this page unclear ??????????

# Q: 11506, where from  ???????????????????????????
# perhaps ensembl 'dnload dna seqs'	 ?????????????????
            
04/15/19:
cd /Users/bterry/mbook2019/vikas19/ensembl
less Triticum_aestivum.IWGSC.dna.chromosome.1A.fa
>1A dna:chromosome chromosome:IWGSC:1A:1:594102056:1 REF
CTAAACCCTAAACCCTAAACCCTAAACCCTAAACCCCTAACCCTAAACCCTAACCAAAAC
CCTAAACCCTAAACCCCTAAACCCTAAACCCTAACCTAAACCTACCTAAACCATACATTG
TTCCATTGGCCAGAGGCTGTTCACCTTGGAGACCTGATGCGGTTATGAGTACGACCGGGC

wc -l Triticum_aestivum.IWGSC.dna.chromosome.1A.fa
 9901702 Triticum_aestivum.IWGSC.dna.chromosome.1A.fa
wc Triticum_aestivum.IWGSC.dna.chromosome.1A.fa
 9901702 9901705 604003814 Triticum_aestivum.IWGSC.dna.chromosome.1A.fa

grep -c "^>" Triticum_aestivum.IWGSC.dna.chromosome.1A.fa  ## 1 row as expect
# Q: is there s/w for locating a snp location and surrounding bases?
# perhaps could use 'head/tail' reduce size of file, then locate in more manual fashion ???
# lines are 60 characters long

head -n 11 Triticum_aestivum.IWGSC.dna.chromosome.1A.fa | tail -n 11
head -n 11 Triticum_aestivum.IWGSC.dna.chromosome.1A.fa | tail -n 10

# file has 9901702 lines, perhaps take 1/4th of them work with, 2475425 ????????

# talked to vikas
# 'about' PolyMarker, don't follow 'Output: mask' ??????????????????????????
# Use http://plants.ensembl.org/Triticum_aestivum/Info/Index site to create input to PolyMarker for design of 4 primers.ac

# place all in one file. Call it 4polymarkerinput.txt

04/16/19:

# slip a save to ***github*** in here

# steps
# in http://plants.ensembl.org/Triticum_aestivum/Info/Index, 'search' box, for S1B_18683593 snp, place 1B:18683593-18683593
# Export data, set confign, 100 for 5' & 3', next, [but if prev step gives 201 already, set flanking sides to zero, appear get same result => 201 bases
# output format, 'text' (check, vikas may favor 'compressed')
# next see screen:
# 1st snp, 1B:18633593
>1B dna:chromosome chromosome:IWGSC:1B:18683493:18683693:1
CCACGGAGCGAGCTCGATCTGGCAACCTCACCTCGGAGGACGCACACAAGCTGTTCGACC
AATTGCTCCTGCAGGCTAATCCGGTCAACATGCGCCTTCCCAACGACCTTCTCACCGCCC
TGGCTCGCGCGCCTGCGTCCGCAGCCTGCAGCAACGGCCCCGCCCTTGCCCTCGCCCTCT
TCAGCCGTTTGTCCCAAGGTG

# now, arrange as in 'example' PolyMarker input file:

SNP1,1B,
CCACGGAGCGAGCTCGATCTGGCAACCTCACCTCGGAGGACGCACACAAGCTGTTCGACC
AATTGCTCCTGCAGGCTAATCCGGTCAACATGCGCCTTCCCAACGACCTTCTCACCGCCC
TGGCTCGCGCGCCTGCGTCCGCAGCCTGCAGCAACGGCCCCGCCCTTGCCCTCGCCCTCT
TCAGCCGTTTGTCCCAAGGTG

SNP1,1B,
CCACGGAGCGAGCTCGATCTGGCAACCTCACCTCGGAGGACGCACACAAGCTGTTCGACCAATTGCTCCTGCAGGCTAATCCGGTCAACATGCGCCTTCC[G\C]AACGACCTTCTCACCGCCCTGGCTCGCGCGCCTGCGTCCGCAGCCTGCAGCAACGGCCCCGCCCTTGCCCTCGCCCTCTTCAGCCGTTTGTCCCAAGGTG

# 2nd snp, 2A:748437723
>2A dna:chromosome chromosome:IWGSC:2A:748437623:748437823:1
CTGCCACCACAGAGCGCGTGTGTGCCGGAACGCTAAGACCGGAGGAGGCGCACCACCTGT
TCGACGAATTGCTGAGCCAAGCCGCCGCCGTCCCGGAACGCGGGCTGAACAACTTTCTTG
CCGCACTAGCCCGTGCTCCACCCTCAGCTGCCTGCAGCGATGGCCCCGGCCTTGCCATCA
CCCTCTTCAACCGCATGTCCC

SNP2,2A,CTGCCACCACAGAGCGCGTGTGTGCCGGAACGCTAAGACCGGAGGAGGCGCACCACCTGTTCGACGAATTGCTGAGCCAAGCCGCCGCCGTCCCGGAACG[G/C]GGGCTGAACAACTTTCTTGCCGCACTAGCCCGTGCTCCACCCTCAGCTGCCTGCAGCGATGGCCCCGGCCTTGCCATCACCCTCTTCAACCGCATGTCCC

# 3rd snp, 2B:753796430
>2B dna:chromosome chromosome:IWGSC:2B:753796330:753796530:1
AAAAAATGTGGTGAGGGTGTTGCTGGACAAAGGTGAAGTAATCAGGGCCGGAGGTTATCT
TTCTAAAATTGATGAGAAGAATTTAGTACTTGAAGCTTCAACCGTTTAGCTGCAGTTGAT
GATCTTCCAGAACCAACTCCAAGCAATAATCTTCCAGAAGAATCCTAAGTATACTGGTTT
GGAGCGCACTGTGAACGTTTT


SNP3,2B,SNP3,2B,AAAAAATGTGGTGAGGGTGTTGCTGGACAAAGGTGAAGTAATCAGGGCCGGAGGTTATCTTTCTAAAATTGATGAGAAGAATTTAGTACTTGAAGCTTCA[T/A]CCGTTTAGCTGCAGTTGATGATCTTCCAGAACCAACTCCAAGCAATAATCTTCCAGAAGAATCCTAAGTATACTGGTTTGGAGCGCACTGTGAACGTTTT

# 4th snp, 6A:66814111
>6A dna:chromosome chromosome:IWGSC:6A:66814011:66814211:1
TTTCGTCGAATAGTTGGTGCGCGAGCTCCGGCCAGAGCGTCCCAGAGCCCAGATGATATT
TGAATTCATCCAGCAGCTCGCTGACTCGTGAGGAGACGGGACTGGAGAAAGAGCGGGGCT
GGAGGCGCGACATTGCCGCCGTCTAGTTCCTGCAGCGGCAGTGAATGCGGGCGGCAAAGA
CCAACTCCTTACTCTGGTGGG

SNP4,6A,TTTCGTCGAATAGTTGGTGCGCGAGCTCCGGCCAGAGCGTCCCAGAGCCCAGATGATATTTGAATTCATCCAGCAGCTCGCTGACTCGTGAGGAGACGGG[A/G]CTGGAGAAAGAGCGGGGCTGGAGGCGCGACATTGCCGCCGTCTAGTTCCTGCAGCGGCAGTGAATGCGGGCGGCAAAGACCAACTCCTTACTCTGGTGGG

# yet to do, submit to polymarker. Q: note, never got return email from yesterday submission ????????????????????????
# Q: new req. primers for /Users/bterry/mbook2019/vikas19/ensembl
/4snpsinppolymarker.txt file, single space ???????????
# vikas, yes
# now, at http://www.polymarker.info/
# browse WON'T work, file names grayed out, can't select ??????????????????????????????
# try Manual Input.
# 'create primers' selected after entered email address (10:41pm)
# http://www.polymarker.info/snp_files/5cb6a003d31c6f7a52edec1b
# this 'output' screen seems to be updating every few seconds ???????????????????

# Q: example polymarker output, how understand ???????????????
 
# ok, talking to vikas earlier today, would like to run all chroms phenogram with GC% (as 4 factors, <=25%, <=50%, <= 75%, <= 100%, exactly how best calc. ??????????????
# & tissue (3 factors)
# refer to table10cols.txt.
# see if visually, can see a pattern of location of RFL & these two parameters on all chrom. phenogram. Thinking he would like to display both of these parameters on 'one' phenogram. Q: may only be able to display one at a time on phenogram ???????

04/17/19:

line 13793
phen_all_203rows.txt

line 13806
chrom size values

line 13834
colm gene names

04/18/19:
# try prepare a phenogram wi phenotype being 'Subcel' colm from file table10cols.txt. Template is 'phenogram-sample.txt example file.

snp	chr	pos	phenotype
rs133	1	1049155	Albumin
rs133	1	1049155	Pregnancy

# For my input, colms will be
prot chr pos phenotype 
# where phenptype colm is the 'Subcel' colm from table10cols.txt. Don't forget to remove last 5 'Un' rows.
# ref: line 15253
R
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()

table10cols <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
dim(table10cols)
head(table10cols, n=2)

library(dplyr)
phenSubcel <- table10cols %>% select(RFL_prot_ID, Chr, Start, Subcel)

dim(phenSubcel)  ## [1] 203   4
head(phenSubcel, n=4)
tail(phenSubcel, n=4)
colnames(phenSubcel)[4] <- "phenotype"
colnames(phenSubcel)[3] <- "pos"
colnames(phenSubcel)[2] <- "chr"
colnames(phenSubcel)[1] <- "rfl"

write.table(phenSubcel, file="phenSubcel.txt", quote=FALSE, sep="\t", row.names=FALSE)

head -n 203 phenSubcel.txt| wc
# this input to phenogram, after remove last 5 rows, 'Un'
head -n 199 phenSubcel.txt > phenSubcel_198.txt

line 13820
steps to run phenogram

# now resume run *all* chroms phenogram again
# genome file: chr_size_Refv1.1_colm2and4minus_Un.txt

# phenotype spacing: default: 'proximity' alg ?????????????????
# phenotype color: default: 'exhaustive search colors' ??????????????????
# image format: default: png
# chromosome only: left unchecked, ???????????????????
# zoom options: none selected this run
# additional options: none selected this run, but possibly some might be useful for this **all** chroms run ?????????????????????
# click 'plot'
# 'Download higher resolution image': pheno_gram.13092.png
/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs
# name: phen_Subcel_198
# ok, pheno_gram.13092.png, lot of red dots, undetermined tissue, hurting finding of a pattern ???????????????

phen_Subcel_198_1A_10to100mil
pheno_gram.89739.png

phen_Subcel_198_1B_10to100mil
pheno_gram.17957.png

# vikas comment: REDO phen_Subcel_198_1A_10to100mil, use names for the 4 values in Subcel colm from targetp web site.


# NEXT, prepare GC percent, use mutate, 4 values, 0-<=25, >25-<=50, >50-<=75, >75 percent.


# For my input, colms will be
prot chr pos phenotype 
# where phenptype colm is the 'GC_tx' colm (colm9) from table10cols.txt. Calc a new colm, converting GC percentages to 4 ranges termed '0-25', '26-50', '51-75', & '76-100'. Don't forget to remove last 5 'Un' rows.
# ref: line 15253
R
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()

table10cols <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
dim(table10cols)
head(table10cols, n=2)

library(dplyr)
phenGC <- table10cols %>% select(RFL_prot_ID, Chr, Start, GC_tx)
dim(phenGC)  ## [1] 203   4
head(phenGC, n=4)
tail(phenGC, n= 4)

# in here need mutate

phenGC5col <- mutate(phenGC, GCfact = ifelse(GC_tx <= 25, "0-25",
                                             ifelse(GC_tx > 25 & GC_tx <= 50, "26-50", 
                                                    ifelse(GC_tx > 50  & GC_tx <= 75, "51-75", "76-100"))))
dim(phenGC5col)  ## [1] 203   4
head(phenGC5col, n=15)
tail(phenGC5col, n=2)

max(phenGC5col$GC_tx)  ## [1] 62.99694
min(phenGC5col$GC_tx)  ## [1] 37.27034

# Q: perhaps need change size of groups since perhaps need separate into smaller groups, for example, no values above 75% ??????????

# now need a select, reduce 5 back to 4 colms

phenGC4col <- phenGC5col %>% select(RFL_prot_ID, Chr, Start, GCfact)
dim(phenGC4col)  ## [1] 203   4
head(phenGC4col, n=4)
tail(phenGC4col, n=4)

colnames(phenGC4col)[4] <- "phenotype"
colnames(phenGC4col)[3] <- "pos"
colnames(phenGC4col)[2] <- "chr"
colnames(phenGC4col)[1] <- "rfl"

write.table(phenGC4col, file="phenGC4col.txt", quote=FALSE, sep="\t", row.names=FALSE)

# now before phenogram, 1st remove 'Un', last 5 rows
head -n 199 phenGC4col.txt > phenGC4col_198.txt

phenGC198_all_chroms
pheno_gram.12824.png
# notes: no particular pattern of GC precents on this phenogram ????? But size of groups, etc. might be tweaked, see what would happen ???????????????????????

04/20/19:
# next, REDO 'Subcel' phenogram, get longer names onto phenogram

# For my input, colms will be
prot chr pos phenotype 
# where phenptype colm is a new 'Subcel' colm (colm10) from table10cols.txt but modified to have 'longer' targetP locating names. Create a new colm, converting 'Subcel" names to the longer targetP names. Don't forget to remove last 5 'Un' rows.
# ref: line 15253
R
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()

table10cols <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
dim(table10cols)
head(table10cols, n=2)

library(dplyr)
phenSubcel <- table10cols %>% select(RFL_prot_ID, Chr, Start, Subcel)
dim(phenSubcel)  ## [1] 203   4
head(phenSubcel, n=4)
tail(phenSubcel, n= 4)

# in here need mutate

phenSubcel5col <- mutate(phenSubcel, Subcelong = ifelse(Subcel == "M", "mitochondrial targeting peptide (mTP)",
                    ifelse(Subcel == "C", "chloroplast transit peptide (cTP)",  
                    ifelse(Subcel == "S", "secretory pathway signal peptide (SP)",  "Other"))))
dim(phenSubcel5col)  ## [1] 203   4
head(phenSubcel5col, n=15)
tail(phenSubcel5col, n=2)

# now need a select, reduce 5 back to 4 colms

phenSubcel4col <- phenSubcel5col %>% select(RFL_prot_ID, Chr, Start, Subcelong)
dim(phenSubcel4col)  ## [1] 203   4
head(phenSubcel4col, n=4)
tail(phenSubcel4col, n=4)

colnames(phenSubcel4col)[4] <- "phenotype"
colnames(phenSubcel4col)[3] <- "pos"
colnames(phenSubcel4col)[2] <- "chr"
colnames(phenSubcel4col)[1] <- "rfl"

write.table(phenSubcel4col, file="phenSubcelong4col.txt", quote=FALSE, sep="\t", row.names=FALSE)

# now before phenogram, 1st remove 'Un', last 5 rows
head -n 199 phenSubcelong4col.txt > phenSubcelong4col_198.txt

# pheno_gram.68914.png
# now, names OVERWRITING, so will need to REDO, *shorten* ??????????????


# TODO Predotar ???????
line 13304
Submit file pid40_216pruned13to203.fa (to targetp)
# note: this file has at least one spurious char at end of a seq (here the 2nd seq in the file, a '.' ??????????????????????????????
# try 1st 7 seqs since 7th 1st with '_' ????????????

04/21/19:
# try all of pid40_216pruned13to203.fa
# invalid request error, so try subset of the .fa file, say, 1st 50
# still invalid request
# retry 1st 7, worked, so need submit in small portions ??????????????
# try 1st 25, => error
# try 1st 15, => error
# try 1st 10, => ok
# try 2nd 10 => ok
# try 3rd 10 => ok
############################################################################
# result/analysis: of 1st 30 seqs (of the 203), 6 diffs betw. targetp & Predotar. Vs 6 'M's from targetp, Predotar found 5 'ER' and one 'none'. Note: only could submit around 10 seqs/submission (15 was too many). Pub. supporting Predotar indicates part of reason to create Predotar was cause other pgms were having too many false positives ???????
Q: how much weight to give to the targetp, predotar results ????????????????/
############################################################################

# Some additional TODO CHECKS:
i. Polymarker never sent an email ?
ii. phenogram Subcelong names ??
iii. if 'M' seqs have more/less of 53 of 203 < 300 aas ??
iv. which phenogram loci 'have' the 4 snps near/within them ?????????

# Q: priorities to finish paper ???????
i. ... ??? perhaps outline what to put in the paper ?????????
ii. ... ???

04/22/19:
# talked to vikas
i. Predotar for all 203 seqs (so, 10 seqs at a time)
# start with pid40_216pruned13to203.fa
# perhaps do cut -f1 for table10cols.txt to list 203 prot. names
cut -f1 table10cols.txt | wc  ##      204     204    4270, has header line
cat table10cols.txt | tail -n 203 | wc -l  ##      203
cat table10cols.txt | tail -n 203 | cut -f1 > tab10col1.txt
cat ../pid40_216pruned13to203.fa | head -n 362 | tail -n 112 > predotar31_40.fa ## ok
# got 404 ????????
cat ../pid40_216pruned13to203.fa | head -n 458 | tail -n 96 > predotar41_50.fa ## ok
# worked

# test cut on colm 6 of predotar output.
cat predotar_out.txt | head -n 11 | tail -n 10 | cut -f6  ## working ok

04/23/19:
cat ../pid40_216pruned13to203.fa | head -n 546 | tail -n 79 > predotar51_60.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 637 | tail -n 91 > predotar61_70.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 735 | tail -n 98 > predotar71_80.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 735 | tail -n 98 > predotar71_80.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 816 | tail -n 81 > predotar81_90.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 894 | tail -n 78 > predotar91_100.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 987 | tail -n 93 > predotar101_110.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1068 | tail -n 81 > predotar111_120.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1155 | tail -n 87 > predotar121_130.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1250 | tail -n 95 > predotar131_140.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1319 | tail -n 69 > predotar141_150.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1386 | tail -n 67 > predotar151_160.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1460 | tail -n 74 > predotar161_170.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1538 | tail -n 78 > predotar171_180.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1616 | tail -n 78 > predotar181_190.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1698 | tail -n 82 > predotar191_200.fa ## ok
# worked
cat ../pid40_216pruned13to203.fa | head -n 1719 | tail -n 21 > predotar201_203.fa ## ok
# worked

04/24/19:
cat ../pid40_216pruned13to203.fa | head -n 362 | tail -n 112 > predotar31_40.fa ## ok
# got 404 ????????
# ok, seq 39 is GSDS problem seq, so 1st, try 31-38
cat ../pid40_216pruned13to203.fa | head -n 331 | tail -n 81 > predotar31_38.fa ## ok

try seqs 39-40
cat ../pid40_216pruned13to203.fa | head -n 362 | tail -n 31 > predotar39_40.fa ## ok,  worked.

# so, now, copy predotar_out.txt to predotar_out_final.txt & remove all but the 203 seq lines.
# WAIT: missed >TraesCS1B02G072900.2 gene=TraesCS1B02G072900
# in table10cols.txt, is seq # 50 of the 203.
# so create .fa file for this one seq to submit to predotar
cat ../pid40_216pruned13to203.fa | head -n 467 | tail -n 9 > predotar50_50.fa ## ok
# NEED run this on predotar to complete predotar_out.txt, then proceed as below

cp predotar_out.txt predotar_out_nohead.txt

cp predotar_out_final.txt predotar_out.txt 
rm predotar_out_final.txt

cp predotar_out_nohead.txt predotar_out_wihead.txt
# add header to predotar_out_wihead.txt

# then, prepare file, has colms 1 & Subcel from table10cols.txt & colms 1 & 6 from      predotar_out_wihead.txt. Arrange 4 cols so TargetP & Predotar are the middle two colms.  Now, can compare outputs from TargetP, Predotar in side by side colms. (use dplyr ?????)

04/25/19:
# ref line 16086
R
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()

table10cols <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
dim(table10cols)
head(table10cols, n=2)

pred6cols <- read.delim("predotar_out_wihead.txt", stringsAsFactors=FALSE)
dim(pred6cols)
head(pred6cols, n=2)

#(dplyr)
#tab10RFL_targetp <- table10cols %>% select(RFL_prot_ID, Subcel)
#dim(tab10RFL_targetp)  ## [1] 203   4
#head(tab10RFL_targetp, n=4)
#tail(tab10RFL_targetp, n= 4)

# do same for predotar_out_wihead.txt
#pred6RFL_predn <- pred6cols %>% select(Sequence, Prediction)
#dim(pred6RFL_predn)  ## [1] 203   4
#head(pred6RFL_predn, n=4)
#tail(pred6RFL_predn, n= 4)

# then, df wi desired 4 colms, name colms as create
#df4 <- data.frame(tab10RFL = table10cols$RFL_prot_ID, "targetp" = table10cols$Subcel, pred_pdn = pred6cols$Prediction, predRFL = pred6cols$Sequence)

df4 <- data.frame(tab10RFL = table10cols$RFL_prot_ID, predRFL = pred6cols$Sequence, targetp = table10cols$Subcel, pred_pdn = pred6cols$Prediction)
dim(df4)  ## [1] 203   4
head(df4, n=4)
tail(df4, n= 4)
write.table(df4, file="compare_targetp_pred.txt", quote=FALSE, sep="\t", row.names=FALSE)

# checking for mismatches betw. colm 3 & 4, gives 53.
# mitochondrial calls targetp = 94
# mitochondrial calls predotar = 67

# upshot: targetp, predotar have in the neighborhood 25% discrepancies. Q: value of their results ???????????????????????????????
# perhaps do do some sort of regression on these two, see pvalue ????????????????

# talked to vikas
i. create table11 by adding Predotar results to table10cols.txt RHS.

R
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()
table10cols <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
dim(table10cols)
head(table10cols, n=2)
pred6cols <- read.delim("predotar_out_wihead.txt", stringsAsFactors=FALSE)
dim(pred6cols)
head(pred6cols, n=2)
table10cols$predn <- pred6cols$Prediction
dim(table10cols)
head(table10cols, n=2)
write.table(table10cols, file="table11cols.txt", quote=FALSE, sep="\t", row.names=FALSE)

# NOTE: for seq num. 39, num. introns = NA. Q: is this ok???????????????????


04/26/19:
# slip a save to ***github*** in here

ii. MIPS genes (google)
# Q: couple different topics under MIPS ???????????????
iii. see table10cols.txt, for groups of seqs by start/end points, 10,000/100 = 100, then, +- 10kb before/end of start/end, would increase number of probes by 2*100 (?) = 100+200=300 (?)

iv. compare Polymarkers output page with Primers.xlsx (check that match?, THEY APPEAR TO)
v. KASP, to see on youtube ?





ii. polymarker input file to box, /Users/bterry/mbook2019/vikas19/ensembl
/4snpsinppolymarker.txt file, single space 
placed in .../RF_GeneFamily/manuscript dir. on box.

iii. redo Subcelong phenogram with: Mitochondria, Chloroplast, Signal Peptide, Unknown names.
iv. start working with vikas powerpoint outline for pub.

talked to vikas
i. check how calc of num. domains colm in table11cols.txt was done?

line 13435
# now ready to submit to hmmer online site.
# Task: count domains in seqs, submit to https://pfam.xfam.org/search#tabview=tab1
pid40_216pruned13to203man_dots.fa from 

line 13473
cat hmmer_email_out203.txt|tr -s " " "\t"|grep "PF01535.20"|cut -f1,8|sort|uniq -c|perl -pe 's/(\d+).+>(\S+).+/\2\t\1/' | tr -d " " > hmmer_email_out203_domain_ct.txt

# looks like for each of 203 (?), hmmer_email_out203.txt, gives hmm acc for each domain in gene/protein, then preceding line counts PF01535.20 rows (correspond with 'PPR' name).
# Q: how does it 'count', perhaps 'uniq -c' ???????

# so, **if** preceding ok, then have PPR domains in 203 RFL seqs
#######################################################################
# Q: BUT, other hmm Acc rows in one of 203 seqs in hmmer_email_out203.txt
PF13041.6       PPR_2
PF12854.7       PPR_1
PF01535.20      PPR
PF13812.6       PPR_3
PF17177.4       PPR_long
# note: start locations, SOME OVERLAP for these different hmm Acc's ????????????????
# perhaps hmm Acc's sort of related, thus overlap of their locations for particular 203 seq ??????????????????????
TO CHECK: seq 39, what does its hmm Acc pattern look like ????????????????
#######################################################################

04/27/19:
# so, for 'domain_number' field in table11cols.txt, submitted pid40_216pruned13to203man_dots.fa to https://pfam.xfam.org/search#tabview=tab1 Batch sequence search, pfam.
# after several processing steps, got hmmer_email_out203_domain_ct.txt which added to table11cols.txt as 'domain_number'. Subset on PF01535.20, 'PPR' rows from pfam output.
ref: lines 13435, 13473

# upload table11cols.txt to box. .../GeneFamily/manuscript

04/28/19:
ref: line 16080
# next, REDO 'Subcel' phenogram, get longer names onto phenogram (but not TOO long)
Names OVERWRITING, so will need to REDO, *shorten* ??????????????
Use Mitochondria, Chloroplast, Signal_Peptide, Unknown names.

# For my input, colms will be
prot chr pos phenotype 
# where phenptype colm is a new 'Subcel' colm (colm10) from table10cols.txt but modified to have 'longer' targetP locating names. Create a new colm, converting 'Subcel" names to the longer targetP names. Don't forget to remove last 5 'Un' rows.
# ref: line 15253
R
rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()

table10cols <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
dim(table10cols)
head(table10cols, n=2)

library(dplyr)
phenSubcel <- table10cols %>% select(RFL_prot_ID, Chr, Start, Subcel)
dim(phenSubcel)  ## [1] 203   4
head(phenSubcel, n=4)
tail(phenSubcel, n= 4)

# in here need mutate

phenSubcel5col <- mutate(phenSubcel, Subcelong = ifelse(Subcel == "M", "Mitochondria",
                    ifelse(Subcel == "C", "Chloroplast",  
                    ifelse(Subcel == "S", "Secretory_pathway",  "Unknown"))))
dim(phenSubcel5col)  ## [1] 203   4
head(phenSubcel5col, n=15)
tail(phenSubcel5col, n=2)

# now need a select, reduce 5 back to 4 colms

phenSubcel4col <- phenSubcel5col %>% select(RFL_prot_ID, Chr, Start, Subcelong)
dim(phenSubcel4col)  ## [1] 203   4
head(phenSubcel4col, n=4)
tail(phenSubcel4col, n=4)

colnames(phenSubcel4col)[4] <- "phenotype"
colnames(phenSubcel4col)[3] <- "pos"
colnames(phenSubcel4col)[2] <- "chr"
colnames(phenSubcel4col)[1] <- "rfl"

write.table(phenSubcel4col, file="phenSubcelong4col.txt", quote=FALSE, sep="\t", row.names=FALSE)

# now before phenogram, 1st remove 'Un', last 5 rows
head -n 199 phenSubcelong4col.txt > phenSubcelong4col_198.txt
# run phenogram
chr_size_Refv1.1_colm2and4minus_Un.txt (file for genome)
# pheno_gram.91241.png
# note: may need new title in this .png for pub? Also, a phenogram for Predotar ???????????


# NOW, attempt to understand PolyMarker process
# For example, 1st snp, S1B_18683593
# How relate to Example Output Mask ?????????????????/
# I note: 'contig_regions, Primers.csv, appears to be the two inputs to ensembl
# Q: where are A, B, 'common' in genome ?????????????
# Q: why A & B seqs don't appear in seq near snp in input seqs ???????????????
# Q: what vikas doing with the BLASTN ???????????????

04/29/19:
talked to vikas
i. phenogram: label as 'Mitochondrial' or 'Not_mitochondrial', or 'Targeted_to_mitochondria' or 'Not_targeted_to_mitochondria'
# Q: Perhaps can do with 'mutate ifelse' ????????
ii. Predotar phenogram: need predotar output colm with 'mitochondrial' & 'not_mitochondrial'
iii. work thru polymarker output, try place output on genome (note, inverse, etc. used ??????????????????/)
iv. check two journals, BMC Plant Biology & ...Integrative..., which wouild our paper best fit ???????????????

04/30/19:

rm(list=ls())
setwd("/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs")
getwd()

table10cols <- read.delim("table10cols.txt", stringsAsFactors=FALSE)
dim(table10cols)
head(table10cols, n=2)

predhalfway <- read.delim("pred_output_colm_halfway.txt", stringsAsFactors=FALSE, header=FALSE, col.names=c("halfway"))
dim(predhalfway)
head(predhalfway, n=2)

library(dplyr)
tab3cols <- table10cols %>% select(RFL_prot_ID, Chr, Start)
dim(tab3cols)  ## [1] 203   3
head(tab3cols, n=4)
tail(tab3cols, n= 4)

#> x <- data.frame("SN" = 1:2, "Age" = c(21,15), "Name" = c("John", "Dora"), stringsAsFactors = FALSE)

df4cols <- data.frame("rf1" = tab3cols$RFL_prot_ID, "chr" = tab3cols$Chr, "pos" = tab3cols$Start, "halfway" = predhalfway$halfway, stringsAsFactors = FALSE)
dim(df4cols)  ## [1] 203   4
head(df4cols, n=4)
tail(df4cols, n= 4)

# in here need mutate
df5cols <- mutate(df4cols, phenotype = ifelse(halfway == "mitochondrial", "Mitochondria", "Not_mitochondrial"))
dim(df5cols)  ## [1] 203   5
head(df5cols, n=15)
tail(df5cols, n=2)

# now need a select, reduce 5 back to 4 colms

phendf4cols <- df5cols %>% select(rf1, chr, pos, phenotype)
dim(phendf4cols)  ## [1] 203   4
head(phendf4cols, n=4)
tail(phendf4cols, n=4)

write.table(phendf4cols, file="phendf4cols_pred.txt", quote=FALSE, sep="\t", row.names=FALSE)

# now before phenogram, 1st remove 'Un', last 5 rows
head -n 199 phendf4cols_pred.txt > phendf4cols_pred_198.txt
# run phenogram
chr_size_Refv1.1_colm2and4minus_Un.txt (file for genome)
# pheno_gram.1478.png
# note: may need new title in this .png for pub? Also, a phenogram for Predotar ???????????

05/01/19:
# try understand polyMarker output
# blast & help links broken (see https://wheat-urgi.versailles.inra.fr/Tools/BLAST)??????
# Q: can I access a file which can blast on 'crane' ????????

/Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/hmmer203seqs

cd ~/mbook2018
find . -name 'iwgsc_refseqv1.1_genes_2017July06.zip' -print
./vikas18/131RFlike/annotation1.1/iwgsc_refseqv1.1_genes_2017July06.zip
./vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls/vikas_filter/iwgsc_refseqv1.1_genes_2017July06.zip

# Q: looks like no file in this directory with just the seq. of bases in each chromosome ????????
# Q: so what file might vikas did a blast with on 'inra' BLAST ???????????????

05/02/19:

TO DO, upload to box pred phenogram pheno_gram.1478.png

SNP1,1B,CCACGGAGCGAGCTCGATCTGGCAACCTCACCTCGGAGGACGCACACAAGCTGTTCGACCAATTGCTCCTGCAGGCTAATCCGGTCAACATGCGCCTTCC[G/C]AACGACCTTCTCACCGCCCTGGCTCGCGCGCCTGCGTCCGCAGCCTGCAGCAACGGCCCCGCCCTTGCCCTCGCCCTCTTCAGCCGTTTGTCCCAAGGTG

18 bases to right of [G/C]
AACGACCTTCTCACCGCC

Q: how relate to 'A' 'primer'??
ggcggtgagaaggtcgtt

Check if is rev comp for 18 bases to right of [G/C].
aacgaccttctcaccgcc, so yes.

So, for this snp, SNP1,1B, rev comp of 'A' primer is the 18 base seq to right of [G/C]

Note, blastn of primer 'A' of this snp has 11 hits, two have identities of 18/18, 9 have 16/16 ??????????

Q: e-value, 0.37, 5.9 ???????????

Q: convention for writing rev comp, looks like write it in reverse direction as 3' to 5' on its strand ????????????

Q : how to think of 'fam' & 'hex' ???????????????????????????????????????

Q: primer type vs snp type ????????????

Q: don't have polymarker output looks like example outlook ?????????????

##################################################
Ok, primer 'B', ggcggtgagaaggtcgtt, except for 'G' on end, same as primer 'A', thus also 18 bases long.

Ok, so what of 'common' seq., tgcaggctaatccggtcaac, 20 bases long. Do a blastn to see where it is located.

ends on 201 input, upstream ending 12 bases ahead of snp base forward strand.

# Ok, so how this 'common' involved ?????????

cd ~/mbook2019
find . -name 'Glover*' -print

See the potential JOURNALs for the pub. ************** (done)

05/03/19:
cd ~/mbook2019
find . -name 'document.pdf' -print

05/04/19:
# looking over /Users/bterry/mbook2019/vikas19/vikas_ppt_presentatn
/RFLGeneFamilyCargillRLines_PPT_v5b_FINAL.pptx, try build a .Rmd file in preparation for writing manuscript.

# ERROR: THIS NOT VIKAS PPT PRESENTATION I NEED TO ACCESS, THO THE NAME SEEMS OK ?????


05/05/19:
# working thru RFLGeneFamilyCargillRLines_PPT_v5b_FINAL.pptx & v1.1_manuscript_template.Rmd to update v1.1_manuscript_template.Rmd ahead of creating a manuscript for publication. FINAL manuscript will be different from this file (omit some of info. in this file). So, after 'improve' this file, then perhaps prepare 'FINAL' manuscript based on parts want to use from this file ????????

05/06/19:
# reviewing res. logfile notes, preparing to add to logfile Rmd file

05/09/19:
# up thru line 16550 of 'log' research notes file

# talked to vikas
# perhaps make list to images, etc. want to collect for pub.

cd mbook2019
find . -name '*FINAL.pptx' -print
./vikas19/vikas_ppt_presentatn/RFLGeneFamilyCargillRLines_PPT_v5b_FINAL.pptx

# file names from /Users/bterry/mbook2018/vikas18/v1.1Rmd_doc
/v1.1_manuscript_template.Rmd
pptx slide 8: image: PPRv1.1.1913plus88ctls1stcolor_guess_P_PLS_forRmd.png file
pptx slide 10: pid40_216pruned13to203_phyml_tree_chrcolor_forRmd.png

05/11/19:
pptx slide 12: full (203 - 5 = 198) , pheno_gram.79071.png
# prepare tiff file. cp pheno_gram.79071.png to /Users/bterry/mbook2019/vikas19/vikas_ppt_presentatn
# open in Preview, same as tiff wi 'LZW', & '300'
# Q: can phenogram output be saved other than '.png' ? YES, so did for full 203. Output is pheno_gram.38631.pdf for input file phen_all_203minus5rows.txt from .../hmmer203seqs dir.
# next, open in Preview, same as tiff wi 'LZW', & '300'. Then export as tiff. Result seems fine (pheno_gram.38631.tiff)

####################
STOPPED, to get tiff for 1A
####################

pptx slide 13: chr 1A, 10to100mil, pheno_gram.45569.png

pptx slide 14: gsds, (vikas used 2nd of 5 slides), P3YUJP.png
pptx slide 16: probably same modifications needed ???
pptx slide 18: some Q's  ???????????????????
pptx slide 19: how use this output ????????????

Q: should PCA, NJ phylogram slides been in here ????????????????

pptx slide 21: TO GO, FIND CALCN of THE 75, 59, 36 ??????????
cd mbook2019
find . -name 'VariantEffectPredictor_Run1.txt' -print
./vikas19/tassel5/VEP/VariantEffectPredictor_Run1.txt
cd vikas19/tassel5/VEP

# line 14397
cat table10cols.txt | cut -f1 | tail -n 203 | python3 testing.py VariantEffectPredictor_Run1.txt
# RESULT: 75 rows of output, does it mean 75 snps associated with an RF gene/protein, i.e., within or +- 5000 of gene ???????

philip-terry-2:VEP bterry$ head -n 2 VariantEffectPredictor_Run1.txt
#Uploaded_variation	Location	Allele	Consequence	IMPACT	SYMBOL	Gene	Feature_type	Feature	BIOTYPE	EXON	INTRON	HGVSc	HGVSp	cDNA_position	CDS_position	Protein_position	Amino_acids	Codons	Existing_variation	DISTANCE	STRAND	FLAGS	SYMBOL_SOURCE	HGNC_ID	TSL	APPRIS	SIFT	CLIN_SIG	SOMATIC	PHENO
S1A_1145442	1A:1145442-1145442	A	synonymous_variant	LOW	-	TraesCS1A02G001800	Transcript	TraesCS1A02G001800.1	protein_coding	2/2	-400	264	88	K	aaG/aaA	-	-	1	-	-	-	--

# Q: how gotten VariantEffectPredictor_Run1.txt ??????????????????

grep -f table10col1.txt VariantEffectPredictor_Run1.txt > vep_Run1_203map_grepf.txt
# result: 75 rows, same order as with testing.py. Since no duplicate rows, therefore same order as testing.py.

# how got 59 or 36  ???????
# from line 14439
cat vep_Run1_203map.txt | cut -f1 | sort|uniq > vep_Run1_203map_col1sortuniq.txt
# gives 36 rows, protein names.

# what about the 59 ?????????
# now, do 'sort|uniq for colm 2, the snp name colm
cat vep_Run1_203map.txt | cut -f2 | sort|uniq > vep_Run1_203map_col2sortuniq.txt
########################################################
# Q: 59 unique rows (snp column) ???????????????????????????
###########################################################


pptx slide 22: flapjack ??????
# line 14600
Vikas placed 4 files on 'box'.
/Users/bterry/mbook2019/vikas19/tassel5/VEP/vikas_box

# what are they ??? Where from ????

# initially, try ForFlapjack_Subgroup2R_and_NonR_lines_RFL_SNPs.recode.txt
# 23 rows
# next, ForFlapjack_Subgroup2Homogeneous_R_and_NonR_lines_RFL_SNPs.recode.txt
# 21 rows
# both of these, **appear** to be colms which distinguish R, nonR rows.

# Q: difference these (23 & 21 rows & pptx slide 22 ?????????????????

pptx slide 23: Q: how slide gotten ???, Q: subgroup 2 & non R lines ?????

05/12/19:
pptx slide 24: Q: 'gene expression' ????????????????

pptx slide 25: Q: 'expression data', where from, are they tx's,  ????????
# Q: slide says 'chromosome 1B', browser asking for a gene or protein name. How to square these two ???????????????????

pptx slides 28-38, Q's, see my pencil comments/questions ??????????????


# ok, now the treatment for an image in figtree to prepare for a pub (vikas discussed, 05/10/19), and a dir. where the resulting tiff/etc files can be stored ??????????

# for slide 10 of RFLGeneFamilyCargillRLines_PPT_v5b_FINAL.pptx, place following 4 files in /Users/bterry/mbook2019/vikas19/vikas_ppt_presentatn dir.

pid40_216pruned13to203_phyml_tree_chrcolor_forRmd.txt.pdf
pid40_216pruned13to203_phyml_tree_chrcolor_forRmd.txt.png
pid40_216pruned13to203_phyml_tree_chrcolor_forRmd.txtline1.5.tiff
# note: shows gsds seq #39 as lowest limb on phylogram.
pid40_216pruned13to203_phyml_tree_chrcolor_forRmdline1.0.txt
pid40_216pruned13to203_phyml_tree_chrcolor_forRmdline1.5.txt

# the .png image above 'straight' from figtree, **not** what vikas suggesting for pub.
#########################################################################
# rather, suggests:
i. in figtree, do steps previously did set up an image (see ????)
ii. in figtree, 'appearance' on lhs, set line width 1.0 to 1.5
iii. export pdf
iv. import this pdf to Preview
v. export tiff file (compression = LZW, Resolution = 300)
vi. Note, in 'preview', if click 'green' button, then can do 'cmd + or -' to make image larger or smaller.
#########################################################################

# now, for slide 8, need the 'tree' file which produced PPRv1.1.1913plus88ctls1stcolor_guess_P_PLS_forRmd.png image, so can convert to tiff (keep 1.0 for now, ???).

05/13/19:

copied from /Users/bterry/mbook2018/vikas18/131RFlike/annotation1.1/PPRv1.1plus_88ctls PPRv1.1.1913plus88ctls1stcolor.txt
copied to
/Users/bterry/mbook2019/vikas19/vikas_ppt_presentatn
# then,
cp PPRv1.1.1913plus88ctls1stcolor.txt PPRv1.1.1913plus88ctls1stcolor_line1.0.txt
# looked at line wt = 1.5. Question if would help this image, so for now, did not create file with 1.5 ???????????????
# so just follow 6 steps above to create tiff file.
# testing printing the tiff from preview, changing size did not change size of printout. Perhaps a screen capture  to change size, but then back to .png file ??????????

# but wait, test line size 0.5
# so, open in figtree, PPRv1.1.1913plus88ctls1stcolor.txt, change to line = 0.5, export as pdf, PPRv1.1.1913plus88ctls1stcolor_line0.5.txt.pdf.
# next, import .pdf file into preview, export tiff file (compression = LZW, Resolution = 300) => PPRv1.1.1913plus88ctls1stcolor_line0.5.txt.tiff

#############################################################
# TO DO: search appropriate wheat file for number PPR seqs (v1.0 was 1602)
#############################################################

05/14/19:
# talked to vikas
i. update manuscript Rmd as per log Rmd
ii. upload to box (probably the box manuscript dir ???) File name v1.1_manuscript_template_051419.html
iii. email vikas, notify
iv. phenogram ...

v. location #39 gsds seq in phylogram (slide 10 in vikas ppt file.
vi. 1602 in v1.1 ??????
vii. 0.5 line width for slide 10 test
viii. put 'final' files (tiff's) in new manuscript box dir. as complete ?????

05/15/19:
# vikas created dir on box: .../RF_GeneFamily/Manuscript_May2019 for final form for pub. files. So list here as upload them
pid40_216pruned13to203_phyml_tree_chrcolor_forRmd.txtline1.5.tiff
# Q: which slide 8 tiff, 0.5 or 1.0 ????????

# slip a save to ***github*** in here
















STOPPED



# TO SEND KELLYE AN EMAIL WITH THE GFF3 PROBLEM ????????????






 



# then compare best hits wi phylogram. No pid40_88ctls phylogram. Will need to use pid50_88 phylogram.





# could try compare pid for say  seven...031600.1 with one used to create the pid40 216 seqs (Q: how, look back where originally created ????????????)


# TO SEND vikas an email discussing ?????????????/




# dir to work wi vikas6 hits for 216 of pid40, /PPRv1.1plus_88ctls/vikas6hits

R
rm(list=ls())
setwd("~/mbook2019/vikas19/tassel5/VEP")
getwd()
iftabvec <- read.delim("ijtabvep4cols.txt", header=TRUE, stringsAsFactors=FALSE)
dim(iftabvec) ## [1] 203   3
View(iftabvec)
head(iftabvec, n=2)


# subset for the 216 prot. seqs (python pgm ?????????)
# then check if 'evalue' can distinguish ...

# line 14576 (dplyr)








# Now, work with Tassel5, VCF tools, Flapjack. Yesterday, Vikas placed 4 files on 'box'.
/Users/bterry/mbook2019/vikas19/tassel5/VEP/vikas_box

ForFlapjack_R_and_NonR_lines_RFL_SNPs.recode.txt
R_and_NonR_lines_RFL_SNPs.log
R_and_NonR_lines_RFL_SNPs.recode.hmp.txt
R_and_NonR_lines_RFL_SNPs.recode.vcf








# **yet** to try venny. 
table10col1.txt, VariantEffectPredictor_Run1.txt as input files






then test grep, bbeditlab


# GC perl script


# perhaps order colms as per template table ??????




GSDS ??
phenogram ??
Zhang table, chrom, ...









--intron-exon structure, compare betw. chroms

# Q: for table like Zhang, 2018, do we want to only work with subset of the 216 seqs of  pid40, or also the additional 89 seqs in pid35 ??????

# Q: seq of seqs in the proposed table:
 



STOPPED

NEXT, READ THRU Rmd, html files, MODIFY FOR LOGIC, MAKE COMMENTS AS TO WHAT CHANGES NEEDED TO SEE WHAT WANT TO SEE IN IMAGES, ETC.

MAY THEN CREATE A NEW Rmd file, EDIT DOWN TO WHAT VIKAS LOOKING FOR, SUMMARY PARAGRAPH















p820br9rice9soy38arab26.fa => phylogram for hmmbuild for this fasta file produced phylogram where wheat chromosomes unable to co-locate on resulting phylogram, perhaps
if the 820 not included, wheat chroms 1, 2, 6 could have co-located ???????
# for purpose here to separate P & PLS seqs, presumably may help ?????????






# probably could transfer to an output file, doc lengths of fasta seq in IWGSC_v1.1_HC_20170706_pep.fasta
# then with largest length for each prot group, compare wi length of '.1' seq for each group, finally retain seq & name for longest seq for each group ????????


#****************************************************************





# then on to MEME (Try new ver **5.0**, rather than 4.12.0 prevly used)
philip-terry-2:iwgsc.2to9 bterry$ ls -al iwsgc139*.fa
-rw-r--r--  1 bterry  staff  79868 Mar 25 20:52 iwsgc139_REPR_PROT_seqs.fa
philip-terry-2:iwgsc.2to9 bterry$ pwd
/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

# MEME has 80Mb limit, so will have to break input .fa file into two parts
# consider use iwsgc139_REPR_PROT_seqs.fa or iwsgc139_REPR_PROT_seqs.fa.aln.hmmaln.fa for input to MEME? Guessing iwsgc139_REPR_PROT_seqs.fa should be fine ????????????
# 139 '>' lines in fasta. iwsgc139ma	cd _REPR_PROT_seqs.fa has 80 kB,
-rw-r--r--  1 pterry amundsen  79868 Mar 26 09:49 iwsgc139_REPR_PROT_seqs.fa
# so, can submit all at one time.

06/19/18:
# 1st try: Your job ID is: appMEME_5.0.01529385634457456677846
Submitted	6/19/2018, 12:20:34 AM
Expires	6/23/2018, 12:20:34 AM
Description	**139_1motif_061918**
(Primary) Sequences	A set of 139 Protein sequences, between 189 and 874 in length (average length 543.1), from the file ***/Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9
/iwsgc139_REPR_PROT_seqs.fa***.
Background	A 0-order background model generated from the supplied sequences.
Discovery Mode	Classic: optimizes the E-value of the motif information content
Site Distribution	Zero or one occurrence (of a contributing motif site) per sequence.
Motif Count	Searching for one motif.
Motif Width	Between 6 wide and 50 wide (inclusive).

# MEME result for MEME description: 139_1motif_061918
# see file in dir /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9/
-rw-r--r--@ 1 bterry  staff  81513 Jun 19 11:39 meme_139_1motif_061918.txt


# are p-values how evaluate how valid the motif is ??????????
# relate which motifs, which seqs?
# motif location?
# fcn of motifs?

# Try MAST

Submitted	6/19/2018, 10:02:31 PM
Expires	6/23/2018, 10:02:31 PM
Description	**mast_139_1motif_061918**
Motifs	One protein motif, with a width of 41, from the file meme_139_1motif_061918.txt.
Sequences	A set of 154140 protein sequences, between 23 and 4844 in length (average length 454.3), from the database Triticum aestivum.
Sequence Threshold	Report sequences with E-value ≤ 10.
Remove Redundant Motifs	Redundant motifs will be removed from your query by MAST.

# To try: MEME with 1 motifs, 'anyreps'
Submitted	6/19/2018, 10:48:37 PM
Expires	6/23/2018, 10:48:37 PM
Description	**meme139_anyreps_1motif_061918**
(Primary) Sequences	A set of 139 Protein sequences, between 189 and 874 in length (average length 543.1), from the file iwsgc139_REPR_PROT_seqs.fa.
Background	A 0-order background model generated from the supplied sequences.
Discovery Mode	Classic: optimizes the E-value of the motif information content
Site Distribution	Any number of repetitions (of a contributing motif site per sequence)
Motif Count	Searching for one motif.
Motif Width	Between 6 wide and 50 wide (inclusive).

06/20/18:
# **meme139_anyreps_1motif_061918** run has different length motif than **139_1motif_061918** run.
# Q: how to deal/use MEME results ????????????????????????

to try run **meme139_anyreps_2motif_061918**

Submitted	6/20/2018, 10:57:11 AM
Expires	6/24/2018, 10:57:11 AM
Description	**meme139_anyreps_2motif_062018**
(Primary) Sequences	A set of 139 Protein sequences, between 189 and 874 in length (average length 543.1), from the file iwsgc139_REPR_PROT_seqs.fa.
Background	A 0-order background model generated from the supplied sequences.
Discovery Mode	Classic: optimizes the E-value of the motif information content
Site Distribution	Any number of repetitions (of a contributing motif site per sequence)
Motif Count	Searching for 2 motifs.
Motif Width	Between 6 wide and 50 wide (inclusive).

# viewing meme.html (meme139_anyreps_2motif_062018.txt, txt version), just lot of motifs on each seq., what to think ????????????????


# talked ***JJ*** about how to try use MEME. Suggests strategy to find motifs in groups of related seqs (for example, promoter seqs in his case). If I try for all 139 seqs, since differences for example, betw. chrom 1, 2, 6 in ML phylogram, appears the MEME alg. reflecting the task it is given (for example, for the 139, for 1motif, it finds diff. motif depending if freq of 0 or 1, vs 'any number of reps'). So perhaps try MEME on chrom 1, 2, 6 separately. Since ML phylogram can group RF-like prots by chrom., perhaps MEME can do also, and would learn motifs unique to the diff. chrom. groups.

# aside for from JJ, **'fasta_toolkits'** (crane for say find length each seq of '.fa' file. **'ea_utils'** for fastq file info.


# so, subset iwsgc139_REPR_PROT_seqs.fa by chrom 1, 2, 6. Then try MEME on each. Q: How best to do? Perhaps find file may have used to create this '.fa' file. Subset it, then make new '.fa' files with using Vikas 'getseq.awk' file ???????????????

# line 7270 above
#./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa iwsgc_131_5_3_139names.d.txt > iwsgc139_REPR_PROT_seqs.fa

# iwsgc_131_5_3_139names.d.txt already sorted by chrom except last 8 which all chrom1. Wait, there is one '5', three '7's, & three without a chrom specification.

STOPPED

06/21/18:

# so, just separate by chrom 1, 2, 6. Omit the '5', '7's, & those without chrom specification.  Run each separately wi getseq.awk. Then submit to MEME, any number reps, initially for 1 motif. Perhaps, since last 8 rows (chrom 1's not picked up by orthomcl, omit them also. So, use 1st 125 rows, omitting chrom 5, row 94. So, 74 '1's, 19 '2's, & 
31 '6's, total 124 rows.

cd /Users/bterry/macbook2018/vikas18/131RFlike/iwgsc.2to9

cat iwsgc_131_5_3_139names.d.txt | head -n 74 > iwsgc_131_5_3_139names_chr1_74.d.txt
cat iwsgc_131_5_3_139names.d.txt | head -n 93 | tail -n 19 > iwsgc_131_5_3_139names_chr2_19.d.txt
cat iwsgc_131_5_3_139names.d.txt | head -n 125 | tail -n 31 > iwsgc_131_5_3_139names_chr6_31.d.txt

# next getseq.awk to produce '.fa' file for these 3 files

./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa iwsgc_131_5_3_139names_chr1_74.d.txt > iwsgc139_REPR_PROT_seqs_chr1_74.fa

./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa iwsgc_131_5_3_139names_chr2_19.d.txt > iwsgc139_REPR_PROT_seqs_chr2_19.fa

./getseq.awk iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa iwsgc_131_5_3_139names_chr6_31.d.txt > iwsgc139_REPR_PROT_seqs_chr6_31.fa

# now submit to MEME
# **meme139_anyreps_1motif_chr1_74_062118**

Submitted	6/21/2018, 12:50:55 PM
Expires	6/25/2018, 12:50:55 PM
Description	**meme139_anyreps_1motif_chr1_74_062118**
(Primary) Sequences	A set of 74 Protein sequences, between 189 and 874 in length (average length 577.2), from the file iwsgc139_REPR_PROT_seqs_chr1_74.fa.
Background	A 0-order background model generated from the supplied sequences.
Discovery Mode	Classic: optimizes the E-value of the motif information content
Site Distribution	Any number of repetitions (of a contributing motif site per sequence)
Motif Count	Searching for one motif.
Motif Width	Between 6 wide and 50 wide (inclusive).

# result: 29 aa motif, many per seq.

# **meme139_anyreps_1motif_chr2_19_062118**

Submitted	6/21/2018, 12:53:46 PM
Expires	6/25/2018, 12:53:46 PM
Description	**meme139_anyreps_1motif_chr2_19_062118**
(Primary) Sequences	A set of 19 Protein sequences, between 228 and 779 in length (average length 574.5), from the file iwsgc139_REPR_PROT_seqs_chr2_19.fa.
Background	A 0-order background model generated from the supplied sequences.
Discovery Mode	Classic: optimizes the E-value of the motif information content
Site Distribution	Any number of repetitions (of a contributing motif site per sequence)
Motif Count	Searching for one motif.
Motif Width	Between 6 wide and 50 wide (inclusive).

# result: 50 aa motif, many per seq.

# **meme139_anyreps_1motif_chr6_31_062118**

Submitted	6/21/2018, 12:56:27 PM
Expires	6/25/2018, 12:56:27 PM
Description	**meme139_anyreps_1motif_chr6_31_062118**
(Primary) Sequences	A set of 31 Protein sequences, between 215 and 837 in length (average length 476.2), from the file iwsgc139_REPR_PROT_seqs_chr6_31.fa.
Background	A 0-order background model generated from the supplied sequences.
Discovery Mode	Classic: optimizes the E-value of the motif information content
Site Distribution	Any number of repetitions (of a contributing motif site per sequence)
Motif Count	Searching for one motif.
Motif Width	Between 6 wide and 50 wide (inclusive).

# result: another 29 aa motif, many per seq.
# Q: is it the same seq?
# for meme139_anyreps_1motif_chr6_31_062118
# MOTIF DEAMDLFDEMVQQGVKPBVVTYNSLIDGY MEME-1	width =  29  sites = 155  llr = 6331  E-value = 7.4e-1815
# for meme139_anyreps_1motif_chr1_74_062118
MOTIF VTYNTLIDGYCKEGRLDEAMKLFREMTSK MEME-1	width =  29  sites = 370  llr = 15249  E-value = 6.8e-4492
# so for chrom 1 & 6, same length of motif, but **different** seq of aa's.
# So, Q: can I benefit from MEME for this RF-like protein project ?????????????



# gwas for RF proteins ??



## relationship protein lengths and ML phylogram ???


BR = red, Gly = pink, rice(AB) = green arab(AT) = yellow, these +ve ctls group to the left of circular phylogram. Red & pink sort og group together, yellow near pink. but note, some dispersal of a few mostly yellow & green ?????????????????????
## now highlighting chr 1, 2, 6 in turn
## they pretty much **spread around** the circular phylogram  ???????????????????
## PERHAPS SHOULD NOT HAVE USED **ALL** SEQS IN p820br9rice9soy38arab26.fa FOR hmmbuild ?????????????
## working with p820br9rice9soy38arab26_fa_aln_hmmaln_phy_phyml_tree.txt file, red [=] TraesCS1, chr 1. green [=] TraesCS2, chr 2, purple [=] TraesCS6, chr 6.






STOPPED



## a note: vikas metric of aligned length/query seq length  ???????

## Perhaps, **map** the locations of the 1545, 1602 PPR's, and setDiff to list 62 which differ ??? See if in clusters? Look back on phenogram, see if can do ???????????


STOPPED 
 

## in 131, are all hits within *same* chrom. of query seq. ?????

## find the different ones from the 22, examine


STOPPED 






iii. subset ~ 110,000 wheat .fa protein seq file using wheat protein names from 131 previously identified RF-like seqs. Check how many isoforms find (.1, .2, etc.) for 131 protein seq names.


## Note: only 3 '.2' seqs in orthoMCL131.fa, rest are '.1' tx.






scp pterry@crane.unl.edu:/work/baenziger/pterry/wheatproj/refinPprots131norice9/orthoMCL131.fa.aln.hmmaln .
less orthoMCL131.fa.aln.hmmaln
## so stockholm MSA form does not give info on 'trim' size of the stockholm format ????????????????




## To do, color rice9, blue10. Locate chr 1, 2, 3, 4, 5, 6, 7 on phylogram.
## Check if topology of rice9 vs other groups has changed when removed 135 to 131 ?????
## locate 3 seqs unique to orthoMCL.












## To do: compare with sizes in fig 3, sci.reports ref. There, spanning ~ 500kb base pair region on chromosome 10. RF regions only ~ 100 Kb. 
## To Do: Compare with the 3 regions immedly above
## To Do: compare with the 36 RFproteins from orthofinder ????????????????
## To **check**: if genes in ref regions fig 3, sci reports in my 9 'RF' genes ?????????????




## perhaps plot start & stop ?????????????????????????

## could **check** distribution of 1602 - 144 "Pentatricopeptide" if can get their start positions from gff3 file ?????



## try some code from Adam

 
for line patternfile.txt
  name = line.strip()
  for line2 in gff3file.txt
    if name in line2.split('\t')[8]
      print line2
      




STOPPED





3) ## display location all proteins (genes) all chromosomes same plot. (Q: how do ????
5) ## gene structure (vikas, online s/w) Q: think this more detailed than (3) above ?????
6) ## sequence logos (online)
7) expression data



## Q: any info on OG5_131220 orthomcl_group ?????????????????

## now venn diagram or 'UpSetR', Gehlenborg ??????????








 
 
 
 
 
## stockholm to fasta format, try internet page ????????????????
## DON'T HAVE VIKAS SCRIPT ????????????????????

## BUT, Vikas NOW trims manually ????????????????
## instead, try Gblocks ???????????????????????????????, MIGHT THERE BE A LIMIT IN FILE SIZE TO Gblocks ???????????????????????????????????

## build phylogeny (PhyML eventually ??), now, Mega (ML) ????????, what file format ????????????
## display in figtree or Mega ?????????????? 
 



## check out 'Download Alignment File' from clustal on PPRhmmsearchsubset_plus9.fa.
## clustalo-E20170703-061614-0438-15309988-oy.clustal_num
## Q: perhaps could run this file thru Gblocks to trim, then thru phylogram producing pgm like Mega, then display in Mega or figtree ???????????????


## Q: Exactly how did Vikas get to file: PPRhmmsearchsubset_plus9_clustaltree_colored ??????????????????????
## Q: what downloaded from clustal ??????????????????????, captured in BBedit ????????, then into figtree ?????????????????
## Q: perhaps 'screen captured' web display from 'Phylogenetic Tree' button, paste in BBedit, save, then load into figtree ????????????????

## Q: difference betw. PPRhmmsearchsubset_plus9_clustaltree_colored_nexus & PPRhmmsearchsubset_plus9_clustaltree & PPRhmmsearchsubset_plus9_clustaltree_colored ?????????????????????
                               


## ok, regarding the PPRhmmsearchsubset_plus9_clustaltree_colored (BBedit or grep command line ??????), 1st, separate  
'color' rows out. Take 1st 1558 lines, subtract 1st 4 = 1554 remaining (or 1st 13, don't need to subset PPRhmmsearchsubset.fa. Then, perhaps with bbedit or grep command line (???), 
find box: \]$
## save file as ...color  ## potl 'P' proteins 

find box not \]$
## save as non-color  ## potl 'PLS' proteins

## pare down to 



## Q: should PPRhmmsearchsubset.fa (1545 seqs) seqs be subset to those > some length, then append FRknownseqs_shtname_7.fa (or should include the '13s' also (i.e., > 10) ??????
## test 1-liner code at , https://stackoverflow.com/questions/23992646/sequence-length-of-fasta-file
## on the ...9.fa file.

## so, append to PPRhmmsearchsubset.fa,

Then do clustal/omega (ensembl) MSA, 'command A', save to txt file, they run thru phylogeny, finally display with figtree (Q: WHICH figtree pgm ????????), want see how compares to 'phylotree.txt.png' produced above. Looking for location the new Rf's in 3rd 'area' of that tree ????????

## so, create 11 fasta files, copy each to new file, shorten name line in each file, & reflect in name new file.


## may 1st add 3 from sykes (see below) ????? before ...
## create MSA wi hmmalign (stockholm format output)
## hmmbuild => hmm
## run on PPRhmmsearchsubset.fa, see if can pull out 'RF's' from this file.


## to check 3 on p-353, sykes
## following blasted vs ... ???????
## here, perhaps include in prepn of an hmm the following, but how  ???????????????????

i) brachypodium, gi|357139997 => ... gene prediction ???????????

ii) rice, gi|33859441

iii) maize, gi|662249846


## Q: how best get some 'RF's' from other species ??????????????


STOPPED



--take 1545 wheat PPRs (PPRhmmsearchsubset.fa) *plus* cloned RFLs
--muscle (MSA)
--BBedit, 'clean' data
--phylogeny
--plot phylogeny (figtree)



v) take output from email response (initially not from browser output ???), perhaps subset by colm 7, 'hmm name', but Q: about colm 6, 'hmm acc' ???????
## Q: how get all the email output (vikas did ?????*****?????). Q: can one get this output like email from the website ?????????
## Q: looks like at least one can dnload each of the results **separately** for each of the 500 names in the input to online hmmscan. Looks like **can't** get the form of the email output thru website? Q: currently if try 'print' the email output, it shorter than what vikas got ???????********???????????????

## At least concatenate output of multiple submissions to hnnscan, take the 'email' output.

 




iv) sort | uniq | length, see if still have same number as in PPRsec2_1562.txt (i.e., are there any duplicates)? Name this file PPRseqnames.txt 
TO CHECK that input fasta file, iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa, has these as its 'fasta names' ???????
v) apply Vikas getseq.awk to iwgsc_refseqv1.0_HighConf_REPR_PROTEIN_2017Apr03.fa & PPRseqnames.txt to get subset of fasta file from sec 2 of PPR.out. I note output from getseq.awk is a fasta fie.
## Note: if dataframe format will be needed, check my prev. method convert fasta to dataframe, then use 'merge', ref., p-224, vbuffalo book ????????????

## Q: try figure out what Vikas thinking with his blast & phylogeny analysis to 'identify gene models', that is, check ref articles how to find find RFL genes ??????????????????????

STOPPED

if the full sequence E-value is significant but the single best domain E-value is not, the target sequence is **probably** a multidomain remote homolog; but be wary, and watch out for the case where it’s just a repetitive sequence.
## so Q:, PPR proteins repetitive domains, & two E-Values significantly diff. here, **not** in hmmsrchshortpep.out ****?????????????****
## line 8217, The two columns headed #doms are two different estimates of the number of distinct domains that the target sequence contains. ... These two numbers should be about the **same**.
## note, betw. hmmsrchshortpep.out & PPR.out, **order** magnitude diff. in the two numbers. Though they are about the same.

06/11/17:
## PPR.hmm, 'inclusion threshold' on line 1540. 
## Q: p-9, sci reports ref, PPR.out drops to <10 at line 542 ??? (Q: confusion, does the 10 domains mean RFLs with at least 10 domains in sec 2 should be retained ????????????)
## (Q: p-533, mentions PPR proteins 2 to 30 tandem repeats ??????????)
## inclusion threshold, line 1539 has only 2.2 & 1 for its two estimates of number of domains.
*******************************************
## Q: OK, so how to decide among these criteria ???????????????????
*********************************************

## **sec 3**, line 1598
## Q: how use sec 3 ???????????*************?????????????????????????
*********************************************************************
## Q: perhaps for PPR.out data, for now, don't use sec 3 ??????????????????????
**********************************************************************

## line 8221, The ! or ? symbol indicates whether this domain does or does not satisfy **both** per-sequence and per-domain inclusion thresholds.
## Q: is this good criterion for whatever use sec 3 for ??????????????????
## line 8227, If the independent E-value is significant (<< 1), that means that even this single domain by itself is such a strong hit that it suffices to identify the sequence as a **significant** homolog with respect to the size of the entire original database search. You can be confident that this is a homologous domain.
## Q: (<< 1), what value ?????????????????????
## line 8228, The next **four** columns give the endpoints of the reported local alignment with respect to both the query model (“hmm from” and “hmm to”) and the target sequence (“ali from” and “ali to”).
## think recall I used these endpoints for qqch ????????????????????????????
## Q: **no** vertical '|' in PPR.out, though in hmmsrchshortpep.out ??????????????????????????????????
## Q: where is line 385075, perhaps in Trinity.fasta.transdecoder.pep file ?????, YES
## line 8250, SO WHAT TO DO ?????????
## Should be able to take 'Sequence' colm from sec 2 of hmmsearch, do %in% to find the sec 2 hits from hmmsrchshortpep.out in Trinity.fasta.transdecoder.pep file, the rows want to build Stockholm MSA file with hmmalign.
## Q: or do I want to get just the 'domains' specified in the 3rd sec of hmmsrchshortpep.out for each of the 'hits' ??????????????
## Q: but PPR.out many more domains per hit ????????????***********??????????

08/08-09/17:
the plant journal (2016) 85, 532-47, file name = cheng...journal.pdf
## Q: p-544, ***HMMs*** ??????????????******?????????????????
## also Vikas refs Scientific Reports 6 35152 2016  ## *to see*
## unl classic libr not working ????????????????????????????????????????
## and Vikas BMC paper earlier ?????????  ## *to see*

## get all appropriate (above appropriate cutoff) PPR's from PPR.out. 

## Vikas rec. way using pfam to separate P & PLS subsets of PPR ??????
## then get RFL's, see new refs from Vikas ????????
## Sci Reports, 6:35152, 2016, p-6, fig 3, Q: non-RFL genes mixed in with RFL genes ????????????????????????????????????????????
## same ref, p-2, 4 methods **identify RFL proteins within P-class** ??????????

06/11/17:

STOPPED
## so need a plan to find RF/RFL (???) genes in wheatproj.
## could start with PPR.hmm from pfam since easy.
## so finish surveying hmmsearch criteria for output (i.e., in PPR.out file). ## Note criteria, p-544, cheng paper.


## line 8822, hmmalign the **1st** output from 1st hmmsearch 

## line 8848, (Q: note, looks like maybe there should *not* be 'redirection' command ">" when run hmmbuild command ?????????????, see p-20, output '.hmm' file name will be name given in hmmbuild command ?????????????

## line 8875, 2nd run of hmmsearch with 'refined' '.hmm'

## line 8937, blastp, Q: do I want to do vs uniprotKB ***??????????***
## line 9099, slurm blastp (FAILED)
## ran uniref90, WHAT VALUE ??????????????????, listed in recent trinotate paper ???????,
## line 9214, ran slurm blastp *uniprotKB* 
## line 9231, nearly same number hit as uniref90
## line 9237, names hits different
## line 9257, compare trinity DE'd wi blastp output from NB-ARC proteins.
## line 9356, ran 'comm' command
## to line 10056 (Q: later to review)

STOPPED



